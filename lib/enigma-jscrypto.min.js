(function(){var b={},c={};var a={get:function(d){return b[d]},set:function(e,d){b[e]=d},exp:function(f,d){var h=f.split(".");var g=c;for(var e in h){if("undefined"==typeof g[h[e]]){if(e==h.length-1){g[h[e]]=d;break}g[h[e]]={}}g=g[h[e]]}}};(function(f){function i(n){var m,l,o=0,k;for(m=0;m<n.length;m++){o+=n[m].byteLength}var p=new Uint8Array(o),q=0;for(m=0;m<n.length;m++){k=new Uint8Array(n[m]);for(l=0;l<k.length;l++){p[q]=k[l];q+=1}}return p.buffer}function d(k,j){if(k.byteLength!=j.byteLength){throw Error("xor-unequal-length-buffer")}var n=new Uint8Array(k.byteLength),m=new Uint8Array(k),o=new Uint8Array(j);for(var l=0;l<n.length;l++){n[l]=m[l]^o[l]}return n.buffer}function g(l,k){try{var j=new Uint8Array(l),o=new Uint8Array(k)}catch(n){return false}if(j.length!=o.length){return false}for(var m=0;m<j.length;m++){if(j[m]!=o[m]){return false}}return true}function e(k){var n=new Uint8Array(k);var j=n.length-1,o=Math.floor(j/2);var q=j,p;for(var m=0;m<=o;m++){p=n[m];n[m]=n[q];n[q]=p;q-=1}return n.buffer}var h={concat:i,xor:d,equal:g,reverse:e};f.set("util.buffer",h);f.exp("util.buffer",h)})(a);(function(d){function e(g,x){var z=this;var p=null;var o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",y="0123456789abcdef";var u=d.get("util.type")(g);if(u.isArrayBuffer()){p=g}else{if(u.isArray()){var h=new Uint8Array(g.length);for(var q=0;q<h.length;q++){h[q]=g[q]&255}p=h.buffer}else{if(u.isString()){if(!x){x=""}switch(x.toLowerCase()){case"hex":if(!/^[0-9a-f]+$/i.test(g)||0!=g.length%2){throw Error("invalid-encoding-choosen")}g=g.toLowerCase();var l=new Uint8Array(g.length/2);for(var q=0;q<l.length;q++){l[q]=y.indexOf(g[2*q])*16+y.indexOf(g[2*q+1])}p=l.buffer;break;case"base64":if(/(=[^=]+|={3,})$/.test(g)){throw Error("invalid-encoding-choosen")}g=g.replace(/=/g,"");var k=g.length&3;if(1==k){throw Error("invalid-encoding-choosen")}var q=0,m=0,r=Math.ceil(g.length/4);var l=new Uint8Array(r*3);var w,v,t,s;for(q=0;q<r;q++){w=o.indexOf(g[m++]||"A");v=o.indexOf(g[m++]||"A");t=o.indexOf(g[m++]||"A");s=o.indexOf(g[m++]||"A");if((w|v|t|s)<0){throw Error("invalid-encoding-choosen")}l[q*3]=((w<<2)|(v>>4))&255;l[q*3+1]=((v<<4)|(t>>2))&255;l[q*3+2]=((t<<6)|s)&255}p=l.buffer.slice(0,l.length+k-4);break;default:var l=new Uint16Array(g.length);for(var q=0;q<g.length;q++){l[q]=g.charCodeAt(q)}p=l.buffer;break}}else{throw Error("unknown-encoding")}}}this.toArrayBuffer=function(){return p};this.toUTF16=function(){var j=new Uint16Array(p),A="";for(var n=0;n<j.length;n++){A+=String.fromCharCode(j[n])}return A};this.toBase64=function(){var F=new Uint8Array(p);var C=0,B=0,A=0,D=F.length/3;var n="";var H,G,E;for(C=0;C<D;++C){H=F[B++];G=F[B++];E=F[B++];n+=o[H>>2]+o[((H<<4)&63)|(G>>4)]+(isNaN(G)?"=":o[((G<<2)&63)|(E>>6)])+(isNaN(G+E)?"=":o[E&63])}console.log(F.length);return n};this.toHEX=function(){var j=new Uint8Array(p),A="";for(var n=0;n<j.length;n++){if(j[n]<16){A+="0"+j[n].toString(16)}else{A+=j[n].toString(16)}}return A};this.toArray=function(){var j=new Uint8Array(p),n=new Array(j.length);for(var A=0;A<n.length;A++){n[A]=j[A]}return n};return this}var f=function(h,g){return new e(h,g)};d.set("util.encoding",f);d.exp("util.encoding",f)})(a);(function(d){var e={notice:function(f){console.log(f)},error:function(f){console.error(f)}};if("undefined"!=typeof module&&"undefined"!=typeof module.exports){module.exports=e}else{define([],function(){return e})}d.set("util.log",e);d.exp("util.log",e)})(a);(function(){function d(n){if(!root.util.type(n).isArrayBuffer()){throw Error("invalid-input")}var f=new Uint8Array(n);var h,l={},k,g,m="",o=[],j=256;for(h=0;h<256;h+=1){l[String.fromCharCode(h)]=h}for(h=0;h<f.length;h+=1){k=String.fromCharCode(f[h]);g=m+k;if(l.hasOwnProperty(g)){m=g}else{o.push(l[m]);l[g]=j++;m=String(k)}}if(""!==m){o.push(l[m])}return o}function e(n){var l,o=[],h,g,j,m="",f=256;for(l=0;l<256;l+=1){o[l]=String.fromCharCode(l)}h=String.fromCharCode(compressed[0]);g=h;for(l=1;l<compressed.length;l+=1){j=compressed[l];if(o[j]){m=o[j]}else{if(j===f){m=h+h.charAt(0)}else{return null}}g+=m;o[f++]=h+m.charAt(0);h=m}return g}})();(function(m){function j(u,i){return(((u)<<(i))|((u)>>>(32-(i))))}function f(y,v){var w;var u=new Uint32Array(16);for(w=0;w<16;w++){u[w]=y[w]}for(w=0;w<20;w++){u[4]^=j(u[0]+u[12],7);u[8]^=j(u[4]+u[0],9);u[12]^=j(u[8]+u[4],13);u[0]^=j(u[12]+u[8],18);u[9]^=j(u[5]+u[1],7);u[13]^=j(u[9]+u[5],9);u[1]^=j(u[13]+u[9],13);u[5]^=j(u[1]+u[13],18);u[14]^=j(u[10]+u[6],7);u[2]^=j(u[14]+u[10],9);u[6]^=j(u[2]+u[14],13);u[10]^=j(u[6]+u[2],18);u[3]^=j(u[15]+u[11],7);u[7]^=j(u[3]+u[15],9);u[11]^=j(u[7]+u[3],13);u[15]^=j(u[11]+u[7],18);u[1]^=j(u[0]+u[3],7);u[2]^=j(u[1]+u[0],9);u[3]^=j(u[2]+u[1],13);u[0]^=j(u[3]+u[2],18);u[6]^=j(u[5]+u[4],7);u[7]^=j(u[6]+u[5],9);u[4]^=j(u[7]+u[6],13);u[5]^=j(u[4]+u[7],18);u[11]^=j(u[10]+u[9],7);u[8]^=j(u[11]+u[10],9);u[9]^=j(u[8]+u[11],13);u[10]^=j(u[9]+u[8],18);u[12]^=j(u[15]+u[14],7);u[13]^=j(u[12]+u[15],9);u[14]^=j(u[13]+u[12],13);u[15]^=j(u[14]+u[13],18)}for(w=0;w<16;w++){v[w]=u[w]+y[w]}}var l=new Uint8Array(16);function r(){for(var u=0;u<16;u++){l[u]=Math.floor(256*Math.random())}}r();var d=new Uint32Array([0,0]);function n(){d[0]=0;d[1]=0}function p(){d[0]+=1;if(0==d[0]){d[1]+=1}if(0==d[1]){r()}}var s=new Uint8Array(32),e=0;function t(i){s[e]=i;e+=1;if(e>=32){n();e=0}}for(var h=0;h<32;h++){t(Math.floor(256*Math.random()))}function g(){t(new Date().getTime()%256)}setInterval(g,100);var q=new Uint32Array([1634760805,857760878,2036477234,1797285236]);function k(u){var i=new Uint32Array(16),v=new Uint32Array(l.buffer),w=new Uint32Array(s.buffer);i[0]=q[0];i[1]=w[0];i[2]=w[1];i[3]=w[2];i[4]=w[3];i[5]=q[1];i[6]=v[0];i[7]=v[1];i[8]=d[0];i[9]=d[1];i[10]=q[2];i[11]=w[4];i[12]=w[5];i[13]=w[6];i[14]=w[7];i[15]=q[3];p();return f(i,u)}function o(){var i=this;var u=new Uint32Array(16);this.touch=function(){g()};this.bytes=function(A){var v=Math.ceil(A/64);var x=new Uint8Array(A),y=0,w=0,B;for(var z=0;z<v;z++){k(u);B=new Uint8Array(u.buffer);for(y=0;y<64;y++){if(w>=A){break}x[w]=B[y];w+=1}}return x.buffer};this.array=function(v){return new Uint8Array(i.bytes(v))};return this}m.set("util.srand",o);m.exp("util.srand",o)})(a);(function(d){function e(f){return{isError:function(){return toString.apply(f)==="[object Error]"},isArray:function(){return toString.apply(f)==="[object Array]"},isDate:function(){return toString.apply(f)==="[object Date]"},isObject:function(){return !!f&&Object.prototype.toString.call(f)==="[object Object]"},isPrimitive:function(){return self.isString(f)||self.isNumber(f)||self.isBoolean(f)},isFunction:function(){return toString.apply(f)==="[object Function]"},isDate:function(){return toString.apply(f)==="[object Date]"},isNumber:function(){return typeof f==="number"&&isFinite(f)},isString:function(){return typeof f==="string"},isBoolean:function(){return typeof f==="boolean"},isArrayBuffer:function(){return toString.apply(f)==="[object ArrayBuffer]"}}}d.set("util.type",e);d.exp("util.type",e)})(a);(function(e){function f(l,j){if(typeof l==="undefined"){l=32}this.isFinished=false;this.digestLength=32;this.blockLength=64;this.iv=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];if(l<=0){l=this.digestLength}else{if(l>32){throw"digestLength is too large"}}var g=0;if(typeof j=="string"){j=this.stringToUtf8Array(j);g=j.length}else{if(typeof j=="object"){g=j.length}}if(g>32){throw"key too long"}var k=[l&255,g,1,1];this.h=this.iv.slice(0);this.h[0]^=this.load32(k,0);this.x=new Array(64);this.t0=0;this.t1=0;this.f0=0;this.f1=0;this.nx=0;this.digestLength=l;if(g>0){for(var h=0;h<g;h++){this.x[h]=j[h]}for(var h=g;h<64;h++){this.x[h]=0}this.nx=64}}f.prototype.load32=function(g,h){return((g[h]&255)|((g[h+1]&255)<<8)|((g[h+2]&255)<<16)|((g[h+3]&255)<<24))>>>0};f.prototype.store32=function(h,i,g){h[i]=(g>>>0)&255;h[i+1]=(g>>>8)&255;h[i+2]=(g>>>16)&255;h[i+3]=(g>>>24)&255};f.prototype.processBlock=function(r){this.t0+=r;if(this.t0!=this.t0>>>0){this.t0=0;this.t1++}var q=this.h[0],p=this.h[1],o=this.h[2],n=this.h[3],l=this.h[4],j=this.h[5],h=this.h[6],M=this.h[7],K=this.iv[0],I=this.iv[1],F=this.iv[2],C=this.iv[3],z=this.iv[4]^this.t0,w=this.iv[5]^this.t1,u=this.iv[6]^this.f0,s=this.iv[7]^this.f1;var m=this.load32(this.x,0),k=this.load32(this.x,4),i=this.load32(this.x,8),g=this.load32(this.x,12),L=this.load32(this.x,16),J=this.load32(this.x,20),H=this.load32(this.x,24),E=this.load32(this.x,28),B=this.load32(this.x,32),y=this.load32(this.x,36),G=this.load32(this.x,40),D=this.load32(this.x,44),A=this.load32(this.x,48),x=this.load32(this.x,52),v=this.load32(this.x,56),t=this.load32(this.x,60);q+=m;q+=l;z^=q;z=z<<(32-16)|z>>>16;K+=z;l^=K;l=l<<(32-12)|l>>>12;p+=i;p+=j;w^=p;w=w<<(32-16)|w>>>16;I+=w;j^=I;j=j<<(32-12)|j>>>12;o+=L;o+=h;u^=o;u=u<<(32-16)|u>>>16;F+=u;h^=F;h=h<<(32-12)|h>>>12;n+=H;n+=M;s^=n;s=s<<(32-16)|s>>>16;C+=s;M^=C;M=M<<(32-12)|M>>>12;o+=J;o+=h;u^=o;u=u<<(32-8)|u>>>8;F+=u;h^=F;h=h<<(32-7)|h>>>7;n+=E;n+=M;s^=n;s=s<<(32-8)|s>>>8;C+=s;M^=C;M=M<<(32-7)|M>>>7;p+=g;p+=j;w^=p;w=w<<(32-8)|w>>>8;I+=w;j^=I;j=j<<(32-7)|j>>>7;q+=k;q+=l;z^=q;z=z<<(32-8)|z>>>8;K+=z;l^=K;l=l<<(32-7)|l>>>7;q+=B;q+=j;s^=q;s=s<<(32-16)|s>>>16;F+=s;j^=F;j=j<<(32-12)|j>>>12;p+=G;p+=h;z^=p;z=z<<(32-16)|z>>>16;C+=z;h^=C;h=h<<(32-12)|h>>>12;o+=A;o+=M;w^=o;w=w<<(32-16)|w>>>16;K+=w;M^=K;M=M<<(32-12)|M>>>12;n+=v;n+=l;u^=n;u=u<<(32-16)|u>>>16;I+=u;l^=I;l=l<<(32-12)|l>>>12;o+=x;o+=M;w^=o;w=w<<(32-8)|w>>>8;K+=w;M^=K;M=M<<(32-7)|M>>>7;n+=t;n+=l;u^=n;u=u<<(32-8)|u>>>8;I+=u;l^=I;l=l<<(32-7)|l>>>7;p+=D;p+=h;z^=p;z=z<<(32-8)|z>>>8;C+=z;h^=C;h=h<<(32-7)|h>>>7;q+=y;q+=j;s^=q;s=s<<(32-8)|s>>>8;F+=s;j^=F;j=j<<(32-7)|j>>>7;q+=v;q+=l;z^=q;z=z<<(32-16)|z>>>16;K+=z;l^=K;l=l<<(32-12)|l>>>12;p+=L;p+=j;w^=p;w=w<<(32-16)|w>>>16;I+=w;j^=I;j=j<<(32-12)|j>>>12;o+=y;o+=h;u^=o;u=u<<(32-16)|u>>>16;F+=u;h^=F;h=h<<(32-12)|h>>>12;n+=x;n+=M;s^=n;s=s<<(32-16)|s>>>16;C+=s;M^=C;M=M<<(32-12)|M>>>12;o+=t;o+=h;u^=o;u=u<<(32-8)|u>>>8;F+=u;h^=F;h=h<<(32-7)|h>>>7;n+=H;n+=M;s^=n;s=s<<(32-8)|s>>>8;C+=s;M^=C;M=M<<(32-7)|M>>>7;p+=B;p+=j;w^=p;w=w<<(32-8)|w>>>8;I+=w;j^=I;j=j<<(32-7)|j>>>7;q+=G;q+=l;z^=q;z=z<<(32-8)|z>>>8;K+=z;l^=K;l=l<<(32-7)|l>>>7;q+=k;q+=j;s^=q;s=s<<(32-16)|s>>>16;F+=s;j^=F;j=j<<(32-12)|j>>>12;p+=m;p+=h;z^=p;z=z<<(32-16)|z>>>16;C+=z;h^=C;h=h<<(32-12)|h>>>12;o+=D;o+=M;w^=o;w=w<<(32-16)|w>>>16;K+=w;M^=K;M=M<<(32-12)|M>>>12;n+=J;n+=l;u^=n;u=u<<(32-16)|u>>>16;I+=u;l^=I;l=l<<(32-12)|l>>>12;o+=E;o+=M;w^=o;w=w<<(32-8)|w>>>8;K+=w;M^=K;M=M<<(32-7)|M>>>7;n+=g;n+=l;u^=n;u=u<<(32-8)|u>>>8;I+=u;l^=I;l=l<<(32-7)|l>>>7;p+=i;p+=h;z^=p;z=z<<(32-8)|z>>>8;C+=z;h^=C;h=h<<(32-7)|h>>>7;q+=A;q+=j;s^=q;s=s<<(32-8)|s>>>8;F+=s;j^=F;j=j<<(32-7)|j>>>7;q+=D;q+=l;z^=q;z=z<<(32-16)|z>>>16;K+=z;l^=K;l=l<<(32-12)|l>>>12;p+=A;p+=j;w^=p;w=w<<(32-16)|w>>>16;I+=w;j^=I;j=j<<(32-12)|j>>>12;o+=J;o+=h;u^=o;u=u<<(32-16)|u>>>16;F+=u;h^=F;h=h<<(32-12)|h>>>12;n+=t;n+=M;s^=n;s=s<<(32-16)|s>>>16;C+=s;M^=C;M=M<<(32-12)|M>>>12;o+=i;o+=h;u^=o;u=u<<(32-8)|u>>>8;F+=u;h^=F;h=h<<(32-7)|h>>>7;n+=x;n+=M;s^=n;s=s<<(32-8)|s>>>8;C+=s;M^=C;M=M<<(32-7)|M>>>7;p+=m;p+=j;w^=p;w=w<<(32-8)|w>>>8;I+=w;j^=I;j=j<<(32-7)|j>>>7;q+=B;q+=l;z^=q;z=z<<(32-8)|z>>>8;K+=z;l^=K;l=l<<(32-7)|l>>>7;q+=G;q+=j;s^=q;s=s<<(32-16)|s>>>16;F+=s;j^=F;j=j<<(32-12)|j>>>12;p+=g;p+=h;z^=p;z=z<<(32-16)|z>>>16;C+=z;h^=C;h=h<<(32-12)|h>>>12;o+=E;o+=M;w^=o;w=w<<(32-16)|w>>>16;K+=w;M^=K;M=M<<(32-12)|M>>>12;n+=y;n+=l;u^=n;u=u<<(32-16)|u>>>16;I+=u;l^=I;l=l<<(32-12)|l>>>12;o+=k;o+=M;w^=o;w=w<<(32-8)|w>>>8;K+=w;M^=K;M=M<<(32-7)|M>>>7;n+=L;n+=l;u^=n;u=u<<(32-8)|u>>>8;I+=u;l^=I;l=l<<(32-7)|l>>>7;p+=H;p+=h;z^=p;z=z<<(32-8)|z>>>8;C+=z;h^=C;h=h<<(32-7)|h>>>7;q+=v;q+=j;s^=q;s=s<<(32-8)|s>>>8;F+=s;j^=F;j=j<<(32-7)|j>>>7;q+=E;q+=l;z^=q;z=z<<(32-16)|z>>>16;K+=z;l^=K;l=l<<(32-12)|l>>>12;p+=g;p+=j;w^=p;w=w<<(32-16)|w>>>16;I+=w;j^=I;j=j<<(32-12)|j>>>12;o+=x;o+=h;u^=o;u=u<<(32-16)|u>>>16;F+=u;h^=F;h=h<<(32-12)|h>>>12;n+=D;n+=M;s^=n;s=s<<(32-16)|s>>>16;C+=s;M^=C;M=M<<(32-12)|M>>>12;o+=A;o+=h;u^=o;u=u<<(32-8)|u>>>8;F+=u;h^=F;h=h<<(32-7)|h>>>7;n+=v;n+=M;s^=n;s=s<<(32-8)|s>>>8;C+=s;M^=C;M=M<<(32-7)|M>>>7;p+=k;p+=j;w^=p;w=w<<(32-8)|w>>>8;I+=w;j^=I;j=j<<(32-7)|j>>>7;q+=y;q+=l;z^=q;z=z<<(32-8)|z>>>8;K+=z;l^=K;l=l<<(32-7)|l>>>7;q+=i;q+=j;s^=q;s=s<<(32-16)|s>>>16;F+=s;j^=F;j=j<<(32-12)|j>>>12;p+=J;p+=h;z^=p;z=z<<(32-16)|z>>>16;C+=z;h^=C;h=h<<(32-12)|h>>>12;o+=L;o+=M;w^=o;w=w<<(32-16)|w>>>16;K+=w;M^=K;M=M<<(32-12)|M>>>12;n+=t;n+=l;u^=n;u=u<<(32-16)|u>>>16;I+=u;l^=I;l=l<<(32-12)|l>>>12;o+=m;o+=M;w^=o;w=w<<(32-8)|w>>>8;K+=w;M^=K;M=M<<(32-7)|M>>>7;n+=B;n+=l;u^=n;u=u<<(32-8)|u>>>8;I+=u;l^=I;l=l<<(32-7)|l>>>7;p+=G;p+=h;z^=p;z=z<<(32-8)|z>>>8;C+=z;h^=C;h=h<<(32-7)|h>>>7;q+=H;q+=j;s^=q;s=s<<(32-8)|s>>>8;F+=s;j^=F;j=j<<(32-7)|j>>>7;q+=y;q+=l;z^=q;z=z<<(32-16)|z>>>16;K+=z;l^=K;l=l<<(32-12)|l>>>12;p+=J;p+=j;w^=p;w=w<<(32-16)|w>>>16;I+=w;j^=I;j=j<<(32-12)|j>>>12;o+=i;o+=h;u^=o;u=u<<(32-16)|u>>>16;F+=u;h^=F;h=h<<(32-12)|h>>>12;n+=G;n+=M;s^=n;s=s<<(32-16)|s>>>16;C+=s;M^=C;M=M<<(32-12)|M>>>12;o+=L;o+=h;u^=o;u=u<<(32-8)|u>>>8;F+=u;h^=F;h=h<<(32-7)|h>>>7;n+=t;n+=M;s^=n;s=s<<(32-8)|s>>>8;C+=s;M^=C;M=M<<(32-7)|M>>>7;p+=E;p+=j;w^=p;w=w<<(32-8)|w>>>8;I+=w;j^=I;j=j<<(32-7)|j>>>7;q+=m;q+=l;z^=q;z=z<<(32-8)|z>>>8;K+=z;l^=K;l=l<<(32-7)|l>>>7;q+=v;q+=j;s^=q;s=s<<(32-16)|s>>>16;F+=s;j^=F;j=j<<(32-12)|j>>>12;p+=D;p+=h;z^=p;z=z<<(32-16)|z>>>16;C+=z;h^=C;h=h<<(32-12)|h>>>12;o+=H;o+=M;w^=o;w=w<<(32-16)|w>>>16;K+=w;M^=K;M=M<<(32-12)|M>>>12;n+=g;n+=l;u^=n;u=u<<(32-16)|u>>>16;I+=u;l^=I;l=l<<(32-12)|l>>>12;o+=B;o+=M;w^=o;w=w<<(32-8)|w>>>8;K+=w;M^=K;M=M<<(32-7)|M>>>7;n+=x;n+=l;u^=n;u=u<<(32-8)|u>>>8;I+=u;l^=I;l=l<<(32-7)|l>>>7;p+=A;p+=h;z^=p;z=z<<(32-8)|z>>>8;C+=z;h^=C;h=h<<(32-7)|h>>>7;q+=k;q+=j;s^=q;s=s<<(32-8)|s>>>8;F+=s;j^=F;j=j<<(32-7)|j>>>7;q+=i;q+=l;z^=q;z=z<<(32-16)|z>>>16;K+=z;l^=K;l=l<<(32-12)|l>>>12;p+=H;p+=j;w^=p;w=w<<(32-16)|w>>>16;I+=w;j^=I;j=j<<(32-12)|j>>>12;o+=m;o+=h;u^=o;u=u<<(32-16)|u>>>16;F+=u;h^=F;h=h<<(32-12)|h>>>12;n+=B;n+=M;s^=n;s=s<<(32-16)|s>>>16;C+=s;M^=C;M=M<<(32-12)|M>>>12;o+=D;o+=h;u^=o;u=u<<(32-8)|u>>>8;F+=u;h^=F;h=h<<(32-7)|h>>>7;n+=g;n+=M;s^=n;s=s<<(32-8)|s>>>8;C+=s;M^=C;M=M<<(32-7)|M>>>7;p+=G;p+=j;w^=p;w=w<<(32-8)|w>>>8;I+=w;j^=I;j=j<<(32-7)|j>>>7;q+=A;q+=l;z^=q;z=z<<(32-8)|z>>>8;K+=z;l^=K;l=l<<(32-7)|l>>>7;q+=L;q+=j;s^=q;s=s<<(32-16)|s>>>16;F+=s;j^=F;j=j<<(32-12)|j>>>12;p+=E;p+=h;z^=p;z=z<<(32-16)|z>>>16;C+=z;h^=C;h=h<<(32-12)|h>>>12;o+=t;o+=M;w^=o;w=w<<(32-16)|w>>>16;K+=w;M^=K;M=M<<(32-12)|M>>>12;n+=k;n+=l;u^=n;u=u<<(32-16)|u>>>16;I+=u;l^=I;l=l<<(32-12)|l>>>12;o+=v;o+=M;w^=o;w=w<<(32-8)|w>>>8;K+=w;M^=K;M=M<<(32-7)|M>>>7;n+=y;n+=l;u^=n;u=u<<(32-8)|u>>>8;I+=u;l^=I;l=l<<(32-7)|l>>>7;p+=J;p+=h;z^=p;z=z<<(32-8)|z>>>8;C+=z;h^=C;h=h<<(32-7)|h>>>7;q+=x;q+=j;s^=q;s=s<<(32-8)|s>>>8;F+=s;j^=F;j=j<<(32-7)|j>>>7;q+=A;q+=l;z^=q;z=z<<(32-16)|z>>>16;K+=z;l^=K;l=l<<(32-12)|l>>>12;p+=k;p+=j;w^=p;w=w<<(32-16)|w>>>16;I+=w;j^=I;j=j<<(32-12)|j>>>12;o+=v;o+=h;u^=o;u=u<<(32-16)|u>>>16;F+=u;h^=F;h=h<<(32-12)|h>>>12;n+=L;n+=M;s^=n;s=s<<(32-16)|s>>>16;C+=s;M^=C;M=M<<(32-12)|M>>>12;o+=x;o+=h;u^=o;u=u<<(32-8)|u>>>8;F+=u;h^=F;h=h<<(32-7)|h>>>7;n+=G;n+=M;s^=n;s=s<<(32-8)|s>>>8;C+=s;M^=C;M=M<<(32-7)|M>>>7;p+=t;p+=j;w^=p;w=w<<(32-8)|w>>>8;I+=w;j^=I;j=j<<(32-7)|j>>>7;q+=J;q+=l;z^=q;z=z<<(32-8)|z>>>8;K+=z;l^=K;l=l<<(32-7)|l>>>7;q+=m;q+=j;s^=q;s=s<<(32-16)|s>>>16;F+=s;j^=F;j=j<<(32-12)|j>>>12;p+=H;p+=h;z^=p;z=z<<(32-16)|z>>>16;C+=z;h^=C;h=h<<(32-12)|h>>>12;o+=y;o+=M;w^=o;w=w<<(32-16)|w>>>16;K+=w;M^=K;M=M<<(32-12)|M>>>12;n+=B;n+=l;u^=n;u=u<<(32-16)|u>>>16;I+=u;l^=I;l=l<<(32-12)|l>>>12;o+=i;o+=M;w^=o;w=w<<(32-8)|w>>>8;K+=w;M^=K;M=M<<(32-7)|M>>>7;n+=D;n+=l;u^=n;u=u<<(32-8)|u>>>8;I+=u;l^=I;l=l<<(32-7)|l>>>7;p+=g;p+=h;z^=p;z=z<<(32-8)|z>>>8;C+=z;h^=C;h=h<<(32-7)|h>>>7;q+=E;q+=j;s^=q;s=s<<(32-8)|s>>>8;F+=s;j^=F;j=j<<(32-7)|j>>>7;q+=x;q+=l;z^=q;z=z<<(32-16)|z>>>16;K+=z;l^=K;l=l<<(32-12)|l>>>12;p+=E;p+=j;w^=p;w=w<<(32-16)|w>>>16;I+=w;j^=I;j=j<<(32-12)|j>>>12;o+=A;o+=h;u^=o;u=u<<(32-16)|u>>>16;F+=u;h^=F;h=h<<(32-12)|h>>>12;n+=g;n+=M;s^=n;s=s<<(32-16)|s>>>16;C+=s;M^=C;M=M<<(32-12)|M>>>12;o+=k;o+=h;u^=o;u=u<<(32-8)|u>>>8;F+=u;h^=F;h=h<<(32-7)|h>>>7;n+=y;n+=M;s^=n;s=s<<(32-8)|s>>>8;C+=s;M^=C;M=M<<(32-7)|M>>>7;p+=v;p+=j;w^=p;w=w<<(32-8)|w>>>8;I+=w;j^=I;j=j<<(32-7)|j>>>7;q+=D;q+=l;z^=q;z=z<<(32-8)|z>>>8;K+=z;l^=K;l=l<<(32-7)|l>>>7;q+=J;q+=j;s^=q;s=s<<(32-16)|s>>>16;F+=s;j^=F;j=j<<(32-12)|j>>>12;p+=t;p+=h;z^=p;z=z<<(32-16)|z>>>16;C+=z;h^=C;h=h<<(32-12)|h>>>12;o+=B;o+=M;w^=o;w=w<<(32-16)|w>>>16;K+=w;M^=K;M=M<<(32-12)|M>>>12;n+=i;n+=l;u^=n;u=u<<(32-16)|u>>>16;I+=u;l^=I;l=l<<(32-12)|l>>>12;o+=H;o+=M;w^=o;w=w<<(32-8)|w>>>8;K+=w;M^=K;M=M<<(32-7)|M>>>7;n+=G;n+=l;u^=n;u=u<<(32-8)|u>>>8;I+=u;l^=I;l=l<<(32-7)|l>>>7;p+=L;p+=h;z^=p;z=z<<(32-8)|z>>>8;C+=z;h^=C;h=h<<(32-7)|h>>>7;q+=m;q+=j;s^=q;s=s<<(32-8)|s>>>8;F+=s;j^=F;j=j<<(32-7)|j>>>7;q+=H;q+=l;z^=q;z=z<<(32-16)|z>>>16;K+=z;l^=K;l=l<<(32-12)|l>>>12;p+=v;p+=j;w^=p;w=w<<(32-16)|w>>>16;I+=w;j^=I;j=j<<(32-12)|j>>>12;o+=D;o+=h;u^=o;u=u<<(32-16)|u>>>16;F+=u;h^=F;h=h<<(32-12)|h>>>12;n+=m;n+=M;s^=n;s=s<<(32-16)|s>>>16;C+=s;M^=C;M=M<<(32-12)|M>>>12;o+=g;o+=h;u^=o;u=u<<(32-8)|u>>>8;F+=u;h^=F;h=h<<(32-7)|h>>>7;n+=B;n+=M;s^=n;s=s<<(32-8)|s>>>8;C+=s;M^=C;M=M<<(32-7)|M>>>7;p+=y;p+=j;w^=p;w=w<<(32-8)|w>>>8;I+=w;j^=I;j=j<<(32-7)|j>>>7;q+=t;q+=l;z^=q;z=z<<(32-8)|z>>>8;K+=z;l^=K;l=l<<(32-7)|l>>>7;q+=A;q+=j;s^=q;s=s<<(32-16)|s>>>16;F+=s;j^=F;j=j<<(32-12)|j>>>12;p+=x;p+=h;z^=p;z=z<<(32-16)|z>>>16;C+=z;h^=C;h=h<<(32-12)|h>>>12;o+=k;o+=M;w^=o;w=w<<(32-16)|w>>>16;K+=w;M^=K;M=M<<(32-12)|M>>>12;n+=G;n+=l;u^=n;u=u<<(32-16)|u>>>16;I+=u;l^=I;l=l<<(32-12)|l>>>12;o+=L;o+=M;w^=o;w=w<<(32-8)|w>>>8;K+=w;M^=K;M=M<<(32-7)|M>>>7;n+=J;n+=l;u^=n;u=u<<(32-8)|u>>>8;I+=u;l^=I;l=l<<(32-7)|l>>>7;p+=E;p+=h;z^=p;z=z<<(32-8)|z>>>8;C+=z;h^=C;h=h<<(32-7)|h>>>7;q+=i;q+=j;s^=q;s=s<<(32-8)|s>>>8;F+=s;j^=F;j=j<<(32-7)|j>>>7;q+=G;q+=l;z^=q;z=z<<(32-16)|z>>>16;K+=z;l^=K;l=l<<(32-12)|l>>>12;p+=B;p+=j;w^=p;w=w<<(32-16)|w>>>16;I+=w;j^=I;j=j<<(32-12)|j>>>12;o+=E;o+=h;u^=o;u=u<<(32-16)|u>>>16;F+=u;h^=F;h=h<<(32-12)|h>>>12;n+=k;n+=M;s^=n;s=s<<(32-16)|s>>>16;C+=s;M^=C;M=M<<(32-12)|M>>>12;o+=H;o+=h;u^=o;u=u<<(32-8)|u>>>8;F+=u;h^=F;h=h<<(32-7)|h>>>7;n+=J;n+=M;s^=n;s=s<<(32-8)|s>>>8;C+=s;M^=C;M=M<<(32-7)|M>>>7;p+=L;p+=j;w^=p;w=w<<(32-8)|w>>>8;I+=w;j^=I;j=j<<(32-7)|j>>>7;q+=i;q+=l;z^=q;z=z<<(32-8)|z>>>8;K+=z;l^=K;l=l<<(32-7)|l>>>7;q+=t;q+=j;s^=q;s=s<<(32-16)|s>>>16;F+=s;j^=F;j=j<<(32-12)|j>>>12;p+=y;p+=h;z^=p;z=z<<(32-16)|z>>>16;C+=z;h^=C;h=h<<(32-12)|h>>>12;o+=g;o+=M;w^=o;w=w<<(32-16)|w>>>16;K+=w;M^=K;M=M<<(32-12)|M>>>12;n+=x;n+=l;u^=n;u=u<<(32-16)|u>>>16;I+=u;l^=I;l=l<<(32-12)|l>>>12;o+=A;o+=M;w^=o;w=w<<(32-8)|w>>>8;K+=w;M^=K;M=M<<(32-7)|M>>>7;n+=m;n+=l;u^=n;u=u<<(32-8)|u>>>8;I+=u;l^=I;l=l<<(32-7)|l>>>7;p+=v;p+=h;z^=p;z=z<<(32-8)|z>>>8;C+=z;h^=C;h=(h<<(32-7))|(h>>>7);q+=D;q+=j;s^=q;s=(s<<(32-8))|(s>>>8);F+=s;j^=F;j=(j<<(32-7))|(j>>>7);this.h[0]^=q^K;this.h[1]^=p^I;this.h[2]^=o^F;this.h[3]^=n^C;this.h[4]^=l^z;this.h[5]^=j^w;this.h[6]^=h^u;this.h[7]^=M^s};f.prototype.stringToUtf8Array=function(j){var g=[];for(var h=0;h<j.length;h++){var k=j.charCodeAt(h);if(k<128){g.push(k)}else{if(k>127&&k<2048){g.push((k>>6)|192);g.push((k&63)|128)}else{g.push((k>>12)|224);g.push(((k>>6)&63)|128);g.push((k&64)|128)}}}return g};f.prototype.update=function(k,l,h){if(typeof l==="undefined"){l=0}if(typeof h==="undefined"){h=k.length}if(this.isFinished){throw"update() after calling digest()"}if(typeof k=="string"){if(l!=0){throw"offset not supported for strings"}k=this.stringToUtf8Array(k);h=k.length;l=0}else{if(typeof k!="object"){throw"unsupported object: string or array required"}}if(h==0){return}var j=64-this.nx;if(h>j){for(var g=0;g<j;g++){this.x[this.nx+g]=k[l+g]}this.processBlock(64);l+=j;h-=j;this.nx=0}while(h>64){for(var g=0;g<64;g++){this.x[g]=k[l+g]}this.processBlock(64);l+=64;h-=64;this.nx=0}for(var g=0;g<h;g++){this.x[this.nx+g]=k[l+g]}this.nx+=h};f.prototype.digest=function(){if(this.isFinished){return this.result}for(var j=this.nx;j<64;j++){this.x[j]=0}this.f0=4294967295;this.processBlock(this.nx);var g=new Array(32);for(var j=0;j<8;j++){var k=this.h[j];g[j*4+0]=(k>>>0)&255;g[j*4+1]=(k>>>8)&255;g[j*4+2]=(k>>>16)&255;g[j*4+3]=(k>>>24)&255}this.result=g.slice(0,this.digestLength);this.isFinished=true;return this.result};function d(i){var g=this;this.name="BLAKE2s";this.blockSize=32;if(i&&e.get("util.type")(i.length).isNumber()&&i.length<=32&&i.length>=1){this.digestSize=Math.floor(i.length)}else{this.digestSize=32}function h(l,k){if(k){var j=new f(g.digestSize,new Uint8Array(k))}else{var j=new f(g.digestSize)}j.update(new Uint8Array(l));return new Uint8Array(j.digest()).buffer}this.mac=function(k,j){if(j.byteLength>32){j=j.slice(0,32)}return h(k,j)};this.hash=function(j){return h(j)};return this}e.set("hash.algorithms.blake2s",d)})(a);(function(e){var f={};function g(k,j){var i=this;this.algorithms=["ripemd160","blake2s","whirlpool"];k=k.toLowerCase();if(this.algorithms.indexOf(k)<0){throw new Error("hash-algorithm-unknown")}var m=e.get("hash.algorithms."+k);function l(n){return{hex:e.get("util.encoding")(n).toHEX(),buffer:n}}this.hash=function(o){if(!e.get("util.type")(o).isArrayBuffer()){throw Error("invalid-parameter")}var n=new m(j);return l(n.hash(o))};this.mac=function(p,q){if(!(e.get("util.type")(q).isArrayBuffer()&&e.get("util.type")(p).isArrayBuffer())){throw Error("invalid-parameter")}var o;var n=new m(j);if(e.get("util.type")(n.mac).isFunction()){o=n.mac(p,q)}else{o=h(n.hash,q,p,n.blockSize)}return l(o)};this.pbkdf2=function(o,n,q,p){if(!(e.get("util.type")(o).isArrayBuffer()&&e.get("util.type")(n).isArrayBuffer()&&q>0&&p>0)){throw Error("invalid-parameter")}return d(i.mac,new m().digestSize,o,n,q,p)};return this}function h(u,l,n,r){if(l.byteLength>r){l=new Uint8Array(u(l))}else{if(l.byteLength<r){var j=new Uint8Array(r),q=new Uint8Array(l);for(var o=0;o<j.length;o++){if(o<l.byteLength){j[o]=q[o]}else{j[o]=0}}l=j}}var v=new Uint8Array(r);var m=new Uint8Array(r);for(var o=0;o<r;o++){v[o]=92^l[o];m[o]=54^l[o]}var k=e.get("util.buffer").concat([m.buffer,n]),s=u(k);var t=e.get("util.buffer").concat([v.buffer,s]),p=u(t);return p}function d(x,v,r,o,m,k){var w=Math.ceil(k/v);var t=new Array(w);for(var q=0;q<w;q++){var s=false;var l=new Uint32Array([q]);var u=e.get("util.buffer").concat([o,l.buffer]);for(var p=0;p<m;p++){var n=x(r,u).buffer;if(false===s){s=n}else{s=e.get("util.buffer").xor(n,s)}u=n}t[q]=s}return e.get("util.buffer").concat(t).slice(0,k)}e.exp("hash",g);e.set("hash",g)})(a);(function(h){var i=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13];var f=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11];var s=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6];var r=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11];var g=[0,1518500249,1859775393,2400959708,2840853838];var u=[1352829926,1548603684,1836072691,2053994217,0];var d=function(w){var y=[];for(var x=0,v=0;x<w.length;x++,v+=8){y[v>>>5]|=w[x]<<(24-v%32)}return y};var j=function(x){var w=[];for(var v=0;v<x.length*32;v+=8){w.push((x[v>>>5]>>>(24-v%32))&255)}return w};var t=function(I,E,z){for(var A=0;A<16;A++){var K=z+A;var F=E[K];E[K]=((((F<<8)|(F>>>24))&16711935)|(((F<<24)|(F>>>8))&4278255360))}var C,w,G,B,v;var y,N,D,x,J;y=C=I[0];N=w=I[1];D=G=I[2];x=B=I[3];J=v=I[4];var L;for(var A=0;A<80;A+=1){L=(C+E[z+i[A]])|0;if(A<16){L+=q(w,G,B)+g[0]}else{if(A<32){L+=p(w,G,B)+g[1]}else{if(A<48){L+=o(w,G,B)+g[2]}else{if(A<64){L+=n(w,G,B)+g[3]}else{L+=m(w,G,B)+g[4]}}}}L=L|0;L=l(L,s[A]);L=(L+v)|0;C=v;v=B;B=l(G,10);G=w;w=L;L=(y+E[z+f[A]])|0;if(A<16){L+=m(N,D,x)+u[0]}else{if(A<32){L+=n(N,D,x)+u[1]}else{if(A<48){L+=o(N,D,x)+u[2]}else{if(A<64){L+=p(N,D,x)+u[3]}else{L+=q(N,D,x)+u[4]}}}}L=L|0;L=l(L,r[A]);L=(L+J)|0;y=J;J=x;x=l(D,10);D=N;N=L}L=(I[1]+G+x)|0;I[1]=(I[2]+B+J)|0;I[2]=(I[3]+v+y)|0;I[3]=(I[4]+C+N)|0;I[4]=(I[0]+w+D)|0;I[0]=L};function q(v,A,w){return((v)^(A)^(w))}function p(v,A,w){return(((v)&(A))|((~v)&(w)))}function o(v,A,w){return(((v)|(~(A)))^(w))}function n(v,A,w){return(((v)&(w))|((A)&(~(w))))}function m(v,A,w){return((v)^((A)|(~(w))))}function l(v,w){return(v<<w)|(v>>>(32-w))}function e(C){var B=[1732584193,4023233417,2562383102,271733878,3285377520],D=new Uint8Array(C);var w=d(D);var A=D.length*8;var z=D.length*8;w[A>>>5]|=128<<(24-A%32);w[(((A+64)>>>9)<<4)+14]=((((z<<8)|(z>>>24))&16711935)|(((z<<24)|(z>>>8))&4278255360));for(var x=0;x<w.length;x+=16){t(B,w,x)}var v;for(var x=0;x<5;x++){v=B[x];B[x]=(((v<<8)|(v>>>24))&16711935)|(((v<<24)|(v>>>8))&4278255360)}var y=j(B);return new Uint8Array(y).buffer}function k(){var v=this;this.name="RIPEMD160";this.blockSize=64;this.digestSize=20;this.hash=function(w){return e(w)};return this}h.set("hash.algorithms.ripemd160",k)})(a);(function(j){var G,l=10,y=[],A=[],v,u,F,z,E,h,g,e,d,J,I,w="\u1823\uc6E8\u87B8\u014F\u36A6\ud2F5\u796F\u9152\u60Bc\u9B8E\uA30c\u7B35\u1dE0\ud7c2\u2E4B\uFE57\u1577\u37E5\u9FF0\u4AdA\u58c9\u290A\uB1A0\u6B85\uBd5d\u10F4\ucB3E\u0567\uE427\u418B\uA77d\u95d8\uFBEE\u7c66\udd17\u479E\ucA2d\uBF07\uAd5A\u8333\u6302\uAA71\uc819\u49d9\uF2E3\u5B88\u9A26\u32B0\uE90F\ud580\uBEcd\u3448\uFF7A\u905F\u2068\u1AAE\uB454\u9322\u64F1\u7312\u4008\uc3Ec\udBA1\u8d3d\u9700\ucF2B\u7682\ud61B\uB5AF\u6A50\u45F3\u30EF\u3F55\uA2EA\u65BA\u2Fc0\udE1c\uFd4d\u9275\u068A\uB2E6\u0E1F\u62d4\uA896\uF9c5\u2559\u8472\u394c\u5E78\u388c\ud1A5\uE261\uB321\u9c1E\u43c7\uFc04\u5199\u6d0d\uFAdF\u7E24\u3BAB\ucE11\u8F4E\uB7EB\u3c81\u94F7\uB913\u2cd3\uE76E\uc403\u5644\u7FA9\u2ABB\uc153\udc0B\u9d6c\u3174\uF646\uAc89\u14E1\u163A\u6909\u70B6\ud0Ed\ucc42\u98A4\u285c\uF886";for(v=8;v-->0;){y[v]=[]}for(u=0;u<256;u++){F=w.charCodeAt(u/2);h=((u&1)==0)?F>>>8:F&255;g=h<<1;if(g>=256){g^=285}e=g<<1;if(e>=256){e^=285}d=e^h;J=e<<1;if(J>=256){J^=285}I=J^h;y[0][u]=[0,0];y[0][u][0]=(h<<24)|(h<<16)|(e<<8)|(h);y[0][u][1]=(J<<24)|(d<<16)|(g<<8)|(I);for(var v=1;v<8;v++){y[v][u]=[0,0];y[v][u][0]=(y[v-1][u][0]>>>8)|((y[v-1][u][1]<<24));y[v][u][1]=(y[v-1][u][1]>>>8)|((y[v-1][u][0]<<24))}}A[0]=[0,0];for(z=1;z<=l;z++){E=8*(z-1);A[z]=[0,0];A[z][0]=(y[0][E][0]&4278190080)^(y[1][E+1][0]&16711680)^(y[2][E+2][0]&65280)^(y[3][E+3][0]&255);A[z][1]=(y[4][E+4][1]&4278190080)^(y[5][E+5][1]&16711680)^(y[6][E+6][1]&65280)^(y[7][E+7][1]&255)}var D=[],B=[],p=0,m=0,f=[],q=[],o=[],n=[],k=[];var H=function(){var K,x,M,L,C;for(K=0,x=0;K<8;K++,x+=8){n[K]=[0,0];n[K][0]=((B[x]&255)<<24)^((B[x+1]&255)<<16)^((B[x+2]&255)<<8)^((B[x+3]&255));n[K][1]=((B[x+4]&255)<<24)^((B[x+5]&255)<<16)^((B[x+6]&255)<<8)^((B[x+7]&255))}for(K=0;K<8;K++){k[K]=[0,0];q[K]=[0,0];k[K][0]=n[K][0]^(q[K][0]=f[K][0]);k[K][1]=n[K][1]^(q[K][1]=f[K][1])}for(M=1;M<=l;M++){for(K=0;K<8;K++){o[K]=[0,0];for(C=0,L=56,x=0;C<8;C++,L-=8,x=L<32?1:0){o[K][0]^=y[C][(q[(K-C)&7][x]>>>(L%32))&255][0];o[K][1]^=y[C][(q[(K-C)&7][x]>>>(L%32))&255][1]}}for(K=0;K<8;K++){q[K][0]=o[K][0];q[K][1]=o[K][1]}q[0][0]^=A[M][0];q[0][1]^=A[M][1];for(K=0;K<8;K++){o[K][0]=q[K][0];o[K][1]=q[K][1];for(C=0,L=56,x=0;C<8;C++,L-=8,x=L<32?1:0){o[K][0]^=y[C][(k[(K-C)&7][x]>>>(L%32))&255][0];o[K][1]^=y[C][(k[(K-C)&7][x]>>>(L%32))&255][1]}}for(K=0;K<8;K++){k[K][0]=o[K][0];k[K][1]=o[K][1]}}for(K=0;K<8;K++){f[K][0]^=k[K][0]^n[K][0];f[K][1]^=k[K][1]^n[K][1]}};G=Whirlpool=function(i){return G.init().add(i).finalize()};G.version="3.0";G.init=function(){for(var r=32;r-->0;){D[r]=0}p=m=0;B=[0];for(r=8;r-->0;){f[r]=[0,0]}return G};G.add=function(L){if(!L){return G}var r=new Uint8Array(L);var P=r.length*8;var t=0,x=(8-(P&7))&7,K=p&7,C,M,O,N=P;for(C=31,O=0;C>=0;C--){O+=(D[C]&255)+(N%256);D[C]=O&255;O>>>=8;N=Math.floor(N/256)}while(P>8){M=((r[t]<<x)&255)|((r[t+1]&255)>>>(8-x));if(M<0||M>=256){return"Whirlpool requires a byte array"}B[m++]|=M>>>K;p+=8-K;if(p==512){H();p=m=0;B=[]}B[m]=((M<<(8-K))&255);p+=K;P-=8;t++}if(P>0){M=(r[t]<<x)&255;B[m]|=M>>>K}else{M=0}if(K+P<8){p+=P}else{m++;p+=8-K;P-=8-K;if(p==512){H();p=m=0;B=[]}B[m]=((M<<(8-K))&255);p+=P}return G};G.finalize=function(){var t,r,x,K="",C=[];B[m]|=128>>>(p&7);m++;if(m>32){while(m<64){B[m++]=0}H();m=0;B=[]}while(m<32){B[m++]=0}B.push.apply(B,D);H();for(t=0,r=0;t<8;t++,r+=8){x=f[t][0];C[r]=x>>>24&255;C[r+1]=x>>>16&255;C[r+2]=x>>>8&255;C[r+3]=x&255;x=f[t][1];C[r+4]=x>>>24&255;C[r+5]=x>>>16&255;C[r+6]=x>>>8&255;C[r+7]=x&255}return new Uint8Array(C).buffer};function s(){var i=this;this.name="WHIRLPOOL";this.blockSize=64;this.digestSize=64;this.hash=function(r){return Whirlpool(r)};return this}j.set("hash.algorithms.whirlpool",s)})(a);(function(){var ba;var aP=244837814094590;var aC=((aP&16777215)==15715070);function aY(bf,be,bg){if(!(this instanceof aY)){return new aY(bf,be,bg)}if(bf!=null){if("number"==typeof bf){this.fromNumber(bf,be,bg)}else{if(be==null&&"string"!=typeof bf){this.fromString(bf,256)}else{this.fromString(bf,be)}}}}var a7=aY.prototype;function o(){return new aY(null)}function d(bi,be,bf,bh,bk,bj){while(--bj>=0){var bg=be*this[bi++]+bf[bh]+bk;bk=Math.floor(bg/67108864);bf[bh++]=bg&67108863}return bk}function bc(bi,bn,bo,bh,bl,be){var bk=bn&32767,bm=bn>>15;while(--be>=0){var bg=this[bi]&32767;var bj=this[bi++]>>15;var bf=bm*bg+bj*bk;bg=bk*bg+((bf&32767)<<15)+bo[bh]+(bl&1073741823);bl=(bg>>>30)+(bf>>>15)+bm*bj+(bl>>>30);bo[bh++]=bg&1073741823}return bl}function bb(bi,bn,bo,bh,bl,be){var bk=bn&16383,bm=bn>>14;while(--be>=0){var bg=this[bi]&16383;var bj=this[bi++]>>14;var bf=bm*bg+bj*bk;bg=bk*bg+((bf&16383)<<14)+bo[bh]+bl;bl=(bg>>28)+(bf>>14)+bm*bj;bo[bh++]=bg&268435455}return bl}aY.prototype.am=d;ba=26;aY.prototype.DB=ba;aY.prototype.DM=((1<<ba)-1);var al=aY.prototype.DV=(1<<ba);var aD=52;aY.prototype.FV=Math.pow(2,aD);aY.prototype.F1=aD-ba;aY.prototype.F2=2*ba-aD;var aL="0123456789abcdefghijklmnopqrstuvwxyz";var aO=new Array();var aW,D;aW="0".charCodeAt(0);for(D=0;D<=9;++D){aO[aW++]=D}aW="a".charCodeAt(0);for(D=10;D<36;++D){aO[aW++]=D}aW="A".charCodeAt(0);for(D=10;D<36;++D){aO[aW++]=D}function bd(be){return aL.charAt(be)}function N(bf,be){var bg=aO[bf.charCodeAt(be)];return(bg==null)?-1:bg}function aB(bf){for(var be=this.t-1;be>=0;--be){bf[be]=this[be]}bf.t=this.t;bf.s=this.s}function x(be){this.t=1;this.s=(be<0)?-1:0;if(be>0){this[0]=be}else{if(be<-1){this[0]=be+al}else{this.t=0}}}function g(be){var bf=o();bf.fromInt(be);return bf}function G(bl,bf){var bi=this;var bh;if(bf==16){bh=4}else{if(bf==8){bh=3}else{if(bf==256){bh=8}else{if(bf==2){bh=1}else{if(bf==32){bh=5}else{if(bf==4){bh=2}else{bi.fromRadix(bl,bf);return}}}}}}bi.t=0;bi.s=0;var bk=bl.length,bg=false,bj=0;while(--bk>=0){var be=(bh==8)?bl[bk]&255:N(bl,bk);if(be<0){if(bl.charAt(bk)=="-"){bg=true}continue}bg=false;if(bj==0){bi[bi.t++]=be}else{if(bj+bh>bi.DB){bi[bi.t-1]|=(be&((1<<(bi.DB-bj))-1))<<bj;bi[bi.t++]=(be>>(bi.DB-bj))}else{bi[bi.t-1]|=be<<bj}}bj+=bh;if(bj>=bi.DB){bj-=bi.DB}}if(bh==8&&(bl[0]&128)!=0){bi.s=-1;if(bj>0){bi[bi.t-1]|=((1<<(bi.DB-bj))-1)<<bj}}bi.clamp();if(bg){aY.ZERO.subTo(bi,bi)}}function ag(){var be=this.s&this.DM;while(this.t>0&&this[this.t-1]==be){--this.t}}function z(bl){var bm=this;if(bm.s<0){return"-"+bm.negate().toString(bl)}var bi;if(bl==16){bi=4}else{if(bl==8){bi=3}else{if(bl==2){bi=1}else{if(bl==32){bi=5}else{if(bl==4){bi=2}else{return bm.toRadix(bl)}}}}}var bf=(1<<bi)-1,bk,bh=false,be="",bj=bm.t;var bg=bm.DB-(bj*bm.DB)%bi;if(bj-->0){if(bg<bm.DB&&(bk=bm[bj]>>bg)>0){bh=true;be=bd(bk)}while(bj>=0){if(bg<bi){bk=(bm[bj]&((1<<bg)-1))<<(bi-bg);bk|=bm[--bj]>>(bg+=bm.DB-bi)}else{bk=(bm[bj]>>(bg-=bi))&bf;if(bg<=0){bg+=bm.DB;--bj}}if(bk>0){bh=true}if(bh){be+=bd(bk)}}}return bh?be:"0"}function ak(){var be=o();aY.ZERO.subTo(this,be);return be}function aS(){return(this.s<0)?this.negate():this}function X(be){var bg=this.s-be.s;if(bg!=0){return bg}var bf=this.t;bg=bf-be.t;if(bg!=0){return(this.s<0)?-bg:bg}while(--bf>=0){if((bg=this[bf]-be[bf])!=0){return bg}}return 0}function t(be){var bg=1,bf;if((bf=be>>>16)!=0){be=bf;bg+=16}if((bf=be>>8)!=0){be=bf;bg+=8}if((bf=be>>4)!=0){be=bf;bg+=4}if((bf=be>>2)!=0){be=bf;bg+=2}if((bf=be>>1)!=0){be=bf;bg+=1}return bg}function C(){if(this.t<=0){return 0}return this.DB*(this.t-1)+t(this[this.t-1]^(this.s&this.DM))}function aX(bg,bf){var be;for(be=this.t-1;be>=0;--be){bf[be+bg]=this[be]}for(be=bg-1;be>=0;--be){bf[be]=0}bf.t=this.t+bg;bf.s=this.s}function aA(bg,bf){for(var be=bg;be<this.t;++be){bf[be-bg]=this[be]}bf.t=Math.max(this.t-bg,0);bf.s=this.s}function B(bg,be){var bn=this;var bl=bg%bn.DB;var bj=bn.DB-bl;var bf=(1<<bj)-1;var bh=Math.floor(bg/bn.DB),bk=(bn.s<<bl)&bn.DM,bi;for(bi=bn.t-1;bi>=0;--bi){be[bi+bh+1]=(bn[bi]>>bj)|bk;bk=(bn[bi]&bf)<<bl}for(bi=bh-1;bi>=0;--bi){be[bi]=0}be[bh]=bk;be.t=bn.t+bh+1;be.s=bn.s;be.clamp()}function u(bl,bi){var be=this;bi.s=be.s;var bj=Math.floor(bl/be.DB);if(bj>=be.t){bi.t=0;return}var bg=bl%be.DB;var bf=be.DB-bg;var bk=(1<<bg)-1;bi[0]=be[bj]>>bg;for(var bh=bj+1;bh<be.t;++bh){bi[bh-bj-1]|=(be[bh]&bk)<<bf;bi[bh-bj]=be[bh]>>bg}if(bg>0){bi[be.t-bj-1]|=(be.s&bk)<<bf}bi.t=be.t-bj;bi.clamp()}function aE(bf,bi){var bg=this;var bh=0,bj=0,be=Math.min(bf.t,bg.t);while(bh<be){bj+=bg[bh]-bf[bh];bi[bh++]=bj&bg.DM;bj>>=bg.DB}if(bf.t<bg.t){bj-=bf.s;while(bh<bg.t){bj+=bg[bh];bi[bh++]=bj&bg.DM;bj>>=bg.DB}bj+=bg.s}else{bj+=bg.s;while(bh<bf.t){bj-=bf[bh];bi[bh++]=bj&bg.DM;bj>>=bg.DB}bj-=bf.s}bi.s=(bj<0)?-1:0;if(bj<-1){bi[bh++]=bg.DV+bj}else{if(bj>0){bi[bh++]=bj}}bi.t=bh;bi.clamp()}function S(bf,bh){var be=this.abs(),bi=bf.abs();var bg=be.t;bh.t=bg+bi.t;while(--bg>=0){bh[bg]=0}for(bg=0;bg<bi.t;++bg){bh[bg+be.t]=be.am(0,bi[bg],bh,bg,0,be.t)}bh.s=0;bh.clamp();if(this.s!=bf.s){aY.ZERO.subTo(bh,bh)}}function ai(bg){var be=this.abs();var bf=bg.t=2*be.t;while(--bf>=0){bg[bf]=0}for(bf=0;bf<be.t-1;++bf){var bh=be.am(bf,be[bf],bg,2*bf,0,1);if((bg[bf+be.t]+=be.am(bf+1,2*be[bf],bg,2*bf+1,bh,be.t-bf-1))>=be.DV){bg[bf+be.t]-=be.DV;bg[bf+be.t+1]=1}}if(bg.t>0){bg[bg.t-1]+=be.am(bf,be[bf],bg,2*bf,0,1)}bg.s=0;bg.clamp()}function T(bo,bl,bj){var bk=this;var bu=bo.abs();if(bu.t<=0){return}var bm=bk.abs();if(bm.t<bu.t){if(bl!=null){bl.fromInt(0)}if(bj!=null){bk.copyTo(bj)}return}if(bj==null){bj=o()}var bh=o(),be=bk.s,bn=bo.s;var bt=bk.DB-t(bu[bu.t-1]);if(bt>0){bu.lShiftTo(bt,bh);bm.lShiftTo(bt,bj)}else{bu.copyTo(bh);bm.copyTo(bj)}var br=bh.t;var bf=bh[br-1];if(bf==0){return}var bp=bf*(1<<bk.F1)+((br>1)?bh[br-2]>>bk.F2:0);var bx=bk.FV/bp,bw=(1<<bk.F1)/bp,bv=1<<bk.F2;var bs=bj.t,bq=bs-br,bi=(bl==null)?o():bl;bh.dlShiftTo(bq,bi);if(bj.compareTo(bi)>=0){bj[bj.t++]=1;bj.subTo(bi,bj)}aY.ONE.dlShiftTo(br,bi);bi.subTo(bh,bh);while(bh.t<br){bh[bh.t++]=0}while(--bq>=0){var bg=(bj[--bs]==bf)?bk.DM:Math.floor(bj[bs]*bx+(bj[bs-1]+bv)*bw);if((bj[bs]+=bh.am(0,bg,bj,bq,0,br))<bg){bh.dlShiftTo(bq,bi);bj.subTo(bi,bj);while(bj[bs]<--bg){bj.subTo(bi,bj)}}}if(bl!=null){bj.drShiftTo(br,bl);if(be!=bn){aY.ZERO.subTo(bl,bl)}}bj.t=br;bj.clamp();if(bt>0){bj.rShiftTo(bt,bj)}if(be<0){aY.ZERO.subTo(bj,bj)}}function af(be){var bf=o();this.abs().divRemTo(be,null,bf);if(this.s<0&&bf.compareTo(aY.ZERO)>0){be.subTo(bf,bf)}return bf}function ab(be){this.m=be}function aw(be){if(be.s<0||be.compareTo(this.m)>=0){return be.mod(this.m)}else{return be}}function aR(be){return be}function Z(be){be.divRemTo(this.m,null,be)}function Y(be,bg,bf){be.multiplyTo(bg,bf);this.reduce(bf)}function a3(be,bf){be.squareTo(bf);this.reduce(bf)}ab.prototype.convert=aw;ab.prototype.revert=aR;ab.prototype.reduce=Z;ab.prototype.mulTo=Y;ab.prototype.sqrTo=a3;function P(){if(this.t<1){return 0}var be=this[0];if((be&1)==0){return 0}var bf=be&3;bf=(bf*(2-(be&15)*bf))&15;bf=(bf*(2-(be&255)*bf))&255;bf=(bf*(2-(((be&65535)*bf)&65535)))&65535;bf=(bf*(2-be*bf%this.DV))%this.DV;return(bf>0)?this.DV-bf:-bf}function k(be){this.m=be;this.mp=be.invDigit();this.mpl=this.mp&32767;this.mph=this.mp>>15;this.um=(1<<(be.DB-15))-1;this.mt2=2*be.t}function aQ(be){var bf=o();be.abs().dlShiftTo(this.m.t,bf);bf.divRemTo(this.m,null,bf);if(be.s<0&&bf.compareTo(aY.ZERO)>0){this.m.subTo(bf,bf)}return bf}function a1(be){var bf=o();be.copyTo(bf);this.reduce(bf);return bf}function ah(be){while(be.t<=this.mt2){be[be.t++]=0}for(var bg=0;bg<this.m.t;++bg){var bf=be[bg]&32767;var bh=(bf*this.mpl+(((bf*this.mph+(be[bg]>>15)*this.mpl)&this.um)<<15))&be.DM;bf=bg+this.m.t;be[bf]+=this.m.am(0,bh,be,bg,0,this.m.t);while(be[bf]>=be.DV){be[bf]-=be.DV;be[++bf]++}}be.clamp();be.drShiftTo(this.m.t,be);if(be.compareTo(this.m)>=0){be.subTo(this.m,be)}}function aT(be,bf){be.squareTo(bf);this.reduce(bf)}function M(be,bg,bf){be.multiplyTo(bg,bf);this.reduce(bf)}k.prototype.convert=aQ;k.prototype.revert=a1;k.prototype.reduce=ah;k.prototype.mulTo=M;k.prototype.sqrTo=aT;function p(){return((this.t>0)?(this[0]&1):this.s)==0}function H(bj,bk){if(bj>4294967295||bj<1){return aY.ONE}var bi=o(),be=o(),bh=bk.convert(this),bg=t(bj)-1;bh.copyTo(bi);while(--bg>=0){bk.sqrTo(bi,be);if((bj&(1<<bg))>0){bk.mulTo(be,bh,bi)}else{var bf=bi;bi=be;be=bf}}return bk.revert(bi)}function aV(bf,be){var bg;if(bf<256||be.isEven()){bg=new ab(be)}else{bg=new k(be)}return this.exp(bf,bg)}a7.copyTo=aB;a7.fromInt=x;a7.fromString=G;a7.clamp=ag;a7.dlShiftTo=aX;a7.drShiftTo=aA;a7.lShiftTo=B;a7.rShiftTo=u;a7.subTo=aE;a7.multiplyTo=S;a7.squareTo=ai;a7.divRemTo=T;a7.invDigit=P;a7.isEven=p;a7.exp=H;a7.toString=z;a7.negate=ak;a7.abs=aS;a7.compareTo=X;a7.bitLength=C;a7.mod=af;a7.modPowInt=aV;function o(){return new aY(null)}function m(){var be=o();this.copyTo(be);return be}function V(){if(this.s<0){if(this.t==1){return this[0]-this.DV}else{if(this.t==0){return -1}}}else{if(this.t==1){return this[0]}else{if(this.t==0){return 0}}}return((this[1]&((1<<(32-this.DB))-1))<<this.DB)|this[0]}function aM(){return(this.t==0)?this.s:(this[0]<<24)>>24}function aj(){return(this.t==0)?this.s:(this[0]<<16)>>16}function ay(be){return Math.floor(Math.LN2*this.DB/Math.log(be))}function aZ(){if(this.s<0){return -1}else{if(this.t<=0||(this.t==1&&this[0]<=0)){return 0}else{return 1}}}function K(be){if(be==null){be=10}if(this.signum()==0||be<2||be>36){return"0"}var bg=this.chunkSize(be);var bf=Math.pow(be,bg);var bj=g(bf),bk=o(),bi=o(),bh="";this.divRemTo(bj,bk,bi);while(bk.signum()>0){bh=(bf+bi.intValue()).toString(be).substr(1)+bh;bk.divRemTo(bj,bk,bi)}return bi.intValue().toString(be)+bh}function ap(bn,bj){var bm=this;bm.fromInt(0);if(bj==null){bj=10}var bh=bm.chunkSize(bj);var bi=Math.pow(bj,bh),bg=false,be=0,bl=0;for(var bf=0;bf<bn.length;++bf){var bk=N(bn,bf);if(bk<0){if(bn.charAt(bf)=="-"&&bm.signum()==0){bg=true}continue}bl=bj*bl+bk;if(++be>=bh){bm.dMultiply(bi);bm.dAddOffset(bl,0);be=0;bl=0}}if(be>0){bm.dMultiply(Math.pow(bj,be));bm.dAddOffset(bl,0)}if(bg){aY.ZERO.subTo(bm,bm)}}function aJ(bg,bf,bj){var bh=this;if("number"==typeof bf){if(bg<2){bh.fromInt(1)}else{bh.fromNumber(bg,bj);if(!bh.testBit(bg-1)){bh.bitwiseTo(aY.ONE.shiftLeft(bg-1),ac,bh)}if(bh.isEven()){bh.dAddOffset(1,0)}while(!bh.isProbablePrime(bf)){bh.dAddOffset(2,0);if(bh.bitLength()>bg){bh.subTo(aY.ONE.shiftLeft(bg-1),bh)}}}}else{var be=new Array(),bi=bg&7;be.length=(bg>>3)+1;bf.nextBytes(be);if(bi>0){be[0]&=((1<<bi)-1)}else{be[0]=0}bh.fromString(be,256)}}function a6(){var bf=this;var bg=bf.t,bh=new Array();bh[0]=bf.s;var bi=bf.DB-(bg*bf.DB)%8,bj,be=0;if(bg-->0){if(bi<bf.DB&&(bj=bf[bg]>>bi)!=(bf.s&bf.DM)>>bi){bh[be++]=bj|(bf.s<<(bf.DB-bi))}while(bg>=0){if(bi<8){bj=(bf[bg]&((1<<bi)-1))<<(8-bi);bj|=bf[--bg]>>(bi+=bf.DB-8)}else{bj=(bf[bg]>>(bi-=8))&255;if(bi<=0){bi+=bf.DB;--bg}}if((bj&128)!=0){bj|=-256}if(be===0&&(bf.s&128)!=(bj&128)){++be}if(be>0||bj!=bf.s){bh[be++]=bj}}}return bh}function an(be){return(this.compareTo(be)==0)}function W(be){return(this.compareTo(be)<0)?this:be}function au(be){return(this.compareTo(be)>0)?this:be}function aK(bf,bk,bi){var bg=this;var bh,bj,be=Math.min(bf.t,bg.t);for(bh=0;bh<be;++bh){bi[bh]=bk(bg[bh],bf[bh])}if(bf.t<bg.t){bj=bf.s&bg.DM;for(bh=be;bh<bg.t;++bh){bi[bh]=bk(bg[bh],bj)}bi.t=bg.t}else{bj=bg.s&bg.DM;for(bh=be;bh<bf.t;++bh){bi[bh]=bk(bj,bf[bh])}bi.t=bf.t}bi.s=bk(bg.s,bf.s);bi.clamp()}function L(be,bf){return be&bf}function a9(be){var bf=o();this.bitwiseTo(be,L,bf);return bf}function ac(be,bf){return be|bf}function az(be){var bf=o();this.bitwiseTo(be,ac,bf);return bf}function Q(be,bf){return be^bf}function i(be){var bf=o();this.bitwiseTo(be,Q,bf);return bf}function E(be,bf){return be&~bf}function v(be){var bf=o();this.bitwiseTo(be,E,bf);return bf}function R(){var bf=o();for(var be=0;be<this.t;++be){bf[be]=this.DM&~this[be]}bf.t=this.t;bf.s=~this.s;return bf}function F(bf){var be=o();if(bf<0){this.rShiftTo(-bf,be)}else{this.lShiftTo(bf,be)}return be}function a8(bf){var be=o();if(bf<0){this.lShiftTo(-bf,be)}else{this.rShiftTo(bf,be)}return be}function r(be){if(be==0){return -1}var bf=0;if((be&65535)==0){be>>=16;bf+=16}if((be&255)==0){be>>=8;bf+=8}if((be&15)==0){be>>=4;bf+=4}if((be&3)==0){be>>=2;bf+=2}if((be&1)==0){++bf}return bf}function y(){for(var be=0;be<this.t;++be){if(this[be]!=0){return be*this.DB+r(this[be])}}if(this.s<0){return this.t*this.DB}return -1}function aU(be){var bf=0;while(be!=0){be&=be-1;++bf}return bf}function aI(){var bg=0,be=this.s&this.DM;for(var bf=0;bf<this.t;++bf){bg+=aU(this[bf]^be)}return bg}function aG(bf){var be=Math.floor(bf/this.DB);if(be>=this.t){return(this.s!=0)}return((this[be]&(1<<(bf%this.DB)))!=0)}function U(bg,bf){var be=aY.ONE.shiftLeft(bg);this.bitwiseTo(be,bf,be);return be}function O(be){return this.changeBit(be,ac)}function w(be){return this.changeBit(be,E)}function f(be){return this.changeBit(be,Q)}function aq(bf,bi){var bg=this;var bh=0,bj=0,be=Math.min(bf.t,bg.t);while(bh<be){bj+=bg[bh]+bf[bh];bi[bh++]=bj&bg.DM;bj>>=bg.DB}if(bf.t<bg.t){bj+=bf.s;while(bh<bg.t){bj+=bg[bh];bi[bh++]=bj&bg.DM;bj>>=bg.DB}bj+=bg.s}else{bj+=bg.s;while(bh<bf.t){bj+=bf[bh];bi[bh++]=bj&bg.DM;bj>>=bg.DB}bj+=bf.s}bi.s=(bj<0)?-1:0;if(bj>0){bi[bh++]=bj}else{if(bj<-1){bi[bh++]=bg.DV+bj}}bi.t=bh;bi.clamp()}function at(be){var bf=o();this.addTo(be,bf);return bf}function a0(be){var bf=o();this.subTo(be,bf);return bf}function am(be){var bf=o();this.multiplyTo(be,bf);return bf}function aF(){var be=o();this.squareTo(be);return be}function h(be){var bf=o();this.divRemTo(be,bf,null);return bf}function l(be){var bf=o();this.divRemTo(be,null,bf);return bf}function aH(be){var bg=o(),bf=o();this.divRemTo(be,bg,bf);return new Array(bg,bf)}function q(be){this[this.t]=this.am(0,be-1,this,0,0,this.t);++this.t;this.clamp()}function ae(bf,be){if(bf==0){return}while(this.t<=be){this[this.t++]=0}this[be]+=bf;while(this[be]>=this.DV){this[be]-=this.DV;if(++be>=this.t){this[this.t++]=0}++this[be]}}function ar(){}function aN(be){return be}function s(be,bg,bf){be.multiplyTo(bg,bf)}function ax(be,bf){be.squareTo(bf)}ar.prototype.convert=aN;ar.prototype.revert=aN;ar.prototype.mulTo=s;ar.prototype.sqrTo=ax;function I(be){return this.exp(be,new ar())}function n(be,bi,bh){var bg=Math.min(this.t+be.t,bi);bh.s=0;bh.t=bg;while(bg>0){bh[--bg]=0}var bf;for(bf=bh.t-this.t;bg<bf;++bg){bh[bg+this.t]=this.am(0,be[bg],bh,bg,0,this.t)}for(bf=Math.min(be.t,bi);bg<bf;++bg){this.am(0,be[bg],bh,bg,0,bi-bg)}bh.clamp()}function j(be,bh,bg){--bh;var bf=bg.t=this.t+be.t-bh;bg.s=0;while(--bf>=0){bg[bf]=0}for(bf=Math.max(bh-this.t,0);bf<be.t;++bf){bg[this.t+bf-bh]=this.am(bh-bf,be[bf],bg,0,0,this.t+bf-bh)}bg.clamp();bg.drShiftTo(1,bg)}function J(be){this.r2=o();this.q3=o();aY.ONE.dlShiftTo(2*be.t,this.r2);this.mu=this.r2.divide(be);this.m=be}function aa(be){if(be.s<0||be.t>2*this.m.t){return be.mod(this.m)}else{if(be.compareTo(this.m)<0){return be}else{var bf=o();be.copyTo(bf);this.reduce(bf);return bf}}}function ad(be){return be}function a4(be){var bf=this;be.drShiftTo(bf.m.t-1,bf.r2);if(be.t>bf.m.t+1){be.t=bf.m.t+1;be.clamp()}bf.mu.multiplyUpperTo(bf.r2,bf.m.t+1,bf.q3);bf.m.multiplyLowerTo(bf.q3,bf.m.t+1,bf.r2);while(be.compareTo(bf.r2)<0){be.dAddOffset(1,bf.m.t+1)}be.subTo(bf.r2,be);while(be.compareTo(bf.m)>=0){be.subTo(bf.m,be)}}function ao(be,bf){be.squareTo(bf);this.reduce(bf)}function a5(be,bg,bf){be.multiplyTo(bg,bf);this.reduce(bf)}J.prototype.convert=aa;J.prototype.revert=ad;J.prototype.reduce=a4;J.prototype.mulTo=a5;J.prototype.sqrTo=ao;function av(bn,bi){var bl=bn.bitLength(),bj,bf=g(1),bq;if(bl<=0){return bf}else{if(bl<18){bj=1}else{if(bl<48){bj=3}else{if(bl<144){bj=4}else{if(bl<768){bj=5}else{bj=6}}}}}if(bl<8){bq=new ab(bi)}else{if(bi.isEven()){bq=new J(bi)}else{bq=new k(bi)}}var bm=new Array(),bh=3,bo=bj-1,be=(1<<bj)-1;bm[1]=bq.convert(this);if(bj>1){var bt=o();bq.sqrTo(bm[1],bt);while(bh<=be){bm[bh]=o();bq.mulTo(bt,bm[bh-2],bm[bh]);bh+=2}}var bk=bn.t-1,br,bp=true,bg=o(),bs;bl=t(bn[bk])-1;while(bk>=0){if(bl>=bo){br=(bn[bk]>>(bl-bo))&be}else{br=(bn[bk]&((1<<(bl+1))-1))<<(bo-bl);if(bk>0){br|=bn[bk-1]>>(this.DB+bl-bo)}}bh=bj;while((br&1)==0){br>>=1;--bh}if((bl-=bh)<0){bl+=this.DB;--bk}if(bp){bm[br].copyTo(bf);bp=false}else{while(bh>1){bq.sqrTo(bf,bg);bq.sqrTo(bg,bf);bh-=2}if(bh>0){bq.sqrTo(bf,bg)}else{bs=bf;bf=bg;bg=bs}bq.mulTo(bg,bm[br],bf)}while(bk>=0&&(bn[bk]&(1<<bl))==0){bq.sqrTo(bf,bg);bs=bf;bf=bg;bg=bs;if(--bl<0){bl=this.DB-1;--bk}}}return bq.revert(bf)}function a2(bf){var be=(this.s<0)?this.negate():this.clone();var bj=(bf.s<0)?bf.negate():bf.clone();if(be.compareTo(bj)<0){var bh=be;be=bj;bj=bh}var bg=be.getLowestSetBit(),bi=bj.getLowestSetBit();if(bi<0){return be}if(bg<bi){bi=bg}if(bi>0){be.rShiftTo(bi,be);bj.rShiftTo(bi,bj)}while(be.signum()>0){if((bg=be.getLowestSetBit())>0){be.rShiftTo(bg,be)}if((bg=bj.getLowestSetBit())>0){bj.rShiftTo(bg,bj)}if(be.compareTo(bj)>=0){be.subTo(bj,be);be.rShiftTo(1,be)}else{bj.subTo(be,bj);bj.rShiftTo(1,bj)}}if(bi>0){bj.lShiftTo(bi,bj)}return bj}function A(bh){if(bh<=0){return 0}var bg=this.DV%bh,bf=(this.s<0)?bh-1:0;if(this.t>0){if(bg==0){bf=this[0]%bh}else{for(var be=this.t-1;be>=0;--be){bf=(bg*bf+this[be])%bh}}}return bf}function e(bf){var bj=bf.isEven();if((this.isEven()&&bj)||bf.signum()==0){return aY.ZERO}var bi=bf.clone(),bh=this.clone();var bg=g(1),be=g(0),bl=g(0),bk=g(1);while(bi.signum()!=0){while(bi.isEven()){bi.rShiftTo(1,bi);if(bj){if(!bg.isEven()||!be.isEven()){bg.addTo(this,bg);be.subTo(bf,be)}bg.rShiftTo(1,bg)}else{if(!be.isEven()){be.subTo(bf,be)}}be.rShiftTo(1,be)}while(bh.isEven()){bh.rShiftTo(1,bh);if(bj){if(!bl.isEven()||!bk.isEven()){bl.addTo(this,bl);bk.subTo(bf,bk)}bl.rShiftTo(1,bl)}else{if(!bk.isEven()){bk.subTo(bf,bk)}}bk.rShiftTo(1,bk)}if(bi.compareTo(bh)>=0){bi.subTo(bh,bi);if(bj){bg.subTo(bl,bg)}be.subTo(bk,be)}else{bh.subTo(bi,bh);if(bj){bl.subTo(bg,bl)}bk.subTo(be,bk)}}if(bh.compareTo(aY.ONE)!=0){return aY.ZERO}if(bk.compareTo(bf)>=0){return bk.subtract(bf)}if(bk.signum()<0){bk.addTo(bf,bk)}else{return bk}if(bk.signum()<0){return bk.add(bf)}else{return bk}}a7.chunkSize=ay;a7.toRadix=K;a7.fromRadix=ap;a7.fromNumber=aJ;a7.bitwiseTo=aK;a7.changeBit=U;a7.addTo=aq;a7.dMultiply=q;a7.dAddOffset=ae;a7.multiplyLowerTo=n;a7.multiplyUpperTo=j;a7.modInt=A;a7.clone=m;a7.intValue=V;a7.byteValue=aM;a7.shortValue=aj;a7.signum=aZ;a7.toByteArray=a6;a7.equals=an;a7.min=W;a7.max=au;a7.and=a9;a7.or=az;a7.xor=i;a7.andNot=v;a7.not=R;a7.shiftLeft=F;a7.shiftRight=a8;a7.getLowestSetBit=y;a7.bitCount=aI;a7.testBit=aG;a7.setBit=O;a7.clearBit=w;a7.flipBit=f;a7.add=at;a7.subtract=a0;a7.multiply=am;a7.divide=h;a7.remainder=l;a7.divideAndRemainder=aH;a7.modPow=av;a7.modInverse=e;a7.pow=I;a7.gcd=a2;a7.square=aF;aY.ZERO=g(0);aY.ONE=g(1);aY.valueOf=g;aY.fromByteArrayUnsigned=function(be){if(!be.length){return new aY.valueOf(0)}else{if(be[0]&128){return new aY([0].concat(be))}else{return new aY(be)}}};aY.fromByteArraySigned=function(be){if(be[0]&128){be[0]&=127;return aY.fromByteArrayUnsigned(be).negate()}else{return aY.fromByteArrayUnsigned(be)}};aY.prototype.toByteArrayUnsigned=function(){var bf=this.abs().toByteArray();if(!bf.length){return bf}if(bf[0]===0){bf=bf.slice(1)}for(var be=0;be<bf.length;++be){bf[be]=(bf[be]<0)?bf[be]+256:bf[be]}return bf};aY.prototype.toByteArraySigned=function(){var be=this.toByteArrayUnsigned();var bf=this.s<0;if(be[0]&128){be.unshift((bf)?128:0)}else{if(bf){be[0]|=128}}return be};if("undefined"!=typeof module&&"undefined"!=typeof module.exports){module.exports=aY}else{define([],function(){return aY})}})();(function(d){function e(m,l){var i=m.ECPointFp;function j(t,p,s,o){var n=Math.max(p.bitLength(),o.bitLength());var u=t.add2D(s);var r=t.curve.getInfinity();for(var q=n-1;q>=0;--q){r=r.twice2D();r.z=l.ONE;if(p.testBit(q)){if(o.testBit(q)){r=r.add2D(u)}else{r=r.add2D(t)}}else{if(o.testBit(q)){r=r.add2D(s)}}}return r}function k(u){var w=this;var v=null;var t=new d.util.srand();var n={nextBytes:function(x){var z=t.bytes(x.length);for(var y=0;y<z.length;++y){x[y]=z[y]}}};this.sign=function(A,F){var D=F;var y=u.getN();var C=l.fromByteArrayUnsigned(A);var z=r(y);var E=u.getG();var B=E.multiply(z);var x=B.getX().toBigInteger().mod(y);var H=z.modInverse(y).multiply(C.add(D.multiply(x))).mod(y);if(H.compareTo(y.divide(l.valueOf(2)))>0){H=y.subtract(H)}return o(x,H)};this.verify=function(D,E,y){var A,x;if(Array.isArray(E)){var C=q(E);A=C.r;x=C.s}else{if("object"===typeof E&&E.r&&E.s){A=E.r;x=E.s}else{throw new Error("Invalid value for signature")}}var z;if(y instanceof i){z=y}else{if(Array.isArray(y)){z=i.decodeFrom(u.getCurve(),y)}else{throw new Error("Invalid format for pubkey value, must be byte array or ECPointFp")}}var B=l.fromByteArrayUnsigned(D);return s(B,A,x,z)};function s(C,x,I,B){var A=u.getN();var H=u.getG();if(x.compareTo(l.ONE)<0||x.compareTo(A)>=0){return false}if(I.compareTo(l.ONE)<0||I.compareTo(A)>=0){return false}var D=I.modInverse(A);var z=C.multiply(D).mod(A);var y=x.multiply(D).mod(A);var E=H.multiply(z).add(B.multiply(y));var F=E.getX().toBigInteger().mod(A);return F.equals(x)}function p(A){if(A.length!==65){throw new Error("Signature has the wrong length")}var x=A[0]-27;if(x<0||x>7){throw new Error("Invalid signature type")}var B=u.getN();var z=l.fromByteArrayUnsigned(A.slice(1,33)).mod(B);var y=l.fromByteArrayUnsigned(A.slice(33,65)).mod(B);return{r:z,s:y,i:x}}function r(x){return new l(x.bitLength(),n).mod(x.subtract(l.ONE)).add(l.ONE)}function o(z,y){var A=z.toByteArraySigned();var x=y.toByteArraySigned();var B=[];B.push(2);B.push(A.length);B=B.concat(A);B.push(2);B.push(x.length);B=B.concat(x);B.unshift(B.length);B.unshift(48);return B}function q(C){var B;if(C[0]!=48){throw new Error("Signature not a valid DERSequence")}B=2;if(C[B]!=2){throw new Error("First element in signature must be a DERInteger")}var A=C.slice(B+2,B+2+C[B+1]);B+=2+C[B+1];if(C[B]!=2){throw new Error("Second element in signature must be a DERInteger")}var x=C.slice(B+2,B+2+C[B+1]);B+=2+C[B+1];var z=l.fromByteArrayUnsigned(A);var y=l.fromByteArrayUnsigned(x);return{r:z,s:y}}return this}return k}if("undefined"!=typeof module&&"undefined"!=typeof module.exports){var h=require("./ecurve.js");var g=require("./bigi.js");var f=e(h,g);module.exports=function(i){return new f(i)}}else{define(["cipher/asymmetric/ec/ecurve","cipher/asymmetric/ec/bigi"],function(k,j){var i=e(k,j);return function(l){return new i(l)}})}})(__enigma_jscrypto__);(function(e){function g(n,l,k,j){function m(u){var B=this;var q=null,r=null;var z=n(u);if(!z){throw Error("unknown-ec-curve-name")}var x=l(z);function s(E){var F=new Array(E.length);for(var D=0;D<F.length;D++){F[D]=E[D]}return F}this.setPrivateKey=function(D){if(!e.util.type(D).isArrayBuffer()){throw new Error("invalid-parameter")}w(e.util.encoding(D).toArray())};this.setPublicKey=function(D){if(!e.util.type(D).isArrayBuffer()){throw new Error("invalid-parameter")}y(e.util.encoding(D).toArray())};function A(D){if(D){B.sign=p;B.decrypt=o;B._computeSecret=C}B.verify=v;B.encrypt=t;B.getPublicKey=function(){return new Uint8Array(r).buffer};delete B.setPrivateKey;delete B.setPublicKey}function y(D){q=null;r=D;A(false)}function w(E){q=j.fromByteArrayUnsigned(E);var D=z.getG().multiply(q);r=D.getEncoded(false);A(true)}function p(E){if(!e.util.type(E).isArrayBuffer()){throw new Error("invalid-parameter")}var D=x.sign(e.util.encoding(E).toArray(),q);return e.util.encoding(D).toArrayBuffer()}function v(E,G){if(!(e.util.type(E).isArrayBuffer()&&e.util.type(G).isArrayBuffer())){throw new Error("invalid-parameter")}try{var H=e.util.encoding(G).toArray(),I=e.util.encoding(E).toArray();var D=x.verify(I,H,r)}catch(F){console.log(F);return false}return D}function C(E){if(!e.util.type(E).isArrayBuffer()){throw Error("invalid-parameter")}var D=e.util.encoding(E).toArray();var G=k.ECPointFp.decodeFrom(z.getCurve(),D);var F=G.multiply(q);var H=F.getEncoded().slice(1);return e.util.encoding(H).toArrayBuffer()}function t(G){if(!e.util.type(G).isArrayBuffer()){throw new Error("invalid-parameter")}var F=new m(u);F.setPrivateKey(new e.util.srand().bytes(128));var J=F._computeSecret(B.getPublicKey()),I=F.getPublicKey();var D=new e.cipher.symmetric().key(J),H=D.encrypt(G);var E=new Uint16Array([I.byteLength]);return e.util.buffer.concat([E.buffer,I,H])}function o(H){if(!(e.util.type(H).isArrayBuffer()&&H.byteLength>2)){throw new Error("invalid-parameter")}var D=H.slice(0,2),H=H.slice(2);var F=new Uint16Array(D)[0];if(H.length<=F){throw new Error("invalid-ciphertext")}var K=H.slice(0,F),I=H.slice(F);var J=C(K);var G=new e.cipher.symmetric().key(J);var E=G.decrypt(I);return E}return this}return{name:"EC",constructor:function(o){return new m(o.curve)}}}if("undefined"!=typeof module&&"undefined"!=typeof module.exports){var i=require("./ecparams.js"),h=require("./ecdsa.js"),f=require("./ecurve.js"),d=require("./bigi.js");module.exports=g(i,h,f,d)}else{define(["cipher/asymmetric/ec/ecparams","cipher/asymmetric/ec/ecdsa","cipher/asymmetric/ec/ecurve","cipher/asymmetric/ec/bigi"],function(m,l,k,j){return g(m,l,k,j)})}})(__enigma_jscrypto__);(function(){function d(i,g){function p(s,r,t,q){this.curve=s;this.g=r;this.n=t;this.h=q}p.prototype.getCurve=function o(){return this.curve};p.prototype.getG=function m(){return this.g};p.prototype.getN=function j(){return this.n};p.prototype.getH=function l(){return this.h};function n(q){q=q.replace(/[^0-9a-f]/ig,"").toUpperCase();return new i(q,16)}var k={secp128r1:function(){var u=n("FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFF");var r=n("FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFC");var q=n("E87579C11079F43DD824993C2CEE5ED3");var w=n("FFFFFFFE0000000075A30D1B9038A115");var t=i.ONE;var v=new g(u,r,q);var s=v.decodePointHex("04161FF7528B899B2D0C28607CA52C5B86CF5AC8395BAFEB13C02DA292DDED7A83");return new p(v,s,w,t)},secp160k1:function(){var u=n("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFAC73");var r=i.ZERO;var q=n("7");var w=n("0100000000000000000001B8FA16DFAB9ACA16B6B3");var t=i.ONE;var v=new g(u,r,q);var s=v.decodePointHex("043B4C382CE37AA192A4019E763036F4F5DD4D7EBB938CF935318FDCED6BC28286531733C3F03C4FEE");return new p(v,s,w,t)},secp160r1:function(){var u=n("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFF");var r=n("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFC");var q=n("1C97BEFC54BD7A8B65ACF89F81D4D4ADC565FA45");var w=n("0100000000000000000001F4C8F927AED3CA752257");var t=i.ONE;var v=new g(u,r,q);var s=v.decodePointHex("044A96B5688EF573284664698968C38BB913CBFC8223A628553168947D59DCC912042351377AC5FB32");return new p(v,s,w,t)},secp192k1:function(){var u=n("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFEE37");var r=i.ZERO;var q=n("3");var w=n("FFFFFFFFFFFFFFFFFFFFFFFE26F2FC170F69466A74DEFD8D");var t=i.ONE;var v=new g(u,r,q);var s=v.decodePointHex("04DB4FF10EC057E9AE26B07D0280B7F4341DA5D1B1EAE06C7D9B2F2F6D9C5628A7844163D015BE86344082AA88D95E2F9D");return new p(v,s,w,t)},secp192r1:function(){var u=n("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFF");var r=n("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFC");var q=n("64210519E59C80E70FA7E9AB72243049FEB8DEECC146B9B1");var w=n("FFFFFFFFFFFFFFFFFFFFFFFF99DEF836146BC9B1B4D22831");var t=i.ONE;var v=new g(u,r,q);var s=v.decodePointHex("04188DA80EB03090F67CBF20EB43A18800F4FF0AFD82FF101207192B95FFC8DA78631011ED6B24CDD573F977A11E794811");return new p(v,s,w,t)},secp224r1:function(){var u=n("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF000000000000000000000001");var r=n("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFE");var q=n("B4050A850C04B3ABF54132565044B0B7D7BFD8BA270B39432355FFB4");var w=n("FFFFFFFFFFFFFFFFFFFFFFFFFFFF16A2E0B8F03E13DD29455C5C2A3D");var t=i.ONE;var v=new g(u,r,q);var s=v.decodePointHex("04B70E0CBD6BB4BF7F321390B94A03C1D356C21122343280D6115C1D21BD376388B5F723FB4C22DFE6CD4375A05A07476444D5819985007E34");return new p(v,s,w,t)},secp256k1:function(){var u=n("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F");var r=i.ZERO;var q=n("7");var w=n("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141");var t=i.ONE;var v=new g(u,r,q);var s=v.decodePointHex("0479BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8");return new p(v,s,w,t)},secp256r1:function(){var u=n("FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF");var r=n("FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC");var q=n("5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B");var w=n("FFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551");var t=i.ONE;var v=new g(u,r,q);var s=v.decodePointHex("046B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C2964FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5");return new p(v,s,w,t)},secp384r1:function(){var u=n("FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFe FFFFFFFF 00000000 00000000 FFFFFFFF");var r=n("FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFe FFFFFFFF 00000000 00000000 FFFFFFFC");var q=n("B3312FA7 E23EE7E4 988E056B E3F82D19 181D9C6E FE814112 0314088F 5013875A C656398D 8A2ED19D 2A85C8ED D3EC2AEF");var w=n("FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF C7634D81 F4372DDF 581A0DB2 48B0A77A ECEC196A CCC52973");var t=i.ONE;var v=new g(u,r,q);var s=v.decodePointHex("04AA87CA22 BE8B0537 8EB1C71E F320AD74 6E1D3B62 8BA79B98 59F741E0 82542A38 5502F25D BF55296C 3A545E38 72760AB73617DE4A 96262C6F 5D9E98BF 9292DC29 F8F41DBD 289A147C E9DA3113 B5F0B8C0 0A60B1CE 1D7E819D 7A431D7C 90EA0E5F");return new p(v,s,w,t)},secp521r1:function(){var u=n("    01FF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFF FFFFFFFF");var r=n("    01FF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFF FFFFFFFC");var q=n("    0051 953EB961 8E1C9A1F 929A21A0 B68540EE A2DA725B 99B315F3B8B48991 8EF109E1 56193951 EC7E937B 1652C0BD 3BB1BF07 3573DF883D2C34F1 EF451FD4 6B503F00");var w=n("    01FF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFA 51868783 BF2F966B 7FCC0148 F709A5D0 3BB5C9B8899C47AE BB6FB71E 91386409");var t=i.ONE;var v=new g(u,r,q);var s=v.decodePointHex("      04 00C6858E 06B70404 E9CD9E3E CB662395 B4429C64 8139053FB521F828 AF606B4D 3DBAA14B 5E77EFE7 5928FE1D C127A2FF A8DE3348B3C1856A 429BF97E 7E31C2E5 BD660118 39296A78 9A3BC004 5C8A5FB42C7D1BD9 98F54449 579B4468 17AFBD17 273E662C 97EE7299 5EF42640C550B901 3FAD0761 353C7086 A272C240 88BE9476 9FD16650");return new p(v,s,w,t)}};return function h(q){return(typeof k[q]=="function")?k[q]():null}}if("undefined"!=typeof module&&"undefined"!=typeof module.exports){var f=require("./bigi.js");var e=require("./ecurve.js");module.exports=d(f,e)}else{define(["cipher/asymmetric/ec/bigi","cipher/asymmetric/ec/ecurve"],function(h,g){return d(h,g)})}})();"use strict";(function(){function d(k){function i(n,l){var m=n.toByteArrayUnsigned();if(l<m.length){m=m.slice(m.length-l)}else{while(l>m.length){m.unshift(0)}}return m}var h=function h(m,l){this.x=l;this.q=m};h.prototype.equals=function(l){if(l==this){return true}return(this.q.equals(l.q)&&this.x.equals(l.x))};h.prototype.toBigInteger=function(){return this.x};h.prototype.negate=function(){return new h(this.q,this.x.negate().mod(this.q))};h.prototype.add=function(l){return new h(this.q,this.x.add(l.toBigInteger()).mod(this.q))};h.prototype.subtract=function(l){return new h(this.q,this.x.subtract(l.toBigInteger()).mod(this.q))};h.prototype.multiply=function(l){return new h(this.q,this.x.multiply(l.toBigInteger()).mod(this.q))};h.prototype.square=function(){return new h(this.q,this.x.square().mod(this.q))};h.prototype.divide=function f(l){return new h(this.q,this.x.multiply(l.toBigInteger().modInverse(this.q)).mod(this.q))};h.prototype.getByteLength=function(){return Math.floor((this.toBigInteger().bitLength()+7)/8)};var g=function g(n,l,o,m){this.curve=n;this.x=l;this.y=o;if(m==null){this.z=k.ONE}else{this.z=m}this.zinv=null};g.prototype.getX=function(){if(this.zinv==null){this.zinv=this.z.modInverse(this.curve.q)}return this.curve.fromBigInteger(this.x.toBigInteger().multiply(this.zinv).mod(this.curve.q))};g.prototype.getY=function(){if(this.zinv==null){this.zinv=this.z.modInverse(this.curve.q)}return this.curve.fromBigInteger(this.y.toBigInteger().multiply(this.zinv).mod(this.curve.q))};g.prototype.equals=function(l){if(l==this){return true}if(this.isInfinity()){return l.isInfinity()}if(l.isInfinity()){return this.isInfinity()}var n,m;n=l.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(l.z)).mod(this.curve.q);if(!n.equals(k.ZERO)){return false}m=l.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(l.z)).mod(this.curve.q);return m.equals(k.ZERO)};g.prototype.isInfinity=function(){if((this.x==null)&&(this.y==null)){return true}return this.z.equals(k.ZERO)&&!this.y.toBigInteger().equals(k.ZERO)};g.prototype.negate=function(){return new g(this.curve,this.x,this.y.negate(),this.z)};g.prototype.add=function(x){if(this.isInfinity()){return x}if(x.isInfinity()){return this}var B=x.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(x.z)).mod(this.curve.q);var A=x.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(x.z)).mod(this.curve.q);if(k.ZERO.equals(A)){if(k.ZERO.equals(B)){return this.twice()}return this.curve.getInfinity()}var t=new k("3");var o=this.x.toBigInteger();var z=this.y.toBigInteger();var m=x.x.toBigInteger();var w=x.y.toBigInteger();var y=A.square();var s=y.multiply(A);var n=o.multiply(y);var q=B.square().multiply(this.z);var l=q.subtract(n.shiftLeft(1)).multiply(x.z).subtract(s).multiply(A).mod(this.curve.q);var r=n.multiply(t).multiply(B).subtract(z.multiply(s)).subtract(q.multiply(B)).multiply(x.z).add(B.multiply(s)).mod(this.curve.q);var p=s.multiply(this.z).multiply(x.z).mod(this.curve.q);return new g(this.curve,this.curve.fromBigInteger(l),this.curve.fromBigInteger(r),p)};g.prototype.twice=function(){if(this.isInfinity()){return this}if(this.y.toBigInteger().signum()==0){return this.curve.getInfinity()}var q=new k("3");var m=this.x.toBigInteger();var r=this.y.toBigInteger();var o=r.multiply(this.z);var t=o.multiply(r).mod(this.curve.q);var s=this.curve.a.toBigInteger();var u=m.square().multiply(q);if(!k.ZERO.equals(s)){u=u.add(this.z.square().multiply(s))}u=u.mod(this.curve.q);var l=u.square().subtract(m.shiftLeft(3).multiply(t)).shiftLeft(1).multiply(o).mod(this.curve.q);var p=u.multiply(q).multiply(m).subtract(t.shiftLeft(1)).shiftLeft(2).multiply(t).subtract(u.square().multiply(u)).mod(this.curve.q);var n=o.square().multiply(o).shiftLeft(3).mod(this.curve.q);return new g(this.curve,this.curve.fromBigInteger(l),this.curve.fromBigInteger(p),n)};g.prototype.multiply=function(m){if(this.isInfinity()){return this}if(m.signum()==0){return this.curve.getInfinity()}var q=m;var p=q.multiply(new k("3"));var s=this.negate();var o=this;var n;for(n=p.bitLength()-2;n>0;--n){o=o.twice();var l=p.testBit(n);var r=q.testBit(n);if(l!=r){o=o.add(l?this:s)}}return o};g.prototype.multiplyTwo=function(n,l,m){var o;if(n.bitLength()>m.bitLength()){o=n.bitLength()-1}else{o=m.bitLength()-1}var q=this.curve.getInfinity();var p=this.add(l);while(o>=0){q=q.twice();if(n.testBit(o)){if(m.testBit(o)){q=q.add(p)}else{q=q.add(this)}}else{if(m.testBit(o)){q=q.add(l)}}--o}return q};g.prototype.getEncoded=function(o){if(this.isInfinity()){return[0]}var l=this.getX().toBigInteger();var p=this.getY().toBigInteger();var n=Math.floor((this.curve.getQ().bitLength()+7)/8);var m=i(l,n);if(o){if(p.isEven()){m.unshift(2)}else{m.unshift(3)}}else{m.unshift(4);m=m.concat(i(p,n))}return m};g.decodeFrom=function(r,n){var q=n[0];var p=n.length-1;var o=n.slice(1,1+p/2);var m=n.slice(1+p/2,1+p);o.unshift(0);m.unshift(0);var l=new k(o);var s=new k(m);return new g(r,r.fromBigInteger(l),r.fromBigInteger(s))};g.prototype.add2D=function(m){if(this.isInfinity()){return m}if(m.isInfinity()){return this}if(this.x.equals(m.x)){if(this.y.equals(m.y)){return this.twice()}return this.curve.getInfinity()}var q=m.x.subtract(this.x);var o=m.y.subtract(this.y);var l=o.divide(q);var n=l.square().subtract(this.x).subtract(m.x);var p=l.multiply(this.x.subtract(n)).subtract(this.y);return new g(this.curve,n,p)};g.prototype.twice2D=function(){if(this.isInfinity()){return this}if(this.y.toBigInteger().signum()==0){return this.curve.getInfinity()}var m=this.curve.fromBigInteger(k.valueOf(2));var p=this.curve.fromBigInteger(k.valueOf(3));var l=this.x.square().multiply(p).add(this.curve.a).divide(this.y.multiply(m));var n=l.square().subtract(this.x.multiply(m));var o=l.multiply(this.x.subtract(n)).subtract(this.y);return new g(this.curve,n,o)};g.prototype.multiply2D=function(m){if(this.isInfinity()){return this}if(m.signum()==0){return this.curve.getInfinity()}var q=m;var p=q.multiply(new k("3"));var s=this.negate();var o=this;var n;for(n=p.bitLength()-2;n>0;--n){o=o.twice();var l=p.testBit(n);var r=q.testBit(n);if(l!=r){o=o.add2D(l?this:s)}}return o};g.prototype.isOnCurve=function(){if(this.isInfinity()){return true}var m=this.getX().toBigInteger();var s=this.getY().toBigInteger();var p=this.curve.getA().toBigInteger();var l=this.curve.getB().toBigInteger();var r=this.curve.getQ();var o=s.multiply(s).mod(r);var q=m.multiply(m).multiply(m).add(p.multiply(m)).add(l).mod(r);return o.equals(q)};g.prototype.toString=function(){if(this.isInfinity()){return"(INFINITY)"}return"("+this.getX().toBigInteger().toString()+","+this.getY().toBigInteger().toString()+")"};g.prototype.validate=function(){var o=this.curve.getQ();if(this.isInfinity()){throw new Error("Point is at infinity.")}var l=this.getX().toBigInteger();var m=this.getY().toBigInteger();if(l.compareTo(k.ONE)<0||l.compareTo(o.subtract(k.ONE))>0){throw new Error("x coordinate out of bounds")}if(m.compareTo(k.ONE)<0||m.compareTo(o.subtract(k.ONE))>0){throw new Error("y coordinate out of bounds")}if(!this.isOnCurve()){throw new Error("Point is not on the curve.")}if(this.multiply(o).isInfinity()){throw new Error("Point is not a scalar multiple of G.")}return true};var j=function j(n,m,l){this.q=n;this.a=this.fromBigInteger(m);this.b=this.fromBigInteger(l);this.infinity=new g(this,null,null)};j.prototype.getQ=function(){return this.q};j.prototype.getA=function(){return this.a};j.prototype.getB=function(){return this.b};j.prototype.equals=function(l){if(l==this){return true}return(this.q.equals(l.q)&&this.a.equals(l.a)&&this.b.equals(l.b))};j.prototype.getInfinity=function(){return this.infinity};j.prototype.fromBigInteger=function(l){return new h(this.q,l)};j.prototype.decodePointHex=function(o){o=o.replace(/[^0-9a-f]/ig,"");switch(parseInt(o.substr(0,2),16)){case 0:return this.infinity;case 2:case 3:return null;case 4:case 6:case 7:var l=(o.length-2)/2;var n=o.substr(2,l);var m=o.substr(l+2,l);return new g(this,this.fromBigInteger(new k(n,16)),this.fromBigInteger(new k(m,16)));default:return null}};j.ECPointFp=g;return j}if("undefined"!=typeof module&&"undefined"!=typeof module.exports){var e=require("./bigi.js");module.exports=d(e)}else{define(["cipher/asymmetric/ec/bigi"],function(f){return d(f)})}})();(function(d){var g={};var e={NECRAC256:{secretLength:128,sign:{algorithm:"EC",parameters:{curve:"secp521r1"},secretLength:64},crypt:{algorithm:"EC",parameters:{curve:"secp521r1"},secretLength:64},hashAlgorithm:"WHIRLPOOL"}};function h(n){var u=this;var o=e[n];var s,m;if(!o){throw new Error("invalid-algorithm-choice")}function i(w){var v=new d.hash(o.hashAlgorithm);return v.hash(w).buffer}function r(v){if(!g[v.algorithm]){return null}return g[v.algorithm](v.parameters)}s=r(o.sign);m=r(o.crypt);function t(v){if(v){u.sign=k;u.decrypt=j}u.verify=q;u.encrypt=p;u.getPublicKey=l;delete u.setPrivateKey;delete u.setPublicKey}function l(){var w=s.getPublicKey(),v=m.getPublicKey();return d.util.buffer.concat([new Uint16Array([w.byteLength]).buffer,w,v])}function k(w){if(!d.util.type(w).isArrayBuffer()){throw new Error("invalid-parameter")}var v=i(w);return s.sign(v)}function q(x,v){if(!(d.util.type(x).isArrayBuffer()&&d.util.type(v).isArrayBuffer())){throw new Error("invalid-parameter")}var w=i(x);return s.verify(w,v)}function p(v){if(!d.util.type(v).isArrayBuffer()){throw $.error("invalid-parameter")}return m.encrypt(v)}function j(v){if(!d.util.type(v).isArrayBuffer()){throw new Error("invalid-parameter")}return m.decrypt(v)}this.setPrivateKey=function(v){if(!d.util.type(v).isArrayBuffer()){throw new Error("invalid-parameter")}var z=new d.hash(o.hashAlgorithm).pbkdf2;var y=z(v,d.util.encoding("derivation-of-signing-key","ascii").toArrayBuffer(),4,o.sign.secretLength);var w=z(v,d.util.encoding("derivation-of-encrypting-key","ascii").toArrayBuffer(),4,o.crypt.secretLength);try{s.setPrivateKey(y);m.setPrivateKey(w)}catch(x){throw new Error("invalid-private-key")}t(true)};this.setPublicKey=function(w){if(!(d.util.type(w).isArrayBuffer()&&w.byteLength>2)){throw new Error("invalid-public-key")}var x=new Uint16Array(w.slice(0,2))[0];w=w.slice(2);if(w.byteLength<=x){throw new Error("invalid-public-key")}var z=w.slice(0,x),v=w.slice(x);try{s.setPublicKey(z);m.setPublicKey(v)}catch(y){throw new Error("invalid-public-key")}t(false)};return this}function f(i){if(i){d.util.log.notice("Load asymmetric cipher component: ["+i.name+"]");g[i.name]=i.constructor;return}if("undefined"!=typeof g.EC){d.util.log.notice("Asymmetric ciphers ready.");return function(j){return new h(j)}}return null}if("undefined"!=typeof module&&"undefined"!=typeof module.exports){module.exports=f}else{define([],function(){return f})}})(__enigma_jscrypto__);(function(d){function e(){var z=16;var A=4;var n=4;var x=[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22];var h=[82,9,106,213,48,54,165,56,191,64,163,158,129,243,215,251,124,227,57,130,155,47,255,135,52,142,67,68,196,222,233,203,84,123,148,50,166,194,35,61,238,76,149,11,66,250,195,78,8,46,161,102,40,217,36,178,118,91,162,73,109,139,209,37,114,248,246,100,134,104,152,22,212,164,92,204,93,101,182,146,108,112,72,80,253,237,185,218,94,21,70,87,167,141,157,132,144,216,171,0,140,188,211,10,247,228,88,5,184,179,69,6,208,44,30,143,202,63,15,2,193,175,189,3,1,19,138,107,58,145,17,65,79,103,220,234,151,242,207,206,240,180,230,115,150,172,116,34,231,173,53,133,226,249,55,232,28,117,223,110,71,241,26,113,29,41,197,137,111,183,98,14,170,24,190,27,252,86,62,75,198,210,121,32,154,219,192,254,120,205,90,244,31,221,168,51,136,7,199,49,177,18,16,89,39,128,236,95,96,81,127,169,25,181,74,13,45,229,122,159,147,201,156,239,160,224,59,77,174,42,245,176,200,235,187,60,131,83,153,97,23,43,4,126,186,119,214,38,225,105,20,99,85,33,12,125];var k=[0,16777216,33554432,67108864,134217728,268435456,536870912,1073741824,2147483648,452984832,905969664];function B(D,C){var F=0;var E;while(D){if((D&1)){F=F^C}E=C&128;C<<=1;if(E){C^=27}D>>=1}return F}function l(E){var D=new Array(256);for(var C=0;C<256;C++){D[C]=B(E,C)&255}return D}var w=l(2);var u=l(3);var o=l(9);var v=l(11);var t=l(13);var s=l(14);function y(C){return(x[C>>>24]<<24|x[(C>>>16)&255]<<16|x[(C>>>8)&255]<<8|x[C&255])}function q(C){return C>>>24|C<<8}function m(C){return C>>>24|(C&16711680)>>>8|(C&65280)<<8|(C&255)<<24}var p=((new Uint8Array((new Uint32Array([1])).buffer))[0]==1);function r(H){var D=new Uint8Array(H);var F=D.length/4;var I=F+6;var C=new Uint32Array(n*(I+1));for(var G=0;G<F;G++){C[G]=(D[G*4]<<24|D[G*4+1]<<16|D[G*4+2]<<8|D[G*4+3])}for(var G=F;G<n*(I+1);G++){var E=C[G-1];if(G%F==0){E=y(q(E))^k[G/F]}else{if(F>6&&G%F==4){E=y(E)}}C[G]=C[G-F]^E}if(p){for(var G=0;G<C.length;G++){C[G]=m(C[G])}}return C}function i(C,K){var H=(K.length/n-1)*4;var O,M,J,I;var G,F,E,D;var R,Q,N,L;O=(C[0]^K[0])>>>0;M=(C[1]^K[1])>>>0;J=(C[2]^K[2])>>>0;I=(C[3]^K[3])>>>0;for(var P=4;P<H;P+=4){G=O;F=M;E=J;D=I;R=x[G&255]>>>0;Q=x[(F>>>8)&255]>>>0;N=x[(E>>>16)&255]>>>0;L=x[D>>>24]>>>0;O=(((w[R]^u[Q]^N^L)|(R^w[Q]^u[N]^L)<<8|(R^Q^w[N]^u[L])<<16|(u[R]^Q^N^w[L])<<24)^K[P])>>>0;R=x[F&255]>>>0;Q=x[(E>>>8)&255]>>>0;N=x[(D>>>16)&255]>>>0;L=x[G>>>24]>>>0;M=(((w[R]^u[Q]^N^L)|(R^w[Q]^u[N]^L)<<8|(R^Q^w[N]^u[L])<<16|(u[R]^Q^N^w[L])<<24)^K[P+1])>>>0;R=x[E&255]>>>0;Q=x[(D>>>8)&255]>>>0;N=x[(G>>>16)&255]>>>0;L=x[F>>>24]>>>0;J=(((w[R]^u[Q]^N^L)|(R^w[Q]^u[N]^L)<<8|(R^Q^w[N]^u[L])<<16|(u[R]^Q^N^w[L])<<24)^K[P+2])>>>0;R=x[D&255]>>>0;Q=x[(G>>>8)&255]>>>0;N=x[(F>>>16)&255]>>>0;L=x[E>>>24]>>>0;I=(((w[R]^u[Q]^N^L)|(R^w[Q]^u[N]^L)<<8|(R^Q^w[N]^u[L])<<16|(u[R]^Q^N^w[L])<<24)^K[P+3])>>>0}C[0]=K[H]^(x[O&255]|x[(M>>>8)&255]<<8|x[(J>>>16)&255]<<16|x[I>>>24]<<24);C[1]=K[H+1]^(x[M&255]|x[(J>>>8)&255]<<8|x[(I>>>16)&255]<<16|x[O>>>24]<<24);C[2]=K[H+2]^(x[J&255]|x[(I>>>8)&255]<<8|x[(O>>>16)&255]<<16|x[M>>>24]<<24);C[3]=K[H+3]^(x[I&255]|x[(O>>>8)&255]<<8|x[(M>>>16)&255]<<16|x[J>>>24]<<24)}function j(C,K){var H=(K.length/n-1)*4;var M,L,J,I;var G,F,E,D;M=(C[0]^K[H])>>>0;L=(C[1]^K[H+1])>>>0;J=(C[2]^K[H+2])>>>0;I=(C[3]^K[H+3])>>>0;for(var N=H-4;N>0;N-=4){G=M;F=L;E=J;D=I;M=((h[G&255]|h[(D>>>8)&255]<<8|h[(E>>>16)&255]<<16|h[F>>>24]<<24)^K[N])>>>0;L=((h[F&255]|h[(G>>>8)&255]<<8|h[(D>>>16)&255]<<16|h[E>>>24]<<24)^K[N+1])>>>0;J=((h[E&255]|h[(F>>>8)&255]<<8|h[(G>>>16)&255]<<16|h[D>>>24]<<24)^K[N+2])>>>0;I=((h[D&255]|h[(E>>>8)&255]<<8|h[(F>>>16)&255]<<16|h[G>>>24]<<24)^K[N+3])>>>0;G=M&255>>>0;F=((M>>>8)&255)>>>0;E=((M>>>16)&255)>>>0;D=M>>>24;M=((s[G]^v[F]^t[E]^o[D])|(o[G]^s[F]^v[E]^t[D])<<8|(t[G]^o[F]^s[E]^v[D])<<16|(v[G]^t[F]^o[E]^s[D])<<24)>>>0;G=(L&255)>>>0;F=((L>>>8)&255)>>>0;E=((L>>>16)&255)>>>0;D=L>>>24;L=((s[G]^v[F]^t[E]^o[D])|(o[G]^s[F]^v[E]^t[D])<<8|(t[G]^o[F]^s[E]^v[D])<<16|(v[G]^t[F]^o[E]^s[D])<<24)>>>0;G=(J&255)>>>0;F=((J>>>8)&255)>>>0;E=((J>>>16)&255)>>>0;D=J>>>24;J=((s[G]^v[F]^t[E]^o[D])|(o[G]^s[F]^v[E]^t[D])<<8|(t[G]^o[F]^s[E]^v[D])<<16|(v[G]^t[F]^o[E]^s[D])<<24)>>>0;G=(I&255)>>>0;F=((I>>>8)&255)>>>0;E=((I>>>16)&255)>>>0;D=I>>>24;I=((s[G]^v[F]^t[E]^o[D])|(o[G]^s[F]^v[E]^t[D])<<8|(t[G]^o[F]^s[E]^v[D])<<16|(v[G]^t[F]^o[E]^s[D])<<24)>>>0}C[0]=K[0]^(h[M&255]|h[(I>>>8)&255]<<8|h[(J>>>16)&255]<<16|h[L>>>24]<<24);C[1]=K[1]^(h[L&255]|h[(M>>>8)&255]<<8|h[(I>>>16)&255]<<16|h[J>>>24]<<24);C[2]=K[2]^(h[J&255]|h[(L>>>8)&255]<<8|h[(M>>>16)&255]<<16|h[I>>>24]<<24);C[3]=K[3]^(h[I&255]|h[(J>>>8)&255]<<8|h[(L>>>16)&255]<<16|h[M>>>24]<<24)}return{block_size_bytes:z,block_size_words:A,endian_swap32:m,is_little_endian:p,key_expansion:r,cipher:i,inv_cipher:j}}function g(){var h=this;var j=new e(),k;function i(n){if(!(d.get("util.type")(n).isArrayBuffer()&&0==n.byteLength%j.block_size_bytes)){throw new Error("invalid-input")}var r=new Uint32Array(n);var s=new Uint32Array(r.length);var p=new Uint32Array(j.block_size_words);var m=j.key_expansion(k);var q,o;for(q=0;q<r.length;q+=j.block_size_words){for(o=0;o<j.block_size_words;o++){p[o]=r[q+o]}j.cipher(p,m);s.set(p,q)}return s.buffer}function l(n){if(!(d.get("util.type")(n).isArrayBuffer()&&0==n.byteLength%j.block_size_bytes)){throw new Error("invalid-input")}var r=new Uint32Array(n);var s=new Uint32Array(r.length);var p=new Uint32Array(j.block_size_words);var t=new Uint32Array(j.block_size_words);var m=j.key_expansion(k),q,o;for(q=0;q<r.length;q+=j.block_size_words){for(o=0;o<j.block_size_words;o++){t[o]=r[q+o]}p.set(t);j.inv_cipher(p,m);s.set(p,q)}return s.buffer}this.key=function(n){if(!d.get("util.type")(n).isArrayBuffer()){throw new Error("invalid-key")}var m=n.byteLength;if(m>32){n=n.slice(0,32)}else{if(m>24){n=n.slice(0,24)}else{if(m>16){n=n.slice(0,16)}else{throw new Error("invalid-key-length")}}}k=new Uint32Array(n);h.encrypt=i;h.decrypt=l;delete h.key;return h};return this}var f={name:"AESECB",constructor:function(){return new g()}};d.set("cipher.symmetric.aes",f)})(a);(function(e){var d=function(){this.key_length=128/8;this.blocksize=128/8;this.kw=new Array(8*4);this.k=new Array(24*8);this.kl=new Array(8*6);this.S1=new Uint8Array([112,130,44,236,179,39,192,229,228,133,87,53,234,12,174,65,35,239,107,147,69,25,165,33,237,14,79,78,29,101,146,189,134,184,175,143,124,235,31,206,62,48,220,95,94,197,11,26,166,225,57,202,213,71,93,61,217,1,90,214,81,86,108,77,139,13,154,102,251,204,176,45,116,18,43,32,240,177,132,153,223,76,203,194,52,126,118,5,109,183,169,49,209,23,4,215,20,88,58,97,222,27,17,28,50,15,156,22,83,24,242,34,254,68,207,178,195,181,122,145,36,8,232,168,96,252,105,80,170,208,160,125,161,137,98,151,84,91,30,149,224,255,100,210,16,196,0,72,163,247,117,219,138,3,230,218,9,63,221,148,135,92,131,2,205,74,144,51,115,103,246,243,157,127,191,226,82,155,216,38,200,55,198,59,129,150,111,75,19,190,99,46,233,121,167,140,159,110,188,142,41,245,249,182,47,253,180,89,120,152,6,106,231,70,113,186,212,37,171,66,136,162,141,250,114,7,185,85,248,238,172,10,54,73,42,104,60,56,241,164,64,40,211,123,187,201,67,193,21,227,173,244,119,199,128,158]);this.S2=new Uint8Array([224,5,88,217,103,78,129,203,201,11,174,106,213,24,93,130,70,223,214,39,138,50,75,66,219,28,158,156,58,202,37,123,13,113,95,31,248,215,62,157,124,96,185,190,188,139,22,52,77,195,114,149,171,142,186,122,179,2,180,173,162,172,216,154,23,26,53,204,247,153,97,90,232,36,86,64,225,99,9,51,191,152,151,133,104,252,236,10,218,111,83,98,163,46,8,175,40,176,116,194,189,54,34,56,100,30,57,44,166,48,229,68,253,136,159,101,135,107,244,35,72,16,209,81,192,249,210,160,85,161,65,250,67,19,196,47,168,182,60,43,193,255,200,165,32,137,0,144,71,239,234,183,21,6,205,181,18,126,187,41,15,184,7,4,155,148,33,102,230,206,237,231,59,254,127,197,164,55,177,76,145,110,141,118,3,45,222,150,38,125,198,92,211,242,79,25,63,220,121,29,82,235,243,109,94,251,105,178,240,49,12,212,207,140,226,117,169,74,87,132,17,69,27,245,228,14,115,170,241,221,89,20,108,146,84,208,120,112,227,73,128,80,167,246,119,147,134,131,42,199,91,233,238,143,1,61]);this.S3=new Uint8Array([56,65,22,118,217,147,96,242,114,194,171,154,117,6,87,160,145,247,181,201,162,140,210,144,246,7,167,39,142,178,73,222,67,92,215,199,62,245,143,103,31,24,110,175,47,226,133,13,83,240,156,101,234,163,174,158,236,128,45,107,168,43,54,166,197,134,77,51,253,102,88,150,58,9,149,16,120,216,66,204,239,38,229,97,26,63,59,130,182,219,212,152,232,139,2,235,10,44,29,176,111,141,136,14,25,135,78,11,169,12,121,17,127,34,231,89,225,218,61,200,18,4,116,84,48,126,180,40,85,104,80,190,208,196,49,203,42,173,15,202,112,255,50,105,8,98,0,36,209,251,186,237,69,129,115,109,132,159,238,74,195,46,193,1,230,37,72,153,185,179,123,249,206,191,223,113,41,205,108,19,100,155,99,157,192,75,183,165,137,95,177,23,244,188,211,70,207,55,94,71,148,250,252,91,151,254,90,172,60,76,3,53,243,35,184,93,106,146,213,33,68,81,198,125,57,131,220,170,124,119,86,5,27,164,21,52,30,28,248,82,32,20,233,189,221,228,161,224,138,241,214,122,187,227,64,79]);this.S4=new Uint8Array([112,44,179,192,228,87,234,174,35,107,69,165,237,79,29,146,134,175,124,31,62,220,94,11,166,57,213,93,217,90,81,108,139,154,251,176,116,43,240,132,223,203,52,118,109,169,209,4,20,58,222,17,50,156,83,242,254,207,195,122,36,232,96,105,170,160,161,98,84,30,224,100,16,0,163,117,138,230,9,221,135,131,205,144,115,246,157,191,82,216,200,198,129,111,19,99,233,167,159,188,41,249,47,180,120,6,231,113,212,171,136,141,114,185,248,172,54,42,60,241,64,211,187,67,21,173,119,128,130,236,39,229,133,53,12,65,239,147,25,33,14,78,101,189,184,143,235,206,48,95,197,26,225,202,71,61,1,214,86,77,13,102,204,45,18,32,177,153,76,194,126,5,183,49,23,215,88,97,27,28,15,22,24,34,68,178,181,145,8,168,252,80,208,125,137,151,91,149,255,210,196,72,247,219,3,218,63,148,92,2,74,51,103,243,127,226,155,38,55,59,150,75,190,46,121,140,110,142,245,182,253,89,152,106,70,186,37,66,162,250,7,85,238,10,73,104,56,164,40,123,201,193,227,244,199,158]);this.SIGMA1=[160,158,102,127,59,204,144,139];this.SIGMA2=[182,122,232,88,76,170,115,178];this.SIGMA3=[198,239,55,47,233,79,130,190];this.SIGMA4=[84,255,83,165,241,211,111,28];this.SIGMA5=[16,229,39,250,222,104,45,29];this.SIGMA6=[176,86,136,194,179,230,193,253];return this};d.prototype._xor_block=function(h,n,j){var m=new Array(j);for(var k=0;k<j;k++){m[k]=h[k]^n[k]}return m};d.prototype._feistel=function(n,m,h,l){var j=new Array(8);var i=this._xor_block(h,l,8);j[0]=this.S1[i[0]];j[1]=this.S2[i[1]];j[2]=this.S3[i[2]];j[3]=this.S4[i[3]];j[4]=this.S2[i[4]];j[5]=this.S3[i[5]];j[6]=this.S4[i[6]];j[7]=this.S1[i[7]];n[0+m]^=j[0]^j[2]^j[3]^j[5]^j[6]^j[7];n[1+m]^=j[0]^j[1]^j[3]^j[4]^j[6]^j[7];n[2+m]^=j[0]^j[1]^j[2]^j[4]^j[5]^j[7];n[3+m]^=j[1]^j[2]^j[3]^j[4]^j[5]^j[6];n[4+m]^=j[0]^j[1]^j[5]^j[6]^j[7];n[5+m]^=j[1]^j[2]^j[4]^j[6]^j[7];n[6+m]^=j[2]^j[3]^j[4]^j[5]^j[7];n[7+m]^=j[0]^j[3]^j[4]^j[5]^j[6]};d.prototype._rot_shift=function(q,p,n,m,h){if(m==0){this._move(q,0,n,0,h);return}var l=Math.floor(m/8)+1;var k=l*8-m;l=l%h;for(var j=0;j<h;j++){q[j+p]=((n[(j+l)%h]>>k)&255)|((n[(j+l-1)%h]<<(8-k))&255)}};d.prototype.setup=function(k){var n=new Array();var h=new Array();var m=new Array();this.key_length=k.byteLength;if(16==k.byteLength){n=new Uint8Array(k.slice(0,16));h=new Array(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}else{if(24==k.byteLength){n=new Uint8Array(k.slice(0,16));for(var j=0;j<8;j++){h[j]=k[j+16];h[j+8]=k[j+16]^255}}else{if(32==k.byteLength){n=new Uint8Array(k.slice(0,16));h=new Uint8Array(k.slice(16,32))}else{throw"wrong key length: key must be 128, 192 or 256 bit"}}}m=this._xor_block(n,h,16);this._feistel(m,8,m,this.SIGMA1);this._feistel(m,0,m.slice(8,16),this.SIGMA2);m=this._xor_block(n,m,16);this._feistel(m,8,m.slice(0,8),this.SIGMA3);this._feistel(m,0,m.slice(8,16),this.SIGMA4);if(k.length==16){this._rot_shift(this.kw,0,n,0,16);this._rot_shift(this.k,0,m,0,16);this._rot_shift(this.k,8*2,n,15,16);this._rot_shift(this.k,8*4,m,15,16);this._rot_shift(this.kl,0,m,30,16);this._rot_shift(this.k,8*6,n,45,16);this._rot_shift(this.k,8*8,m,45,16);this._rot_shift(this.k,8*9,n,60,16);this._move(this.k,8*9,this.k.slice(8*10,8*10+8),0,8);this._rot_shift(this.k,8*10,m,60,16);this._rot_shift(this.kl,8*2,n,77,16);this._rot_shift(this.k,8*12,n,94,16);this._rot_shift(this.k,8*14,m,94,16);this._rot_shift(this.k,8*16,n,111,16);this._rot_shift(this.kw,8*2,m,111,16)}else{var l=this._xor_block(h,m,16);this._feistel(l,8,l.slice(0,8),this.SIGMA5);this._feistel(l,0,l.slice(8,16),this.SIGMA6);this._rot_shift(this.kw,0,n,0,16);this._rot_shift(this.k,0,l,0,16);this._rot_shift(this.k,8*2,h,15,16);this._rot_shift(this.k,8*4,m,15,16);this._rot_shift(this.kl,0,h,30,16);this._rot_shift(this.k,8*6,l,30,16);this._rot_shift(this.k,8*8,n,45,16);this._rot_shift(this.k,8*10,m,45,16);this._rot_shift(this.kl,8*2,n,60,16);this._rot_shift(this.k,8*12,h,60,16);this._rot_shift(this.k,8*14,l,60,16);this._rot_shift(this.k,8*16,n,77,16);this._rot_shift(this.kl,8*4,m,77,16);this._rot_shift(this.k,8*18,h,94,16);this._rot_shift(this.k,8*20,m,94,16);this._rot_shift(this.k,8*22,n,111,16);this._rot_shift(this.kw,8*2,l,111,16)}};d.prototype._flayer=function(j,h,i){this._move(j,0,h,0,8);j[4+0]^=(((h[0]&i[0])<<1)&255)^(h[1]&i[1])>>7;j[4+1]^=(((h[1]&i[1])<<1)&255)^(h[2]&i[2])>>7;j[4+2]^=(((h[2]&i[2])<<1)&255)^(h[3]&i[3])>>7;j[4+3]^=(((h[3]&i[3])<<1)&255)^(h[0]&i[0])>>7;j[0]^=j[4+0]|i[4+0];j[1]^=j[4+1]|i[4+1];j[2]^=j[4+2]|i[4+2];j[3]^=j[4+3]|i[4+3]};d.prototype._flayer_1=function(j,h,i){this._move(j,0,h,0,8);j[0]^=h[4+0]|i[4+0];j[1]^=h[4+1]|i[4+1];j[2]^=h[4+2]|i[4+2];j[3]^=h[4+3]|i[4+3];j[4+0]^=(((j[0]&i[0])<<1)&255)^(j[1]&i[1])>>7;j[4+1]^=(((j[1]&i[1])<<1)&255)^(j[2]&i[2])>>7;j[4+2]^=(((j[2]&i[2])<<1)&255)^(j[3]&i[3])>>7;j[4+3]^=(((j[3]&i[3])<<1)&255)^(j[0]&i[0])>>7};d.prototype.encrypt=function(m){var h=new Uint8Array(m.slice(0,8));var k=new Uint8Array(m.slice(8,16));h=this._xor_block(h,this.kw.slice(0,8),8);k=this._xor_block(k,this.kw.slice(8,16),8);if(this.key_length==16){for(var j=0;j<18;j+=2){this._feistel(k,0,h,this.k.slice(8*j,(8*j)+8));this._feistel(h,0,k,this.k.slice(8*(j+1),8*(j+1)+8));if(j==4){this._flayer(h,h,this.kl,0);this._flayer_1(k,k,this.kl.slice(8,16),0)}else{if(j==10){this._flayer(h,h,this.kl.slice(16,24),0);this._flayer_1(k,k,this.kl.slice(24,32),0)}}}}else{for(var j=0;j<24;j+=2){this._feistel(k,0,h,this.k.slice(8*j,(8*j)+8));this._feistel(h,0,k,this.k.slice(8*(j+1),8*(j+1)+8));if(j==4){this._flayer(h,h,this.kl,0);this._flayer_1(k,k,this.kl.slice(8,16),0)}else{if(j==10){this._flayer(h,h,this.kl.slice(16,24),0);this._flayer_1(k,k,this.kl.slice(24,32),0)}else{if(j==16){this._flayer(h,h,this.kl.slice(32,40),0);this._flayer_1(k,k,this.kl.slice(40,48),0)}}}}}k=this._xor_block(k,this.kw.slice(16,24),8);h=this._xor_block(h,this.kw.slice(24,32),8);return k.concat(h)};d.prototype.decrypt=function(m){var k=new Uint8Array(m.slice(0,8));var h=new Uint8Array(m.slice(8,16));k=this._xor_block(k,this.kw.slice(8*2,8*2+8),8);h=this._xor_block(h,this.kw.slice(8*3,8*3+8),8);if(this.key_length==16){for(var j=16;j>=0;j-=2){this._feistel(h,0,k,this.k.slice(8*(j+1),8*(j+1)+8));this._feistel(k,0,h,this.k.slice(8*j,(8*j)+8));if(j==12){this._flayer(k,k,this.kl.slice(8*3,8*3+8),0);this._flayer_1(h,h,this.kl.slice(8*2,8*2+8),0)}else{if(j==6){this._flayer(k,k,this.kl.slice(8*1,8*1+8),0);this._flayer_1(h,h,this.kl.slice(8*0,8*0+8),0)}}}}else{for(var j=22;j>=0;j-=2){this._feistel(h,0,k,this.k.slice(8*(j+1),8*(j+1)+8));this._feistel(k,0,h,this.k.slice(8*j,(8*j)+8));if(j==18){this._flayer(k,k,this.kl.slice(8*5,8*5+8),0);this._flayer_1(h,h,this.kl.slice(8*4,8*4+8),0)}else{if(j==12){this._flayer(k,k,this.kl.slice(8*3,8*3+8),0);this._flayer_1(h,h,this.kl.slice(8*2,8*2+8),0)}else{if(j==6){this._flayer(k,k,this.kl.slice(8*1,8*1+8),0);this._flayer_1(h,h,this.kl.slice(8*0,8*0+8),0)}}}}}h=this._xor_block(h,this.kw.slice(8*0,8*0+8),8);k=this._xor_block(k,this.kw.slice(8*1,8*1+8),8);return h.concat(k)};d.prototype._move=function(n,j,m,l,h){for(var k=0;k<h;k++){n[k+j]=m[k+l]}};function g(){var i=this;var h=new d(),k,l;this.key=function(n){if(!e.get("util.type")(n).isArrayBuffer()){throw new Error("invalid-key-input")}k=new Uint8Array(n.slice(0,16));if(n.byteLength>=32){l=new Uint8Array(n.slice(0,32))}else{if(n.byteLength>=24){l=new Uint8Array(n.slice(0,24))}else{if(n.byteLength>=16){l=new Uint8Array(n.slice(0,16))}else{throw new Error("key-too-short")}}}h.setup(l.buffer);i.encrypt=m;i.decrypt=j;delete i.key;return i};function m(p){if(!e.get("util.type")(p).isArrayBuffer()){throw new Error("invalid-buffer-input")}if(p.byteLength%16!=0){throw new Error("invalid-plaintext")}var r,o=new Uint8Array(p.byteLength),t=k,s;var q,n;for(q=0;q<p.byteLength;q+=16){r=new Uint8Array(p.slice(q,q+16));s=h.encrypt(h._xor_block(t,r,16));for(n=0;n<16;n++){o[q+n]=s[n]}t=s}return o.buffer}function j(p){if(!e.get("util.type")(p).isArrayBuffer()){throw new Error("invalid-buffer-input")}if(p.byteLength%16!=0){throw new Error("invalid-ciphertext")}var o=new Uint8Array(p.byteLength),r,s=k,q,n;for(q=0;q<p.byteLength;q+=16){r=p.slice(q,q+16);pBlock=h._xor_block(h.decrypt(r),s,16);for(n=0;n<16;n++){o[q+n]=pBlock[n]}s=r}return o.buffer}return this}var f={name:"CAMELLIA",constructor:function(){return new g()}};e.set("cipher.symmetric.camellia",f)})(a);(function(e){function d(p){var q=this;if(!p||p<10){p=10}function l(t,s){return(((t)<<(s))|((t)>>>(32-(s))))}function i(v,t){var u;var s=new Uint32Array(16);for(u=0;u<16;u++){s[u]=v[u]}for(u=0;u<p;u++){s[4]^=l(s[0]+s[12],7);s[8]^=l(s[4]+s[0],9);s[12]^=l(s[8]+s[4],13);s[0]^=l(s[12]+s[8],18);s[9]^=l(s[5]+s[1],7);s[13]^=l(s[9]+s[5],9);s[1]^=l(s[13]+s[9],13);s[5]^=l(s[1]+s[13],18);s[14]^=l(s[10]+s[6],7);s[2]^=l(s[14]+s[10],9);s[6]^=l(s[2]+s[14],13);s[10]^=l(s[6]+s[2],18);s[3]^=l(s[15]+s[11],7);s[7]^=l(s[3]+s[15],9);s[11]^=l(s[7]+s[3],13);s[15]^=l(s[11]+s[7],18);s[1]^=l(s[0]+s[3],7);s[2]^=l(s[1]+s[0],9);s[3]^=l(s[2]+s[1],13);s[0]^=l(s[3]+s[2],18);s[6]^=l(s[5]+s[4],7);s[7]^=l(s[6]+s[5],9);s[4]^=l(s[7]+s[6],13);s[5]^=l(s[4]+s[7],18);s[11]^=l(s[10]+s[9],7);s[8]^=l(s[11]+s[10],9);s[9]^=l(s[8]+s[11],13);s[10]^=l(s[9]+s[8],18);s[12]^=l(s[15]+s[14],7);s[13]^=l(s[12]+s[15],9);s[14]^=l(s[13]+s[12],13);s[15]^=l(s[14]+s[13],18)}for(u=0;u<16;u++){t[u]=s[u]+v[u]}}function j(x,v,u,t){var w=new Uint32Array([1634760805,857760878,2036477234,1797285236]);var s=new Uint32Array(16);s[0]=w[0];s[1]=x[0];s[2]=x[1];s[3]=x[2];s[4]=x[3];s[5]=w[1];s[6]=v[0];s[7]=v[1];s[8]=u[0];s[9]=u[1];s[10]=w[2];s[11]=x[4];s[12]=x[5];s[13]=x[6];s[14]=x[7];s[15]=w[3];return i(s,t)}function n(u,w,v,t){var x=new Uint32Array([1634760805,824206446,2036477238,1797285236]);var s=new Uint32Array(16);s[0]=x[0];s[1]=u[0];s[2]=u[1];s[3]=u[2];s[4]=u[3];s[5]=x[1];s[6]=w[0];s[7]=w[1];s[8]=v[0];s[9]=v[1];s[10]=x[2];s[11]=u[0];s[12]=u[1];s[13]=u[2];s[14]=u[3];s[15]=x[3];return i(s,t)}var g=new Uint32Array(2);var m;function o(){g[0]=0;g[1]=0}function r(){g[0]+=1;if(0==g[0]){g[1]+=1}}function k(s,v){var u=new Uint32Array(s);if(32==v.byteLength){var t=new Uint32Array(v);m=(function(x,w){return function(y){j(w,x,g,y);r()}})(u,t)}else{if(16==v.byteLength){var t=new Uint32Array(v);m=(function(x,w){return function(y){n(w,x,g,y);r()}})(u,t)}else{throw new Error("invalid-key-length")}}}function h(x){if(!e.get("util.type")(x).isArrayBuffer()){throw new Error("invalid-input")}var v=x.byteLength,w=Math.ceil(v/64),z=new Uint32Array(16);var y=new Uint8Array(x);var s=0,u,t;o();for(u=0;u<w;u++){m(z);for(t=0;t<64;t++){y[s+t]^=z[t]}s+=64}return y.buffer.slice(0,v)}this.key=function(t){if(!e.get("util.type")(t).isArrayBuffer()){throw new Error("invalid-key")}var u=t.byteLength;if(u<24){throw new Error("invalid-key")}var s=t.slice(0,8);if(u<40){k(s,t.slice(8,24))}else{k(s,t.slice(8,40))}q.encrypt=h;q.decrypt=h;delete q.key;return q};return this}var f={name:"Salsa20/20",constructor:function(){return new d(20)}};e.set("cipher.symmetric.salsa20",f)})(a);(function(f){function e(){var s=this;function r(v,x){var z=v.byteLength,y=x-(z%x),A=z+y,u=new Uint8Array(v),t=new Uint8Array(A);for(var w=0;w<A;w++){if(w<z){t[w]=u[w]}else{t[w]=y}}return t.buffer}function q(u){var t=new Uint8Array(u);var v=t[t.length-1];if(t.length<v){return null}return u.slice(0,u.byteLength-v)}function n(t){return t}function k(t){return t}var m=null;function o(w,u,x){var z=64;var y=new f.get("hash")("BLAKE2s").pbkdf2(w,u,4,x*z);var t=new Array(x);for(var v=0;v<x;v++){t[v]=new f.get("hash")("WHIRLPOOL").hash(y.slice(v*z,(v+1)*z)).buffer}return t}var p=function(v){if(!f.get("util.type")(v).isArrayBuffer()){throw new Error("invalid-parameter")}var u=new f.get("util.srand")().bytes(10);var w=o(m,u,5);var x=new f.get("hash")("BLAKE2s",{length:6}).mac(v,w[0]).buffer;v=f.get("util.buffer").concat([x,v]);var t=v;t=n(t);t=r(t,16);t=d(w[1],t);t=j(w[2],t);t=f.get("util.buffer").reverse(t);return f.get("util.buffer").concat([u,t])};var l=function(v){if(!(f.get("util.type")(v).isArrayBuffer()&&v.byteLength>=26)){throw new Error("invalid-parameter")}var x=v.slice(0,10);v=v.slice(10);var y=o(m,x,5);var u=v;u=f.get("util.buffer").reverse(u);u=h(y[2],u);u=g(y[1],u);u=q(u,16);if(!f.get("util.type")(u).isArrayBuffer()){return null}u=k(u);if(!f.get("util.type")(u).isArrayBuffer()){return null}var w=u.slice(0,6);u=u.slice(6);var t=new f.get("hash")("BLAKE2s",{length:6}).mac(u,y[0]).buffer;if(f.get("util.buffer").equal(w,t)){return u}return null};this.key=function(t){if(!f.get("util.type")(t).isArrayBuffer()){throw new Error("invalid-key")}m=t;delete s.key;s.encrypt=p;s.decrypt=l;return s};return this}var j=function(k,m){try{var l=f.get("cipher.symmetric.aes").constructor;return l().key(k).encrypt(m)}catch(n){f.get("util.log").error(n);return new Error("unable-to-encrypt",n)}};var h=function(k,m){try{var l=f.get("cipher.symmetric.aes").constructor;return l().key(k).decrypt(m)}catch(n){f.get("util.log").error(n);return new Error("unable-to-decrypt",n)}};var d=function(k,l){try{var n=f.get("cipher.symmetric.salsa20").constructor;return n().key(k).encrypt(l)}catch(m){f.get("util.log").error(m);return new Error("unable-to-encrypt")}};var g=function(k,l){try{var n=f.get("cipher.symmetric.salsa20").constructor;return n().key(k).decrypt(l)}catch(m){f.get("util.log").error(m);return new Error("unable-to-decrypt",m)}};function i(){return new e()}f.set("cipher.symmetric",i);f.exp("cipher.symmetric",i)})(a);if("undefined"!=typeof module&&"undefined"!=module.exports){module.exports=c}else{define([],function(){return c})}})();