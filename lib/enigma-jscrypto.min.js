__enigma_jscrypto__={};(function(b){var a={};(function(d){function h(n){var m,l,o=0,k;for(m=0;m<n.length;m++){o+=n[m].byteLength}var p=new Uint8Array(o),q=0;for(m=0;m<n.length;m++){k=new Uint8Array(n[m]);for(l=0;l<k.length;l++){p[q]=k[l];q+=1}}return p.buffer}function c(k,j){if(k.byteLength!=j.byteLength){throw Error("xor-unequal-length-buffer")}var n=new Uint8Array(k.byteLength),m=new Uint8Array(k),o=new Uint8Array(j);for(var l=0;l<n.length;l++){n[l]=m[l]^o[l]}return n.buffer}function f(l,k){try{var j=new Uint8Array(l),o=new Uint8Array(k)}catch(n){return false}if(j.length!=o.length){return false}for(var m=0;m<j.length;m++){if(j[m]!=o[m]){return false}}return true}function e(j){var m=new Uint8Array(j);var i=m.length-1,n=Math.floor(i/2);var p=i,o;for(var k=0;k<=n;k++){o=m[k];m[k]=m[p];m[p]=o;p-=1}return m.buffer}var g={concat:h,xor:c,equal:f,reverse:e};if("undefined"!=typeof module&&"undefined"!=typeof module.exports){module.exports=g}else{define([],function(){return g})}d.util.buffer=g})(__enigma_jscrypto__);(function(c){function d(f,w){var y=this;var o=null;var m="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",x="0123456789abcdef";var t=c.util.type(f);if(t.isArrayBuffer()){o=f}else{if(t.isArray()){var g=new Uint8Array(f.length);for(var p=0;p<g.length;p++){g[p]=f[p]&255}o=g.buffer}else{if(t.isString()){if(!w){w=""}switch(w.toLowerCase()){case"hex":if(!/^[0-9a-f]+$/i.test(f)||0!=f.length%2){throw Error("invalid-encoding-choosen")}f=f.toLowerCase();var k=new Uint8Array(f.length/2);for(var p=0;p<k.length;p++){k[p]=x.indexOf(f[2*p])*16+x.indexOf(f[2*p+1])}o=k.buffer;break;case"base64":if(/(=[^=]+|={3,})$/.test(f)){throw Error("invalid-encoding-choosen")}f=f.replace(/=/g,"");var h=f.length&3;if(1==h){throw Error("invalid-encoding-choosen")}var p=0,l=0,q=Math.ceil(f.length/4);var k=new Uint8Array(q*3);var v,u,s,r;for(p=0;p<q;p++){v=m.indexOf(f[l++]||"A");u=m.indexOf(f[l++]||"A");s=m.indexOf(f[l++]||"A");r=m.indexOf(f[l++]||"A");if((v|u|s|r)<0){throw Error("invalid-encoding-choosen")}k[p*3]=((v<<2)|(u>>4))&255;k[p*3+1]=((u<<4)|(s>>2))&255;k[p*3+2]=((s<<6)|r)&255}o=k.buffer.slice(0,k.length+h-4);break;default:var k=new Uint16Array(f.length);for(var p=0;p<f.length;p++){k[p]=f.charCodeAt(p)}o=k.buffer;break}}else{throw Error("unknown-encoding")}}}this.toArrayBuffer=function(){return o};this.toUTF16=function(){var j=new Uint16Array(o),z="";for(var n=0;n<j.length;n++){z+=String.fromCharCode(j[n])}return z};this.toBase64=function(){var E=new Uint8Array(o);var B=0,A=0,z=0,C=E.length/3;var n="";var G,F,D;for(B=0;B<C;++B){G=E[A++];F=E[A++];D=E[A++];n+=m[G>>2]+m[((G<<4)&63)|(F>>4)]+(isNaN(F)?"=":m[((F<<2)&63)|(D>>6)])+(isNaN(F+D)?"=":m[D&63])}console.log(E.length);return n};this.toHEX=function(){var j=new Uint8Array(o),z="";for(var n=0;n<j.length;n++){if(j[n]<16){z+="0"+j[n].toString(16)}else{z+=j[n].toString(16)}}return z};this.toArray=function(){var j=new Uint8Array(o),n=new Array(j.length);for(var z=0;z<n.length;z++){n[z]=j[z]}return n};return this}var e=function(g,f){return new d(g,f)};if("undefined"!=typeof module&&"undefined"!=typeof module.exports){module.exports=e}else{define([],function(){return e})}c.util.encoding=e})(__enigma_jscrypto__);(function(c){if("undefined"==typeof c.util){c.util={}}function d(){return c}if("undefined"!=typeof module&&"undefined"!=typeof module.exports){module.exports=d(require("./log.js"),require("./type.js"),require("./buffer.js"),require("./random.js"),require("./encoding.js"))}else{define(["util/log","util/type","util/buffer","util/random","util/encoding"],d)}})(__enigma_jscrypto__);(function(c){var d={notice:function(e){console.log(e)},error:function(e){console.error(e)}};if("undefined"!=typeof module&&"undefined"!=typeof module.exports){module.exports=d}else{define([],function(){return d})}c.util.log=d})(__enigma_jscrypto__);(function(){function c(m){if(!a.util.type(m).isArrayBuffer()){throw Error("invalid-input")}var e=new Uint8Array(m);var g,k={},j,f,l="",n=[],h=256;for(g=0;g<256;g+=1){k[String.fromCharCode(g)]=g}for(g=0;g<e.length;g+=1){j=String.fromCharCode(e[g]);f=l+j;if(k.hasOwnProperty(f)){l=f}else{n.push(k[l]);k[f]=h++;l=String(j)}}if(""!==l){n.push(k[l])}return n}function d(m){var j,n=[],g,f,h,l="",e=256;for(j=0;j<256;j+=1){n[j]=String.fromCharCode(j)}g=String.fromCharCode(compressed[0]);f=g;for(j=1;j<compressed.length;j+=1){h=compressed[j];if(n[h]){l=n[h]}else{if(h===e){l=g+g.charAt(0)}else{return null}}f+=l;n[e++]=g+l.charAt(0);g=l}return f}})();(function(o){function h(t,i){return(((t)<<(i))|((t)>>>(32-(i))))}function e(w,u){var v;var t=new Uint32Array(16);for(v=0;v<16;v++){t[v]=w[v]}for(v=0;v<20;v++){t[4]^=h(t[0]+t[12],7);t[8]^=h(t[4]+t[0],9);t[12]^=h(t[8]+t[4],13);t[0]^=h(t[12]+t[8],18);t[9]^=h(t[5]+t[1],7);t[13]^=h(t[9]+t[5],9);t[1]^=h(t[13]+t[9],13);t[5]^=h(t[1]+t[13],18);t[14]^=h(t[10]+t[6],7);t[2]^=h(t[14]+t[10],9);t[6]^=h(t[2]+t[14],13);t[10]^=h(t[6]+t[2],18);t[3]^=h(t[15]+t[11],7);t[7]^=h(t[3]+t[15],9);t[11]^=h(t[7]+t[3],13);t[15]^=h(t[11]+t[7],18);t[1]^=h(t[0]+t[3],7);t[2]^=h(t[1]+t[0],9);t[3]^=h(t[2]+t[1],13);t[0]^=h(t[3]+t[2],18);t[6]^=h(t[5]+t[4],7);t[7]^=h(t[6]+t[5],9);t[4]^=h(t[7]+t[6],13);t[5]^=h(t[4]+t[7],18);t[11]^=h(t[10]+t[9],7);t[8]^=h(t[11]+t[10],9);t[9]^=h(t[8]+t[11],13);t[10]^=h(t[9]+t[8],18);t[12]^=h(t[15]+t[14],7);t[13]^=h(t[12]+t[15],9);t[14]^=h(t[13]+t[12],13);t[15]^=h(t[14]+t[13],18)}for(v=0;v<16;v++){u[v]=t[v]+w[v]}}var k=new Uint8Array(16);function q(){for(var t=0;t<16;t++){k[t]=Math.floor(256*Math.random())}}q();var c=new Uint32Array([0,0]);function l(){c[0]=0;c[1]=0}function n(){c[0]+=1;if(0==c[0]){c[1]+=1}if(0==c[1]){q()}}var r=new Uint8Array(32),d=0;function s(i){r[d]=i;d+=1;if(d>=32){l();d=0}}for(var g=0;g<32;g++){s(Math.floor(256*Math.random()))}function f(){s(new Date().getTime()%256)}setInterval(f,100);var p=new Uint32Array([1634760805,857760878,2036477234,1797285236]);function j(t){var i=new Uint32Array(16),u=new Uint32Array(k.buffer),v=new Uint32Array(r.buffer);i[0]=p[0];i[1]=v[0];i[2]=v[1];i[3]=v[2];i[4]=v[3];i[5]=p[1];i[6]=u[0];i[7]=u[1];i[8]=c[0];i[9]=c[1];i[10]=p[2];i[11]=v[4];i[12]=v[5];i[13]=v[6];i[14]=v[7];i[15]=p[3];n();return e(i,t)}function m(){var i=this;var t=new Uint32Array(16);this.touch=function(){f()};this.bytes=function(z){var u=Math.ceil(z/64);var w=new Uint8Array(z),x=0,v=0,A;for(var y=0;y<u;y++){j(t);A=new Uint8Array(t.buffer);for(x=0;x<64;x++){if(v>=z){break}w[v]=A[x];v+=1}}return w.buffer};this.array=function(u){return new Uint8Array(i.bytes(u))};return this}if("undefined"!=typeof module&&"undefined"!=typeof module.exports){module.exports=m}else{define([],function(){return m})}o.util.srand=m})(__enigma_jscrypto__);(function(c){function d(e){return{isError:function(){return toString.apply(e)==="[object Error]"},isArray:function(){return toString.apply(e)==="[object Array]"},isDate:function(){return toString.apply(e)==="[object Date]"},isObject:function(){return !!e&&Object.prototype.toString.call(e)==="[object Object]"},isPrimitive:function(){return self.isString(e)||self.isNumber(e)||self.isBoolean(e)},isFunction:function(){return toString.apply(e)==="[object Function]"},isDate:function(){return toString.apply(e)==="[object Date]"},isNumber:function(){return typeof e==="number"&&isFinite(e)},isString:function(){return typeof e==="string"},isBoolean:function(){return typeof e==="boolean"},isArrayBuffer:function(){return toString.apply(e)==="[object ArrayBuffer]"}}}if("undefined"!=typeof module&&"undefined"!=typeof module.exports){module.exports=d}else{define([],function(){return d})}c.util.type=d})(__enigma_jscrypto__);(function(c){var f={};var d={NECRAC256:{secretLength:128,sign:{algorithm:"EC",parameters:{curve:"secp521r1"},secretLength:64},crypt:{algorithm:"EC",parameters:{curve:"secp521r1"},secretLength:64},hashAlgorithm:"WHIRLPOOL"}};function g(m){var t=this;var n=d[m];var r,l;if(!n){throw new Error("invalid-algorithm-choice")}function h(v){var u=new c.hash(n.hashAlgorithm);return u.hash(v).buffer}function q(u){if(!f[u.algorithm]){return null}return f[u.algorithm](u.parameters)}r=q(n.sign);l=q(n.crypt);function s(u){if(u){t.sign=j;t.decrypt=i}t.verify=p;t.encrypt=o;t.getPublicKey=k;delete t.setPrivateKey;delete t.setPublicKey}function k(){var v=r.getPublicKey(),u=l.getPublicKey();return c.util.buffer.concat([new Uint16Array([v.byteLength]).buffer,v,u])}function j(v){if(!c.util.type(v).isArrayBuffer()){throw new Error("invalid-parameter")}var u=h(v);return r.sign(u)}function p(w,u){if(!(c.util.type(w).isArrayBuffer()&&c.util.type(u).isArrayBuffer())){throw new Error("invalid-parameter")}var v=h(w);return r.verify(v,u)}function o(u){if(!c.util.type(u).isArrayBuffer()){throw $.error("invalid-parameter")}return l.encrypt(u)}function i(u){if(!c.util.type(u).isArrayBuffer()){throw new Error("invalid-parameter")}return l.decrypt(u)}this.setPrivateKey=function(u){if(!c.util.type(u).isArrayBuffer()){throw new Error("invalid-parameter")}var y=new c.hash(n.hashAlgorithm).pbkdf2;var x=y(u,c.util.encoding("derivation-of-signing-key","ascii").toArrayBuffer(),4,n.sign.secretLength);var v=y(u,c.util.encoding("derivation-of-encrypting-key","ascii").toArrayBuffer(),4,n.crypt.secretLength);try{r.setPrivateKey(x);l.setPrivateKey(v)}catch(w){throw new Error("invalid-private-key")}s(true)};this.setPublicKey=function(v){if(!(c.util.type(v).isArrayBuffer()&&v.byteLength>2)){throw new Error("invalid-public-key")}var w=new Uint16Array(v.slice(0,2))[0];v=v.slice(2);if(v.byteLength<=w){throw new Error("invalid-public-key")}var y=v.slice(0,w),u=v.slice(w);try{r.setPublicKey(y);l.setPublicKey(u)}catch(x){throw new Error("invalid-public-key")}s(false)};return this}function e(h){if(h){c.util.log.notice("Load asymmetric cipher component: ["+h.name+"]");f[h.name]=h.constructor;return}if("undefined"!=typeof f.EC){c.util.log.notice("Asymmetric ciphers ready.");return function(i){return new g(i)}}return null}if("undefined"!=typeof module&&"undefined"!=typeof module.exports){module.exports=e}else{define([],function(){return e})}})(__enigma_jscrypto__);(function(c){var d=["ec/ec"];function g(j){for(var h=1;h<arguments.length;h++){j(arguments[h])}c.cipher.asymmetric=j(false)}if("undefined"!=typeof module&&"undefined"!=typeof module.exports){var f=[require("./asymmetric.js")];for(var e in d){f.push(require("./"+d[e]+".js"))}g.apply(this,f)}else{var f=["cipher/asymmetric/asymmetric"];for(var e in d){f.push("cipher/asymmetric/"+d[e])}define(f,g)}})(__enigma_jscrypto__);(function(c){function d(){var y=16;var z=4;var m=4;var w=[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22];var g=[82,9,106,213,48,54,165,56,191,64,163,158,129,243,215,251,124,227,57,130,155,47,255,135,52,142,67,68,196,222,233,203,84,123,148,50,166,194,35,61,238,76,149,11,66,250,195,78,8,46,161,102,40,217,36,178,118,91,162,73,109,139,209,37,114,248,246,100,134,104,152,22,212,164,92,204,93,101,182,146,108,112,72,80,253,237,185,218,94,21,70,87,167,141,157,132,144,216,171,0,140,188,211,10,247,228,88,5,184,179,69,6,208,44,30,143,202,63,15,2,193,175,189,3,1,19,138,107,58,145,17,65,79,103,220,234,151,242,207,206,240,180,230,115,150,172,116,34,231,173,53,133,226,249,55,232,28,117,223,110,71,241,26,113,29,41,197,137,111,183,98,14,170,24,190,27,252,86,62,75,198,210,121,32,154,219,192,254,120,205,90,244,31,221,168,51,136,7,199,49,177,18,16,89,39,128,236,95,96,81,127,169,25,181,74,13,45,229,122,159,147,201,156,239,160,224,59,77,174,42,245,176,200,235,187,60,131,83,153,97,23,43,4,126,186,119,214,38,225,105,20,99,85,33,12,125];var j=[0,16777216,33554432,67108864,134217728,268435456,536870912,1073741824,2147483648,452984832,905969664];function A(C,B){var E=0;var D;while(C){if((C&1)){E=E^B}D=B&128;B<<=1;if(D){B^=27}C>>=1}return E}function k(D){var C=new Array(256);for(var B=0;B<256;B++){C[B]=A(D,B)&255}return C}var v=k(2);var t=k(3);var n=k(9);var u=k(11);var s=k(13);var r=k(14);function x(B){return(w[B>>>24]<<24|w[(B>>>16)&255]<<16|w[(B>>>8)&255]<<8|w[B&255])}function p(B){return B>>>24|B<<8}function l(B){return B>>>24|(B&16711680)>>>8|(B&65280)<<8|(B&255)<<24}var o=((new Uint8Array((new Uint32Array([1])).buffer))[0]==1);function q(G){var C=new Uint8Array(G);var E=C.length/4;var H=E+6;var B=new Uint32Array(m*(H+1));for(var F=0;F<E;F++){B[F]=(C[F*4]<<24|C[F*4+1]<<16|C[F*4+2]<<8|C[F*4+3])}for(var F=E;F<m*(H+1);F++){var D=B[F-1];if(F%E==0){D=x(p(D))^j[F/E]}else{if(E>6&&F%E==4){D=x(D)}}B[F]=B[F-E]^D}if(o){for(var F=0;F<B.length;F++){B[F]=l(B[F])}}return B}function h(B,J){var G=(J.length/m-1)*4;var N,L,I,H;var F,E,D,C;var Q,P,M,K;N=(B[0]^J[0])>>>0;L=(B[1]^J[1])>>>0;I=(B[2]^J[2])>>>0;H=(B[3]^J[3])>>>0;for(var O=4;O<G;O+=4){F=N;E=L;D=I;C=H;Q=w[F&255]>>>0;P=w[(E>>>8)&255]>>>0;M=w[(D>>>16)&255]>>>0;K=w[C>>>24]>>>0;N=(((v[Q]^t[P]^M^K)|(Q^v[P]^t[M]^K)<<8|(Q^P^v[M]^t[K])<<16|(t[Q]^P^M^v[K])<<24)^J[O])>>>0;Q=w[E&255]>>>0;P=w[(D>>>8)&255]>>>0;M=w[(C>>>16)&255]>>>0;K=w[F>>>24]>>>0;L=(((v[Q]^t[P]^M^K)|(Q^v[P]^t[M]^K)<<8|(Q^P^v[M]^t[K])<<16|(t[Q]^P^M^v[K])<<24)^J[O+1])>>>0;Q=w[D&255]>>>0;P=w[(C>>>8)&255]>>>0;M=w[(F>>>16)&255]>>>0;K=w[E>>>24]>>>0;I=(((v[Q]^t[P]^M^K)|(Q^v[P]^t[M]^K)<<8|(Q^P^v[M]^t[K])<<16|(t[Q]^P^M^v[K])<<24)^J[O+2])>>>0;Q=w[C&255]>>>0;P=w[(F>>>8)&255]>>>0;M=w[(E>>>16)&255]>>>0;K=w[D>>>24]>>>0;H=(((v[Q]^t[P]^M^K)|(Q^v[P]^t[M]^K)<<8|(Q^P^v[M]^t[K])<<16|(t[Q]^P^M^v[K])<<24)^J[O+3])>>>0}B[0]=J[G]^(w[N&255]|w[(L>>>8)&255]<<8|w[(I>>>16)&255]<<16|w[H>>>24]<<24);B[1]=J[G+1]^(w[L&255]|w[(I>>>8)&255]<<8|w[(H>>>16)&255]<<16|w[N>>>24]<<24);B[2]=J[G+2]^(w[I&255]|w[(H>>>8)&255]<<8|w[(N>>>16)&255]<<16|w[L>>>24]<<24);B[3]=J[G+3]^(w[H&255]|w[(N>>>8)&255]<<8|w[(L>>>16)&255]<<16|w[I>>>24]<<24)}function i(B,J){var G=(J.length/m-1)*4;var L,K,I,H;var F,E,D,C;L=(B[0]^J[G])>>>0;K=(B[1]^J[G+1])>>>0;I=(B[2]^J[G+2])>>>0;H=(B[3]^J[G+3])>>>0;for(var M=G-4;M>0;M-=4){F=L;E=K;D=I;C=H;L=((g[F&255]|g[(C>>>8)&255]<<8|g[(D>>>16)&255]<<16|g[E>>>24]<<24)^J[M])>>>0;K=((g[E&255]|g[(F>>>8)&255]<<8|g[(C>>>16)&255]<<16|g[D>>>24]<<24)^J[M+1])>>>0;I=((g[D&255]|g[(E>>>8)&255]<<8|g[(F>>>16)&255]<<16|g[C>>>24]<<24)^J[M+2])>>>0;H=((g[C&255]|g[(D>>>8)&255]<<8|g[(E>>>16)&255]<<16|g[F>>>24]<<24)^J[M+3])>>>0;F=L&255>>>0;E=((L>>>8)&255)>>>0;D=((L>>>16)&255)>>>0;C=L>>>24;L=((r[F]^u[E]^s[D]^n[C])|(n[F]^r[E]^u[D]^s[C])<<8|(s[F]^n[E]^r[D]^u[C])<<16|(u[F]^s[E]^n[D]^r[C])<<24)>>>0;F=(K&255)>>>0;E=((K>>>8)&255)>>>0;D=((K>>>16)&255)>>>0;C=K>>>24;K=((r[F]^u[E]^s[D]^n[C])|(n[F]^r[E]^u[D]^s[C])<<8|(s[F]^n[E]^r[D]^u[C])<<16|(u[F]^s[E]^n[D]^r[C])<<24)>>>0;F=(I&255)>>>0;E=((I>>>8)&255)>>>0;D=((I>>>16)&255)>>>0;C=I>>>24;I=((r[F]^u[E]^s[D]^n[C])|(n[F]^r[E]^u[D]^s[C])<<8|(s[F]^n[E]^r[D]^u[C])<<16|(u[F]^s[E]^n[D]^r[C])<<24)>>>0;F=(H&255)>>>0;E=((H>>>8)&255)>>>0;D=((H>>>16)&255)>>>0;C=H>>>24;H=((r[F]^u[E]^s[D]^n[C])|(n[F]^r[E]^u[D]^s[C])<<8|(s[F]^n[E]^r[D]^u[C])<<16|(u[F]^s[E]^n[D]^r[C])<<24)>>>0}B[0]=J[0]^(g[L&255]|g[(H>>>8)&255]<<8|g[(I>>>16)&255]<<16|g[K>>>24]<<24);B[1]=J[1]^(g[K&255]|g[(L>>>8)&255]<<8|g[(H>>>16)&255]<<16|g[I>>>24]<<24);B[2]=J[2]^(g[I&255]|g[(K>>>8)&255]<<8|g[(L>>>16)&255]<<16|g[H>>>24]<<24);B[3]=J[3]^(g[H&255]|g[(I>>>8)&255]<<8|g[(K>>>16)&255]<<16|g[L>>>24]<<24)}return{block_size_bytes:y,block_size_words:z,endian_swap32:l,is_little_endian:o,key_expansion:q,cipher:h,inv_cipher:i}}function f(){var g=this;var i=new d(),j;function h(m){if(!(c.util.type(m).isArrayBuffer()&&0==m.byteLength%i.block_size_bytes)){throw new Error("invalid-input")}var q=new Uint32Array(m);var r=new Uint32Array(q.length);var o=new Uint32Array(i.block_size_words);var l=i.key_expansion(j);var p,n;for(p=0;p<q.length;p+=i.block_size_words){for(n=0;n<i.block_size_words;n++){o[n]=q[p+n]}i.cipher(o,l);r.set(o,p)}return r.buffer}function k(m){if(!(c.util.type(m).isArrayBuffer()&&0==m.byteLength%i.block_size_bytes)){throw new Error("invalid-input")}var q=new Uint32Array(m);var r=new Uint32Array(q.length);var o=new Uint32Array(i.block_size_words);var s=new Uint32Array(i.block_size_words);var l=i.key_expansion(j),p,n;for(p=0;p<q.length;p+=i.block_size_words){for(n=0;n<i.block_size_words;n++){s[n]=q[p+n]}o.set(s);i.inv_cipher(o,l);r.set(o,p)}return r.buffer}this.key=function(m){if(!c.util.type(m).isArrayBuffer()){throw new Error("invalid-key")}var l=m.byteLength;if(l>32){m=m.slice(0,32)}else{if(l>24){m=m.slice(0,24)}else{if(l>16){m=m.slice(0,16)}else{throw new Error("invalid-key-length")}}}j=new Uint32Array(m);g.encrypt=h;g.decrypt=k;delete g.key;return g};return this}var e={name:"AESECB",constructor:function(){return new f()}};if("undefined"!=typeof module&&"undefined"!=typeof module.exports){module.exports=e}else{define([],function(){return e})}})(__enigma_jscrypto__);(function(c){var d=function(){this.key_length=128/8;this.blocksize=128/8;this.kw=new Array(8*4);this.k=new Array(24*8);this.kl=new Array(8*6);this.S1=new Uint8Array([112,130,44,236,179,39,192,229,228,133,87,53,234,12,174,65,35,239,107,147,69,25,165,33,237,14,79,78,29,101,146,189,134,184,175,143,124,235,31,206,62,48,220,95,94,197,11,26,166,225,57,202,213,71,93,61,217,1,90,214,81,86,108,77,139,13,154,102,251,204,176,45,116,18,43,32,240,177,132,153,223,76,203,194,52,126,118,5,109,183,169,49,209,23,4,215,20,88,58,97,222,27,17,28,50,15,156,22,83,24,242,34,254,68,207,178,195,181,122,145,36,8,232,168,96,252,105,80,170,208,160,125,161,137,98,151,84,91,30,149,224,255,100,210,16,196,0,72,163,247,117,219,138,3,230,218,9,63,221,148,135,92,131,2,205,74,144,51,115,103,246,243,157,127,191,226,82,155,216,38,200,55,198,59,129,150,111,75,19,190,99,46,233,121,167,140,159,110,188,142,41,245,249,182,47,253,180,89,120,152,6,106,231,70,113,186,212,37,171,66,136,162,141,250,114,7,185,85,248,238,172,10,54,73,42,104,60,56,241,164,64,40,211,123,187,201,67,193,21,227,173,244,119,199,128,158]);this.S2=new Uint8Array([224,5,88,217,103,78,129,203,201,11,174,106,213,24,93,130,70,223,214,39,138,50,75,66,219,28,158,156,58,202,37,123,13,113,95,31,248,215,62,157,124,96,185,190,188,139,22,52,77,195,114,149,171,142,186,122,179,2,180,173,162,172,216,154,23,26,53,204,247,153,97,90,232,36,86,64,225,99,9,51,191,152,151,133,104,252,236,10,218,111,83,98,163,46,8,175,40,176,116,194,189,54,34,56,100,30,57,44,166,48,229,68,253,136,159,101,135,107,244,35,72,16,209,81,192,249,210,160,85,161,65,250,67,19,196,47,168,182,60,43,193,255,200,165,32,137,0,144,71,239,234,183,21,6,205,181,18,126,187,41,15,184,7,4,155,148,33,102,230,206,237,231,59,254,127,197,164,55,177,76,145,110,141,118,3,45,222,150,38,125,198,92,211,242,79,25,63,220,121,29,82,235,243,109,94,251,105,178,240,49,12,212,207,140,226,117,169,74,87,132,17,69,27,245,228,14,115,170,241,221,89,20,108,146,84,208,120,112,227,73,128,80,167,246,119,147,134,131,42,199,91,233,238,143,1,61]);this.S3=new Uint8Array([56,65,22,118,217,147,96,242,114,194,171,154,117,6,87,160,145,247,181,201,162,140,210,144,246,7,167,39,142,178,73,222,67,92,215,199,62,245,143,103,31,24,110,175,47,226,133,13,83,240,156,101,234,163,174,158,236,128,45,107,168,43,54,166,197,134,77,51,253,102,88,150,58,9,149,16,120,216,66,204,239,38,229,97,26,63,59,130,182,219,212,152,232,139,2,235,10,44,29,176,111,141,136,14,25,135,78,11,169,12,121,17,127,34,231,89,225,218,61,200,18,4,116,84,48,126,180,40,85,104,80,190,208,196,49,203,42,173,15,202,112,255,50,105,8,98,0,36,209,251,186,237,69,129,115,109,132,159,238,74,195,46,193,1,230,37,72,153,185,179,123,249,206,191,223,113,41,205,108,19,100,155,99,157,192,75,183,165,137,95,177,23,244,188,211,70,207,55,94,71,148,250,252,91,151,254,90,172,60,76,3,53,243,35,184,93,106,146,213,33,68,81,198,125,57,131,220,170,124,119,86,5,27,164,21,52,30,28,248,82,32,20,233,189,221,228,161,224,138,241,214,122,187,227,64,79]);this.S4=new Uint8Array([112,44,179,192,228,87,234,174,35,107,69,165,237,79,29,146,134,175,124,31,62,220,94,11,166,57,213,93,217,90,81,108,139,154,251,176,116,43,240,132,223,203,52,118,109,169,209,4,20,58,222,17,50,156,83,242,254,207,195,122,36,232,96,105,170,160,161,98,84,30,224,100,16,0,163,117,138,230,9,221,135,131,205,144,115,246,157,191,82,216,200,198,129,111,19,99,233,167,159,188,41,249,47,180,120,6,231,113,212,171,136,141,114,185,248,172,54,42,60,241,64,211,187,67,21,173,119,128,130,236,39,229,133,53,12,65,239,147,25,33,14,78,101,189,184,143,235,206,48,95,197,26,225,202,71,61,1,214,86,77,13,102,204,45,18,32,177,153,76,194,126,5,183,49,23,215,88,97,27,28,15,22,24,34,68,178,181,145,8,168,252,80,208,125,137,151,91,149,255,210,196,72,247,219,3,218,63,148,92,2,74,51,103,243,127,226,155,38,55,59,150,75,190,46,121,140,110,142,245,182,253,89,152,106,70,186,37,66,162,250,7,85,238,10,73,104,56,164,40,123,201,193,227,244,199,158]);this.SIGMA1=[160,158,102,127,59,204,144,139];this.SIGMA2=[182,122,232,88,76,170,115,178];this.SIGMA3=[198,239,55,47,233,79,130,190];this.SIGMA4=[84,255,83,165,241,211,111,28];this.SIGMA5=[16,229,39,250,222,104,45,29];this.SIGMA6=[176,86,136,194,179,230,193,253];return this};d.prototype._xor_block=function(g,m,h){var k=new Array(h);for(var j=0;j<h;j++){k[j]=g[j]^m[j]}return k};d.prototype._feistel=function(m,l,g,j){var i=new Array(8);var h=this._xor_block(g,j,8);i[0]=this.S1[h[0]];i[1]=this.S2[h[1]];i[2]=this.S3[h[2]];i[3]=this.S4[h[3]];i[4]=this.S2[h[4]];i[5]=this.S3[h[5]];i[6]=this.S4[h[6]];i[7]=this.S1[h[7]];m[0+l]^=i[0]^i[2]^i[3]^i[5]^i[6]^i[7];m[1+l]^=i[0]^i[1]^i[3]^i[4]^i[6]^i[7];m[2+l]^=i[0]^i[1]^i[2]^i[4]^i[5]^i[7];m[3+l]^=i[1]^i[2]^i[3]^i[4]^i[5]^i[6];m[4+l]^=i[0]^i[1]^i[5]^i[6]^i[7];m[5+l]^=i[1]^i[2]^i[4]^i[6]^i[7];m[6+l]^=i[2]^i[3]^i[4]^i[5]^i[7];m[7+l]^=i[0]^i[3]^i[4]^i[5]^i[6]};d.prototype._rot_shift=function(p,n,m,l,g){if(l==0){this._move(p,0,m,0,g);return}var k=Math.floor(l/8)+1;var j=k*8-l;k=k%g;for(var h=0;h<g;h++){p[h+n]=((m[(h+k)%g]>>j)&255)|((m[(h+k-1)%g]<<(8-j))&255)}};d.prototype.setup=function(j){var m=new Array();var g=new Array();var l=new Array();this.key_length=j.byteLength;if(16==j.byteLength){m=new Uint8Array(j.slice(0,16));g=new Array(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}else{if(24==j.byteLength){m=new Uint8Array(j.slice(0,16));for(var h=0;h<8;h++){g[h]=j[h+16];g[h+8]=j[h+16]^255}}else{if(32==j.byteLength){m=new Uint8Array(j.slice(0,16));g=new Uint8Array(j.slice(16,32))}else{throw"wrong key length: key must be 128, 192 or 256 bit"}}}l=this._xor_block(m,g,16);this._feistel(l,8,l,this.SIGMA1);this._feistel(l,0,l.slice(8,16),this.SIGMA2);l=this._xor_block(m,l,16);this._feistel(l,8,l.slice(0,8),this.SIGMA3);this._feistel(l,0,l.slice(8,16),this.SIGMA4);if(j.length==16){this._rot_shift(this.kw,0,m,0,16);this._rot_shift(this.k,0,l,0,16);this._rot_shift(this.k,8*2,m,15,16);this._rot_shift(this.k,8*4,l,15,16);this._rot_shift(this.kl,0,l,30,16);this._rot_shift(this.k,8*6,m,45,16);this._rot_shift(this.k,8*8,l,45,16);this._rot_shift(this.k,8*9,m,60,16);this._move(this.k,8*9,this.k.slice(8*10,8*10+8),0,8);this._rot_shift(this.k,8*10,l,60,16);this._rot_shift(this.kl,8*2,m,77,16);this._rot_shift(this.k,8*12,m,94,16);this._rot_shift(this.k,8*14,l,94,16);this._rot_shift(this.k,8*16,m,111,16);this._rot_shift(this.kw,8*2,l,111,16)}else{var k=this._xor_block(g,l,16);this._feistel(k,8,k.slice(0,8),this.SIGMA5);this._feistel(k,0,k.slice(8,16),this.SIGMA6);this._rot_shift(this.kw,0,m,0,16);this._rot_shift(this.k,0,k,0,16);this._rot_shift(this.k,8*2,g,15,16);this._rot_shift(this.k,8*4,l,15,16);this._rot_shift(this.kl,0,g,30,16);this._rot_shift(this.k,8*6,k,30,16);this._rot_shift(this.k,8*8,m,45,16);this._rot_shift(this.k,8*10,l,45,16);this._rot_shift(this.kl,8*2,m,60,16);this._rot_shift(this.k,8*12,g,60,16);this._rot_shift(this.k,8*14,k,60,16);this._rot_shift(this.k,8*16,m,77,16);this._rot_shift(this.kl,8*4,l,77,16);this._rot_shift(this.k,8*18,g,94,16);this._rot_shift(this.k,8*20,l,94,16);this._rot_shift(this.k,8*22,m,111,16);this._rot_shift(this.kw,8*2,k,111,16)}};d.prototype._flayer=function(i,g,h){this._move(i,0,g,0,8);i[4+0]^=(((g[0]&h[0])<<1)&255)^(g[1]&h[1])>>7;i[4+1]^=(((g[1]&h[1])<<1)&255)^(g[2]&h[2])>>7;i[4+2]^=(((g[2]&h[2])<<1)&255)^(g[3]&h[3])>>7;i[4+3]^=(((g[3]&h[3])<<1)&255)^(g[0]&h[0])>>7;i[0]^=i[4+0]|h[4+0];i[1]^=i[4+1]|h[4+1];i[2]^=i[4+2]|h[4+2];i[3]^=i[4+3]|h[4+3]};d.prototype._flayer_1=function(i,g,h){this._move(i,0,g,0,8);i[0]^=g[4+0]|h[4+0];i[1]^=g[4+1]|h[4+1];i[2]^=g[4+2]|h[4+2];i[3]^=g[4+3]|h[4+3];i[4+0]^=(((i[0]&h[0])<<1)&255)^(i[1]&h[1])>>7;i[4+1]^=(((i[1]&h[1])<<1)&255)^(i[2]&h[2])>>7;i[4+2]^=(((i[2]&h[2])<<1)&255)^(i[3]&h[3])>>7;i[4+3]^=(((i[3]&h[3])<<1)&255)^(i[0]&h[0])>>7};d.prototype.encrypt=function(k){var g=new Uint8Array(k.slice(0,8));var j=new Uint8Array(k.slice(8,16));g=this._xor_block(g,this.kw.slice(0,8),8);j=this._xor_block(j,this.kw.slice(8,16),8);if(this.key_length==16){for(var h=0;h<18;h+=2){this._feistel(j,0,g,this.k.slice(8*h,(8*h)+8));this._feistel(g,0,j,this.k.slice(8*(h+1),8*(h+1)+8));if(h==4){this._flayer(g,g,this.kl,0);this._flayer_1(j,j,this.kl.slice(8,16),0)}else{if(h==10){this._flayer(g,g,this.kl.slice(16,24),0);this._flayer_1(j,j,this.kl.slice(24,32),0)}}}}else{for(var h=0;h<24;h+=2){this._feistel(j,0,g,this.k.slice(8*h,(8*h)+8));this._feistel(g,0,j,this.k.slice(8*(h+1),8*(h+1)+8));if(h==4){this._flayer(g,g,this.kl,0);this._flayer_1(j,j,this.kl.slice(8,16),0)}else{if(h==10){this._flayer(g,g,this.kl.slice(16,24),0);this._flayer_1(j,j,this.kl.slice(24,32),0)}else{if(h==16){this._flayer(g,g,this.kl.slice(32,40),0);this._flayer_1(j,j,this.kl.slice(40,48),0)}}}}}j=this._xor_block(j,this.kw.slice(16,24),8);g=this._xor_block(g,this.kw.slice(24,32),8);return j.concat(g)};d.prototype.decrypt=function(k){var j=new Uint8Array(k.slice(0,8));var g=new Uint8Array(k.slice(8,16));j=this._xor_block(j,this.kw.slice(8*2,8*2+8),8);g=this._xor_block(g,this.kw.slice(8*3,8*3+8),8);if(this.key_length==16){for(var h=16;h>=0;h-=2){this._feistel(g,0,j,this.k.slice(8*(h+1),8*(h+1)+8));this._feistel(j,0,g,this.k.slice(8*h,(8*h)+8));if(h==12){this._flayer(j,j,this.kl.slice(8*3,8*3+8),0);this._flayer_1(g,g,this.kl.slice(8*2,8*2+8),0)}else{if(h==6){this._flayer(j,j,this.kl.slice(8*1,8*1+8),0);this._flayer_1(g,g,this.kl.slice(8*0,8*0+8),0)}}}}else{for(var h=22;h>=0;h-=2){this._feistel(g,0,j,this.k.slice(8*(h+1),8*(h+1)+8));this._feistel(j,0,g,this.k.slice(8*h,(8*h)+8));if(h==18){this._flayer(j,j,this.kl.slice(8*5,8*5+8),0);this._flayer_1(g,g,this.kl.slice(8*4,8*4+8),0)}else{if(h==12){this._flayer(j,j,this.kl.slice(8*3,8*3+8),0);this._flayer_1(g,g,this.kl.slice(8*2,8*2+8),0)}else{if(h==6){this._flayer(j,j,this.kl.slice(8*1,8*1+8),0);this._flayer_1(g,g,this.kl.slice(8*0,8*0+8),0)}}}}}g=this._xor_block(g,this.kw.slice(8*0,8*0+8),8);j=this._xor_block(j,this.kw.slice(8*1,8*1+8),8);return g.concat(j)};d.prototype._move=function(m,h,l,k,g){for(var j=0;j<g;j++){m[j+h]=l[j+k]}};function f(){var h=this;var g=new d(),j,k;this.key=function(m){if(!c.util.type(m).isArrayBuffer()){throw new Error("invalid-key-input")}j=new Uint8Array(m.slice(0,16));if(m.byteLength>=32){k=new Uint8Array(m.slice(0,32))}else{if(m.byteLength>=24){k=new Uint8Array(m.slice(0,24))}else{if(m.byteLength>=16){k=new Uint8Array(m.slice(0,16))}else{throw new Error("key-too-short")}}}g.setup(k.buffer);h.encrypt=l;h.decrypt=i;delete h.key;return h};function l(o){if(!c.util.type(o).isArrayBuffer()){throw new Error("invalid-buffer-input")}if(o.byteLength%16!=0){throw new Error("invalid-plaintext")}var q,n=new Uint8Array(o.byteLength),s=j,r;var p,m;for(p=0;p<o.byteLength;p+=16){q=new Uint8Array(o.slice(p,p+16));r=g.encrypt(g._xor_block(s,q,16));for(m=0;m<16;m++){n[p+m]=r[m]}s=r}return n.buffer}function i(o){if(!c.util.type(o).isArrayBuffer()){throw new Error("invalid-buffer-input")}if(o.byteLength%16!=0){throw new Error("invalid-ciphertext")}var n=new Uint8Array(o.byteLength),q,r=j,p,m;for(p=0;p<o.byteLength;p+=16){q=o.slice(p,p+16);pBlock=g._xor_block(g.decrypt(q),r,16);for(m=0;m<16;m++){n[p+m]=pBlock[m]}r=q}return n.buffer}return this}var e={name:"CAMELLIA",constructor:function(){return new f()}};if("undefined"!=typeof module&&"undefined"!=typeof module.exports){module.exports=e}else{define([],function(){return e})}})(__enigma_jscrypto__);(function(c){var d=["aes","salsa20","camellia"];function g(j){for(var h=1;h<arguments.length;h++){j(arguments[h])}c.cipher.symmetric=j(false)}if("undefined"!=typeof module&&"undefined"!=typeof module.exports){var f=[require("./symmetric.js")];for(var e in d){f.push(require("./"+d[e]+".js"))}g.apply(this,f)}else{var f=["cipher/symmetric/symmetric"];for(var e in d){f.push("cipher/symmetric/"+d[e])}define(f,g)}})(__enigma_jscrypto__);(function(c){function d(o){var p=this;if(!o||o<10){o=10}function k(s,r){return(((s)<<(r))|((s)>>>(32-(r))))}function h(u,s){var t;var r=new Uint32Array(16);for(t=0;t<16;t++){r[t]=u[t]}for(t=0;t<o;t++){r[4]^=k(r[0]+r[12],7);r[8]^=k(r[4]+r[0],9);r[12]^=k(r[8]+r[4],13);r[0]^=k(r[12]+r[8],18);r[9]^=k(r[5]+r[1],7);r[13]^=k(r[9]+r[5],9);r[1]^=k(r[13]+r[9],13);r[5]^=k(r[1]+r[13],18);r[14]^=k(r[10]+r[6],7);r[2]^=k(r[14]+r[10],9);r[6]^=k(r[2]+r[14],13);r[10]^=k(r[6]+r[2],18);r[3]^=k(r[15]+r[11],7);r[7]^=k(r[3]+r[15],9);r[11]^=k(r[7]+r[3],13);r[15]^=k(r[11]+r[7],18);r[1]^=k(r[0]+r[3],7);r[2]^=k(r[1]+r[0],9);r[3]^=k(r[2]+r[1],13);r[0]^=k(r[3]+r[2],18);r[6]^=k(r[5]+r[4],7);r[7]^=k(r[6]+r[5],9);r[4]^=k(r[7]+r[6],13);r[5]^=k(r[4]+r[7],18);r[11]^=k(r[10]+r[9],7);r[8]^=k(r[11]+r[10],9);r[9]^=k(r[8]+r[11],13);r[10]^=k(r[9]+r[8],18);r[12]^=k(r[15]+r[14],7);r[13]^=k(r[12]+r[15],9);r[14]^=k(r[13]+r[12],13);r[15]^=k(r[14]+r[13],18)}for(t=0;t<16;t++){s[t]=r[t]+u[t]}}function i(w,u,t,s){var v=new Uint32Array([1634760805,857760878,2036477234,1797285236]);var r=new Uint32Array(16);r[0]=v[0];r[1]=w[0];r[2]=w[1];r[3]=w[2];r[4]=w[3];r[5]=v[1];r[6]=u[0];r[7]=u[1];r[8]=t[0];r[9]=t[1];r[10]=v[2];r[11]=w[4];r[12]=w[5];r[13]=w[6];r[14]=w[7];r[15]=v[3];return h(r,s)}function m(t,v,u,s){var w=new Uint32Array([1634760805,824206446,2036477238,1797285236]);var r=new Uint32Array(16);r[0]=w[0];r[1]=t[0];r[2]=t[1];r[3]=t[2];r[4]=t[3];r[5]=w[1];r[6]=v[0];r[7]=v[1];r[8]=u[0];r[9]=u[1];r[10]=w[2];r[11]=t[0];r[12]=t[1];r[13]=t[2];r[14]=t[3];r[15]=w[3];return h(r,s)}var f=new Uint32Array(2);var l;function n(){f[0]=0;f[1]=0}function q(){f[0]+=1;if(0==f[0]){f[1]+=1}}function j(r,u){var t=new Uint32Array(r);if(32==u.byteLength){var s=new Uint32Array(u);l=(function(w,v){return function(x){i(v,w,f,x);q()}})(t,s)}else{if(16==u.byteLength){var s=new Uint32Array(u);l=(function(w,v){return function(x){m(v,w,f,x);q()}})(t,s)}else{throw new Error("invalid-key-length")}}}function g(w){if(!c.util.type(w).isArrayBuffer()){throw new Error("invalid-input")}var u=w.byteLength,v=Math.ceil(u/64),y=new Uint32Array(16);var x=new Uint8Array(w);var r=0,t,s;n();for(t=0;t<v;t++){l(y);for(s=0;s<64;s++){x[r+s]^=y[s]}r+=64}return x.buffer.slice(0,u)}this.key=function(s){if(!c.util.type(s).isArrayBuffer()){throw new Error("invalid-key")}var t=s.byteLength;if(t<24){throw new Error("invalid-key")}var r=s.slice(0,8);if(t<40){j(r,s.slice(8,24))}else{j(r,s.slice(8,40))}p.encrypt=g;p.decrypt=g;delete p.key;return p};return this}var e={name:"Salsa20/20",constructor:function(){return new d(20)}};if("undefined"!=typeof module&&"undefined"!=typeof module.exports){module.exports=e}else{define([],function(){return e})}})(__enigma_jscrypto__);(function(i){var l={};function e(){var u=this;function t(x,z){var B=x.byteLength,A=z-(B%z),C=B+A,w=new Uint8Array(x),v=new Uint8Array(C);for(var y=0;y<C;y++){if(y<B){v[y]=w[y]}else{v[y]=A}}return v.buffer}function s(w){var v=new Uint8Array(w);var x=v[v.length-1];if(v.length<x){return null}return w.slice(0,w.byteLength-x)}function p(v){return v}function m(v){return v}var o=null;function q(y,w,z){var B=64;var A=new i.hash("BLAKE2s").pbkdf2(y,w,4,z*B);var v=new Array(z);for(var x=0;x<z;x++){v[x]=new i.hash("WHIRLPOOL").hash(A.slice(x*B,(x+1)*B)).buffer}return v}var r=function(x){if(!i.util.type(x).isArrayBuffer()){throw new Error("invalid-parameter")}var w=new i.util.srand().bytes(10);var y=q(o,w,5);var z=new i.hash("BLAKE2s",{length:6}).mac(x,y[0]).buffer;x=i.util.buffer.concat([z,x]);var v=x;v=p(v);v=t(v,16);v=c(y[1],v);v=h(y[2],v);v=i.util.buffer.reverse(v);return i.util.buffer.concat([w,v])};var n=function(x){if(!(i.util.type(x).isArrayBuffer()&&x.byteLength>=26)){throw new Error("invalid-parameter")}var z=x.slice(0,10);x=x.slice(10);var A=q(o,z,5);var w=x;w=i.util.buffer.reverse(w);w=d(A[2],w);w=k(A[1],w);w=s(w,16);if(!i.util.type(w).isArrayBuffer()){return null}w=m(w);if(!i.util.type(w).isArrayBuffer()){return null}var y=w.slice(0,6);w=w.slice(6);var v=new i.hash("BLAKE2s",{length:6}).mac(w,A[0]).buffer;if(i.util.buffer.equal(y,v)){return w}return null};this.key=function(v){if(!i.util.type(v).isArrayBuffer()){throw new Error("invalid-key")}o=v;delete u.key;u.encrypt=r;u.decrypt=n;return u};return this}var h=function(m,n){try{return l.AESECB().key(m).encrypt(n)}catch(o){i.util.log.error(o);return new Error("unable-to-encrypt",o)}};var d=function(m,n){try{return l.AESECB().key(m).decrypt(n)}catch(o){i.util.log.error(o);return new Error("unable-to-decrypt",o)}};var c=function(m,n){try{return l["Salsa20/20"]().key(m).encrypt(n)}catch(o){i.util.log.error(o);return new Error("unable-to-encrypt")}};var k=function(m,n){try{return l["Salsa20/20"]().key(m).decrypt(n)}catch(o){i.util.log.error(o);return new Error("unable-to-decrypt",o)}};var j=function(m,o){var n=l.CAMELLIA;try{return n().key(m).encrypt(o)}catch(p){i.util.log.error(p);return new Error("unable-to-encrypt",p)}};var f=function(m,o){var n=l.CAMELLIA;try{return n().key(m).decrypt(o)}catch(p){i.util.log.error(p);return new Error("unable-to-decrypt",p)}};function g(m){if(m){i.util.log.notice("Load symmetric cipher component: ["+m.name+"]");l[m.name]=m.constructor;return}if("undefined"!=typeof l.AESECB&&"undefined"!=typeof l.CAMELLIA&&"undefined"!=typeof l["Salsa20/20"]){i.util.log.notice("Symmetric cascading cipher [NCSC512] ready.");return function(){return new e()}}return null}if("undefined"!=typeof module&&"undefined"!=typeof module.exports){module.exports=g}else{define([],function(){return g})}})(__enigma_jscrypto__);(function(c){function e(k,h){if(typeof k==="undefined"){k=32}this.isFinished=false;this.digestLength=32;this.blockLength=64;this.iv=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];if(k<=0){k=this.digestLength}else{if(k>32){throw"digestLength is too large"}}var f=0;if(typeof h=="string"){h=this.stringToUtf8Array(h);f=h.length}else{if(typeof h=="object"){f=h.length}}if(f>32){throw"key too long"}var j=[k&255,f,1,1];this.h=this.iv.slice(0);this.h[0]^=this.load32(j,0);this.x=new Array(64);this.t0=0;this.t1=0;this.f0=0;this.f1=0;this.nx=0;this.digestLength=k;if(f>0){for(var g=0;g<f;g++){this.x[g]=h[g]}for(var g=f;g<64;g++){this.x[g]=0}this.nx=64}}e.prototype.load32=function(f,g){return((f[g]&255)|((f[g+1]&255)<<8)|((f[g+2]&255)<<16)|((f[g+3]&255)<<24))>>>0};e.prototype.store32=function(g,h,f){g[h]=(f>>>0)&255;g[h+1]=(f>>>8)&255;g[h+2]=(f>>>16)&255;g[h+3]=(f>>>24)&255};e.prototype.processBlock=function(q){this.t0+=q;if(this.t0!=this.t0>>>0){this.t0=0;this.t1++}var p=this.h[0],o=this.h[1],n=this.h[2],m=this.h[3],k=this.h[4],i=this.h[5],g=this.h[6],L=this.h[7],J=this.iv[0],H=this.iv[1],E=this.iv[2],B=this.iv[3],y=this.iv[4]^this.t0,v=this.iv[5]^this.t1,t=this.iv[6]^this.f0,r=this.iv[7]^this.f1;var l=this.load32(this.x,0),j=this.load32(this.x,4),h=this.load32(this.x,8),f=this.load32(this.x,12),K=this.load32(this.x,16),I=this.load32(this.x,20),G=this.load32(this.x,24),D=this.load32(this.x,28),A=this.load32(this.x,32),x=this.load32(this.x,36),F=this.load32(this.x,40),C=this.load32(this.x,44),z=this.load32(this.x,48),w=this.load32(this.x,52),u=this.load32(this.x,56),s=this.load32(this.x,60);p+=l;p+=k;y^=p;y=y<<(32-16)|y>>>16;J+=y;k^=J;k=k<<(32-12)|k>>>12;o+=h;o+=i;v^=o;v=v<<(32-16)|v>>>16;H+=v;i^=H;i=i<<(32-12)|i>>>12;n+=K;n+=g;t^=n;t=t<<(32-16)|t>>>16;E+=t;g^=E;g=g<<(32-12)|g>>>12;m+=G;m+=L;r^=m;r=r<<(32-16)|r>>>16;B+=r;L^=B;L=L<<(32-12)|L>>>12;n+=I;n+=g;t^=n;t=t<<(32-8)|t>>>8;E+=t;g^=E;g=g<<(32-7)|g>>>7;m+=D;m+=L;r^=m;r=r<<(32-8)|r>>>8;B+=r;L^=B;L=L<<(32-7)|L>>>7;o+=f;o+=i;v^=o;v=v<<(32-8)|v>>>8;H+=v;i^=H;i=i<<(32-7)|i>>>7;p+=j;p+=k;y^=p;y=y<<(32-8)|y>>>8;J+=y;k^=J;k=k<<(32-7)|k>>>7;p+=A;p+=i;r^=p;r=r<<(32-16)|r>>>16;E+=r;i^=E;i=i<<(32-12)|i>>>12;o+=F;o+=g;y^=o;y=y<<(32-16)|y>>>16;B+=y;g^=B;g=g<<(32-12)|g>>>12;n+=z;n+=L;v^=n;v=v<<(32-16)|v>>>16;J+=v;L^=J;L=L<<(32-12)|L>>>12;m+=u;m+=k;t^=m;t=t<<(32-16)|t>>>16;H+=t;k^=H;k=k<<(32-12)|k>>>12;n+=w;n+=L;v^=n;v=v<<(32-8)|v>>>8;J+=v;L^=J;L=L<<(32-7)|L>>>7;m+=s;m+=k;t^=m;t=t<<(32-8)|t>>>8;H+=t;k^=H;k=k<<(32-7)|k>>>7;o+=C;o+=g;y^=o;y=y<<(32-8)|y>>>8;B+=y;g^=B;g=g<<(32-7)|g>>>7;p+=x;p+=i;r^=p;r=r<<(32-8)|r>>>8;E+=r;i^=E;i=i<<(32-7)|i>>>7;p+=u;p+=k;y^=p;y=y<<(32-16)|y>>>16;J+=y;k^=J;k=k<<(32-12)|k>>>12;o+=K;o+=i;v^=o;v=v<<(32-16)|v>>>16;H+=v;i^=H;i=i<<(32-12)|i>>>12;n+=x;n+=g;t^=n;t=t<<(32-16)|t>>>16;E+=t;g^=E;g=g<<(32-12)|g>>>12;m+=w;m+=L;r^=m;r=r<<(32-16)|r>>>16;B+=r;L^=B;L=L<<(32-12)|L>>>12;n+=s;n+=g;t^=n;t=t<<(32-8)|t>>>8;E+=t;g^=E;g=g<<(32-7)|g>>>7;m+=G;m+=L;r^=m;r=r<<(32-8)|r>>>8;B+=r;L^=B;L=L<<(32-7)|L>>>7;o+=A;o+=i;v^=o;v=v<<(32-8)|v>>>8;H+=v;i^=H;i=i<<(32-7)|i>>>7;p+=F;p+=k;y^=p;y=y<<(32-8)|y>>>8;J+=y;k^=J;k=k<<(32-7)|k>>>7;p+=j;p+=i;r^=p;r=r<<(32-16)|r>>>16;E+=r;i^=E;i=i<<(32-12)|i>>>12;o+=l;o+=g;y^=o;y=y<<(32-16)|y>>>16;B+=y;g^=B;g=g<<(32-12)|g>>>12;n+=C;n+=L;v^=n;v=v<<(32-16)|v>>>16;J+=v;L^=J;L=L<<(32-12)|L>>>12;m+=I;m+=k;t^=m;t=t<<(32-16)|t>>>16;H+=t;k^=H;k=k<<(32-12)|k>>>12;n+=D;n+=L;v^=n;v=v<<(32-8)|v>>>8;J+=v;L^=J;L=L<<(32-7)|L>>>7;m+=f;m+=k;t^=m;t=t<<(32-8)|t>>>8;H+=t;k^=H;k=k<<(32-7)|k>>>7;o+=h;o+=g;y^=o;y=y<<(32-8)|y>>>8;B+=y;g^=B;g=g<<(32-7)|g>>>7;p+=z;p+=i;r^=p;r=r<<(32-8)|r>>>8;E+=r;i^=E;i=i<<(32-7)|i>>>7;p+=C;p+=k;y^=p;y=y<<(32-16)|y>>>16;J+=y;k^=J;k=k<<(32-12)|k>>>12;o+=z;o+=i;v^=o;v=v<<(32-16)|v>>>16;H+=v;i^=H;i=i<<(32-12)|i>>>12;n+=I;n+=g;t^=n;t=t<<(32-16)|t>>>16;E+=t;g^=E;g=g<<(32-12)|g>>>12;m+=s;m+=L;r^=m;r=r<<(32-16)|r>>>16;B+=r;L^=B;L=L<<(32-12)|L>>>12;n+=h;n+=g;t^=n;t=t<<(32-8)|t>>>8;E+=t;g^=E;g=g<<(32-7)|g>>>7;m+=w;m+=L;r^=m;r=r<<(32-8)|r>>>8;B+=r;L^=B;L=L<<(32-7)|L>>>7;o+=l;o+=i;v^=o;v=v<<(32-8)|v>>>8;H+=v;i^=H;i=i<<(32-7)|i>>>7;p+=A;p+=k;y^=p;y=y<<(32-8)|y>>>8;J+=y;k^=J;k=k<<(32-7)|k>>>7;p+=F;p+=i;r^=p;r=r<<(32-16)|r>>>16;E+=r;i^=E;i=i<<(32-12)|i>>>12;o+=f;o+=g;y^=o;y=y<<(32-16)|y>>>16;B+=y;g^=B;g=g<<(32-12)|g>>>12;n+=D;n+=L;v^=n;v=v<<(32-16)|v>>>16;J+=v;L^=J;L=L<<(32-12)|L>>>12;m+=x;m+=k;t^=m;t=t<<(32-16)|t>>>16;H+=t;k^=H;k=k<<(32-12)|k>>>12;n+=j;n+=L;v^=n;v=v<<(32-8)|v>>>8;J+=v;L^=J;L=L<<(32-7)|L>>>7;m+=K;m+=k;t^=m;t=t<<(32-8)|t>>>8;H+=t;k^=H;k=k<<(32-7)|k>>>7;o+=G;o+=g;y^=o;y=y<<(32-8)|y>>>8;B+=y;g^=B;g=g<<(32-7)|g>>>7;p+=u;p+=i;r^=p;r=r<<(32-8)|r>>>8;E+=r;i^=E;i=i<<(32-7)|i>>>7;p+=D;p+=k;y^=p;y=y<<(32-16)|y>>>16;J+=y;k^=J;k=k<<(32-12)|k>>>12;o+=f;o+=i;v^=o;v=v<<(32-16)|v>>>16;H+=v;i^=H;i=i<<(32-12)|i>>>12;n+=w;n+=g;t^=n;t=t<<(32-16)|t>>>16;E+=t;g^=E;g=g<<(32-12)|g>>>12;m+=C;m+=L;r^=m;r=r<<(32-16)|r>>>16;B+=r;L^=B;L=L<<(32-12)|L>>>12;n+=z;n+=g;t^=n;t=t<<(32-8)|t>>>8;E+=t;g^=E;g=g<<(32-7)|g>>>7;m+=u;m+=L;r^=m;r=r<<(32-8)|r>>>8;B+=r;L^=B;L=L<<(32-7)|L>>>7;o+=j;o+=i;v^=o;v=v<<(32-8)|v>>>8;H+=v;i^=H;i=i<<(32-7)|i>>>7;p+=x;p+=k;y^=p;y=y<<(32-8)|y>>>8;J+=y;k^=J;k=k<<(32-7)|k>>>7;p+=h;p+=i;r^=p;r=r<<(32-16)|r>>>16;E+=r;i^=E;i=i<<(32-12)|i>>>12;o+=I;o+=g;y^=o;y=y<<(32-16)|y>>>16;B+=y;g^=B;g=g<<(32-12)|g>>>12;n+=K;n+=L;v^=n;v=v<<(32-16)|v>>>16;J+=v;L^=J;L=L<<(32-12)|L>>>12;m+=s;m+=k;t^=m;t=t<<(32-16)|t>>>16;H+=t;k^=H;k=k<<(32-12)|k>>>12;n+=l;n+=L;v^=n;v=v<<(32-8)|v>>>8;J+=v;L^=J;L=L<<(32-7)|L>>>7;m+=A;m+=k;t^=m;t=t<<(32-8)|t>>>8;H+=t;k^=H;k=k<<(32-7)|k>>>7;o+=F;o+=g;y^=o;y=y<<(32-8)|y>>>8;B+=y;g^=B;g=g<<(32-7)|g>>>7;p+=G;p+=i;r^=p;r=r<<(32-8)|r>>>8;E+=r;i^=E;i=i<<(32-7)|i>>>7;p+=x;p+=k;y^=p;y=y<<(32-16)|y>>>16;J+=y;k^=J;k=k<<(32-12)|k>>>12;o+=I;o+=i;v^=o;v=v<<(32-16)|v>>>16;H+=v;i^=H;i=i<<(32-12)|i>>>12;n+=h;n+=g;t^=n;t=t<<(32-16)|t>>>16;E+=t;g^=E;g=g<<(32-12)|g>>>12;m+=F;m+=L;r^=m;r=r<<(32-16)|r>>>16;B+=r;L^=B;L=L<<(32-12)|L>>>12;n+=K;n+=g;t^=n;t=t<<(32-8)|t>>>8;E+=t;g^=E;g=g<<(32-7)|g>>>7;m+=s;m+=L;r^=m;r=r<<(32-8)|r>>>8;B+=r;L^=B;L=L<<(32-7)|L>>>7;o+=D;o+=i;v^=o;v=v<<(32-8)|v>>>8;H+=v;i^=H;i=i<<(32-7)|i>>>7;p+=l;p+=k;y^=p;y=y<<(32-8)|y>>>8;J+=y;k^=J;k=k<<(32-7)|k>>>7;p+=u;p+=i;r^=p;r=r<<(32-16)|r>>>16;E+=r;i^=E;i=i<<(32-12)|i>>>12;o+=C;o+=g;y^=o;y=y<<(32-16)|y>>>16;B+=y;g^=B;g=g<<(32-12)|g>>>12;n+=G;n+=L;v^=n;v=v<<(32-16)|v>>>16;J+=v;L^=J;L=L<<(32-12)|L>>>12;m+=f;m+=k;t^=m;t=t<<(32-16)|t>>>16;H+=t;k^=H;k=k<<(32-12)|k>>>12;n+=A;n+=L;v^=n;v=v<<(32-8)|v>>>8;J+=v;L^=J;L=L<<(32-7)|L>>>7;m+=w;m+=k;t^=m;t=t<<(32-8)|t>>>8;H+=t;k^=H;k=k<<(32-7)|k>>>7;o+=z;o+=g;y^=o;y=y<<(32-8)|y>>>8;B+=y;g^=B;g=g<<(32-7)|g>>>7;p+=j;p+=i;r^=p;r=r<<(32-8)|r>>>8;E+=r;i^=E;i=i<<(32-7)|i>>>7;p+=h;p+=k;y^=p;y=y<<(32-16)|y>>>16;J+=y;k^=J;k=k<<(32-12)|k>>>12;o+=G;o+=i;v^=o;v=v<<(32-16)|v>>>16;H+=v;i^=H;i=i<<(32-12)|i>>>12;n+=l;n+=g;t^=n;t=t<<(32-16)|t>>>16;E+=t;g^=E;g=g<<(32-12)|g>>>12;m+=A;m+=L;r^=m;r=r<<(32-16)|r>>>16;B+=r;L^=B;L=L<<(32-12)|L>>>12;n+=C;n+=g;t^=n;t=t<<(32-8)|t>>>8;E+=t;g^=E;g=g<<(32-7)|g>>>7;m+=f;m+=L;r^=m;r=r<<(32-8)|r>>>8;B+=r;L^=B;L=L<<(32-7)|L>>>7;o+=F;o+=i;v^=o;v=v<<(32-8)|v>>>8;H+=v;i^=H;i=i<<(32-7)|i>>>7;p+=z;p+=k;y^=p;y=y<<(32-8)|y>>>8;J+=y;k^=J;k=k<<(32-7)|k>>>7;p+=K;p+=i;r^=p;r=r<<(32-16)|r>>>16;E+=r;i^=E;i=i<<(32-12)|i>>>12;o+=D;o+=g;y^=o;y=y<<(32-16)|y>>>16;B+=y;g^=B;g=g<<(32-12)|g>>>12;n+=s;n+=L;v^=n;v=v<<(32-16)|v>>>16;J+=v;L^=J;L=L<<(32-12)|L>>>12;m+=j;m+=k;t^=m;t=t<<(32-16)|t>>>16;H+=t;k^=H;k=k<<(32-12)|k>>>12;n+=u;n+=L;v^=n;v=v<<(32-8)|v>>>8;J+=v;L^=J;L=L<<(32-7)|L>>>7;m+=x;m+=k;t^=m;t=t<<(32-8)|t>>>8;H+=t;k^=H;k=k<<(32-7)|k>>>7;o+=I;o+=g;y^=o;y=y<<(32-8)|y>>>8;B+=y;g^=B;g=g<<(32-7)|g>>>7;p+=w;p+=i;r^=p;r=r<<(32-8)|r>>>8;E+=r;i^=E;i=i<<(32-7)|i>>>7;p+=z;p+=k;y^=p;y=y<<(32-16)|y>>>16;J+=y;k^=J;k=k<<(32-12)|k>>>12;o+=j;o+=i;v^=o;v=v<<(32-16)|v>>>16;H+=v;i^=H;i=i<<(32-12)|i>>>12;n+=u;n+=g;t^=n;t=t<<(32-16)|t>>>16;E+=t;g^=E;g=g<<(32-12)|g>>>12;m+=K;m+=L;r^=m;r=r<<(32-16)|r>>>16;B+=r;L^=B;L=L<<(32-12)|L>>>12;n+=w;n+=g;t^=n;t=t<<(32-8)|t>>>8;E+=t;g^=E;g=g<<(32-7)|g>>>7;m+=F;m+=L;r^=m;r=r<<(32-8)|r>>>8;B+=r;L^=B;L=L<<(32-7)|L>>>7;o+=s;o+=i;v^=o;v=v<<(32-8)|v>>>8;H+=v;i^=H;i=i<<(32-7)|i>>>7;p+=I;p+=k;y^=p;y=y<<(32-8)|y>>>8;J+=y;k^=J;k=k<<(32-7)|k>>>7;p+=l;p+=i;r^=p;r=r<<(32-16)|r>>>16;E+=r;i^=E;i=i<<(32-12)|i>>>12;o+=G;o+=g;y^=o;y=y<<(32-16)|y>>>16;B+=y;g^=B;g=g<<(32-12)|g>>>12;n+=x;n+=L;v^=n;v=v<<(32-16)|v>>>16;J+=v;L^=J;L=L<<(32-12)|L>>>12;m+=A;m+=k;t^=m;t=t<<(32-16)|t>>>16;H+=t;k^=H;k=k<<(32-12)|k>>>12;n+=h;n+=L;v^=n;v=v<<(32-8)|v>>>8;J+=v;L^=J;L=L<<(32-7)|L>>>7;m+=C;m+=k;t^=m;t=t<<(32-8)|t>>>8;H+=t;k^=H;k=k<<(32-7)|k>>>7;o+=f;o+=g;y^=o;y=y<<(32-8)|y>>>8;B+=y;g^=B;g=g<<(32-7)|g>>>7;p+=D;p+=i;r^=p;r=r<<(32-8)|r>>>8;E+=r;i^=E;i=i<<(32-7)|i>>>7;p+=w;p+=k;y^=p;y=y<<(32-16)|y>>>16;J+=y;k^=J;k=k<<(32-12)|k>>>12;o+=D;o+=i;v^=o;v=v<<(32-16)|v>>>16;H+=v;i^=H;i=i<<(32-12)|i>>>12;n+=z;n+=g;t^=n;t=t<<(32-16)|t>>>16;E+=t;g^=E;g=g<<(32-12)|g>>>12;m+=f;m+=L;r^=m;r=r<<(32-16)|r>>>16;B+=r;L^=B;L=L<<(32-12)|L>>>12;n+=j;n+=g;t^=n;t=t<<(32-8)|t>>>8;E+=t;g^=E;g=g<<(32-7)|g>>>7;m+=x;m+=L;r^=m;r=r<<(32-8)|r>>>8;B+=r;L^=B;L=L<<(32-7)|L>>>7;o+=u;o+=i;v^=o;v=v<<(32-8)|v>>>8;H+=v;i^=H;i=i<<(32-7)|i>>>7;p+=C;p+=k;y^=p;y=y<<(32-8)|y>>>8;J+=y;k^=J;k=k<<(32-7)|k>>>7;p+=I;p+=i;r^=p;r=r<<(32-16)|r>>>16;E+=r;i^=E;i=i<<(32-12)|i>>>12;o+=s;o+=g;y^=o;y=y<<(32-16)|y>>>16;B+=y;g^=B;g=g<<(32-12)|g>>>12;n+=A;n+=L;v^=n;v=v<<(32-16)|v>>>16;J+=v;L^=J;L=L<<(32-12)|L>>>12;m+=h;m+=k;t^=m;t=t<<(32-16)|t>>>16;H+=t;k^=H;k=k<<(32-12)|k>>>12;n+=G;n+=L;v^=n;v=v<<(32-8)|v>>>8;J+=v;L^=J;L=L<<(32-7)|L>>>7;m+=F;m+=k;t^=m;t=t<<(32-8)|t>>>8;H+=t;k^=H;k=k<<(32-7)|k>>>7;o+=K;o+=g;y^=o;y=y<<(32-8)|y>>>8;B+=y;g^=B;g=g<<(32-7)|g>>>7;p+=l;p+=i;r^=p;r=r<<(32-8)|r>>>8;E+=r;i^=E;i=i<<(32-7)|i>>>7;p+=G;p+=k;y^=p;y=y<<(32-16)|y>>>16;J+=y;k^=J;k=k<<(32-12)|k>>>12;o+=u;o+=i;v^=o;v=v<<(32-16)|v>>>16;H+=v;i^=H;i=i<<(32-12)|i>>>12;n+=C;n+=g;t^=n;t=t<<(32-16)|t>>>16;E+=t;g^=E;g=g<<(32-12)|g>>>12;m+=l;m+=L;r^=m;r=r<<(32-16)|r>>>16;B+=r;L^=B;L=L<<(32-12)|L>>>12;n+=f;n+=g;t^=n;t=t<<(32-8)|t>>>8;E+=t;g^=E;g=g<<(32-7)|g>>>7;m+=A;m+=L;r^=m;r=r<<(32-8)|r>>>8;B+=r;L^=B;L=L<<(32-7)|L>>>7;o+=x;o+=i;v^=o;v=v<<(32-8)|v>>>8;H+=v;i^=H;i=i<<(32-7)|i>>>7;p+=s;p+=k;y^=p;y=y<<(32-8)|y>>>8;J+=y;k^=J;k=k<<(32-7)|k>>>7;p+=z;p+=i;r^=p;r=r<<(32-16)|r>>>16;E+=r;i^=E;i=i<<(32-12)|i>>>12;o+=w;o+=g;y^=o;y=y<<(32-16)|y>>>16;B+=y;g^=B;g=g<<(32-12)|g>>>12;n+=j;n+=L;v^=n;v=v<<(32-16)|v>>>16;J+=v;L^=J;L=L<<(32-12)|L>>>12;m+=F;m+=k;t^=m;t=t<<(32-16)|t>>>16;H+=t;k^=H;k=k<<(32-12)|k>>>12;n+=K;n+=L;v^=n;v=v<<(32-8)|v>>>8;J+=v;L^=J;L=L<<(32-7)|L>>>7;m+=I;m+=k;t^=m;t=t<<(32-8)|t>>>8;H+=t;k^=H;k=k<<(32-7)|k>>>7;o+=D;o+=g;y^=o;y=y<<(32-8)|y>>>8;B+=y;g^=B;g=g<<(32-7)|g>>>7;p+=h;p+=i;r^=p;r=r<<(32-8)|r>>>8;E+=r;i^=E;i=i<<(32-7)|i>>>7;p+=F;p+=k;y^=p;y=y<<(32-16)|y>>>16;J+=y;k^=J;k=k<<(32-12)|k>>>12;o+=A;o+=i;v^=o;v=v<<(32-16)|v>>>16;H+=v;i^=H;i=i<<(32-12)|i>>>12;n+=D;n+=g;t^=n;t=t<<(32-16)|t>>>16;E+=t;g^=E;g=g<<(32-12)|g>>>12;m+=j;m+=L;r^=m;r=r<<(32-16)|r>>>16;B+=r;L^=B;L=L<<(32-12)|L>>>12;n+=G;n+=g;t^=n;t=t<<(32-8)|t>>>8;E+=t;g^=E;g=g<<(32-7)|g>>>7;m+=I;m+=L;r^=m;r=r<<(32-8)|r>>>8;B+=r;L^=B;L=L<<(32-7)|L>>>7;o+=K;o+=i;v^=o;v=v<<(32-8)|v>>>8;H+=v;i^=H;i=i<<(32-7)|i>>>7;p+=h;p+=k;y^=p;y=y<<(32-8)|y>>>8;J+=y;k^=J;k=k<<(32-7)|k>>>7;p+=s;p+=i;r^=p;r=r<<(32-16)|r>>>16;E+=r;i^=E;i=i<<(32-12)|i>>>12;o+=x;o+=g;y^=o;y=y<<(32-16)|y>>>16;B+=y;g^=B;g=g<<(32-12)|g>>>12;n+=f;n+=L;v^=n;v=v<<(32-16)|v>>>16;J+=v;L^=J;L=L<<(32-12)|L>>>12;m+=w;m+=k;t^=m;t=t<<(32-16)|t>>>16;H+=t;k^=H;k=k<<(32-12)|k>>>12;n+=z;n+=L;v^=n;v=v<<(32-8)|v>>>8;J+=v;L^=J;L=L<<(32-7)|L>>>7;m+=l;m+=k;t^=m;t=t<<(32-8)|t>>>8;H+=t;k^=H;k=k<<(32-7)|k>>>7;o+=u;o+=g;y^=o;y=y<<(32-8)|y>>>8;B+=y;g^=B;g=(g<<(32-7))|(g>>>7);p+=C;p+=i;r^=p;r=(r<<(32-8))|(r>>>8);E+=r;i^=E;i=(i<<(32-7))|(i>>>7);this.h[0]^=p^J;this.h[1]^=o^H;this.h[2]^=n^E;this.h[3]^=m^B;this.h[4]^=k^y;this.h[5]^=i^v;this.h[6]^=g^t;this.h[7]^=L^r};e.prototype.stringToUtf8Array=function(h){var f=[];for(var g=0;g<h.length;g++){var j=h.charCodeAt(g);if(j<128){f.push(j)}else{if(j>127&&j<2048){f.push((j>>6)|192);f.push((j&63)|128)}else{f.push((j>>12)|224);f.push(((j>>6)&63)|128);f.push((j&64)|128)}}}return f};e.prototype.update=function(j,k,g){if(typeof k==="undefined"){k=0}if(typeof g==="undefined"){g=j.length}if(this.isFinished){throw"update() after calling digest()"}if(typeof j=="string"){if(k!=0){throw"offset not supported for strings"}j=this.stringToUtf8Array(j);g=j.length;k=0}else{if(typeof j!="object"){throw"unsupported object: string or array required"}}if(g==0){return}var h=64-this.nx;if(g>h){for(var f=0;f<h;f++){this.x[this.nx+f]=j[k+f]}this.processBlock(64);k+=h;g-=h;this.nx=0}while(g>64){for(var f=0;f<64;f++){this.x[f]=j[k+f]}this.processBlock(64);k+=64;g-=64;this.nx=0}for(var f=0;f<g;f++){this.x[this.nx+f]=j[k+f]}this.nx+=g};e.prototype.digest=function(){if(this.isFinished){return this.result}for(var g=this.nx;g<64;g++){this.x[g]=0}this.f0=4294967295;this.processBlock(this.nx);var f=new Array(32);for(var g=0;g<8;g++){var j=this.h[g];f[g*4+0]=(j>>>0)&255;f[g*4+1]=(j>>>8)&255;f[g*4+2]=(j>>>16)&255;f[g*4+3]=(j>>>24)&255}this.result=f.slice(0,this.digestLength);this.isFinished=true;return this.result};function d(h){var f=this;this.name="BLAKE2s";this.blockSize=32;if(h&&c.util.type(h.length).isNumber()&&h.length<=32&&h.length>=1){this.digestSize=Math.floor(h.length)}else{this.digestSize=32}function g(k,j){if(j){var i=new e(f.digestSize,new Uint8Array(j))}else{var i=new e(f.digestSize)}i.update(new Uint8Array(k));return new Uint8Array(i.digest()).buffer}this.mac=function(j,i){if(i.byteLength>32){i=i.slice(0,32)}return g(j,i)};this.hash=function(i){return g(i)};return this}if("undefined"!=typeof module&&"undefined"!=typeof module.exports){module.exports=d}else{define([],function(){return d})}})(__enigma_jscrypto__);(function(d){var f={};function g(k,j){var i=this;this.algorithms=Object.keys(f);if(this.algorithms.indexOf(k)<0){throw new Error("hash-algorithm-unknown")}var m=f[k];function l(n){return{hex:d.util.encoding(n).toHEX(),buffer:n}}this.hash=function(o){if(!d.util.type(o).isArrayBuffer()){throw Error("invalid-parameter")}var n=new m.constructor(j);return l(n.hash(o))};this.mac=function(p,q){if(!(d.util.type(q).isArrayBuffer()&&d.util.type(p).isArrayBuffer())){throw Error("invalid-parameter")}var o;var n=new m.constructor(j);if(d.util.type(n.mac).isFunction()){o=n.mac(p,q)}else{o=h(n.hash,q,p,n.blockSize)}return l(o)};this.pbkdf2=function(o,n,q,p){if(!(d.util.type(o).isArrayBuffer()&&d.util.type(n).isArrayBuffer()&&q>0&&p>0)){throw Error("invalid-parameter")}return e(i.mac,m.digestSize,o,n,q,p)};return this}function h(u,l,n,r){if(l.byteLength>r){l=new Uint8Array(u(l))}else{if(l.byteLength<r){var j=new Uint8Array(r),q=new Uint8Array(l);for(var o=0;o<j.length;o++){if(o<l.byteLength){j[o]=q[o]}else{j[o]=0}}l=j}}var v=new Uint8Array(r);var m=new Uint8Array(r);for(var o=0;o<r;o++){v[o]=92^l[o];m[o]=54^l[o]}var k=d.util.buffer.concat([m.buffer,n]),s=u(k);var t=d.util.buffer.concat([v.buffer,s]),p=u(t);return p}function e(x,v,r,o,m,k){var w=Math.ceil(k/v);var t=new Array(w);for(var q=0;q<w;q++){var s=false;var l=new Uint32Array([q]);var u=d.util.buffer.concat([o,l.buffer]);for(var p=0;p<m;p++){var n=x(r,u).buffer;if(false===s){s=n}else{s=d.util.buffer.xor(n,s)}u=n}t[q]=s}return d.util.buffer.concat(t).slice(0,k)}function c(i){if(false===i){return g}var j=new i();f[j.name]={constructor:i,blockSize:j.blockSize,digestSize:j.digestSize,name:j.name};d.util.log.notice("Load hash algorithm: ["+j.name+"]")}if("undefined"!=typeof module&&"undefined"!=typeof module.exports){module.exports=c}else{define([],function(){return c})}})(__enigma_jscrypto__);(function(d){var c=["blake2s","ripemd160","whirlpool"];function e(h){for(var j=1;j<arguments.length;j++){h(arguments[j])}d.hash=h(false)}if("undefined"!=typeof module&&"undefined"!=typeof module.exports){var g=[require("./hash.js")];for(var f in c){g.push(require("./"+c[f]+".js"))}e.apply(this,g)}else{var g=["hash/hash"];for(var f in c){g.push("hash/"+c[f])}define(g,e)}})(__enigma_jscrypto__);(function(){var r=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13];var o=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11];var k=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6];var c=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11];var d=[0,1518500249,1859775393,2400959708,2840853838];var q=[1352829926,1548603684,1836072691,2053994217,0];var p=function(u){var w=[];for(var v=0,t=0;v<u.length;v++,t+=8){w[t>>>5]|=u[v]<<(24-t%32)}return w};var f=function(v){var u=[];for(var t=0;t<v.length*32;t+=8){u.push((v[t>>>5]>>>(24-t%32))&255)}return u};var j=function(G,D,y){for(var z=0;z<16;z++){var J=y+z;var E=D[J];D[J]=((((E<<8)|(E>>>24))&16711935)|(((E<<24)|(E>>>8))&4278255360))}var B,v,F,A,u;var x,L,C,w,I;x=B=G[0];L=v=G[1];C=F=G[2];w=A=G[3];I=u=G[4];var K;for(var z=0;z<80;z+=1){K=(B+D[y+r[z]])|0;if(z<16){K+=n(v,F,A)+d[0]}else{if(z<32){K+=m(v,F,A)+d[1]}else{if(z<48){K+=i(v,F,A)+d[2]}else{if(z<64){K+=g(v,F,A)+d[3]}else{K+=e(v,F,A)+d[4]}}}}K=K|0;K=l(K,k[z]);K=(K+u)|0;B=u;u=A;A=l(F,10);F=v;v=K;K=(x+D[y+o[z]])|0;if(z<16){K+=e(L,C,w)+q[0]}else{if(z<32){K+=g(L,C,w)+q[1]}else{if(z<48){K+=i(L,C,w)+q[2]}else{if(z<64){K+=m(L,C,w)+q[3]}else{K+=n(L,C,w)+q[4]}}}}K=K|0;K=l(K,c[z]);K=(K+I)|0;x=I;I=w;w=l(C,10);C=L;L=K}K=(G[1]+F+w)|0;G[1]=(G[2]+A+I)|0;G[2]=(G[3]+u+x)|0;G[3]=(G[4]+B+L)|0;G[4]=(G[0]+v+C)|0;G[0]=K};function n(t,v,u){return((t)^(v)^(u))}function m(t,v,u){return(((t)&(v))|((~t)&(u)))}function i(t,v,u){return(((t)|(~(v)))^(u))}function g(t,v,u){return(((t)&(u))|((v)&(~(u))))}function e(t,v,u){return((t)^((v)|(~(u))))}function l(t,u){return(t<<u)|(t>>>(32-u))}function h(A){var z=[1732584193,4023233417,2562383102,271733878,3285377520],B=new Uint8Array(A);var u=p(B);var y=B.length*8;var x=B.length*8;u[y>>>5]|=128<<(24-y%32);u[(((y+64)>>>9)<<4)+14]=((((x<<8)|(x>>>24))&16711935)|(((x<<24)|(x>>>8))&4278255360));for(var v=0;v<u.length;v+=16){j(z,u,v)}var t;for(var v=0;v<5;v++){t=z[v];z[v]=(((t<<8)|(t>>>24))&16711935)|(((t<<24)|(t>>>8))&4278255360)}var w=f(z);return new Uint8Array(w).buffer}function s(){var t=this;this.name="RIPEMD160";this.blockSize=64;this.digestSize=20;this.hash=function(u){return h(u)};return this}if("undefined"!=typeof module&&"undefined"!=typeof module.exports){module.exports=s}else{define([],function(){return s})}})();(function(){var F,k=10,w=[],z=[],u,s,E,y,D,h,g,e,d,I,H,v="\u1823\uc6E8\u87B8\u014F\u36A6\ud2F5\u796F\u9152\u60Bc\u9B8E\uA30c\u7B35\u1dE0\ud7c2\u2E4B\uFE57\u1577\u37E5\u9FF0\u4AdA\u58c9\u290A\uB1A0\u6B85\uBd5d\u10F4\ucB3E\u0567\uE427\u418B\uA77d\u95d8\uFBEE\u7c66\udd17\u479E\ucA2d\uBF07\uAd5A\u8333\u6302\uAA71\uc819\u49d9\uF2E3\u5B88\u9A26\u32B0\uE90F\ud580\uBEcd\u3448\uFF7A\u905F\u2068\u1AAE\uB454\u9322\u64F1\u7312\u4008\uc3Ec\udBA1\u8d3d\u9700\ucF2B\u7682\ud61B\uB5AF\u6A50\u45F3\u30EF\u3F55\uA2EA\u65BA\u2Fc0\udE1c\uFd4d\u9275\u068A\uB2E6\u0E1F\u62d4\uA896\uF9c5\u2559\u8472\u394c\u5E78\u388c\ud1A5\uE261\uB321\u9c1E\u43c7\uFc04\u5199\u6d0d\uFAdF\u7E24\u3BAB\ucE11\u8F4E\uB7EB\u3c81\u94F7\uB913\u2cd3\uE76E\uc403\u5644\u7FA9\u2ABB\uc153\udc0B\u9d6c\u3174\uF646\uAc89\u14E1\u163A\u6909\u70B6\ud0Ed\ucc42\u98A4\u285c\uF886";for(u=8;u-->0;){w[u]=[]}for(s=0;s<256;s++){E=v.charCodeAt(s/2);h=((s&1)==0)?E>>>8:E&255;g=h<<1;if(g>=256){g^=285}e=g<<1;if(e>=256){e^=285}d=e^h;I=e<<1;if(I>=256){I^=285}H=I^h;w[0][s]=[0,0];w[0][s][0]=(h<<24)|(h<<16)|(e<<8)|(h);w[0][s][1]=(I<<24)|(d<<16)|(g<<8)|(H);for(var u=1;u<8;u++){w[u][s]=[0,0];w[u][s][0]=(w[u-1][s][0]>>>8)|((w[u-1][s][1]<<24));w[u][s][1]=(w[u-1][s][1]>>>8)|((w[u-1][s][0]<<24))}}z[0]=[0,0];for(y=1;y<=k;y++){D=8*(y-1);z[y]=[0,0];z[y][0]=(w[0][D][0]&4278190080)^(w[1][D+1][0]&16711680)^(w[2][D+2][0]&65280)^(w[3][D+3][0]&255);z[y][1]=(w[4][D+4][1]&4278190080)^(w[5][D+5][1]&16711680)^(w[6][D+6][1]&65280)^(w[7][D+7][1]&255)}var B=[],A=[],o=0,l=0,f=[],p=[],n=[],m=[],j=[];var G=function(){var C,c,K,J,x;for(C=0,c=0;C<8;C++,c+=8){m[C]=[0,0];m[C][0]=((A[c]&255)<<24)^((A[c+1]&255)<<16)^((A[c+2]&255)<<8)^((A[c+3]&255));m[C][1]=((A[c+4]&255)<<24)^((A[c+5]&255)<<16)^((A[c+6]&255)<<8)^((A[c+7]&255))}for(C=0;C<8;C++){j[C]=[0,0];p[C]=[0,0];j[C][0]=m[C][0]^(p[C][0]=f[C][0]);j[C][1]=m[C][1]^(p[C][1]=f[C][1])}for(K=1;K<=k;K++){for(C=0;C<8;C++){n[C]=[0,0];for(x=0,J=56,c=0;x<8;x++,J-=8,c=J<32?1:0){n[C][0]^=w[x][(p[(C-x)&7][c]>>>(J%32))&255][0];n[C][1]^=w[x][(p[(C-x)&7][c]>>>(J%32))&255][1]}}for(C=0;C<8;C++){p[C][0]=n[C][0];p[C][1]=n[C][1]}p[0][0]^=z[K][0];p[0][1]^=z[K][1];for(C=0;C<8;C++){n[C][0]=p[C][0];n[C][1]=p[C][1];for(x=0,J=56,c=0;x<8;x++,J-=8,c=J<32?1:0){n[C][0]^=w[x][(j[(C-x)&7][c]>>>(J%32))&255][0];n[C][1]^=w[x][(j[(C-x)&7][c]>>>(J%32))&255][1]}}for(C=0;C<8;C++){j[C][0]=n[C][0];j[C][1]=n[C][1]}}for(C=0;C<8;C++){f[C][0]^=j[C][0]^m[C][0];f[C][1]^=j[C][1]^m[C][1]}};F=Whirlpool=function(c){return F.init().add(c).finalize()};F.version="3.0";F.init=function(){for(var c=32;c-->0;){B[c]=0}o=l=0;A=[0];for(c=8;c-->0;){f[c]=[0,0]}return F};F.add=function(J){if(!J){return F}var c=new Uint8Array(J);var N=c.length*8;var r=0,t=(8-(N&7))&7,C=o&7,x,K,M,L=N;for(x=31,M=0;x>=0;x--){M+=(B[x]&255)+(L%256);B[x]=M&255;M>>>=8;L=Math.floor(L/256)}while(N>8){K=((c[r]<<t)&255)|((c[r+1]&255)>>>(8-t));if(K<0||K>=256){return"Whirlpool requires a byte array"}A[l++]|=K>>>C;o+=8-C;if(o==512){G();o=l=0;A=[]}A[l]=((K<<(8-C))&255);o+=C;N-=8;r++}if(N>0){K=(c[r]<<t)&255;A[l]|=K>>>C}else{K=0}if(C+N<8){o+=N}else{l++;o+=8-C;N-=8-C;if(o==512){G();o=l=0;A=[]}A[l]=((K<<(8-C))&255);o+=N}return F};F.finalize=function(){var r,c,t,C="",x=[];A[l]|=128>>>(o&7);l++;if(l>32){while(l<64){A[l++]=0}G();l=0;A=[]}while(l<32){A[l++]=0}A.push.apply(A,B);G();for(r=0,c=0;r<8;r++,c+=8){t=f[r][0];x[c]=t>>>24&255;x[c+1]=t>>>16&255;x[c+2]=t>>>8&255;x[c+3]=t&255;t=f[r][1];x[c+4]=t>>>24&255;x[c+5]=t>>>16&255;x[c+6]=t>>>8&255;x[c+7]=t&255}return new Uint8Array(x).buffer};function q(){var c=this;this.name="WHIRLPOOL";this.blockSize=64;this.digestSize=64;this.hash=function(i){return Whirlpool(i)};return this}if("undefined"!=typeof module&&"undefined"!=typeof module.exports){module.exports=q}else{define([],function(){return q})}})();b=a})(__enigma_jscrypto__);