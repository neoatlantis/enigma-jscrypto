(function(){var b={},g={};var a={get:function(j){return b[j]},set:function(k,j){b[k]=j},exp:function(l,j){var n=l.split(".");var m=g;for(var k in n){if("undefined"==typeof m[n[k]]){if(k==n.length-1){m[n[k]]=j;break}m[n[k]]={}}m=m[n[k]]}}};(function(p){var k="0123456789abcdefghjkmnpqrtuvwxyz";var n={o:0,i:1,l:1,s:5};var l=function(){var u={};for(var t=0;t<k.length;t++){u[k[t]]=t}for(var s in n){if(!n.hasOwnProperty(s)){continue}u[s]=u[""+n[s]]}l=function(){return u};return u};function m(){var s=0;var t=0;this.output="";this.readByte=function(u){if(s<0){t|=(u>>(-s))}else{t=(u<<s)&248}if(s>3){s-=8;return 1}if(s<4){this.output+=k[t>>3];s+=5}return 0};this.finish=function(){var u=this.output+(s<0?k[t>>3]:"");this.output="";return u}}m.prototype.update=function(u,s){for(var v=0;v<u.length;){v+=this.readByte(u[v])}var t=this.output;this.output="";if(s){t+=this.finish()}return t};function r(){var s=0;var t=0;this.output=[];this.readChar=function(u){var v=l()[u];if(typeof v=="undefined"){throw Error('Could not find character "'+u+'" in lookup table.')}v<<=3;t|=v>>>s;s+=5;if(s>=8){this.output.push(t);s-=8;if(s>0){t=(v<<(5-s))&255}else{t=0}}};this.finish=function(){if(s<0){this.output.push(k[bits>>3])}return this.output}}r.prototype.update=function(u,s){for(var v=0;v<u.length;v++){this.readChar(u[v])}var t=this.output;this.output="";if(s){t.concat(this.finish())}return t};function o(t){var u=new m();var s=u.update(t,true);return s}function j(t){var u=new r();t=t.toLowerCase();var s=u.update(t,true);return s}var q={encode:o,decode:j};p.set("util.encoding.base32",q)})(a);(function(l){function o(s){var r,q,t=0,p;for(r=0;r<s.length;r++){t+=s[r].byteLength}var u=new Uint8Array(t),v=0;for(r=0;r<s.length;r++){p=new Uint8Array(s[r]);for(q=0;q<p.length;q++){u[v]=p[q];v+=1}}return u.buffer}function j(q,p){if(q.byteLength!=p.byteLength){throw Error("xor-unequal-length-buffer")}var t=new Uint8Array(q.byteLength),s=new Uint8Array(q),u=new Uint8Array(p);for(var r=0;r<t.length;r++){t[r]=s[r]^u[r]}return t.buffer}function m(r,q){try{var p=new Uint8Array(r),u=new Uint8Array(q)}catch(t){return false}if(p.length!=u.length){return false}for(var s=0;s<p.length;s++){if(p[s]!=u[s]){return false}}return true}function k(q){var u=new Uint8Array(q);var p=u.length-1,v=Math.floor(p/2);var x=p,w;for(var s=0;s<=v;s++){w=u[s];u[s]=u[x];u[x]=w;x-=1}return u.buffer}var n={concat:o,xor:j,equal:m,reverse:k};l.set("util.buffer",n);l.exp("util.buffer",n)})(a);(function(l){function m(u){var r=4-u.length%4;if(4==r){r=0}for(var s=0;s<r;s++){u.push(0)}var y=[r],q,p,o,x,t;function v(z){if(z<=255){return 0}else{if(z<=65535){return 1}else{if(z<=16777215){return 2}else{if(z<=4294967295){return 3}else{throw Error("uncompressible: "+z)}}}}}function w(A,z){if(z<=255){A.push(z)}else{if(z<=65535){A.push((z&65280)>>8,z&255)}else{if(z<=16777215){A.push((z&16711680)>>16,(z&65280)>>8,z&255)}else{if(z<=4294967295){A.push((z&4278190080)>>24(z&16711680)>>16,(z&65280)>>8,(z&255))}}}}}for(var s=0;s<u.length;s+=4){q=u[s];p=u[s+1];o=u[s+2];x=u[s+3];t=(v(q)<<6)+(v(p)<<4)+(v(o)<<2)+(v(x));y.push(t);w(y,q);w(y,p);w(y,o);w(y,x)}return y}function n(t){var o=t[0];if(o>=4){throw new Error("invalid-input")}var q=1,p;var r,z,x,w,u;function v(B,A){return((B>>(A*2))&3)+1}function y(C){var B=0;for(var A=0;A<C.length;A++){B=(B<<8);B|=(C[A]&255)}return B}var s=[];while(q<t.length){r=t[q];q++;p=v(r,3);z=y(t.slice(q,q+p));q+=p;p=v(r,2);x=y(t.slice(q,q+p));q+=p;p=v(r,1);w=y(t.slice(q,q+p));q+=p;p=v(r,0);u=y(t.slice(q,q+p));q+=p;s.push(z,x,w,u)}return s.slice(0,s.length-o)}function j(v){if(!l.get("util.type")(v).isArrayBuffer()){throw Error("invalid-input")}var o=new Uint8Array(v);var q,t={},s,p,u="",x=[],r=256;for(q=0;q<256;q+=1){t[String.fromCharCode(q)]=q}for(q=0;q<o.length;q+=1){s=String.fromCharCode(o[q]);p=u+s;if(t.hasOwnProperty(p)){u=p}else{x.push(t[u]);t[p]=r++;u=String(s)}}if(""!==u){x.push(t[u])}return new Uint8Array(m(x)).buffer}function k(t){if(!l.get("util.type")(t).isArrayBuffer()){throw Error("invalid-input")}var o=new Uint8Array(t);o=n(o);var q,u=[],x,y,p,v="",r=256;for(q=0;q<256;q+=1){u[q]=String.fromCharCode(q)}x=String.fromCharCode(o[0]);y=x;for(q=1;q<o.length;q+=1){p=o[q];if(u[p]){v=u[p]}else{if(p===r){v=x+x.charAt(0)}else{return null}}y+=v;u[r++]=x+v.charAt(0);x=v}var s=new Uint8Array(y.length);for(var q=0;q<s.length;q++){s[q]=y.charCodeAt(q)}return s.buffer}l.exp("util.compress",j);l.exp("util.decompress",k);l.set("util.compress",j);l.set("util.decompress",k)})(a);(function(k){function j(t){if(!0==t.byteLength%2){throw new Error("decoding-error")}var t=new Uint16Array(t),o=0,q,n,r,p="";while(o<t.length){q=t[o];if((q>=0&&q<=55295)||(q>=57344&&q<=65535)){p+=String.fromCharCode(q);o+=1}else{if(q>=55296&&q<=56319){r=q;n=t[o+1];o+=2;if(n>=56320&&n<=57343){p+=String.fromCharCode(r)+String.fromCharCode(n)}else{throw new Error("decoding-error")}}else{throw new Error("decoding-error")}}}return p}function l(q,z){var r=this;var v=null;var o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",x="0123456789abcdef";var p=k.get("util.type")(q),B=k.get("util.encoding.base32");if(p.isArrayBuffer()){v=q}else{if(p.isArray()){var u=new Uint8Array(q.length);for(var y=0;y<u.length;y++){u[y]=q[y]&255}v=u.buffer}else{if(p.isString()){if(!z){z=""}switch(z.toLowerCase()){case"hex":if(!/^[0-9a-f]+$/i.test(q)||0!=q.length%2){throw Error("invalid-encoding-choosen")}q=q.toLowerCase();var s=new Uint8Array(q.length/2);for(var y=0;y<s.length;y++){s[y]=x.indexOf(q[2*y])*16+x.indexOf(q[2*y+1])}v=s.buffer;break;case"base64":if(/(=[^=]+|={3,})$/.test(q)){throw Error("invalid-encoding-choosen")}q=q.replace(/=/g,"");var t=q.length&3;if(1==t){throw Error("invalid-encoding-choosen")}var y=0,w=0,A=Math.ceil(q.length/4);var s=new Uint8Array(A*3);var G,F,E,C;for(y=0;y<A;y++){G=o.indexOf(q[w++]||"A");F=o.indexOf(q[w++]||"A");E=o.indexOf(q[w++]||"A");C=o.indexOf(q[w++]||"A");if((G|F|E|C)<0){throw Error("invalid-encoding-choosen")}s[y*3]=((G<<2)|(F>>4))&255;s[y*3+1]=((F<<4)|(E>>2))&255;s[y*3+2]=((E<<6)|C)&255}v=s.buffer.slice(0,s.length+t-4);break;case"base32":if(!/^[0-9a-z=]+$/.test(q)){throw Error("invalid-encoding-choosen")}var D=B.decode(q);v=new Uint8Array(D).buffer;break;default:var s=new Uint16Array(q.length);for(var y=0;y<q.length;y++){s[y]=q.charCodeAt(y)}v=s.buffer;break}}else{throw Error("unknown-encoding")}}}this.toArrayBuffer=function(){return v};this.toUTF16=function(){return j(v)};this.toBase64=function(){var M=new Uint8Array(v);var J=0,I=0,H=0,K=M.length/3;var n="";var O,N,L;for(J=0;J<K;++J){O=M[I++];N=M[I++];L=M[I++];n+=o[O>>2]+o[((O<<4)&63)|(N>>4)]+(isNaN(N)?"=":o[((N<<2)&63)|(L>>6)])+(isNaN(N+L)?"=":o[L&63])}console.log(M.length);return n};this.toBase32=function(){var n=new Uint8Array(v),H=B.encode(n);return H};this.toHEX=function(){var n=new Uint8Array(v),I="";for(var H=0;H<n.length;H++){if(n[H]<16){I+="0"+n[H].toString(16)}else{I+=n[H].toString(16)}}return I};this.toArray=function(){var n=new Uint8Array(v),H=new Array(n.length);for(var I=0;I<H.length;I++){H[I]=n[I]}return H};return this}var m=function(o,n){return new l(o,n)};k.set("util.encoding",m);k.exp("util.encoding",m)})(a);(function(j){var k={notice:function(l){console.log(l)},error:function(l){console.error(l)}};j.set("util.log",k);j.exp("util.log",k)})(a);(function(r){var j=new Uint32Array(16);function m(C,z){function B(E,D){return(((E)<<(D))|((E)>>>(32-(D))))}var A;var y=j;for(A=0;A<16;A++){y[A]=C[A]}for(A=0;A<32;A++){y[4]^=B(y[0]+y[12],7);y[8]^=B(y[4]+y[0],9);y[12]^=B(y[8]+y[4],13);y[0]^=B(y[12]+y[8],18);y[9]^=B(y[5]+y[1],7);y[13]^=B(y[9]+y[5],9);y[1]^=B(y[13]+y[9],13);y[5]^=B(y[1]+y[13],18);y[14]^=B(y[10]+y[6],7);y[2]^=B(y[14]+y[10],9);y[6]^=B(y[2]+y[14],13);y[10]^=B(y[6]+y[2],18);y[3]^=B(y[15]+y[11],7);y[7]^=B(y[3]+y[15],9);y[11]^=B(y[7]+y[3],13);y[15]^=B(y[11]+y[7],18);y[1]^=B(y[0]+y[3],7);y[2]^=B(y[1]+y[0],9);y[3]^=B(y[2]+y[1],13);y[0]^=B(y[3]+y[2],18);y[6]^=B(y[5]+y[4],7);y[7]^=B(y[6]+y[5],9);y[4]^=B(y[7]+y[6],13);y[5]^=B(y[4]+y[7],18);y[11]^=B(y[10]+y[9],7);y[8]^=B(y[11]+y[10],9);y[9]^=B(y[8]+y[11],13);y[10]^=B(y[9]+y[8],18);y[12]^=B(y[15]+y[14],7);y[13]^=B(y[12]+y[15],9);y[14]^=B(y[13]+y[12],13);y[15]^=B(y[14]+y[13],18)}for(A=0;A<16;A++){z[A]=y[A]+C[A]}}var q=new Uint8Array(16);function v(){for(var y=0;y<16;y++){q[y]=Math.floor(256*Math.random())}}v();var k=new Uint32Array([0,0]);function s(){k[0]=0;k[1]=0}function u(){k[0]+=1;if(0==k[0]){k[1]+=1}if(0==k[1]){v()}}var w=new Uint8Array(32),l=0;function x(y){w[l]=y;l+=1;if(l>=32){s();l=0}}for(var o=0;o<32;o++){x(Math.floor(256*Math.random()))}function n(){x(new Date().getTime()%256)}setInterval(n,100);function p(z){var B=new Uint32Array([1634760805,857760878,2036477234,1797285236]);var y=new Uint32Array(16),A=new Uint32Array(q.buffer),C=new Uint32Array(w.buffer);y[0]=B[0];y[1]=C[0];y[2]=C[1];y[3]=C[2];y[4]=C[3];y[5]=B[1];y[6]=A[0];y[7]=A[1];y[8]=k[0];y[9]=k[1];y[10]=B[2];y[11]=C[4];y[12]=C[5];y[13]=C[6];y[14]=C[7];y[15]=B[3];u();return m(y,z)}function t(){var y=this;var z=new Uint32Array(16);this.touch=function(){n()};this.bytes=function(F){var A=Math.ceil(F/64);var C=new Uint8Array(F),D=0,B=0,G;for(var E=0;E<A;E++){p(z);G=new Uint8Array(z.buffer);for(D=0;D<64;D++){if(B>=F){break}C[B]=G[D];B+=1}}return C.buffer};this.array=function(A){return new Uint8Array(y.bytes(A))};return this}r.set("util.srand",t);r.exp("util.srand",t)})(a);(function(j){function k(l){return{isError:function(){return toString.apply(l)==="[object Error]"},isArray:function(){return toString.apply(l)==="[object Array]"},isDate:function(){return toString.apply(l)==="[object Date]"},isObject:function(){return !!l&&Object.prototype.toString.call(l)==="[object Object]"},isPrimitive:function(){return self.isString(l)||self.isNumber(l)||self.isBoolean(l)},isFunction:function(){return toString.apply(l)==="[object Function]"},isDate:function(){return toString.apply(l)==="[object Date]"},isNumber:function(){return typeof l==="number"&&isFinite(l)},isString:function(){return typeof l==="string"},isBoolean:function(){return typeof l==="boolean"},isArrayBuffer:function(){return toString.apply(l)==="[object ArrayBuffer]"}}}j.set("util.type",k);j.exp("util.type",k)})(a);module.exports=function(j){j.array=function(){return new e()}};function e(){var j=this;this.pack=function(n){if(!Boolean(n)){n=[]}else{if(!$.tools.type.areBuffers(n)||n.length>255){throw $.error("invalid-parameter","not-buffers-items")}}var o=[];for(var m in n){var k=n[m].length,l=new $.node.buffer.Buffer(2);if(k>65535){throw $.error("invalid-parameter","data-too-long")}l.writeUInt16BE(k,0);o.push($.node.buffer.Buffer.concat([l,n[m]]))}l=new $.node.buffer.Buffer(2);l.writeUInt16BE(n.length,0);o.unshift(l);return $.node.buffer.Buffer.concat(o)};this.unpack=function(n){var l=0,k=0,q;var p=n.slice(0,2);n=n.slice(2);l=p.readUInt16BE(0);var m=[];for(var o=0;o<l;o++){p=n.slice(0,2);n=n.slice(2);k=p.readUInt16BE(0);q=n.slice(0,k);n=n.slice(k);m.push(q)}return[m,n]};return this}module.exports=function(j){j.binary=function(){return new i(false)};j.longBinary=function(){return new i(true)}};function i(k){var j=this;this.unpack=function(l){var m;if(k){m=l.readUInt32BE(0);l=l.slice(4)}else{m=l.readUInt16BE(0);l=l.slice(2)}if(0==m){return[null,l]}unpackResult=l.slice(0,m);l=l.slice(m);return[unpackResult,l]};this.pack=function(l){if(!Boolean(l)){l=new $.node.buffer.Buffer(0)}if(!$.tools.type.isBuffer(l)){throw $.error("invalid-parameter","not-buffer-item")}packLength=l.length;if((k&&packLength>4294967295)||(!k&&packLength>65535)){throw $.error("invalid-parameter","too-long")}var m=new $.node.buffer.Buffer((k?4:2));if(k){m.writeUInt32BE(packLength,0)}else{m.writeUInt16BE(packLength,0)}return $.node.buffer.Buffer.concat([m,l])};return this}module.exports=function(j){j["boolean"]=function(){return new h()}};function h(){var j=this;this.pack=function(k){if(!$.tools.type.isBoolean(k)){throw $.error("invalid-parameter","not-boolean-item")}var l=new $.node.buffer.Buffer(1);l.writeUInt8((k?255:0),0);return l};this.unpack=function(k){var l=k.slice(0,1);k=k.slice(1);l=(255==l.readUInt8(0));return[l,k]};return this}module.exports=function(j){j.constant=function(k){return new c(k)}};function c(k){var j=this;if(!$.tools.type.isArray(k)){throw $.error("invalid-parameter")}var l=false;k=k[0];if($.tools.type.isString(k)){k=new $.node.buffer.Buffer(k);l=true}if(!$.tools.type.isBuffer(k)){throw $.error("invalid-parameter")}this.pack=function(){return k};this.unpack=function(m){var n=m.slice(0,k.length);m=m.slice(k.length);if(n.toString("hex")!==k.toString("hex")){throw $.error("invalid-parameter","unexpected-constant")}if(l){n=n.toString()}return[n,m]};return this}module.exports=function(j){j.datetime=function(){return new d()}};function d(){var j=this;this.pack=function(n){if(!Boolean(n)){return new $.node.buffer.Buffer("00","hex")}if(!$.tools.type.isDate(n)){if($.tools.type.isString(n)){try{n=new Date(n)}catch(o){throw $.error("invalid-parameter","date")}}else{throw $.error("invalid-parameter","date")}}var l=new $.node.buffer.Buffer(n.toISOString(),"ascii"),m=l.length,k=new $.node.buffer.Buffer(1);k.writeUInt8(m,0);return $.node.buffer.Buffer.concat([k,l])};this.unpack=function(o){var l=o.slice(0,1),n=l.readUInt8(0);o=o.slice(1);if(0==n){return[null,o]}var k=o.slice(0,n);o=o.slice(n);var m=new Date(k.toString("ascii"));return[m,o]};return this}module.exports=function(j){j["enum"]=function(k){return new f(k)}};function f(k){var j=this;if(!$.tools.type.isArray(k)||k.length>255){throw $.error("invalid-parameter")}this.pack=function(n){var m=k.indexOf(n);if(m<0){throw $.error("invalid-parameter","not-enum-item")}var l=new $.node.buffer.Buffer(1);l.writeUInt8(m,0);return l};this.unpack=function(l){var m=l.slice(0,1);l=l.slice(1);m=m.readUInt8(0);return[k[m],l]};return this}(function(k){var m={};require("./binary.js")(m);require("./enum.js")(m);require("./boolean.js")(m);require("./datetime.js")(m);require("./constant.js")(m);require("./array.js")(m);function j(t){var q=this;if(!$.tools.type.isObject(t)){throw $.error("invalid-data-structure")}var n=Object.keys(t).sort(),o=[];for(var s in n){var r=n[s];var p,u;if($.tools.type.isString(t[r])){p=t[r];u=[]}else{p=t[r][0];u=t[r].slice(1)}if(!m[p]){throw $.error("invalid-data-structure")}o.push(m[p](u))}this.serialize=function(y){if(!$.tools.type.isObject(y)){throw $.error("invalid-parameter")}var v=[];for(var x in o){var w=n[x];v.push(o[x].pack(y[w]))}return $.node.buffer.Buffer.concat(v)};this.deserialize=function(w){if(!$.tools.type.isBuffer(w)){throw $.error("invalid-parameter")}var x={};for(var z in n){var y=n[z];var v=o[z].unpack(w);x[y]=v[0];w=v[1]}return x};return this}var l=function(n){return new j(n)};k.set("util.serialize",l)})(a);(function(k){function l(q,o){if(typeof q==="undefined"){q=32}this.isFinished=false;this.digestLength=32;this.blockLength=64;this.iv=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];if(q<=0){q=this.digestLength}else{if(q>32){throw"digestLength is too large"}}var m=0;if(typeof o=="string"){o=this.stringToUtf8Array(o);m=o.length}else{if(typeof o=="object"){m=o.length}}if(m>32){throw"key too long"}var p=[q&255,m,1,1];this.h=this.iv.slice(0);this.h[0]^=this.load32(p,0);this.x=new Array(64);this.t0=0;this.t1=0;this.f0=0;this.f1=0;this.nx=0;this.digestLength=q;if(m>0){for(var n=0;n<m;n++){this.x[n]=o[n]}for(var n=m;n<64;n++){this.x[n]=0}this.nx=64}}l.prototype.load32=function(m,n){return((m[n]&255)|((m[n+1]&255)<<8)|((m[n+2]&255)<<16)|((m[n+3]&255)<<24))>>>0};l.prototype.store32=function(n,o,m){n[o]=(m>>>0)&255;n[o+1]=(m>>>8)&255;n[o+2]=(m>>>16)&255;n[o+3]=(m>>>24)&255};l.prototype.processBlock=function(x){this.t0+=x;if(this.t0!=this.t0>>>0){this.t0=0;this.t1++}var w=this.h[0],v=this.h[1],u=this.h[2],t=this.h[3],r=this.h[4],p=this.h[5],n=this.h[6],S=this.h[7],Q=this.iv[0],O=this.iv[1],L=this.iv[2],I=this.iv[3],F=this.iv[4]^this.t0,C=this.iv[5]^this.t1,A=this.iv[6]^this.f0,y=this.iv[7]^this.f1;var s=this.load32(this.x,0),q=this.load32(this.x,4),o=this.load32(this.x,8),m=this.load32(this.x,12),R=this.load32(this.x,16),P=this.load32(this.x,20),N=this.load32(this.x,24),K=this.load32(this.x,28),H=this.load32(this.x,32),E=this.load32(this.x,36),M=this.load32(this.x,40),J=this.load32(this.x,44),G=this.load32(this.x,48),D=this.load32(this.x,52),B=this.load32(this.x,56),z=this.load32(this.x,60);w+=s;w+=r;F^=w;F=F<<(32-16)|F>>>16;Q+=F;r^=Q;r=r<<(32-12)|r>>>12;v+=o;v+=p;C^=v;C=C<<(32-16)|C>>>16;O+=C;p^=O;p=p<<(32-12)|p>>>12;u+=R;u+=n;A^=u;A=A<<(32-16)|A>>>16;L+=A;n^=L;n=n<<(32-12)|n>>>12;t+=N;t+=S;y^=t;y=y<<(32-16)|y>>>16;I+=y;S^=I;S=S<<(32-12)|S>>>12;u+=P;u+=n;A^=u;A=A<<(32-8)|A>>>8;L+=A;n^=L;n=n<<(32-7)|n>>>7;t+=K;t+=S;y^=t;y=y<<(32-8)|y>>>8;I+=y;S^=I;S=S<<(32-7)|S>>>7;v+=m;v+=p;C^=v;C=C<<(32-8)|C>>>8;O+=C;p^=O;p=p<<(32-7)|p>>>7;w+=q;w+=r;F^=w;F=F<<(32-8)|F>>>8;Q+=F;r^=Q;r=r<<(32-7)|r>>>7;w+=H;w+=p;y^=w;y=y<<(32-16)|y>>>16;L+=y;p^=L;p=p<<(32-12)|p>>>12;v+=M;v+=n;F^=v;F=F<<(32-16)|F>>>16;I+=F;n^=I;n=n<<(32-12)|n>>>12;u+=G;u+=S;C^=u;C=C<<(32-16)|C>>>16;Q+=C;S^=Q;S=S<<(32-12)|S>>>12;t+=B;t+=r;A^=t;A=A<<(32-16)|A>>>16;O+=A;r^=O;r=r<<(32-12)|r>>>12;u+=D;u+=S;C^=u;C=C<<(32-8)|C>>>8;Q+=C;S^=Q;S=S<<(32-7)|S>>>7;t+=z;t+=r;A^=t;A=A<<(32-8)|A>>>8;O+=A;r^=O;r=r<<(32-7)|r>>>7;v+=J;v+=n;F^=v;F=F<<(32-8)|F>>>8;I+=F;n^=I;n=n<<(32-7)|n>>>7;w+=E;w+=p;y^=w;y=y<<(32-8)|y>>>8;L+=y;p^=L;p=p<<(32-7)|p>>>7;w+=B;w+=r;F^=w;F=F<<(32-16)|F>>>16;Q+=F;r^=Q;r=r<<(32-12)|r>>>12;v+=R;v+=p;C^=v;C=C<<(32-16)|C>>>16;O+=C;p^=O;p=p<<(32-12)|p>>>12;u+=E;u+=n;A^=u;A=A<<(32-16)|A>>>16;L+=A;n^=L;n=n<<(32-12)|n>>>12;t+=D;t+=S;y^=t;y=y<<(32-16)|y>>>16;I+=y;S^=I;S=S<<(32-12)|S>>>12;u+=z;u+=n;A^=u;A=A<<(32-8)|A>>>8;L+=A;n^=L;n=n<<(32-7)|n>>>7;t+=N;t+=S;y^=t;y=y<<(32-8)|y>>>8;I+=y;S^=I;S=S<<(32-7)|S>>>7;v+=H;v+=p;C^=v;C=C<<(32-8)|C>>>8;O+=C;p^=O;p=p<<(32-7)|p>>>7;w+=M;w+=r;F^=w;F=F<<(32-8)|F>>>8;Q+=F;r^=Q;r=r<<(32-7)|r>>>7;w+=q;w+=p;y^=w;y=y<<(32-16)|y>>>16;L+=y;p^=L;p=p<<(32-12)|p>>>12;v+=s;v+=n;F^=v;F=F<<(32-16)|F>>>16;I+=F;n^=I;n=n<<(32-12)|n>>>12;u+=J;u+=S;C^=u;C=C<<(32-16)|C>>>16;Q+=C;S^=Q;S=S<<(32-12)|S>>>12;t+=P;t+=r;A^=t;A=A<<(32-16)|A>>>16;O+=A;r^=O;r=r<<(32-12)|r>>>12;u+=K;u+=S;C^=u;C=C<<(32-8)|C>>>8;Q+=C;S^=Q;S=S<<(32-7)|S>>>7;t+=m;t+=r;A^=t;A=A<<(32-8)|A>>>8;O+=A;r^=O;r=r<<(32-7)|r>>>7;v+=o;v+=n;F^=v;F=F<<(32-8)|F>>>8;I+=F;n^=I;n=n<<(32-7)|n>>>7;w+=G;w+=p;y^=w;y=y<<(32-8)|y>>>8;L+=y;p^=L;p=p<<(32-7)|p>>>7;w+=J;w+=r;F^=w;F=F<<(32-16)|F>>>16;Q+=F;r^=Q;r=r<<(32-12)|r>>>12;v+=G;v+=p;C^=v;C=C<<(32-16)|C>>>16;O+=C;p^=O;p=p<<(32-12)|p>>>12;u+=P;u+=n;A^=u;A=A<<(32-16)|A>>>16;L+=A;n^=L;n=n<<(32-12)|n>>>12;t+=z;t+=S;y^=t;y=y<<(32-16)|y>>>16;I+=y;S^=I;S=S<<(32-12)|S>>>12;u+=o;u+=n;A^=u;A=A<<(32-8)|A>>>8;L+=A;n^=L;n=n<<(32-7)|n>>>7;t+=D;t+=S;y^=t;y=y<<(32-8)|y>>>8;I+=y;S^=I;S=S<<(32-7)|S>>>7;v+=s;v+=p;C^=v;C=C<<(32-8)|C>>>8;O+=C;p^=O;p=p<<(32-7)|p>>>7;w+=H;w+=r;F^=w;F=F<<(32-8)|F>>>8;Q+=F;r^=Q;r=r<<(32-7)|r>>>7;w+=M;w+=p;y^=w;y=y<<(32-16)|y>>>16;L+=y;p^=L;p=p<<(32-12)|p>>>12;v+=m;v+=n;F^=v;F=F<<(32-16)|F>>>16;I+=F;n^=I;n=n<<(32-12)|n>>>12;u+=K;u+=S;C^=u;C=C<<(32-16)|C>>>16;Q+=C;S^=Q;S=S<<(32-12)|S>>>12;t+=E;t+=r;A^=t;A=A<<(32-16)|A>>>16;O+=A;r^=O;r=r<<(32-12)|r>>>12;u+=q;u+=S;C^=u;C=C<<(32-8)|C>>>8;Q+=C;S^=Q;S=S<<(32-7)|S>>>7;t+=R;t+=r;A^=t;A=A<<(32-8)|A>>>8;O+=A;r^=O;r=r<<(32-7)|r>>>7;v+=N;v+=n;F^=v;F=F<<(32-8)|F>>>8;I+=F;n^=I;n=n<<(32-7)|n>>>7;w+=B;w+=p;y^=w;y=y<<(32-8)|y>>>8;L+=y;p^=L;p=p<<(32-7)|p>>>7;w+=K;w+=r;F^=w;F=F<<(32-16)|F>>>16;Q+=F;r^=Q;r=r<<(32-12)|r>>>12;v+=m;v+=p;C^=v;C=C<<(32-16)|C>>>16;O+=C;p^=O;p=p<<(32-12)|p>>>12;u+=D;u+=n;A^=u;A=A<<(32-16)|A>>>16;L+=A;n^=L;n=n<<(32-12)|n>>>12;t+=J;t+=S;y^=t;y=y<<(32-16)|y>>>16;I+=y;S^=I;S=S<<(32-12)|S>>>12;u+=G;u+=n;A^=u;A=A<<(32-8)|A>>>8;L+=A;n^=L;n=n<<(32-7)|n>>>7;t+=B;t+=S;y^=t;y=y<<(32-8)|y>>>8;I+=y;S^=I;S=S<<(32-7)|S>>>7;v+=q;v+=p;C^=v;C=C<<(32-8)|C>>>8;O+=C;p^=O;p=p<<(32-7)|p>>>7;w+=E;w+=r;F^=w;F=F<<(32-8)|F>>>8;Q+=F;r^=Q;r=r<<(32-7)|r>>>7;w+=o;w+=p;y^=w;y=y<<(32-16)|y>>>16;L+=y;p^=L;p=p<<(32-12)|p>>>12;v+=P;v+=n;F^=v;F=F<<(32-16)|F>>>16;I+=F;n^=I;n=n<<(32-12)|n>>>12;u+=R;u+=S;C^=u;C=C<<(32-16)|C>>>16;Q+=C;S^=Q;S=S<<(32-12)|S>>>12;t+=z;t+=r;A^=t;A=A<<(32-16)|A>>>16;O+=A;r^=O;r=r<<(32-12)|r>>>12;u+=s;u+=S;C^=u;C=C<<(32-8)|C>>>8;Q+=C;S^=Q;S=S<<(32-7)|S>>>7;t+=H;t+=r;A^=t;A=A<<(32-8)|A>>>8;O+=A;r^=O;r=r<<(32-7)|r>>>7;v+=M;v+=n;F^=v;F=F<<(32-8)|F>>>8;I+=F;n^=I;n=n<<(32-7)|n>>>7;w+=N;w+=p;y^=w;y=y<<(32-8)|y>>>8;L+=y;p^=L;p=p<<(32-7)|p>>>7;w+=E;w+=r;F^=w;F=F<<(32-16)|F>>>16;Q+=F;r^=Q;r=r<<(32-12)|r>>>12;v+=P;v+=p;C^=v;C=C<<(32-16)|C>>>16;O+=C;p^=O;p=p<<(32-12)|p>>>12;u+=o;u+=n;A^=u;A=A<<(32-16)|A>>>16;L+=A;n^=L;n=n<<(32-12)|n>>>12;t+=M;t+=S;y^=t;y=y<<(32-16)|y>>>16;I+=y;S^=I;S=S<<(32-12)|S>>>12;u+=R;u+=n;A^=u;A=A<<(32-8)|A>>>8;L+=A;n^=L;n=n<<(32-7)|n>>>7;t+=z;t+=S;y^=t;y=y<<(32-8)|y>>>8;I+=y;S^=I;S=S<<(32-7)|S>>>7;v+=K;v+=p;C^=v;C=C<<(32-8)|C>>>8;O+=C;p^=O;p=p<<(32-7)|p>>>7;w+=s;w+=r;F^=w;F=F<<(32-8)|F>>>8;Q+=F;r^=Q;r=r<<(32-7)|r>>>7;w+=B;w+=p;y^=w;y=y<<(32-16)|y>>>16;L+=y;p^=L;p=p<<(32-12)|p>>>12;v+=J;v+=n;F^=v;F=F<<(32-16)|F>>>16;I+=F;n^=I;n=n<<(32-12)|n>>>12;u+=N;u+=S;C^=u;C=C<<(32-16)|C>>>16;Q+=C;S^=Q;S=S<<(32-12)|S>>>12;t+=m;t+=r;A^=t;A=A<<(32-16)|A>>>16;O+=A;r^=O;r=r<<(32-12)|r>>>12;u+=H;u+=S;C^=u;C=C<<(32-8)|C>>>8;Q+=C;S^=Q;S=S<<(32-7)|S>>>7;t+=D;t+=r;A^=t;A=A<<(32-8)|A>>>8;O+=A;r^=O;r=r<<(32-7)|r>>>7;v+=G;v+=n;F^=v;F=F<<(32-8)|F>>>8;I+=F;n^=I;n=n<<(32-7)|n>>>7;w+=q;w+=p;y^=w;y=y<<(32-8)|y>>>8;L+=y;p^=L;p=p<<(32-7)|p>>>7;w+=o;w+=r;F^=w;F=F<<(32-16)|F>>>16;Q+=F;r^=Q;r=r<<(32-12)|r>>>12;v+=N;v+=p;C^=v;C=C<<(32-16)|C>>>16;O+=C;p^=O;p=p<<(32-12)|p>>>12;u+=s;u+=n;A^=u;A=A<<(32-16)|A>>>16;L+=A;n^=L;n=n<<(32-12)|n>>>12;t+=H;t+=S;y^=t;y=y<<(32-16)|y>>>16;I+=y;S^=I;S=S<<(32-12)|S>>>12;u+=J;u+=n;A^=u;A=A<<(32-8)|A>>>8;L+=A;n^=L;n=n<<(32-7)|n>>>7;t+=m;t+=S;y^=t;y=y<<(32-8)|y>>>8;I+=y;S^=I;S=S<<(32-7)|S>>>7;v+=M;v+=p;C^=v;C=C<<(32-8)|C>>>8;O+=C;p^=O;p=p<<(32-7)|p>>>7;w+=G;w+=r;F^=w;F=F<<(32-8)|F>>>8;Q+=F;r^=Q;r=r<<(32-7)|r>>>7;w+=R;w+=p;y^=w;y=y<<(32-16)|y>>>16;L+=y;p^=L;p=p<<(32-12)|p>>>12;v+=K;v+=n;F^=v;F=F<<(32-16)|F>>>16;I+=F;n^=I;n=n<<(32-12)|n>>>12;u+=z;u+=S;C^=u;C=C<<(32-16)|C>>>16;Q+=C;S^=Q;S=S<<(32-12)|S>>>12;t+=q;t+=r;A^=t;A=A<<(32-16)|A>>>16;O+=A;r^=O;r=r<<(32-12)|r>>>12;u+=B;u+=S;C^=u;C=C<<(32-8)|C>>>8;Q+=C;S^=Q;S=S<<(32-7)|S>>>7;t+=E;t+=r;A^=t;A=A<<(32-8)|A>>>8;O+=A;r^=O;r=r<<(32-7)|r>>>7;v+=P;v+=n;F^=v;F=F<<(32-8)|F>>>8;I+=F;n^=I;n=n<<(32-7)|n>>>7;w+=D;w+=p;y^=w;y=y<<(32-8)|y>>>8;L+=y;p^=L;p=p<<(32-7)|p>>>7;w+=G;w+=r;F^=w;F=F<<(32-16)|F>>>16;Q+=F;r^=Q;r=r<<(32-12)|r>>>12;v+=q;v+=p;C^=v;C=C<<(32-16)|C>>>16;O+=C;p^=O;p=p<<(32-12)|p>>>12;u+=B;u+=n;A^=u;A=A<<(32-16)|A>>>16;L+=A;n^=L;n=n<<(32-12)|n>>>12;t+=R;t+=S;y^=t;y=y<<(32-16)|y>>>16;I+=y;S^=I;S=S<<(32-12)|S>>>12;u+=D;u+=n;A^=u;A=A<<(32-8)|A>>>8;L+=A;n^=L;n=n<<(32-7)|n>>>7;t+=M;t+=S;y^=t;y=y<<(32-8)|y>>>8;I+=y;S^=I;S=S<<(32-7)|S>>>7;v+=z;v+=p;C^=v;C=C<<(32-8)|C>>>8;O+=C;p^=O;p=p<<(32-7)|p>>>7;w+=P;w+=r;F^=w;F=F<<(32-8)|F>>>8;Q+=F;r^=Q;r=r<<(32-7)|r>>>7;w+=s;w+=p;y^=w;y=y<<(32-16)|y>>>16;L+=y;p^=L;p=p<<(32-12)|p>>>12;v+=N;v+=n;F^=v;F=F<<(32-16)|F>>>16;I+=F;n^=I;n=n<<(32-12)|n>>>12;u+=E;u+=S;C^=u;C=C<<(32-16)|C>>>16;Q+=C;S^=Q;S=S<<(32-12)|S>>>12;t+=H;t+=r;A^=t;A=A<<(32-16)|A>>>16;O+=A;r^=O;r=r<<(32-12)|r>>>12;u+=o;u+=S;C^=u;C=C<<(32-8)|C>>>8;Q+=C;S^=Q;S=S<<(32-7)|S>>>7;t+=J;t+=r;A^=t;A=A<<(32-8)|A>>>8;O+=A;r^=O;r=r<<(32-7)|r>>>7;v+=m;v+=n;F^=v;F=F<<(32-8)|F>>>8;I+=F;n^=I;n=n<<(32-7)|n>>>7;w+=K;w+=p;y^=w;y=y<<(32-8)|y>>>8;L+=y;p^=L;p=p<<(32-7)|p>>>7;w+=D;w+=r;F^=w;F=F<<(32-16)|F>>>16;Q+=F;r^=Q;r=r<<(32-12)|r>>>12;v+=K;v+=p;C^=v;C=C<<(32-16)|C>>>16;O+=C;p^=O;p=p<<(32-12)|p>>>12;u+=G;u+=n;A^=u;A=A<<(32-16)|A>>>16;L+=A;n^=L;n=n<<(32-12)|n>>>12;t+=m;t+=S;y^=t;y=y<<(32-16)|y>>>16;I+=y;S^=I;S=S<<(32-12)|S>>>12;u+=q;u+=n;A^=u;A=A<<(32-8)|A>>>8;L+=A;n^=L;n=n<<(32-7)|n>>>7;t+=E;t+=S;y^=t;y=y<<(32-8)|y>>>8;I+=y;S^=I;S=S<<(32-7)|S>>>7;v+=B;v+=p;C^=v;C=C<<(32-8)|C>>>8;O+=C;p^=O;p=p<<(32-7)|p>>>7;w+=J;w+=r;F^=w;F=F<<(32-8)|F>>>8;Q+=F;r^=Q;r=r<<(32-7)|r>>>7;w+=P;w+=p;y^=w;y=y<<(32-16)|y>>>16;L+=y;p^=L;p=p<<(32-12)|p>>>12;v+=z;v+=n;F^=v;F=F<<(32-16)|F>>>16;I+=F;n^=I;n=n<<(32-12)|n>>>12;u+=H;u+=S;C^=u;C=C<<(32-16)|C>>>16;Q+=C;S^=Q;S=S<<(32-12)|S>>>12;t+=o;t+=r;A^=t;A=A<<(32-16)|A>>>16;O+=A;r^=O;r=r<<(32-12)|r>>>12;u+=N;u+=S;C^=u;C=C<<(32-8)|C>>>8;Q+=C;S^=Q;S=S<<(32-7)|S>>>7;t+=M;t+=r;A^=t;A=A<<(32-8)|A>>>8;O+=A;r^=O;r=r<<(32-7)|r>>>7;v+=R;v+=n;F^=v;F=F<<(32-8)|F>>>8;I+=F;n^=I;n=n<<(32-7)|n>>>7;w+=s;w+=p;y^=w;y=y<<(32-8)|y>>>8;L+=y;p^=L;p=p<<(32-7)|p>>>7;w+=N;w+=r;F^=w;F=F<<(32-16)|F>>>16;Q+=F;r^=Q;r=r<<(32-12)|r>>>12;v+=B;v+=p;C^=v;C=C<<(32-16)|C>>>16;O+=C;p^=O;p=p<<(32-12)|p>>>12;u+=J;u+=n;A^=u;A=A<<(32-16)|A>>>16;L+=A;n^=L;n=n<<(32-12)|n>>>12;t+=s;t+=S;y^=t;y=y<<(32-16)|y>>>16;I+=y;S^=I;S=S<<(32-12)|S>>>12;u+=m;u+=n;A^=u;A=A<<(32-8)|A>>>8;L+=A;n^=L;n=n<<(32-7)|n>>>7;t+=H;t+=S;y^=t;y=y<<(32-8)|y>>>8;I+=y;S^=I;S=S<<(32-7)|S>>>7;v+=E;v+=p;C^=v;C=C<<(32-8)|C>>>8;O+=C;p^=O;p=p<<(32-7)|p>>>7;w+=z;w+=r;F^=w;F=F<<(32-8)|F>>>8;Q+=F;r^=Q;r=r<<(32-7)|r>>>7;w+=G;w+=p;y^=w;y=y<<(32-16)|y>>>16;L+=y;p^=L;p=p<<(32-12)|p>>>12;v+=D;v+=n;F^=v;F=F<<(32-16)|F>>>16;I+=F;n^=I;n=n<<(32-12)|n>>>12;u+=q;u+=S;C^=u;C=C<<(32-16)|C>>>16;Q+=C;S^=Q;S=S<<(32-12)|S>>>12;t+=M;t+=r;A^=t;A=A<<(32-16)|A>>>16;O+=A;r^=O;r=r<<(32-12)|r>>>12;u+=R;u+=S;C^=u;C=C<<(32-8)|C>>>8;Q+=C;S^=Q;S=S<<(32-7)|S>>>7;t+=P;t+=r;A^=t;A=A<<(32-8)|A>>>8;O+=A;r^=O;r=r<<(32-7)|r>>>7;v+=K;v+=n;F^=v;F=F<<(32-8)|F>>>8;I+=F;n^=I;n=n<<(32-7)|n>>>7;w+=o;w+=p;y^=w;y=y<<(32-8)|y>>>8;L+=y;p^=L;p=p<<(32-7)|p>>>7;w+=M;w+=r;F^=w;F=F<<(32-16)|F>>>16;Q+=F;r^=Q;r=r<<(32-12)|r>>>12;v+=H;v+=p;C^=v;C=C<<(32-16)|C>>>16;O+=C;p^=O;p=p<<(32-12)|p>>>12;u+=K;u+=n;A^=u;A=A<<(32-16)|A>>>16;L+=A;n^=L;n=n<<(32-12)|n>>>12;t+=q;t+=S;y^=t;y=y<<(32-16)|y>>>16;I+=y;S^=I;S=S<<(32-12)|S>>>12;u+=N;u+=n;A^=u;A=A<<(32-8)|A>>>8;L+=A;n^=L;n=n<<(32-7)|n>>>7;t+=P;t+=S;y^=t;y=y<<(32-8)|y>>>8;I+=y;S^=I;S=S<<(32-7)|S>>>7;v+=R;v+=p;C^=v;C=C<<(32-8)|C>>>8;O+=C;p^=O;p=p<<(32-7)|p>>>7;w+=o;w+=r;F^=w;F=F<<(32-8)|F>>>8;Q+=F;r^=Q;r=r<<(32-7)|r>>>7;w+=z;w+=p;y^=w;y=y<<(32-16)|y>>>16;L+=y;p^=L;p=p<<(32-12)|p>>>12;v+=E;v+=n;F^=v;F=F<<(32-16)|F>>>16;I+=F;n^=I;n=n<<(32-12)|n>>>12;u+=m;u+=S;C^=u;C=C<<(32-16)|C>>>16;Q+=C;S^=Q;S=S<<(32-12)|S>>>12;t+=D;t+=r;A^=t;A=A<<(32-16)|A>>>16;O+=A;r^=O;r=r<<(32-12)|r>>>12;u+=G;u+=S;C^=u;C=C<<(32-8)|C>>>8;Q+=C;S^=Q;S=S<<(32-7)|S>>>7;t+=s;t+=r;A^=t;A=A<<(32-8)|A>>>8;O+=A;r^=O;r=r<<(32-7)|r>>>7;v+=B;v+=n;F^=v;F=F<<(32-8)|F>>>8;I+=F;n^=I;n=(n<<(32-7))|(n>>>7);w+=J;w+=p;y^=w;y=(y<<(32-8))|(y>>>8);L+=y;p^=L;p=(p<<(32-7))|(p>>>7);this.h[0]^=w^Q;this.h[1]^=v^O;this.h[2]^=u^L;this.h[3]^=t^I;this.h[4]^=r^F;this.h[5]^=p^C;this.h[6]^=n^A;this.h[7]^=S^y};l.prototype.stringToUtf8Array=function(o){var m=[];for(var n=0;n<o.length;n++){var p=o.charCodeAt(n);if(p<128){m.push(p)}else{if(p>127&&p<2048){m.push((p>>6)|192);m.push((p&63)|128)}else{m.push((p>>12)|224);m.push(((p>>6)&63)|128);m.push((p&64)|128)}}}return m};l.prototype.update=function(q,r,n){if(typeof r==="undefined"){r=0}if(typeof n==="undefined"){n=q.length}if(this.isFinished){throw"update() after calling digest()"}if(typeof q=="string"){if(r!=0){throw"offset not supported for strings"}q=this.stringToUtf8Array(q);n=q.length;r=0}else{if(typeof q!="object"){throw"unsupported object: string or array required"}}if(n==0){return}var o=64-this.nx;if(n>o){for(var m=0;m<o;m++){this.x[this.nx+m]=q[r+m]}this.processBlock(64);r+=o;n-=o;this.nx=0}while(n>64){for(var m=0;m<64;m++){this.x[m]=q[r+m]}this.processBlock(64);r+=64;n-=64;this.nx=0}for(var m=0;m<n;m++){this.x[this.nx+m]=q[r+m]}this.nx+=n};l.prototype.digest=function(){if(this.isFinished){return this.result}for(var n=this.nx;n<64;n++){this.x[n]=0}this.f0=4294967295;this.processBlock(this.nx);var m=new Array(32);for(var n=0;n<8;n++){var o=this.h[n];m[n*4+0]=(o>>>0)&255;m[n*4+1]=(o>>>8)&255;m[n*4+2]=(o>>>16)&255;m[n*4+3]=(o>>>24)&255}this.result=m.slice(0,this.digestLength);this.isFinished=true;return this.result};function j(o){var m=this;this.name="BLAKE2s";this.blockSize=32;if(o&&k.get("util.type")(o.length).isNumber()&&o.length<=32&&o.length>=1){this.digestSize=Math.floor(o.length)}else{this.digestSize=32}function n(r,q){if(q){var p=new l(m.digestSize,new Uint8Array(q))}else{var p=new l(m.digestSize)}p.update(new Uint8Array(r));return new Uint8Array(p.digest()).buffer}this.mac=function(q,p){if(p.byteLength>32){p=p.slice(0,32)}return n(q,p)};this.hash=function(p){return n(p)};return this}k.set("hash.algorithms.blake2s",j)})(a);(function(k){var l={};function m(q,p){var o=this;this.algorithms=["ripemd160","blake2s","whirlpool"];q=q.toLowerCase();if(this.algorithms.indexOf(q)<0){throw new Error("hash-algorithm-unknown")}var s=k.get("hash.algorithms."+q);function r(t){return{hex:k.get("util.encoding")(t).toHEX(),buffer:t}}this.hash=function(u){if(!k.get("util.type")(u).isArrayBuffer()){throw Error("invalid-parameter")}var t=new s(p);return r(t.hash(u))};this.mac=function(v,w){if(!(k.get("util.type")(w).isArrayBuffer()&&k.get("util.type")(v).isArrayBuffer())){throw Error("invalid-parameter")}var u;var t=new s(p);if(k.get("util.type")(t.mac).isFunction()){u=t.mac(v,w)}else{u=n(t.hash,w,v,t.blockSize)}return r(u)};this.pbkdf2=function(u,t,w,v){if(!(k.get("util.type")(u).isArrayBuffer()&&k.get("util.type")(t).isArrayBuffer()&&w>0&&v>0)){throw Error("invalid-parameter")}return j(o.mac,new s().digestSize,u,t,w,v)};return this}function n(z,q,s,w){if(q.byteLength>w){q=new Uint8Array(z(q))}else{if(q.byteLength<w){var o=new Uint8Array(w),v=new Uint8Array(q);for(var t=0;t<o.length;t++){if(t<q.byteLength){o[t]=v[t]}else{o[t]=0}}q=o}}var A=new Uint8Array(w);var r=new Uint8Array(w);for(var t=0;t<w;t++){A[t]=92^q[t];r[t]=54^q[t]}var p=k.get("util.buffer").concat([r.buffer,s]),x=z(p);var y=k.get("util.buffer").concat([A.buffer,x]),u=z(y);return u}function j(B,z,v,s,q,o){var A=Math.ceil(o/z);var x=new Array(A);for(var u=0;u<A;u++){var w=false;var p=new Uint32Array([u]);var y=k.get("util.buffer").concat([s,p.buffer]);for(var t=0;t<q;t++){var r=B(v,y).buffer;if(false===w){w=r}else{w=k.get("util.buffer").xor(r,w)}y=r}x[u]=w}return k.get("util.buffer").concat(x).slice(0,o)}k.exp("hash",m);k.set("hash",m)})(a);(function(n){var o=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13];var l=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11];var y=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6];var x=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11];var m=[0,1518500249,1859775393,2400959708,2840853838];var A=[1352829926,1548603684,1836072691,2053994217,0];var j=function(C){var E=[];for(var D=0,B=0;D<C.length;D++,B+=8){E[B>>>5]|=C[D]<<(24-B%32)}return E};var p=function(D){var C=[];for(var B=0;B<D.length*32;B+=8){C.push((D[B>>>5]>>>(24-B%32))&255)}return C};var z=function(P,L,F){for(var G=0;G<16;G++){var R=F+G;var N=L[R];L[R]=((((N<<8)|(N>>>24))&16711935)|(((N<<24)|(N>>>8))&4278255360))}var J,C,O,I,B;var E,T,K,D,Q;E=J=P[0];T=C=P[1];K=O=P[2];D=I=P[3];Q=B=P[4];var S;for(var G=0;G<80;G+=1){S=(J+L[F+o[G]])|0;if(G<16){S+=w(C,O,I)+m[0]}else{if(G<32){S+=v(C,O,I)+m[1]}else{if(G<48){S+=u(C,O,I)+m[2]}else{if(G<64){S+=t(C,O,I)+m[3]}else{S+=s(C,O,I)+m[4]}}}}S=S|0;S=r(S,y[G]);S=(S+B)|0;J=B;B=I;I=r(O,10);O=C;C=S;S=(E+L[F+l[G]])|0;if(G<16){S+=s(T,K,D)+A[0]}else{if(G<32){S+=t(T,K,D)+A[1]}else{if(G<48){S+=u(T,K,D)+A[2]}else{if(G<64){S+=v(T,K,D)+A[3]}else{S+=w(T,K,D)+A[4]}}}}S=S|0;S=r(S,x[G]);S=(S+Q)|0;E=Q;Q=D;D=r(K,10);K=T;T=S}S=(P[1]+O+D)|0;P[1]=(P[2]+I+Q)|0;P[2]=(P[3]+B+E)|0;P[3]=(P[4]+J+T)|0;P[4]=(P[0]+C+K)|0;P[0]=S};function w(B,D,C){return((B)^(D)^(C))}function v(B,D,C){return(((B)&(D))|((~B)&(C)))}function u(B,D,C){return(((B)|(~(D)))^(C))}function t(B,D,C){return(((B)&(C))|((D)&(~(C))))}function s(B,D,C){return((B)^((D)|(~(C))))}function r(B,C){return(B<<C)|(B>>>(32-C))}function k(J){var I=[1732584193,4023233417,2562383102,271733878,3285377520],K=new Uint8Array(J);var C=j(K);var G=K.length*8;var F=K.length*8;C[G>>>5]|=128<<(24-G%32);C[(((G+64)>>>9)<<4)+14]=((((F<<8)|(F>>>24))&16711935)|(((F<<24)|(F>>>8))&4278255360));for(var D=0;D<C.length;D+=16){z(I,C,D)}var B;for(var D=0;D<5;D++){B=I[D];I[D]=(((B<<8)|(B>>>24))&16711935)|(((B<<24)|(B>>>8))&4278255360)}var E=p(I);return new Uint8Array(E).buffer}function q(){var B=this;this.name="RIPEMD160";this.blockSize=64;this.digestSize=20;this.hash=function(C){return k(C)};return this}n.set("hash.algorithms.ripemd160",q)})(a);(function(o){var N,q=10,E=[],G=[],B,A,M,F,J,n,m,k,j,Q,P,D="\u1823\uc6E8\u87B8\u014F\u36A6\ud2F5\u796F\u9152\u60Bc\u9B8E\uA30c\u7B35\u1dE0\ud7c2\u2E4B\uFE57\u1577\u37E5\u9FF0\u4AdA\u58c9\u290A\uB1A0\u6B85\uBd5d\u10F4\ucB3E\u0567\uE427\u418B\uA77d\u95d8\uFBEE\u7c66\udd17\u479E\ucA2d\uBF07\uAd5A\u8333\u6302\uAA71\uc819\u49d9\uF2E3\u5B88\u9A26\u32B0\uE90F\ud580\uBEcd\u3448\uFF7A\u905F\u2068\u1AAE\uB454\u9322\u64F1\u7312\u4008\uc3Ec\udBA1\u8d3d\u9700\ucF2B\u7682\ud61B\uB5AF\u6A50\u45F3\u30EF\u3F55\uA2EA\u65BA\u2Fc0\udE1c\uFd4d\u9275\u068A\uB2E6\u0E1F\u62d4\uA896\uF9c5\u2559\u8472\u394c\u5E78\u388c\ud1A5\uE261\uB321\u9c1E\u43c7\uFc04\u5199\u6d0d\uFAdF\u7E24\u3BAB\ucE11\u8F4E\uB7EB\u3c81\u94F7\uB913\u2cd3\uE76E\uc403\u5644\u7FA9\u2ABB\uc153\udc0B\u9d6c\u3174\uF646\uAc89\u14E1\u163A\u6909\u70B6\ud0Ed\ucc42\u98A4\u285c\uF886";for(B=8;B-->0;){E[B]=[]}for(A=0;A<256;A++){M=D.charCodeAt(A/2);n=((A&1)==0)?M>>>8:M&255;m=n<<1;if(m>=256){m^=285}k=m<<1;if(k>=256){k^=285}j=k^n;Q=k<<1;if(Q>=256){Q^=285}P=Q^n;E[0][A]=[0,0];E[0][A][0]=(n<<24)|(n<<16)|(k<<8)|(n);E[0][A][1]=(Q<<24)|(j<<16)|(m<<8)|(P);for(var B=1;B<8;B++){E[B][A]=[0,0];E[B][A][0]=(E[B-1][A][0]>>>8)|((E[B-1][A][1]<<24));E[B][A][1]=(E[B-1][A][1]>>>8)|((E[B-1][A][0]<<24))}}G[0]=[0,0];for(F=1;F<=q;F++){J=8*(F-1);G[F]=[0,0];G[F][0]=(E[0][J][0]&4278190080)^(E[1][J+1][0]&16711680)^(E[2][J+2][0]&65280)^(E[3][J+3][0]&255);G[F][1]=(E[4][J+4][1]&4278190080)^(E[5][J+5][1]&16711680)^(E[6][J+6][1]&65280)^(E[7][J+7][1]&255)}var I=[],H=[],w=0,s=0,l=[],y=[],v=[],u=[],p=[];var O=function(){var K,x,R,L,C;for(K=0,x=0;K<8;K++,x+=8){u[K]=[0,0];u[K][0]=((H[x]&255)<<24)^((H[x+1]&255)<<16)^((H[x+2]&255)<<8)^((H[x+3]&255));u[K][1]=((H[x+4]&255)<<24)^((H[x+5]&255)<<16)^((H[x+6]&255)<<8)^((H[x+7]&255))}for(K=0;K<8;K++){p[K]=[0,0];y[K]=[0,0];p[K][0]=u[K][0]^(y[K][0]=l[K][0]);p[K][1]=u[K][1]^(y[K][1]=l[K][1])}for(R=1;R<=q;R++){for(K=0;K<8;K++){v[K]=[0,0];for(C=0,L=56,x=0;C<8;C++,L-=8,x=L<32?1:0){v[K][0]^=E[C][(y[(K-C)&7][x]>>>(L%32))&255][0];v[K][1]^=E[C][(y[(K-C)&7][x]>>>(L%32))&255][1]}}for(K=0;K<8;K++){y[K][0]=v[K][0];y[K][1]=v[K][1]}y[0][0]^=G[R][0];y[0][1]^=G[R][1];for(K=0;K<8;K++){v[K][0]=y[K][0];v[K][1]=y[K][1];for(C=0,L=56,x=0;C<8;C++,L-=8,x=L<32?1:0){v[K][0]^=E[C][(p[(K-C)&7][x]>>>(L%32))&255][0];v[K][1]^=E[C][(p[(K-C)&7][x]>>>(L%32))&255][1]}}for(K=0;K<8;K++){p[K][0]=v[K][0];p[K][1]=v[K][1]}}for(K=0;K<8;K++){l[K][0]^=p[K][0]^u[K][0];l[K][1]^=p[K][1]^u[K][1]}};N=Whirlpool=function(r){return N.init().add(r).finalize()};N.version="3.0";N.init=function(){for(var r=32;r-->0;){I[r]=0}w=s=0;H=[0];for(r=8;r-->0;){l[r]=[0,0]}return N};N.add=function(L){if(!L){return N}var r=new Uint8Array(L);var U=r.length*8;var t=0,x=(8-(U&7))&7,K=w&7,C,R,T,S=U;for(C=31,T=0;C>=0;C--){T+=(I[C]&255)+(S%256);I[C]=T&255;T>>>=8;S=Math.floor(S/256)}while(U>8){R=((r[t]<<x)&255)|((r[t+1]&255)>>>(8-x));if(R<0||R>=256){return"Whirlpool requires a byte array"}H[s++]|=R>>>K;w+=8-K;if(w==512){O();w=s=0;H=[]}H[s]=((R<<(8-K))&255);w+=K;U-=8;t++}if(U>0){R=(r[t]<<x)&255;H[s]|=R>>>K}else{R=0}if(K+U<8){w+=U}else{s++;w+=8-K;U-=8-K;if(w==512){O();w=s=0;H=[]}H[s]=((R<<(8-K))&255);w+=U}return N};N.finalize=function(){var t,r,x,K="",C=[];H[s]|=128>>>(w&7);s++;if(s>32){while(s<64){H[s++]=0}O();s=0;H=[]}while(s<32){H[s++]=0}H.push.apply(H,I);O();for(t=0,r=0;t<8;t++,r+=8){x=l[t][0];C[r]=x>>>24&255;C[r+1]=x>>>16&255;C[r+2]=x>>>8&255;C[r+3]=x&255;x=l[t][1];C[r+4]=x>>>24&255;C[r+5]=x>>>16&255;C[r+6]=x>>>8&255;C[r+7]=x&255}return new Uint8Array(C).buffer};function z(){var r=this;this.name="WHIRLPOOL";this.blockSize=64;this.digestSize=64;this.hash=function(t){return Whirlpool(t)};return this}o.set("hash.algorithms.whirlpool",z)})(a);(function(bc){var bh;var aV=244837814094590;var aI=((aV&16777215)==15715070);function a4(bm,bl,bn){if(!(this instanceof a4)){return new a4(bm,bl,bn)}if(bm!=null){if("number"==typeof bm){this.fromNumber(bm,bl,bn)}else{if(bl==null&&"string"!=typeof bm){this.fromString(bm,256)}else{this.fromString(bm,bl)}}}}var be=a4.prototype;function u(){return new a4(null)}function j(bp,bl,bm,bo,br,bq){while(--bq>=0){var bn=bl*this[bp++]+bm[bo]+br;br=Math.floor(bn/67108864);bm[bo++]=bn&67108863}return br}function bj(bp,bu,bv,bo,bs,bl){var br=bu&32767,bt=bu>>15;while(--bl>=0){var bn=this[bp]&32767;var bq=this[bp++]>>15;var bm=bt*bn+bq*br;bn=br*bn+((bm&32767)<<15)+bv[bo]+(bs&1073741823);bs=(bn>>>30)+(bm>>>15)+bt*bq+(bs>>>30);bv[bo++]=bn&1073741823}return bs}function bi(bp,bu,bv,bo,bs,bl){var br=bu&16383,bt=bu>>14;while(--bl>=0){var bn=this[bp]&16383;var bq=this[bp++]>>14;var bm=bt*bn+bq*br;bn=br*bn+((bm&16383)<<14)+bv[bo]+bs;bs=(bn>>28)+(bm>>14)+bt*bq;bv[bo++]=bn&268435455}return bs}a4.prototype.am=j;bh=26;a4.prototype.DB=bh;a4.prototype.DM=((1<<bh)-1);var ar=a4.prototype.DV=(1<<bh);var aJ=52;a4.prototype.FV=Math.pow(2,aJ);a4.prototype.F1=aJ-bh;a4.prototype.F2=2*bh-aJ;var aR="0123456789abcdefghijklmnopqrstuvwxyz";var aU=new Array();var a2,J;a2="0".charCodeAt(0);for(J=0;J<=9;++J){aU[a2++]=J}a2="a".charCodeAt(0);for(J=10;J<36;++J){aU[a2++]=J}a2="A".charCodeAt(0);for(J=10;J<36;++J){aU[a2++]=J}function bk(bl){return aR.charAt(bl)}function T(bm,bl){var bn=aU[bm.charCodeAt(bl)];return(bn==null)?-1:bn}function aH(bm){for(var bl=this.t-1;bl>=0;--bl){bm[bl]=this[bl]}bm.t=this.t;bm.s=this.s}function D(bl){this.t=1;this.s=(bl<0)?-1:0;if(bl>0){this[0]=bl}else{if(bl<-1){this[0]=bl+ar}else{this.t=0}}}function m(bl){var bm=u();bm.fromInt(bl);return bm}function M(bs,bm){var bp=this;var bo;if(bm==16){bo=4}else{if(bm==8){bo=3}else{if(bm==256){bo=8}else{if(bm==2){bo=1}else{if(bm==32){bo=5}else{if(bm==4){bo=2}else{bp.fromRadix(bs,bm);return}}}}}}bp.t=0;bp.s=0;var br=bs.length,bn=false,bq=0;while(--br>=0){var bl=(bo==8)?bs[br]&255:T(bs,br);if(bl<0){if(bs.charAt(br)=="-"){bn=true}continue}bn=false;if(bq==0){bp[bp.t++]=bl}else{if(bq+bo>bp.DB){bp[bp.t-1]|=(bl&((1<<(bp.DB-bq))-1))<<bq;bp[bp.t++]=(bl>>(bp.DB-bq))}else{bp[bp.t-1]|=bl<<bq}}bq+=bo;if(bq>=bp.DB){bq-=bp.DB}}if(bo==8&&(bs[0]&128)!=0){bp.s=-1;if(bq>0){bp[bp.t-1]|=((1<<(bp.DB-bq))-1)<<bq}}bp.clamp();if(bn){a4.ZERO.subTo(bp,bp)}}function am(){var bl=this.s&this.DM;while(this.t>0&&this[this.t-1]==bl){--this.t}}function F(bs){var bt=this;if(bt.s<0){return"-"+bt.negate().toString(bs)}var bp;if(bs==16){bp=4}else{if(bs==8){bp=3}else{if(bs==2){bp=1}else{if(bs==32){bp=5}else{if(bs==4){bp=2}else{return bt.toRadix(bs)}}}}}var bm=(1<<bp)-1,br,bo=false,bl="",bq=bt.t;var bn=bt.DB-(bq*bt.DB)%bp;if(bq-->0){if(bn<bt.DB&&(br=bt[bq]>>bn)>0){bo=true;bl=bk(br)}while(bq>=0){if(bn<bp){br=(bt[bq]&((1<<bn)-1))<<(bp-bn);br|=bt[--bq]>>(bn+=bt.DB-bp)}else{br=(bt[bq]>>(bn-=bp))&bm;if(bn<=0){bn+=bt.DB;--bq}}if(br>0){bo=true}if(bo){bl+=bk(br)}}}return bo?bl:"0"}function aq(){var bl=u();a4.ZERO.subTo(this,bl);return bl}function aY(){return(this.s<0)?this.negate():this}function ad(bl){var bn=this.s-bl.s;if(bn!=0){return bn}var bm=this.t;bn=bm-bl.t;if(bn!=0){return(this.s<0)?-bn:bn}while(--bm>=0){if((bn=this[bm]-bl[bm])!=0){return bn}}return 0}function z(bl){var bn=1,bm;if((bm=bl>>>16)!=0){bl=bm;bn+=16}if((bm=bl>>8)!=0){bl=bm;bn+=8}if((bm=bl>>4)!=0){bl=bm;bn+=4}if((bm=bl>>2)!=0){bl=bm;bn+=2}if((bm=bl>>1)!=0){bl=bm;bn+=1}return bn}function I(){if(this.t<=0){return 0}return this.DB*(this.t-1)+z(this[this.t-1]^(this.s&this.DM))}function a3(bn,bm){var bl;for(bl=this.t-1;bl>=0;--bl){bm[bl+bn]=this[bl]}for(bl=bn-1;bl>=0;--bl){bm[bl]=0}bm.t=this.t+bn;bm.s=this.s}function aG(bn,bm){for(var bl=bn;bl<this.t;++bl){bm[bl-bn]=this[bl]}bm.t=Math.max(this.t-bn,0);bm.s=this.s}function H(bo,bl){var bv=this;var bu=bo%bv.DB;var br=bv.DB-bu;var bn=(1<<br)-1;var bp=Math.floor(bo/bv.DB),bt=(bv.s<<bu)&bv.DM,bq;for(bq=bv.t-1;bq>=0;--bq){bl[bq+bp+1]=(bv[bq]>>br)|bt;bt=(bv[bq]&bn)<<bu}for(bq=bp-1;bq>=0;--bq){bl[bq]=0}bl[bp]=bt;bl.t=bv.t+bp+1;bl.s=bv.s;bl.clamp()}function A(bu,bq){var bl=this;bq.s=bl.s;var br=Math.floor(bu/bl.DB);if(br>=bl.t){bq.t=0;return}var bo=bu%bl.DB;var bn=bl.DB-bo;var bt=(1<<bo)-1;bq[0]=bl[br]>>bo;for(var bp=br+1;bp<bl.t;++bp){bq[bp-br-1]|=(bl[bp]&bt)<<bn;bq[bp-br]=bl[bp]>>bo}if(bo>0){bq[bl.t-br-1]|=(bl.s&bt)<<bn}bq.t=bl.t-br;bq.clamp()}function aK(bm,bp){var bn=this;var bo=0,bq=0,bl=Math.min(bm.t,bn.t);while(bo<bl){bq+=bn[bo]-bm[bo];bp[bo++]=bq&bn.DM;bq>>=bn.DB}if(bm.t<bn.t){bq-=bm.s;while(bo<bn.t){bq+=bn[bo];bp[bo++]=bq&bn.DM;bq>>=bn.DB}bq+=bn.s}else{bq+=bn.s;while(bo<bm.t){bq-=bm[bo];bp[bo++]=bq&bn.DM;bq>>=bn.DB}bq-=bm.s}bp.s=(bq<0)?-1:0;if(bq<-1){bp[bo++]=bn.DV+bq}else{if(bq>0){bp[bo++]=bq}}bp.t=bo;bp.clamp()}function Y(bm,bo){var bl=this.abs(),bp=bm.abs();var bn=bl.t;bo.t=bn+bp.t;while(--bn>=0){bo[bn]=0}for(bn=0;bn<bp.t;++bn){bo[bn+bl.t]=bl.am(0,bp[bn],bo,bn,0,bl.t)}bo.s=0;bo.clamp();if(this.s!=bm.s){a4.ZERO.subTo(bo,bo)}}function ao(bn){var bl=this.abs();var bm=bn.t=2*bl.t;while(--bm>=0){bn[bm]=0}for(bm=0;bm<bl.t-1;++bm){var bo=bl.am(bm,bl[bm],bn,2*bm,0,1);if((bn[bm+bl.t]+=bl.am(bm+1,2*bl[bm],bn,2*bm+1,bo,bl.t-bm-1))>=bl.DV){bn[bm+bl.t]-=bl.DV;bn[bm+bl.t+1]=1}}if(bn.t>0){bn[bn.t-1]+=bl.am(bm,bl[bm],bn,2*bm,0,1)}bn.s=0;bn.clamp()}function Z(bv,bs,bq){var br=this;var bB=bv.abs();if(bB.t<=0){return}var bt=br.abs();if(bt.t<bB.t){if(bs!=null){bs.fromInt(0)}if(bq!=null){br.copyTo(bq)}return}if(bq==null){bq=u()}var bo=u(),bl=br.s,bu=bv.s;var bA=br.DB-z(bB[bB.t-1]);if(bA>0){bB.lShiftTo(bA,bo);bt.lShiftTo(bA,bq)}else{bB.copyTo(bo);bt.copyTo(bq)}var by=bo.t;var bm=bo[by-1];if(bm==0){return}var bw=bm*(1<<br.F1)+((by>1)?bo[by-2]>>br.F2:0);var bE=br.FV/bw,bD=(1<<br.F1)/bw,bC=1<<br.F2;var bz=bq.t,bx=bz-by,bp=(bs==null)?u():bs;bo.dlShiftTo(bx,bp);if(bq.compareTo(bp)>=0){bq[bq.t++]=1;bq.subTo(bp,bq)}a4.ONE.dlShiftTo(by,bp);bp.subTo(bo,bo);while(bo.t<by){bo[bo.t++]=0}while(--bx>=0){var bn=(bq[--bz]==bm)?br.DM:Math.floor(bq[bz]*bE+(bq[bz-1]+bC)*bD);if((bq[bz]+=bo.am(0,bn,bq,bx,0,by))<bn){bo.dlShiftTo(bx,bp);bq.subTo(bp,bq);while(bq[bz]<--bn){bq.subTo(bp,bq)}}}if(bs!=null){bq.drShiftTo(by,bs);if(bl!=bu){a4.ZERO.subTo(bs,bs)}}bq.t=by;bq.clamp();if(bA>0){bq.rShiftTo(bA,bq)}if(bl<0){a4.ZERO.subTo(bq,bq)}}function al(bl){var bm=u();this.abs().divRemTo(bl,null,bm);if(this.s<0&&bm.compareTo(a4.ZERO)>0){bl.subTo(bm,bm)}return bm}function ah(bl){this.m=bl}function aC(bl){if(bl.s<0||bl.compareTo(this.m)>=0){return bl.mod(this.m)}else{return bl}}function aX(bl){return bl}function af(bl){bl.divRemTo(this.m,null,bl)}function ae(bl,bn,bm){bl.multiplyTo(bn,bm);this.reduce(bm)}function a9(bl,bm){bl.squareTo(bm);this.reduce(bm)}ah.prototype.convert=aC;ah.prototype.revert=aX;ah.prototype.reduce=af;ah.prototype.mulTo=ae;ah.prototype.sqrTo=a9;function V(){if(this.t<1){return 0}var bl=this[0];if((bl&1)==0){return 0}var bm=bl&3;bm=(bm*(2-(bl&15)*bm))&15;bm=(bm*(2-(bl&255)*bm))&255;bm=(bm*(2-(((bl&65535)*bm)&65535)))&65535;bm=(bm*(2-bl*bm%this.DV))%this.DV;return(bm>0)?this.DV-bm:-bm}function q(bl){this.m=bl;this.mp=bl.invDigit();this.mpl=this.mp&32767;this.mph=this.mp>>15;this.um=(1<<(bl.DB-15))-1;this.mt2=2*bl.t}function aW(bl){var bm=u();bl.abs().dlShiftTo(this.m.t,bm);bm.divRemTo(this.m,null,bm);if(bl.s<0&&bm.compareTo(a4.ZERO)>0){this.m.subTo(bm,bm)}return bm}function a7(bl){var bm=u();bl.copyTo(bm);this.reduce(bm);return bm}function an(bl){while(bl.t<=this.mt2){bl[bl.t++]=0}for(var bn=0;bn<this.m.t;++bn){var bm=bl[bn]&32767;var bo=(bm*this.mpl+(((bm*this.mph+(bl[bn]>>15)*this.mpl)&this.um)<<15))&bl.DM;bm=bn+this.m.t;bl[bm]+=this.m.am(0,bo,bl,bn,0,this.m.t);while(bl[bm]>=bl.DV){bl[bm]-=bl.DV;bl[++bm]++}}bl.clamp();bl.drShiftTo(this.m.t,bl);if(bl.compareTo(this.m)>=0){bl.subTo(this.m,bl)}}function aZ(bl,bm){bl.squareTo(bm);this.reduce(bm)}function S(bl,bn,bm){bl.multiplyTo(bn,bm);this.reduce(bm)}q.prototype.convert=aW;q.prototype.revert=a7;q.prototype.reduce=an;q.prototype.mulTo=S;q.prototype.sqrTo=aZ;function v(){return((this.t>0)?(this[0]&1):this.s)==0}function N(bq,br){if(bq>4294967295||bq<1){return a4.ONE}var bp=u(),bl=u(),bo=br.convert(this),bn=z(bq)-1;bo.copyTo(bp);while(--bn>=0){br.sqrTo(bp,bl);if((bq&(1<<bn))>0){br.mulTo(bl,bo,bp)}else{var bm=bp;bp=bl;bl=bm}}return br.revert(bp)}function a1(bm,bl){var bn;if(bm<256||bl.isEven()){bn=new ah(bl)}else{bn=new q(bl)}return this.exp(bm,bn)}be.copyTo=aH;be.fromInt=D;be.fromString=M;be.clamp=am;be.dlShiftTo=a3;be.drShiftTo=aG;be.lShiftTo=H;be.rShiftTo=A;be.subTo=aK;be.multiplyTo=Y;be.squareTo=ao;be.divRemTo=Z;be.invDigit=V;be.isEven=v;be.exp=N;be.toString=F;be.negate=aq;be.abs=aY;be.compareTo=ad;be.bitLength=I;be.mod=al;be.modPowInt=a1;function u(){return new a4(null)}function s(){var bl=u();this.copyTo(bl);return bl}function ab(){if(this.s<0){if(this.t==1){return this[0]-this.DV}else{if(this.t==0){return -1}}}else{if(this.t==1){return this[0]}else{if(this.t==0){return 0}}}return((this[1]&((1<<(32-this.DB))-1))<<this.DB)|this[0]}function aS(){return(this.t==0)?this.s:(this[0]<<24)>>24}function ap(){return(this.t==0)?this.s:(this[0]<<16)>>16}function aF(bl){return Math.floor(Math.LN2*this.DB/Math.log(bl))}function a5(){if(this.s<0){return -1}else{if(this.t<=0||(this.t==1&&this[0]<=0)){return 0}else{return 1}}}function Q(bl){if(bl==null){bl=10}if(this.signum()==0||bl<2||bl>36){return"0"}var bn=this.chunkSize(bl);var bm=Math.pow(bl,bn);var bq=m(bm),br=u(),bp=u(),bo="";this.divRemTo(bq,br,bp);while(br.signum()>0){bo=(bm+bp.intValue()).toString(bl).substr(1)+bo;br.divRemTo(bq,br,bp)}return bp.intValue().toString(bl)+bo}function aw(bu,bq){var bt=this;bt.fromInt(0);if(bq==null){bq=10}var bo=bt.chunkSize(bq);var bp=Math.pow(bq,bo),bn=false,bl=0,bs=0;for(var bm=0;bm<bu.length;++bm){var br=T(bu,bm);if(br<0){if(bu.charAt(bm)=="-"&&bt.signum()==0){bn=true}continue}bs=bq*bs+br;if(++bl>=bo){bt.dMultiply(bp);bt.dAddOffset(bs,0);bl=0;bs=0}}if(bl>0){bt.dMultiply(Math.pow(bq,bl));bt.dAddOffset(bs,0)}if(bn){a4.ZERO.subTo(bt,bt)}}function aP(bn,bm,bq){var bo=this;if("number"==typeof bm){if(bn<2){bo.fromInt(1)}else{bo.fromNumber(bn,bq);if(!bo.testBit(bn-1)){bo.bitwiseTo(a4.ONE.shiftLeft(bn-1),ai,bo)}if(bo.isEven()){bo.dAddOffset(1,0)}while(!bo.isProbablePrime(bm)){bo.dAddOffset(2,0);if(bo.bitLength()>bn){bo.subTo(a4.ONE.shiftLeft(bn-1),bo)}}}}else{var bl=new Array(),bp=bn&7;bl.length=(bn>>3)+1;bm.nextBytes(bl);if(bp>0){bl[0]&=((1<<bp)-1)}else{bl[0]=0}bo.fromString(bl,256)}}function bd(){var bm=this;var bn=bm.t,bo=new Array();bo[0]=bm.s;var bp=bm.DB-(bn*bm.DB)%8,bq,bl=0;if(bn-->0){if(bp<bm.DB&&(bq=bm[bn]>>bp)!=(bm.s&bm.DM)>>bp){bo[bl++]=bq|(bm.s<<(bm.DB-bp))}while(bn>=0){if(bp<8){bq=(bm[bn]&((1<<bp)-1))<<(8-bp);bq|=bm[--bn]>>(bp+=bm.DB-8)}else{bq=(bm[bn]>>(bp-=8))&255;if(bp<=0){bp+=bm.DB;--bn}}if((bq&128)!=0){bq|=-256}if(bl===0&&(bm.s&128)!=(bq&128)){++bl}if(bl>0||bq!=bm.s){bo[bl++]=bq}}}return bo}function au(bl){return(this.compareTo(bl)==0)}function ac(bl){return(this.compareTo(bl)<0)?this:bl}function aA(bl){return(this.compareTo(bl)>0)?this:bl}function aQ(bm,br,bp){var bn=this;var bo,bq,bl=Math.min(bm.t,bn.t);for(bo=0;bo<bl;++bo){bp[bo]=br(bn[bo],bm[bo])}if(bm.t<bn.t){bq=bm.s&bn.DM;for(bo=bl;bo<bn.t;++bo){bp[bo]=br(bn[bo],bq)}bp.t=bn.t}else{bq=bn.s&bn.DM;for(bo=bl;bo<bm.t;++bo){bp[bo]=br(bq,bm[bo])}bp.t=bm.t}bp.s=br(bn.s,bm.s);bp.clamp()}function R(bl,bm){return bl&bm}function bg(bl){var bm=u();this.bitwiseTo(bl,R,bm);return bm}function ai(bl,bm){return bl|bm}function aE(bl){var bm=u();this.bitwiseTo(bl,ai,bm);return bm}function W(bl,bm){return bl^bm}function o(bl){var bm=u();this.bitwiseTo(bl,W,bm);return bm}function K(bl,bm){return bl&~bm}function B(bl){var bm=u();this.bitwiseTo(bl,K,bm);return bm}function X(){var bm=u();for(var bl=0;bl<this.t;++bl){bm[bl]=this.DM&~this[bl]}bm.t=this.t;bm.s=~this.s;return bm}function L(bm){var bl=u();if(bm<0){this.rShiftTo(-bm,bl)}else{this.lShiftTo(bm,bl)}return bl}function bf(bm){var bl=u();if(bm<0){this.lShiftTo(-bm,bl)}else{this.rShiftTo(bm,bl)}return bl}function x(bl){if(bl==0){return -1}var bm=0;if((bl&65535)==0){bl>>=16;bm+=16}if((bl&255)==0){bl>>=8;bm+=8}if((bl&15)==0){bl>>=4;bm+=4}if((bl&3)==0){bl>>=2;bm+=2}if((bl&1)==0){++bm}return bm}function E(){for(var bl=0;bl<this.t;++bl){if(this[bl]!=0){return bl*this.DB+x(this[bl])}}if(this.s<0){return this.t*this.DB}return -1}function a0(bl){var bm=0;while(bl!=0){bl&=bl-1;++bm}return bm}function aO(){var bn=0,bl=this.s&this.DM;for(var bm=0;bm<this.t;++bm){bn+=a0(this[bm]^bl)}return bn}function aM(bm){var bl=Math.floor(bm/this.DB);if(bl>=this.t){return(this.s!=0)}return((this[bl]&(1<<(bm%this.DB)))!=0)}function aa(bn,bm){var bl=a4.ONE.shiftLeft(bn);this.bitwiseTo(bl,bm,bl);return bl}function U(bl){return this.changeBit(bl,ai)}function C(bl){return this.changeBit(bl,K)}function l(bl){return this.changeBit(bl,W)}function ax(bm,bp){var bn=this;var bo=0,bq=0,bl=Math.min(bm.t,bn.t);while(bo<bl){bq+=bn[bo]+bm[bo];bp[bo++]=bq&bn.DM;bq>>=bn.DB}if(bm.t<bn.t){bq+=bm.s;while(bo<bn.t){bq+=bn[bo];bp[bo++]=bq&bn.DM;bq>>=bn.DB}bq+=bn.s}else{bq+=bn.s;while(bo<bm.t){bq+=bm[bo];bp[bo++]=bq&bn.DM;bq>>=bn.DB}bq+=bm.s}bp.s=(bq<0)?-1:0;if(bq>0){bp[bo++]=bq}else{if(bq<-1){bp[bo++]=bn.DV+bq}}bp.t=bo;bp.clamp()}function az(bl){var bm=u();this.addTo(bl,bm);return bm}function a6(bl){var bm=u();this.subTo(bl,bm);return bm}function at(bl){var bm=u();this.multiplyTo(bl,bm);return bm}function aL(){var bl=u();this.squareTo(bl);return bl}function n(bl){var bm=u();this.divRemTo(bl,bm,null);return bm}function r(bl){var bm=u();this.divRemTo(bl,null,bm);return bm}function aN(bl){var bn=u(),bm=u();this.divRemTo(bl,bn,bm);return new Array(bn,bm)}function w(bl){this[this.t]=this.am(0,bl-1,this,0,0,this.t);++this.t;this.clamp()}function ak(bm,bl){if(bm==0){return}while(this.t<=bl){this[this.t++]=0}this[bl]+=bm;while(this[bl]>=this.DV){this[bl]-=this.DV;if(++bl>=this.t){this[this.t++]=0}++this[bl]}}function ay(){}function aT(bl){return bl}function y(bl,bn,bm){bl.multiplyTo(bn,bm)}function aD(bl,bm){bl.squareTo(bm)}ay.prototype.convert=aT;ay.prototype.revert=aT;ay.prototype.mulTo=y;ay.prototype.sqrTo=aD;function O(bl){return this.exp(bl,new ay())}function t(bl,bp,bo){var bn=Math.min(this.t+bl.t,bp);bo.s=0;bo.t=bn;while(bn>0){bo[--bn]=0}var bm;for(bm=bo.t-this.t;bn<bm;++bn){bo[bn+this.t]=this.am(0,bl[bn],bo,bn,0,this.t)}for(bm=Math.min(bl.t,bp);bn<bm;++bn){this.am(0,bl[bn],bo,bn,0,bp-bn)}bo.clamp()}function p(bl,bo,bn){--bo;var bm=bn.t=this.t+bl.t-bo;bn.s=0;while(--bm>=0){bn[bm]=0}for(bm=Math.max(bo-this.t,0);bm<bl.t;++bm){bn[this.t+bm-bo]=this.am(bo-bm,bl[bm],bn,0,0,this.t+bm-bo)}bn.clamp();bn.drShiftTo(1,bn)}function P(bl){this.r2=u();this.q3=u();a4.ONE.dlShiftTo(2*bl.t,this.r2);this.mu=this.r2.divide(bl);this.m=bl}function ag(bl){if(bl.s<0||bl.t>2*this.m.t){return bl.mod(this.m)}else{if(bl.compareTo(this.m)<0){return bl}else{var bm=u();bl.copyTo(bm);this.reduce(bm);return bm}}}function aj(bl){return bl}function ba(bl){var bm=this;bl.drShiftTo(bm.m.t-1,bm.r2);if(bl.t>bm.m.t+1){bl.t=bm.m.t+1;bl.clamp()}bm.mu.multiplyUpperTo(bm.r2,bm.m.t+1,bm.q3);bm.m.multiplyLowerTo(bm.q3,bm.m.t+1,bm.r2);while(bl.compareTo(bm.r2)<0){bl.dAddOffset(1,bm.m.t+1)}bl.subTo(bm.r2,bl);while(bl.compareTo(bm.m)>=0){bl.subTo(bm.m,bl)}}function av(bl,bm){bl.squareTo(bm);this.reduce(bm)}function bb(bl,bn,bm){bl.multiplyTo(bn,bm);this.reduce(bm)}P.prototype.convert=ag;P.prototype.revert=aj;P.prototype.reduce=ba;P.prototype.mulTo=bb;P.prototype.sqrTo=av;function aB(bu,bp){var bs=bu.bitLength(),bq,bm=m(1),bx;if(bs<=0){return bm}else{if(bs<18){bq=1}else{if(bs<48){bq=3}else{if(bs<144){bq=4}else{if(bs<768){bq=5}else{bq=6}}}}}if(bs<8){bx=new ah(bp)}else{if(bp.isEven()){bx=new P(bp)}else{bx=new q(bp)}}var bt=new Array(),bo=3,bv=bq-1,bl=(1<<bq)-1;bt[1]=bx.convert(this);if(bq>1){var bA=u();bx.sqrTo(bt[1],bA);while(bo<=bl){bt[bo]=u();bx.mulTo(bA,bt[bo-2],bt[bo]);bo+=2}}var br=bu.t-1,by,bw=true,bn=u(),bz;bs=z(bu[br])-1;while(br>=0){if(bs>=bv){by=(bu[br]>>(bs-bv))&bl}else{by=(bu[br]&((1<<(bs+1))-1))<<(bv-bs);if(br>0){by|=bu[br-1]>>(this.DB+bs-bv)}}bo=bq;while((by&1)==0){by>>=1;--bo}if((bs-=bo)<0){bs+=this.DB;--br}if(bw){bt[by].copyTo(bm);bw=false}else{while(bo>1){bx.sqrTo(bm,bn);bx.sqrTo(bn,bm);bo-=2}if(bo>0){bx.sqrTo(bm,bn)}else{bz=bm;bm=bn;bn=bz}bx.mulTo(bn,bt[by],bm)}while(br>=0&&(bu[br]&(1<<bs))==0){bx.sqrTo(bm,bn);bz=bm;bm=bn;bn=bz;if(--bs<0){bs=this.DB-1;--br}}}return bx.revert(bm)}function a8(bm){var bl=(this.s<0)?this.negate():this.clone();var bq=(bm.s<0)?bm.negate():bm.clone();if(bl.compareTo(bq)<0){var bo=bl;bl=bq;bq=bo}var bn=bl.getLowestSetBit(),bp=bq.getLowestSetBit();if(bp<0){return bl}if(bn<bp){bp=bn}if(bp>0){bl.rShiftTo(bp,bl);bq.rShiftTo(bp,bq)}while(bl.signum()>0){if((bn=bl.getLowestSetBit())>0){bl.rShiftTo(bn,bl)}if((bn=bq.getLowestSetBit())>0){bq.rShiftTo(bn,bq)}if(bl.compareTo(bq)>=0){bl.subTo(bq,bl);bl.rShiftTo(1,bl)}else{bq.subTo(bl,bq);bq.rShiftTo(1,bq)}}if(bp>0){bq.lShiftTo(bp,bq)}return bq}function G(bo){if(bo<=0){return 0}var bn=this.DV%bo,bm=(this.s<0)?bo-1:0;if(this.t>0){if(bn==0){bm=this[0]%bo}else{for(var bl=this.t-1;bl>=0;--bl){bm=(bn*bm+this[bl])%bo}}}return bm}function k(bm){var bq=bm.isEven();if((this.isEven()&&bq)||bm.signum()==0){return a4.ZERO}var bp=bm.clone(),bo=this.clone();var bn=m(1),bl=m(0),bs=m(0),br=m(1);while(bp.signum()!=0){while(bp.isEven()){bp.rShiftTo(1,bp);if(bq){if(!bn.isEven()||!bl.isEven()){bn.addTo(this,bn);bl.subTo(bm,bl)}bn.rShiftTo(1,bn)}else{if(!bl.isEven()){bl.subTo(bm,bl)}}bl.rShiftTo(1,bl)}while(bo.isEven()){bo.rShiftTo(1,bo);if(bq){if(!bs.isEven()||!br.isEven()){bs.addTo(this,bs);br.subTo(bm,br)}bs.rShiftTo(1,bs)}else{if(!br.isEven()){br.subTo(bm,br)}}br.rShiftTo(1,br)}if(bp.compareTo(bo)>=0){bp.subTo(bo,bp);if(bq){bn.subTo(bs,bn)}bl.subTo(br,bl)}else{bo.subTo(bp,bo);if(bq){bs.subTo(bn,bs)}br.subTo(bl,br)}}if(bo.compareTo(a4.ONE)!=0){return a4.ZERO}if(br.compareTo(bm)>=0){return br.subtract(bm)}if(br.signum()<0){br.addTo(bm,br)}else{return br}if(br.signum()<0){return br.add(bm)}else{return br}}be.chunkSize=aF;be.toRadix=Q;be.fromRadix=aw;be.fromNumber=aP;be.bitwiseTo=aQ;be.changeBit=aa;be.addTo=ax;be.dMultiply=w;be.dAddOffset=ak;be.multiplyLowerTo=t;be.multiplyUpperTo=p;be.modInt=G;be.clone=s;be.intValue=ab;be.byteValue=aS;be.shortValue=ap;be.signum=a5;be.toByteArray=bd;be.equals=au;be.min=ac;be.max=aA;be.and=bg;be.or=aE;be.xor=o;be.andNot=B;be.not=X;be.shiftLeft=L;be.shiftRight=bf;be.getLowestSetBit=E;be.bitCount=aO;be.testBit=aM;be.setBit=U;be.clearBit=C;be.flipBit=l;be.add=az;be.subtract=a6;be.multiply=at;be.divide=n;be.remainder=r;be.divideAndRemainder=aN;be.modPow=aB;be.modInverse=k;be.pow=O;be.gcd=a8;be.square=aL;a4.ZERO=m(0);a4.ONE=m(1);a4.valueOf=m;a4.fromByteArrayUnsigned=function(bl){if(!bl.length){return new a4.valueOf(0)}else{if(bl[0]&128){return new a4([0].concat(bl))}else{return new a4(bl)}}};a4.fromByteArraySigned=function(bl){if(bl[0]&128){bl[0]&=127;return a4.fromByteArrayUnsigned(bl).negate()}else{return a4.fromByteArrayUnsigned(bl)}};a4.prototype.toByteArrayUnsigned=function(){var bm=this.abs().toByteArray();if(!bm.length){return bm}if(bm[0]===0){bm=bm.slice(1)}for(var bl=0;bl<bm.length;++bl){bm[bl]=(bm[bl]<0)?bm[bl]+256:bm[bl]}return bm};a4.prototype.toByteArraySigned=function(){var bl=this.toByteArrayUnsigned();var bm=this.s<0;if(bl[0]&128){bl.unshift((bm)?128:0)}else{if(bm){bl[0]|=128}}return bl};bc.set("cipher.asymmetric.ec.bigi",a4)})(a);(function(k){function j(p,o){var l=p.ECPointFp;function m(w,s,v,r){var q=Math.max(s.bitLength(),r.bitLength());var x=w.add2D(v);var u=w.curve.getInfinity();for(var t=q-1;t>=0;--t){u=u.twice2D();u.z=o.ONE;if(s.testBit(t)){if(r.testBit(t)){u=u.add2D(x)}else{u=u.add2D(w)}}else{if(r.testBit(t)){u=u.add2D(v)}}}return u}function n(x){var z=this;var y=null;var w=new k.get("util.srand")();var q={nextBytes:function(A){var C=w.bytes(A.length);for(var B=0;B<C.length;++B){A[B]=C[B]}}};this.sign=function(D,J){var H=J;var B=x.getN();var F=o.fromByteArrayUnsigned(D);var C=u(B);var I=x.getG();var E=I.multiply(C);var A=E.getX().toBigInteger().mod(B);var K=C.modInverse(B).multiply(F.add(H.multiply(A))).mod(B);if(K.compareTo(B.divide(o.valueOf(2)))>0){K=B.subtract(K)}return r(A,K)};this.verify=function(G,H,B){var D,A;if(Array.isArray(H)){var F=t(H);D=F.r;A=F.s}else{throw new Error("Invalid value for signature")}var C;if(B instanceof l){C=B}else{if(Array.isArray(B)){C=l.decodeFrom(x.getCurve(),B)}else{throw new Error("Invalid format for pubkey value, must be byte array or ECPointFp")}}var E=o.fromByteArrayUnsigned(G);return v(E,D,A,C)};function v(F,A,L,E){var D=x.getN();var K=x.getG();if(A.compareTo(o.ONE)<0||A.compareTo(D)>=0){return false}if(L.compareTo(o.ONE)<0||L.compareTo(D)>=0){return false}var H=L.modInverse(D);var C=F.multiply(H).mod(D);var B=A.multiply(H).mod(D);var I=K.multiply(C).add(E.multiply(B));var J=I.getX().toBigInteger().mod(D);return J.equals(A)}function s(D){if(D.length!==65){throw new Error("Signature has the wrong length")}var A=D[0]-27;if(A<0||A>7){throw new Error("Invalid signature type")}var E=x.getN();var C=o.fromByteArrayUnsigned(D.slice(1,33)).mod(E);var B=o.fromByteArrayUnsigned(D.slice(33,65)).mod(E);return{r:C,s:B,i:A}}function u(A){return new o(A.bitLength(),q).mod(A.subtract(o.ONE)).add(o.ONE)}function r(C,B){var D=C.toByteArraySigned();var A=B.toByteArraySigned();var E=[];E.push(2);E.push(D.length);E=E.concat(D);E.push(2);E.push(A.length);E=E.concat(A);E.unshift(E.length);E.unshift(48);return E}function t(F){var E;if(F[0]!=48){throw new Error("Signature not a valid DERSequence")}E=2;if(F[E]!=2){throw new Error("First element in signature must be a DERInteger")}var D=F.slice(E+2,E+2+F[E+1]);E+=2+F[E+1];if(F[E]!=2){throw new Error("Second element in signature must be a DERInteger")}var A=F.slice(E+2,E+2+F[E+1]);E+=2+F[E+1];var C=o.fromByteArrayUnsigned(D);var B=o.fromByteArrayUnsigned(A);return{r:C,s:B}}return this}return n}k.set("cipher.asymmetric.ec.ecdsa",function(m){var l=j(k.get("cipher.asymmetric.ec.ecurve"),k.get("cipher.asymmetric.ec.bigi"));return new l(m)})})(a);(function(j){function k(r){var v=this;var q=j.get("cipher.asymmetric.ec.ecparams"),n=j.get("cipher.asymmetric.ec.ecdsa"),s=j.get("cipher.asymmetric.ec.ecurve"),p=j.get("cipher.asymmetric.ec.bigi");var C=null,B=null;var D=q(r);if(!D){throw Error("unknown-ec-curve-name")}var u=n(D);function y(G){var H=new Array(G.length);for(var F=0;F<H.length;F++){H[F]=G[F]}return H}this.setPrivateKey=function(F){A(j.get("util.encoding")(F).toArray())};this.setPublicKey=function(F){x(j.get("util.encoding")(F).toArray())};function z(F){if(F){v.sign=E;v.decrypt=o;v._computeSecret=t}v.verify=m;v.encrypt=w;v.getPublicKey=function(){return new Uint8Array(B).buffer};delete v.setPrivateKey;delete v.setPublicKey}function x(F){C=null;B=F;z(false)}function A(G){C=p.fromByteArrayUnsigned(G);var F=D.getG().multiply(C);B=F.getEncoded(false);z(true)}function E(G){if(!j.get("util.type")(G).isArrayBuffer()){throw new Error("invalid-parameter")}var F=u.sign(j.get("util.encoding")(G).toArray(),C);return j.get("util.encoding")(F).toArrayBuffer()}function m(G,I){if(!(j.get("util.type")(G).isArrayBuffer()&&j.get("util.type")(I).isArrayBuffer())){throw new Error("invalid-parameter")}try{var J=j.get("util.encoding")(I).toArray(),K=j.get("util.encoding")(G).toArray();var F=u.verify(K,J,B)}catch(H){console.log(H);return false}return F}function t(G){if(!j.get("util.type")(G).isArrayBuffer()){throw Error("invalid-parameter")}var F=j.get("util.encoding")(G).toArray();var I=s.ECPointFp.decodeFrom(D.getCurve(),F);var H=I.multiply(C);var J=H.getEncoded().slice(1);return j.get("util.encoding")(J).toArrayBuffer()}function w(I){if(!j.get("util.type")(I).isArrayBuffer()){throw new Error("invalid-parameter")}var H=new k(r);H.setPrivateKey(new j.get("util.srand")().bytes(64));var L=H._computeSecret(v.getPublicKey()),K=H.getPublicKey();var F=new j.get("cipher.symmetric")().key(L),J=F.encrypt(I);var G=new Uint16Array([K.byteLength]);return j.get("util.buffer").concat([G.buffer,K,J])}function o(J){if(!(j.get("util.type")(J).isArrayBuffer()&&J.byteLength>2)){throw new Error("invalid-parameter")}var F=J.slice(0,2),J=J.slice(2);var H=new Uint16Array(F)[0];if(J.length<=H){throw new Error("invalid-ciphertext")}var M=J.slice(0,H),K=J.slice(H);var L=t(M);var I=new j.get("cipher.symmetric")().key(L);var G=I.decrypt(K);return G}return this}var l={name:"EC",constructor:function(m){return new k(m.curve)}};j.set("cipher.asymmetric.ec",l)})(a);(function(r){var l,j;"use strict";function t(w,v,x,u){this.curve=w;this.g=v;this.n=x;this.h=u}t.prototype.getCurve=function s(){return this.curve};t.prototype.getG=function q(){return this.g};t.prototype.getN=function m(){return this.n};t.prototype.getH=function o(){return this.h};function p(u){u=u.replace(/[^0-9a-f]/ig,"").toUpperCase();return new l(u,16)}var n={secp128r1:function(){var y=p("FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFF");var v=p("FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFC");var u=p("E87579C11079F43DD824993C2CEE5ED3");var A=p("FFFFFFFE0000000075A30D1B9038A115");var x=l.ONE;var z=new j(y,v,u);var w=z.decodePointHex("04161FF7528B899B2D0C28607CA52C5B86CF5AC8395BAFEB13C02DA292DDED7A83");return new t(z,w,A,x)},secp160k1:function(){var y=p("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFAC73");var v=l.ZERO;var u=p("7");var A=p("0100000000000000000001B8FA16DFAB9ACA16B6B3");var x=l.ONE;var z=new j(y,v,u);var w=z.decodePointHex("043B4C382CE37AA192A4019E763036F4F5DD4D7EBB938CF935318FDCED6BC28286531733C3F03C4FEE");return new t(z,w,A,x)},secp160r1:function(){var y=p("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFF");var v=p("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFC");var u=p("1C97BEFC54BD7A8B65ACF89F81D4D4ADC565FA45");var A=p("0100000000000000000001F4C8F927AED3CA752257");var x=l.ONE;var z=new j(y,v,u);var w=z.decodePointHex("044A96B5688EF573284664698968C38BB913CBFC8223A628553168947D59DCC912042351377AC5FB32");return new t(z,w,A,x)},secp192k1:function(){var y=p("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFEE37");var v=l.ZERO;var u=p("3");var A=p("FFFFFFFFFFFFFFFFFFFFFFFE26F2FC170F69466A74DEFD8D");var x=l.ONE;var z=new j(y,v,u);var w=z.decodePointHex("04DB4FF10EC057E9AE26B07D0280B7F4341DA5D1B1EAE06C7D9B2F2F6D9C5628A7844163D015BE86344082AA88D95E2F9D");return new t(z,w,A,x)},secp192r1:function(){var y=p("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFF");var v=p("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFC");var u=p("64210519E59C80E70FA7E9AB72243049FEB8DEECC146B9B1");var A=p("FFFFFFFFFFFFFFFFFFFFFFFF99DEF836146BC9B1B4D22831");var x=l.ONE;var z=new j(y,v,u);var w=z.decodePointHex("04188DA80EB03090F67CBF20EB43A18800F4FF0AFD82FF101207192B95FFC8DA78631011ED6B24CDD573F977A11E794811");return new t(z,w,A,x)},secp224r1:function(){var y=p("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF000000000000000000000001");var v=p("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFE");var u=p("B4050A850C04B3ABF54132565044B0B7D7BFD8BA270B39432355FFB4");var A=p("FFFFFFFFFFFFFFFFFFFFFFFFFFFF16A2E0B8F03E13DD29455C5C2A3D");var x=l.ONE;var z=new j(y,v,u);var w=z.decodePointHex("04B70E0CBD6BB4BF7F321390B94A03C1D356C21122343280D6115C1D21BD376388B5F723FB4C22DFE6CD4375A05A07476444D5819985007E34");return new t(z,w,A,x)},secp256k1:function(){var y=p("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F");var v=l.ZERO;var u=p("7");var A=p("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141");var x=l.ONE;var z=new j(y,v,u);var w=z.decodePointHex("0479BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8");return new t(z,w,A,x)},secp256r1:function(){var y=p("FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF");var v=p("FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC");var u=p("5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B");var A=p("FFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551");var x=l.ONE;var z=new j(y,v,u);var w=z.decodePointHex("046B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C2964FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5");return new t(z,w,A,x)},secp384r1:function(){var y=p("FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFe FFFFFFFF 00000000 00000000 FFFFFFFF");var v=p("FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFe FFFFFFFF 00000000 00000000 FFFFFFFC");var u=p("B3312FA7 E23EE7E4 988E056B E3F82D19 181D9C6E FE814112 0314088F 5013875A C656398D 8A2ED19D 2A85C8ED D3EC2AEF");var A=p("FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF C7634D81 F4372DDF 581A0DB2 48B0A77A ECEC196A CCC52973");var x=l.ONE;var z=new j(y,v,u);var w=z.decodePointHex("04AA87CA22 BE8B0537 8EB1C71E F320AD74 6E1D3B62 8BA79B98 59F741E0 82542A38 5502F25D BF55296C 3A545E38 72760AB73617DE4A 96262C6F 5D9E98BF 9292DC29 F8F41DBD 289A147C E9DA3113 B5F0B8C0 0A60B1CE 1D7E819D 7A431D7C 90EA0E5F");return new t(z,w,A,x)},secp521r1:function(){var y=p("    01FF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFF FFFFFFFF");var v=p("    01FF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFF FFFFFFFC");var u=p("    0051 953EB961 8E1C9A1F 929A21A0 B68540EE A2DA725B 99B315F3B8B48991 8EF109E1 56193951 EC7E937B 1652C0BD 3BB1BF07 3573DF883D2C34F1 EF451FD4 6B503F00");var A=p("    01FF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFA 51868783 BF2F966B 7FCC0148 F709A5D0 3BB5C9B8899C47AE BB6FB71E 91386409");var x=l.ONE;var z=new j(y,v,u);var w=z.decodePointHex("      04 00C6858E 06B70404 E9CD9E3E CB662395 B4429C64 8139053FB521F828 AF606B4D 3DBAA14B 5E77EFE7 5928FE1D C127A2FF A8DE3348B3C1856A 429BF97E 7E31C2E5 BD660118 39296A78 9A3BC004 5C8A5FB42C7D1BD9 98F54449 579B4468 17AFBD17 273E662C 97EE7299 5EF42640C550B901 3FAD0761 353C7086 A272C240 88BE9476 9FD16650");return new t(z,w,A,x)}};r.set("cipher.asymmetric.ec.ecparams",function k(u){if(!l){l=r.get("cipher.asymmetric.ec.bigi"),j=r.get("cipher.asymmetric.ec.ecurve")}return(typeof n[u]=="function")?n[u]():null})})(a);"use strict";(function(j){var p;function n(s,q){var r=s.toByteArrayUnsigned();if(q<r.length){r=r.slice(r.length-q)}else{while(q>r.length){r.unshift(0)}}return r}var m=function m(s,r){this.x=r;this.q=s};m.prototype.equals=function(q){if(q==this){return true}return(this.q.equals(q.q)&&this.x.equals(q.x))};m.prototype.toBigInteger=function(){return this.x};m.prototype.negate=function(){return new m(this.q,this.x.negate().mod(this.q))};m.prototype.add=function(q){return new m(this.q,this.x.add(q.toBigInteger()).mod(this.q))};m.prototype.subtract=function(q){return new m(this.q,this.x.subtract(q.toBigInteger()).mod(this.q))};m.prototype.multiply=function(q){return new m(this.q,this.x.multiply(q.toBigInteger()).mod(this.q))};m.prototype.square=function(){return new m(this.q,this.x.square().mod(this.q))};m.prototype.divide=function k(q){return new m(this.q,this.x.multiply(q.toBigInteger().modInverse(this.q)).mod(this.q))};m.prototype.getByteLength=function(){return Math.floor((this.toBigInteger().bitLength()+7)/8)};var l=function l(s,q,t,r){if(!p){p=j.get("cipher.asymmetric.ec.bigi")}this.curve=s;this.x=q;this.y=t;if(r==null){this.z=p.ONE}else{this.z=r}this.zinv=null};l.prototype.getX=function(){if(this.zinv==null){this.zinv=this.z.modInverse(this.curve.q)}return this.curve.fromBigInteger(this.x.toBigInteger().multiply(this.zinv).mod(this.curve.q))};l.prototype.getY=function(){if(this.zinv==null){this.zinv=this.z.modInverse(this.curve.q)}return this.curve.fromBigInteger(this.y.toBigInteger().multiply(this.zinv).mod(this.curve.q))};l.prototype.equals=function(q){if(q==this){return true}if(this.isInfinity()){return q.isInfinity()}if(q.isInfinity()){return this.isInfinity()}var s,r;s=q.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(q.z)).mod(this.curve.q);if(!s.equals(p.ZERO)){return false}r=q.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(q.z)).mod(this.curve.q);return r.equals(p.ZERO)};l.prototype.isInfinity=function(){if((this.x==null)&&(this.y==null)){return true}return this.z.equals(p.ZERO)&&!this.y.toBigInteger().equals(p.ZERO)};l.prototype.negate=function(){return new l(this.curve,this.x,this.y.negate(),this.z)};l.prototype.add=function(C){if(this.isInfinity()){return C}if(C.isInfinity()){return this}var G=C.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(C.z)).mod(this.curve.q);var F=C.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(C.z)).mod(this.curve.q);if(p.ZERO.equals(F)){if(p.ZERO.equals(G)){return this.twice()}return this.curve.getInfinity()}var A=new p("3");var t=this.x.toBigInteger();var E=this.y.toBigInteger();var r=C.x.toBigInteger();var B=C.y.toBigInteger();var D=F.square();var z=D.multiply(F);var s=t.multiply(D);var x=G.square().multiply(this.z);var q=x.subtract(s.shiftLeft(1)).multiply(C.z).subtract(z).multiply(F).mod(this.curve.q);var y=s.multiply(A).multiply(G).subtract(E.multiply(z)).subtract(x.multiply(G)).multiply(C.z).add(G.multiply(z)).mod(this.curve.q);var w=z.multiply(this.z).multiply(C.z).mod(this.curve.q);return new l(this.curve,this.curve.fromBigInteger(q),this.curve.fromBigInteger(y),w)};l.prototype.twice=function(){if(this.isInfinity()){return this}if(this.y.toBigInteger().signum()==0){return this.curve.getInfinity()}var v=new p("3");var r=this.x.toBigInteger();var x=this.y.toBigInteger();var t=x.multiply(this.z);var z=t.multiply(x).mod(this.curve.q);var y=this.curve.a.toBigInteger();var A=r.square().multiply(v);if(!p.ZERO.equals(y)){A=A.add(this.z.square().multiply(y))}A=A.mod(this.curve.q);var q=A.square().subtract(r.shiftLeft(3).multiply(z)).shiftLeft(1).multiply(t).mod(this.curve.q);var u=A.multiply(v).multiply(r).subtract(z.shiftLeft(1)).shiftLeft(2).multiply(z).subtract(A.square().multiply(A)).mod(this.curve.q);var s=t.square().multiply(t).shiftLeft(3).mod(this.curve.q);return new l(this.curve,this.curve.fromBigInteger(q),this.curve.fromBigInteger(u),s)};l.prototype.multiply=function(r){if(this.isInfinity()){return this}if(r.signum()==0){return this.curve.getInfinity()}var v=r;var u=v.multiply(new p("3"));var x=this.negate();var t=this;var s;for(s=u.bitLength()-2;s>0;--s){t=t.twice();var q=u.testBit(s);var w=v.testBit(s);if(q!=w){t=t.add(q?this:x)}}return t};l.prototype.multiplyTwo=function(s,q,r){var t;if(s.bitLength()>r.bitLength()){t=s.bitLength()-1}else{t=r.bitLength()-1}var v=this.curve.getInfinity();var u=this.add(q);while(t>=0){v=v.twice();if(s.testBit(t)){if(r.testBit(t)){v=v.add(u)}else{v=v.add(this)}}else{if(r.testBit(t)){v=v.add(q)}}--t}return v};l.prototype.getEncoded=function(t){if(this.isInfinity()){return[0]}var q=this.getX().toBigInteger();var u=this.getY().toBigInteger();var s=Math.floor((this.curve.getQ().bitLength()+7)/8);var r=n(q,s);if(t){if(u.isEven()){r.unshift(2)}else{r.unshift(3)}}else{r.unshift(4);r=r.concat(n(u,s))}return r};l.decodeFrom=function(w,s){var v=s[0];var u=s.length-1;var t=s.slice(1,1+u/2);var r=s.slice(1+u/2,1+u);t.unshift(0);r.unshift(0);var q=new p(t);var z=new p(r);return new l(w,w.fromBigInteger(q),w.fromBigInteger(z))};l.prototype.add2D=function(r){if(this.isInfinity()){return r}if(r.isInfinity()){return this}if(this.x.equals(r.x)){if(this.y.equals(r.y)){return this.twice()}return this.curve.getInfinity()}var v=r.x.subtract(this.x);var t=r.y.subtract(this.y);var q=t.divide(v);var s=q.square().subtract(this.x).subtract(r.x);var u=q.multiply(this.x.subtract(s)).subtract(this.y);return new l(this.curve,s,u)};l.prototype.twice2D=function(){if(this.isInfinity()){return this}if(this.y.toBigInteger().signum()==0){return this.curve.getInfinity()}var r=this.curve.fromBigInteger(p.valueOf(2));var u=this.curve.fromBigInteger(p.valueOf(3));var q=this.x.square().multiply(u).add(this.curve.a).divide(this.y.multiply(r));var s=q.square().subtract(this.x.multiply(r));var t=q.multiply(this.x.subtract(s)).subtract(this.y);return new l(this.curve,s,t)};l.prototype.multiply2D=function(r){if(this.isInfinity()){return this}if(r.signum()==0){return this.curve.getInfinity()}var v=r;var u=v.multiply(new p("3"));var x=this.negate();var t=this;var s;for(s=u.bitLength()-2;s>0;--s){t=t.twice();var q=u.testBit(s);var w=v.testBit(s);if(q!=w){t=t.add2D(q?this:x)}}return t};l.prototype.isOnCurve=function(){if(this.isInfinity()){return true}var r=this.getX().toBigInteger();var w=this.getY().toBigInteger();var t=this.curve.getA().toBigInteger();var q=this.curve.getB().toBigInteger();var v=this.curve.getQ();var s=w.multiply(w).mod(v);var u=r.multiply(r).multiply(r).add(t.multiply(r)).add(q).mod(v);return s.equals(u)};l.prototype.toString=function(){if(this.isInfinity()){return"(INFINITY)"}return"("+this.getX().toBigInteger().toString()+","+this.getY().toBigInteger().toString()+")"};l.prototype.validate=function(){var s=this.curve.getQ();if(this.isInfinity()){throw new Error("Point is at infinity.")}var q=this.getX().toBigInteger();var r=this.getY().toBigInteger();if(q.compareTo(p.ONE)<0||q.compareTo(s.subtract(p.ONE))>0){throw new Error("x coordinate out of bounds")}if(r.compareTo(p.ONE)<0||r.compareTo(s.subtract(p.ONE))>0){throw new Error("y coordinate out of bounds")}if(!this.isOnCurve()){throw new Error("Point is not on the curve.")}if(this.multiply(s).isInfinity()){throw new Error("Point is not a scalar multiple of G.")}return true};var o=function o(t,s,r){this.q=t;this.a=this.fromBigInteger(s);this.b=this.fromBigInteger(r);this.infinity=new l(this,null,null)};o.prototype.getQ=function(){return this.q};o.prototype.getA=function(){return this.a};o.prototype.getB=function(){return this.b};o.prototype.equals=function(q){if(q==this){return true}return(this.q.equals(q.q)&&this.a.equals(q.a)&&this.b.equals(q.b))};o.prototype.getInfinity=function(){return this.infinity};o.prototype.fromBigInteger=function(q){return new m(this.q,q)};o.prototype.decodePointHex=function(u){u=u.replace(/[^0-9a-f]/ig,"");switch(parseInt(u.substr(0,2),16)){case 0:return this.infinity;case 2:case 3:return null;case 4:case 6:case 7:var q=(u.length-2)/2;var t=u.substr(2,q);var r=u.substr(q+2,q);return new l(this,this.fromBigInteger(new p(t,16)),this.fromBigInteger(new p(r,16)));default:return null}};o.ECPointFp=l;j.set("cipher.asymmetric.ec.ecurve",o)})(a);(function(j){var n={};var k={NECRAC256:{name:"NECRAC256",secretLength:128,sign:{algorithm:"ec",parameters:{curve:"secp521r1"},secretLength:64},crypt:{algorithm:"ec",parameters:{curve:"secp521r1"},secretLength:64},hashAlgorithm:"WHIRLPOOL"},NECRAC192:{name:"NECRAC192",secretLength:96,sign:{algorithm:"ec",parameters:{curve:"secp384r1"},secretLength:48},crypt:{algorithm:"ec",parameters:{curve:"secp384r1"},secretLength:48},hashAlgorithm:"BLAKE2s"},NECRAC128:{name:"NECRAC128",secretLength:64,sign:{algorithm:"ec",parameters:{curve:"secp256r1"},secretLength:32},crypt:{algorithm:"ec",parameters:{curve:"secp256k1"},secretLength:32},hashAlgorithm:"BLAKE2s"}};function o(u){var B=this;var v=k[u];var z,t;if(!v){throw new Error("invalid-algorithm-choice")}function p(D){var C=new j.get("hash")(v.hashAlgorithm);return C.hash(D).buffer}function y(C){var D=j.get("cipher.asymmetric."+C.algorithm).constructor;return D(C.parameters)}z=y(v.sign);t=y(v.crypt);function A(C){if(C){B.sign=r;B.decrypt=q}B.verify=x;B.encrypt=w;B.getPublicKey=s;delete B.setPrivateKey;delete B.setPublicKey}function s(){var D=z.getPublicKey(),C=t.getPublicKey();return j.get("util.buffer").concat([new Uint16Array([D.byteLength]).buffer,D,C])}function r(D){if(!j.get("util.type")(D).isArrayBuffer()){throw new Error("invalid-parameter")}var C=p(D);return z.sign(C)}function x(E,C){if(!(j.get("util.type")(E).isArrayBuffer()&&j.get("util.type")(C).isArrayBuffer())){throw new Error("invalid-parameter")}var D=p(E);return z.verify(D,C)}function w(C){if(!j.get("util.type")(C).isArrayBuffer()){throw new Error("invalid-parameter")}return t.encrypt(C)}function q(C){if(!j.get("util.type")(C).isArrayBuffer()){throw new Error("invalid-parameter")}return t.decrypt(C)}this.setPrivateKey=function(C){if(!j.get("util.type")(C).isArrayBuffer()){throw new Error("invalid-parameter")}var G=new j.get("hash")(v.hashAlgorithm).pbkdf2;var F=G(C,j.get("util.encoding")("derivation-of-signing-key","ascii").toArrayBuffer(),4,v.sign.secretLength);var D=G(C,j.get("util.encoding")("derivation-of-encrypting-key","ascii").toArrayBuffer(),4,v.crypt.secretLength);try{z.setPrivateKey(F);t.setPrivateKey(D)}catch(E){throw new Error("invalid-private-key")}A(true)};this.setPublicKey=function(D){if(!(j.get("util.type")(D).isArrayBuffer()&&D.byteLength>2)){throw new Error("invalid-public-key")}var E=new Uint16Array(D.slice(0,2))[0];D=D.slice(2);if(D.byteLength<=E){throw new Error("invalid-public-key")}var G=D.slice(0,E),C=D.slice(E);try{z.setPublicKey(G);t.setPublicKey(C)}catch(F){throw new Error("invalid-public-key")}A(false)};return this}function l(p){if(p){j.get("util.log").notice("Load asymmetric cipher component: ["+p.name+"]");n[p.name]=p.constructor;return}if("undefined"!=typeof n.EC){j.get("util.log").notice("Asymmetric ciphers ready.");return function(q){return new o(q)}}return null}var m=function(p){return new o(p)};j.set("cipher.asymmetric",m);j.set("cipher.asymmetric.definition",function(p){return k[p]||null});j.exp("cipher.asymmetric",m)})(a);(function(j){function k(){var F=16;var G=4;var t=4;var p=[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22];var s=[82,9,106,213,48,54,165,56,191,64,163,158,129,243,215,251,124,227,57,130,155,47,255,135,52,142,67,68,196,222,233,203,84,123,148,50,166,194,35,61,238,76,149,11,66,250,195,78,8,46,161,102,40,217,36,178,118,91,162,73,109,139,209,37,114,248,246,100,134,104,152,22,212,164,92,204,93,101,182,146,108,112,72,80,253,237,185,218,94,21,70,87,167,141,157,132,144,216,171,0,140,188,211,10,247,228,88,5,184,179,69,6,208,44,30,143,202,63,15,2,193,175,189,3,1,19,138,107,58,145,17,65,79,103,220,234,151,242,207,206,240,180,230,115,150,172,116,34,231,173,53,133,226,249,55,232,28,117,223,110,71,241,26,113,29,41,197,137,111,183,98,14,170,24,190,27,252,86,62,75,198,210,121,32,154,219,192,254,120,205,90,244,31,221,168,51,136,7,199,49,177,18,16,89,39,128,236,95,96,81,127,169,25,181,74,13,45,229,122,159,147,201,156,239,160,224,59,77,174,42,245,176,200,235,187,60,131,83,153,97,23,43,4,126,186,119,214,38,225,105,20,99,85,33,12,125];var E=[0,16777216,33554432,67108864,134217728,268435456,536870912,1073741824,2147483648,452984832,905969664];function H(J,I){var L=0;var K;while(J){if((J&1)){L=L^I}K=I&128;I<<=1;if(K){I^=27}J>>=1}return L}function q(K){var J=new Array(256);for(var I=0;I<256;I++){J[I]=H(K,I)&255}return J}var C=q(2);var A=q(3);var u=q(9);var B=q(11);var z=q(13);var y=q(14);function D(I){var J=p;return(J[I>>>24]<<24|J[(I>>>16)&255]<<16|J[(I>>>8)&255]<<8|J[I&255])}function w(I){return I>>>24|I<<8}function r(I){return I>>>24|(I&16711680)>>>8|(I&65280)<<8|(I&255)<<24}var v=((new Uint8Array((new Uint32Array([1])).buffer))[0]==1);function x(O){var I=E;var K=new Uint8Array(O);var M=K.length/4;var P=M+6;var J=new Uint32Array(t*(P+1));for(var N=0;N<M;N++){J[N]=(K[N*4]<<24|K[N*4+1]<<16|K[N*4+2]<<8|K[N*4+3])}for(var N=M;N<t*(P+1);N++){var L=J[N-1];if(N%M==0){L=D(w(L))^I[N/M]}else{if(M>6&&N%M==4){L=D(L)}}J[N]=J[N-M]^L}if(v){for(var N=0;N<J.length;N++){J[N]=r(J[N])}}return J}function n(I,R){var O=(R.length/t-1)*4;var V,T,Q,P;var M,L,K,J;var Y,X,U,S;var N=p;V=(I[0]^R[0])>>>0;T=(I[1]^R[1])>>>0;Q=(I[2]^R[2])>>>0;P=(I[3]^R[3])>>>0;for(var W=4;W<O;W+=4){M=V;L=T;K=Q;J=P;Y=N[M&255]>>>0;X=N[(L>>>8)&255]>>>0;U=N[(K>>>16)&255]>>>0;S=N[J>>>24]>>>0;V=(((C[Y]^A[X]^U^S)|(Y^C[X]^A[U]^S)<<8|(Y^X^C[U]^A[S])<<16|(A[Y]^X^U^C[S])<<24)^R[W])>>>0;Y=N[L&255]>>>0;X=N[(K>>>8)&255]>>>0;U=N[(J>>>16)&255]>>>0;S=N[M>>>24]>>>0;T=(((C[Y]^A[X]^U^S)|(Y^C[X]^A[U]^S)<<8|(Y^X^C[U]^A[S])<<16|(A[Y]^X^U^C[S])<<24)^R[W+1])>>>0;Y=N[K&255]>>>0;X=N[(J>>>8)&255]>>>0;U=N[(M>>>16)&255]>>>0;S=N[L>>>24]>>>0;Q=(((C[Y]^A[X]^U^S)|(Y^C[X]^A[U]^S)<<8|(Y^X^C[U]^A[S])<<16|(A[Y]^X^U^C[S])<<24)^R[W+2])>>>0;Y=N[J&255]>>>0;X=N[(M>>>8)&255]>>>0;U=N[(L>>>16)&255]>>>0;S=N[K>>>24]>>>0;P=(((C[Y]^A[X]^U^S)|(Y^C[X]^A[U]^S)<<8|(Y^X^C[U]^A[S])<<16|(A[Y]^X^U^C[S])<<24)^R[W+3])>>>0}I[0]=R[O]^(N[V&255]|N[(T>>>8)&255]<<8|N[(Q>>>16)&255]<<16|N[P>>>24]<<24);I[1]=R[O+1]^(N[T&255]|N[(Q>>>8)&255]<<8|N[(P>>>16)&255]<<16|N[V>>>24]<<24);I[2]=R[O+2]^(N[Q&255]|N[(P>>>8)&255]<<8|N[(V>>>16)&255]<<16|N[T>>>24]<<24);I[3]=R[O+3]^(N[P&255]|N[(V>>>8)&255]<<8|N[(T>>>16)&255]<<16|N[Q>>>24]<<24)}function o(I,R){var J=s;var O=(R.length/t-1)*4;var T,S,Q,P;var N,M,L,K;T=(I[0]^R[O])>>>0;S=(I[1]^R[O+1])>>>0;Q=(I[2]^R[O+2])>>>0;P=(I[3]^R[O+3])>>>0;for(var U=O-4;U>0;U-=4){N=T;M=S;L=Q;K=P;T=((J[N&255]|J[(K>>>8)&255]<<8|J[(L>>>16)&255]<<16|J[M>>>24]<<24)^R[U])>>>0;S=((J[M&255]|J[(N>>>8)&255]<<8|J[(K>>>16)&255]<<16|J[L>>>24]<<24)^R[U+1])>>>0;Q=((J[L&255]|J[(M>>>8)&255]<<8|J[(N>>>16)&255]<<16|J[K>>>24]<<24)^R[U+2])>>>0;P=((J[K&255]|J[(L>>>8)&255]<<8|J[(M>>>16)&255]<<16|J[N>>>24]<<24)^R[U+3])>>>0;N=T&255>>>0;M=((T>>>8)&255)>>>0;L=((T>>>16)&255)>>>0;K=T>>>24;T=((y[N]^B[M]^z[L]^u[K])|(u[N]^y[M]^B[L]^z[K])<<8|(z[N]^u[M]^y[L]^B[K])<<16|(B[N]^z[M]^u[L]^y[K])<<24)>>>0;N=(S&255)>>>0;M=((S>>>8)&255)>>>0;L=((S>>>16)&255)>>>0;K=S>>>24;S=((y[N]^B[M]^z[L]^u[K])|(u[N]^y[M]^B[L]^z[K])<<8|(z[N]^u[M]^y[L]^B[K])<<16|(B[N]^z[M]^u[L]^y[K])<<24)>>>0;N=(Q&255)>>>0;M=((Q>>>8)&255)>>>0;L=((Q>>>16)&255)>>>0;K=Q>>>24;Q=((y[N]^B[M]^z[L]^u[K])|(u[N]^y[M]^B[L]^z[K])<<8|(z[N]^u[M]^y[L]^B[K])<<16|(B[N]^z[M]^u[L]^y[K])<<24)>>>0;N=(P&255)>>>0;M=((P>>>8)&255)>>>0;L=((P>>>16)&255)>>>0;K=P>>>24;P=((y[N]^B[M]^z[L]^u[K])|(u[N]^y[M]^B[L]^z[K])<<8|(z[N]^u[M]^y[L]^B[K])<<16|(B[N]^z[M]^u[L]^y[K])<<24)>>>0}I[0]=R[0]^(J[T&255]|J[(P>>>8)&255]<<8|J[(Q>>>16)&255]<<16|J[S>>>24]<<24);I[1]=R[1]^(J[S&255]|J[(T>>>8)&255]<<8|J[(P>>>16)&255]<<16|J[Q>>>24]<<24);I[2]=R[2]^(J[Q&255]|J[(S>>>8)&255]<<8|J[(T>>>16)&255]<<16|J[P>>>24]<<24);I[3]=R[3]^(J[P&255]|J[(Q>>>8)&255]<<8|J[(S>>>16)&255]<<16|J[T>>>24]<<24)}return{block_size_bytes:F,block_size_words:G,endian_swap32:r,is_little_endian:v,key_expansion:x,cipher:n,inv_cipher:o}}function m(){var n=this;var p=new k(),q;function o(t){if(!(j.get("util.type")(t).isArrayBuffer()&&0==t.byteLength%p.block_size_bytes)){throw new Error("invalid-input")}var y=new Uint32Array(t);var z=new Uint32Array(y.length);var v=new Uint32Array(p.block_size_words);var s=p.key_expansion(q);var x,u;for(x=0;x<y.length;x+=p.block_size_words){for(u=0;u<p.block_size_words;u++){v[u]=y[x+u]}p.cipher(v,s);z.set(v,x)}return z.buffer}function r(t){if(!(j.get("util.type")(t).isArrayBuffer()&&0==t.byteLength%p.block_size_bytes)){throw new Error("invalid-input")}var y=new Uint32Array(t);var z=new Uint32Array(y.length);var v=new Uint32Array(p.block_size_words);var A=new Uint32Array(p.block_size_words);var s=p.key_expansion(q),x,u;for(x=0;x<y.length;x+=p.block_size_words){for(u=0;u<p.block_size_words;u++){A[u]=y[x+u]}v.set(A);p.inv_cipher(v,s);z.set(v,x)}return z.buffer}this.key=function(t){if(!j.get("util.type")(t).isArrayBuffer()){throw new Error("invalid-key")}var s=t.byteLength;if(s>32){t=t.slice(0,32)}else{if(s>24){t=t.slice(0,24)}else{if(s>16){t=t.slice(0,16)}else{throw new Error("invalid-key-length")}}}q=new Uint32Array(t);n.encrypt=o;n.decrypt=r;delete n.key;return n};return this}var l={name:"AESECB",constructor:function(){return new m()}};j.set("cipher.symmetric.aes",l)})(a);(function(k){function j(x){var y=this;if(!x||x<10){x=10}var w=new Uint32Array(16);function p(E,B){function D(G,F){return(((G)<<(F))|((G)>>>(32-(F))))}var C;var A=w;for(C=0;C<16;C++){A[C]=E[C]}for(C=0;C<x;C++){A[4]^=D(A[0]+A[12],7);A[8]^=D(A[4]+A[0],9);A[12]^=D(A[8]+A[4],13);A[0]^=D(A[12]+A[8],18);A[9]^=D(A[5]+A[1],7);A[13]^=D(A[9]+A[5],9);A[1]^=D(A[13]+A[9],13);A[5]^=D(A[1]+A[13],18);A[14]^=D(A[10]+A[6],7);A[2]^=D(A[14]+A[10],9);A[6]^=D(A[2]+A[14],13);A[10]^=D(A[6]+A[2],18);A[3]^=D(A[15]+A[11],7);A[7]^=D(A[3]+A[15],9);A[11]^=D(A[7]+A[3],13);A[15]^=D(A[11]+A[7],18);A[1]^=D(A[0]+A[3],7);A[2]^=D(A[1]+A[0],9);A[3]^=D(A[2]+A[1],13);A[0]^=D(A[3]+A[2],18);A[6]^=D(A[5]+A[4],7);A[7]^=D(A[6]+A[5],9);A[4]^=D(A[7]+A[6],13);A[5]^=D(A[4]+A[7],18);A[11]^=D(A[10]+A[9],7);A[8]^=D(A[11]+A[10],9);A[9]^=D(A[8]+A[11],13);A[10]^=D(A[9]+A[8],18);A[12]^=D(A[15]+A[14],7);A[13]^=D(A[12]+A[15],9);A[14]^=D(A[13]+A[12],13);A[15]^=D(A[14]+A[13],18)}for(C=0;C<16;C++){B[C]=A[C]+E[C]}}var s=new Uint32Array(16);function o(B,D){var A=s,C=new Uint32Array([1634760805,857760878,2036477234,1797285236]);A[0]=C[0];A[1]=D[0];A[2]=D[1];A[3]=D[2];A[4]=D[3];A[5]=C[1];A[6]=B[0];A[7]=B[1];A[10]=C[2];A[11]=D[4];A[12]=D[5];A[13]=D[6];A[14]=D[7];A[15]=C[3]}function q(C,B){var A=s;A[8]=C[0];A[9]=C[1];return p(A,B)}function o(C,B){var A=s;tau=new Uint32Array([1634760805,824206446,2036477238,1797285236]);A[0]=tau[0];A[1]=B[0];A[2]=B[1];A[3]=B[2];A[4]=B[3];A[5]=tau[1];A[6]=C[0];A[7]=C[1];A[10]=tau[2];A[11]=B[0];A[12]=B[1];A[13]=B[2];A[14]=B[3];A[15]=tau[3]}function u(C,B){var A=s;A[8]=C[0];A[9]=C[1];return p(A,B)}var m=new Uint32Array(2);var t;function v(){m[0]=0;m[1]=0}function z(){m[0]+=1;if(0==m[0]){m[1]+=1}}function r(A,D){var C=new Uint32Array(A);if(32==D.byteLength){var B=new Uint32Array(D);o(C,B);t=(function(){return function(E){q(m,E);z()}})()}else{if(16==D.byteLength){var B=new Uint32Array(D);_salsa20BufferFillKey4(C,B);t=(function(){return function(E){u(m,E);z()}})()}else{throw new Error("invalid-key-length")}}}function n(G){if(!k.get("util.type")(G).isArrayBuffer()){throw new Error("invalid-input")}var A=G.byteLength,E=Math.ceil(A/64),B=new Uint32Array(16);var H=new Uint8Array(G),I=new Uint8Array(H.length+64);var F=0,D,C;v();for(D=0;D<E;D++){t(B);for(C=0;C<16;C++){I[F++]=(B[C]>>24)&255;I[F++]=(B[C]>>16)&255;I[F++]=(B[C]>>8)&255;I[F++]=B[C]&255}}for(D=0;D<A;D++){H[D]^=I[D]}return H.buffer}this.key=function(B){if(!k.get("util.type")(B).isArrayBuffer()){throw new Error("invalid-key")}var C=B.byteLength;if(C<24){throw new Error("invalid-key")}var A=B.slice(0,8);if(C<40){r(A,B.slice(8,24))}else{r(A,B.slice(8,40))}y.encrypt=n;y.decrypt=n;delete y.key;return y};return this}var l={name:"Salsa20/20",constructor:function(){return new j(20)}};k.set("cipher.symmetric.salsa20",l)})(a);(function(l){function k(){var y=this;function x(B,D){var F=B.byteLength,E=D-(F%D),G=F+E,A=new Uint8Array(B),z=new Uint8Array(G);for(var C=0;C<G;C++){if(C<F){z[C]=A[C]}else{z[C]=E}}return z.buffer}function w(A){var z=new Uint8Array(A);var B=z[z.length-1];if(z.length<B){return null}return A.slice(0,A.byteLength-B)}function t(z){return z}function q(z){return z}var s=null;function u(C,A,D){var F=64;var E=new l.get("hash")("BLAKE2s").pbkdf2(C,A,4,D*F);var z=new Array(D);for(var B=0;B<D;B++){z[B]=new l.get("hash")("WHIRLPOOL").hash(E.slice(B*F,(B+1)*F)).buffer}return z}var v=function(B){if(!l.get("util.type")(B).isArrayBuffer()){throw new Error("invalid-parameter")}var A=new l.get("util.srand")().bytes(10);var C=u(s,A,5);var D=new l.get("hash")("BLAKE2s",{length:6}).mac(B,C[0]).buffer;B=l.get("util.buffer").concat([D,B]);var z=B;z=t(z);z=x(z,16);z=j(C[1],z);z=p(C[2],z);return l.get("util.buffer").concat([A,z])};var r=function(B){if(!(l.get("util.type")(B).isArrayBuffer()&&B.byteLength>=26)){throw new Error("invalid-parameter")}var D=B.slice(0,10);B=B.slice(10);var E=u(s,D,5);var A=B;A=n(E[2],A);A=m(E[1],A);A=w(A,16);if(!l.get("util.type")(A).isArrayBuffer()){return null}A=q(A);if(!l.get("util.type")(A).isArrayBuffer()){return null}var C=A.slice(0,6);A=A.slice(6);var z=new l.get("hash")("BLAKE2s",{length:6}).mac(A,E[0]).buffer;if(l.get("util.buffer").equal(C,z)){return A}return null};this.key=function(z){if(!l.get("util.type")(z).isArrayBuffer()){throw new Error("invalid-key")}s=z;delete y.key;y.encrypt=v;y.decrypt=r;return y};return this}var p=function(q,s){try{var r=l.get("cipher.symmetric.aes").constructor;return r().key(q).encrypt(s)}catch(t){l.get("util.log").error(t);return new Error("unable-to-encrypt",t)}};var n=function(q,s){try{var r=l.get("cipher.symmetric.aes").constructor;return r().key(q).decrypt(s)}catch(t){l.get("util.log").error(t);return new Error("unable-to-decrypt",t)}};var j=function(q,r){try{var t=l.get("cipher.symmetric.salsa20").constructor;return t().key(q).encrypt(r)}catch(s){l.get("util.log").error(s);return new Error("unable-to-encrypt")}};var m=function(q,r){try{var t=l.get("cipher.symmetric.salsa20").constructor;return t().key(q).decrypt(r)}catch(s){l.get("util.log").error(s);return new Error("unable-to-decrypt",s)}};function o(){return new k()}l.set("cipher.symmetric",o);l.exp("cipher.symmetric",o)})(a);(function(j){})(a);(function(j){function k(){var l=this;return this}})(a);(function(k){var l={algorithmName:"NECRAC128"};function j(){var x=this;var p=k.get("hash");var z=k.get("util.buffer");var m=k.get("cipher.asymmetric.definition");var C,q,s,v,u,D;var A=new Uint8Array([69,73]).buffer;function r(){return p("BLAKE2s").mac(s,C)}function o(F){}this.generate=function(H,G){if(!/^[0-9a-z]{8, 255}$/i.test(H)){throw new Error("invalid-subject")}C=k.get("util.encoding")(H).toArrayBuffer();v=G.algorithm||l.algorithmName;var F=m(algoirthmName);if(!F){v=l.algorithmName;F=m(algorithmname)}q=k.get("util.srand")().bytes(F.secretLength);D=k.get("cipher.asymmetric")(F.name);D.setPrivateKey(q);s=D.getPublicKey();u=D.sign(r());o(true)};this.loadPublic=function(F){};this.loadPrivate=function(F,G){};function B(){}function t(F){}function w(G,F){}function E(F){}function y(F){}function n(F){}return this}})(a);(function(j){function k(){var n=this;this.write=function(s){};this.read=function(s){};function m(s){}function r(s){}function p(){}function o(s){}function q(s){}return this}function l(){return new k()}j.exp("enigma.message",l)})(a);if("undefined"!=typeof module&&"undefined"!=module.exports){module.exports=g}else{define([],function(){return g})}})();