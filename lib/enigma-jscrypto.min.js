(function(){var e={},h={},j={};var c={get:function(m){if(true){if(h[m]){return h[m]}}return e[m]},set:function(n,m){e[n]=m},exp:function(o,m){var q=o.split(".");var p=j;for(var n in q){if("undefined"==typeof p[q[n]]){if(n==q.length-1){p[q[n]]=m;break}p[q[n]]={}}p=p[q[n]]}},acc:function(n,m){h[n]=m}};c.set("env.isNode",("undefined"!=typeof module&&"undefined"!=typeof process&&"undefined"!=typeof process.title&&"node"===process.title));(function(s){var n="0123456789abcdefghjkmnpqrtuvwxyz";var q={o:0,i:1,l:1,s:5};var o=function(){var x={};for(var w=0;w<n.length;w++){x[n[w]]=w}for(var v in q){if(!q.hasOwnProperty(v)){continue}x[v]=x[""+q[v]]}o=function(){return x};return x};function p(){var v=0;var w=0;this.output="";this.readByte=function(x){if(v<0){w|=(x>>(-v))}else{w=(x<<v)&248}if(v>3){v-=8;return 1}if(v<4){this.output+=n[w>>3];v+=5}return 0};this.finish=function(){var x=this.output+(v<0?n[w>>3]:"");this.output="";return x}}p.prototype.update=function(x,v){for(var y=0;y<x.length;){y+=this.readByte(x[y])}var w=this.output;this.output="";if(v){w+=this.finish()}return w};function u(){var v=0;var w=0;this.output=[];this.readChar=function(x){var y=o()[x];if(typeof y=="undefined"){throw Error('Could not find character "'+x+'" in lookup table.')}y<<=3;w|=y>>>v;v+=5;if(v>=8){this.output.push(w);v-=8;if(v>0){w=(y<<(5-v))&255}else{w=0}}};this.finish=function(){if(v<0){this.output.push(n[bits>>3])}return this.output}}u.prototype.update=function(x,v){for(var y=0;y<x.length;y++){this.readChar(x[y])}var w=this.output;this.output="";if(v){w.concat(this.finish())}return w};function r(w){var x=new p();var v=x.update(w,true);return v}function m(w){var x=new u();w=w.toLowerCase();var v=x.update(w,true);return v}var t={encode:r,decode:m};s.set("util.encoding.base32",t)})(c);(function(o){function r(v){var u,t,w=0,s;for(u=0;u<v.length;u++){w+=v[u].byteLength}var x=new Uint8Array(w),y=0;for(u=0;u<v.length;u++){s=new Uint8Array(v[u]);for(t=0;t<s.length;t++){x[y]=s[t];y+=1}}return x.buffer}function m(t,s){if(t.byteLength!=s.byteLength){throw Error("xor-unequal-length-buffer")}var w=new Uint8Array(t.byteLength),v=new Uint8Array(t),x=new Uint8Array(s);for(var u=0;u<w.length;u++){w[u]=v[u]^x[u]}return w.buffer}function p(u,t){try{var s=new Uint8Array(u),z=new Uint8Array(t)}catch(w){return false}if(s.length!=z.length){return false}for(var v=0;v<s.length;v++){if(s[v]!=z[v]){return false}}return true}function n(u){var w=new Uint8Array(u);var s=w.length-1,x=Math.floor(s/2);var z=s,y;for(var v=0;v<=x;v++){y=w[v];w[v]=w[z];w[z]=y;z-=1}return w.buffer}var q={concat:r,xor:m,equal:p,reverse:n};o.set("util.buffer",q);o.exp("util.buffer",q)})(c);(function(o){function p(x){var u=4-x.length%4;if(4==u){u=0}for(var v=0;v<u;v++){x.push(0)}var B=[u],t,s,r,A,w;function y(C){if(C<=255){return 0}else{if(C<=65535){return 1}else{if(C<=16777215){return 2}else{if(C<=4294967295){return 3}else{throw Error("uncompressible: "+C)}}}}}function z(D,C){if(C<=255){D.push(C)}else{if(C<=65535){D.push((C&65280)>>8,C&255)}else{if(C<=16777215){D.push((C&16711680)>>16,(C&65280)>>8,C&255)}else{if(C<=4294967295){D.push((C&4278190080)>>24(C&16711680)>>16,(C&65280)>>8,(C&255))}}}}}for(var v=0;v<x.length;v+=4){t=x[v];s=x[v+1];r=x[v+2];A=x[v+3];w=(y(t)<<6)+(y(s)<<4)+(y(r)<<2)+(y(A));B.push(w);z(B,t);z(B,s);z(B,r);z(B,A)}return B}function q(w){var r=w[0];if(r>=4){throw new Error("invalid-input")}var t=1,s;var u,C,A,z,x;function y(E,D){return((E>>(D*2))&3)+1}function B(H,G,F){var E=0;for(var D=G;D<G+F;D++){E=(E<<8);E|=(H[D]&255)}return E}var v=[];while(t<w.length){u=w[t];t++;s=y(u,3);C=B(w,t,s);t+=s;s=y(u,2);A=B(w,t,s);t+=s;s=y(u,1);z=B(w,t,s);t+=s;s=y(u,0);x=B(w,t,s);t+=s;v.push(C,A,z,x)}return v.slice(0,v.length-r)}function m(z){if(!o.get("util.type")(z).isArrayBuffer()){throw Error("invalid-input")}var r=new Uint8Array(z);var t,x={},v,s,y="",A=[],u=256;for(t=0;t<256;t+=1){x[String.fromCharCode(t)]=t}for(t=0;t<r.length;t+=1){v=String.fromCharCode(r[t]);s=y+v;if(x.hasOwnProperty(s)){y=s}else{A.push(x[y]);x[s]=u++;y=String(v)}}if(""!==y){A.push(x[y])}return new Uint8Array(p(A)).buffer}function n(x){if(!o.get("util.type")(x).isArrayBuffer()){throw Error("invalid-input")}var r=new Uint8Array(x);r=q(r);var t,y=[],A,B,s,z="",u=256;for(t=0;t<256;t+=1){y[t]=String.fromCharCode(t)}A=String.fromCharCode(r[0]);B=A;for(t=1;t<r.length;t+=1){s=r[t];if(y[s]){z=y[s]}else{if(s===u){z=A+A.charAt(0)}else{return null}}B+=z;y[u++]=A+z.charAt(0);A=z}var v=new Uint8Array(B.length);for(var t=0;t<v.length;t++){v[t]=B.charCodeAt(t)}return v.buffer}o.exp("util.compress",m);o.exp("util.decompress",n);o.set("util.compress",m);o.set("util.decompress",n)})(c);(function(n){function m(w){if(!0==w.byteLength%2){throw new Error("decoding-error")}var w=new Uint16Array(w),r=0,u,q,v,t="";while(r<w.length){u=w[r];if((u>=0&&u<=55295)||(u>=57344&&u<=65535)){t+=String.fromCharCode(u);r+=1}else{if(u>=55296&&u<=56319){v=u;q=w[r+1];r+=2;if(q>=56320&&q<=57343){t+=String.fromCharCode(v)+String.fromCharCode(q)}else{throw new Error("decoding-error")}}else{throw new Error("decoding-error")}}}return t}function o(s,B){var t=this;var x=null;var q="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",z="0123456789abcdef";var r=n.get("util.type")(s),D=n.get("util.encoding.base32");if(r.isArrayBuffer()){x=s}else{if(r.isArray()){var w=new Uint8Array(s.length);for(var A=0;A<w.length;A++){w[A]=s[A]&255}x=w.buffer}else{if(r.isString()){if(!B){B=""}switch(B.toLowerCase()){case"hex":if(!/^[0-9a-f]+$/i.test(s)||0!=s.length%2){throw Error("invalid-encoding-choosen")}s=s.toLowerCase();var u=new Uint8Array(s.length/2);for(var A=0;A<u.length;A++){u[A]=z.indexOf(s[2*A])*16+z.indexOf(s[2*A+1])}x=u.buffer;break;case"base64":if(/(=[^=]+|={3,})$/.test(s)){throw Error("invalid-encoding-choosen")}s=s.replace(/=/g,"");var v=s.length&3;if(1==v){throw Error("invalid-encoding-choosen")}var A=0,y=0,C=Math.ceil(s.length/4);var u=new Uint8Array(C*3);var I,H,G,E;for(A=0;A<C;A++){I=q.indexOf(s[y++]||"A");H=q.indexOf(s[y++]||"A");G=q.indexOf(s[y++]||"A");E=q.indexOf(s[y++]||"A");if((I|H|G|E)<0){throw Error("invalid-encoding-choosen")}u[A*3]=((I<<2)|(H>>4))&255;u[A*3+1]=((H<<4)|(G>>2))&255;u[A*3+2]=((G<<6)|E)&255}x=u.buffer.slice(0,u.length+v-4);break;case"base32":if(!/^[0-9a-z=]+$/.test(s)){throw Error("invalid-encoding-choosen")}var F=D.decode(s);x=new Uint8Array(F).buffer;break;case"ascii":var u=new Uint8Array(s.length);for(var A=0;A<u.length;A++){u[A]=s.charCodeAt(A)&255}x=u.buffer;break;default:var u=new Uint16Array(s.length);for(var A=0;A<s.length;A++){u[A]=s.charCodeAt(A)}x=u.buffer;break}}else{throw Error("unknown-encoding")}}}this.toArrayBuffer=function(){return x};this.toUTF16=function(){return m(x)};this.toBase64=function(){var P=new Uint8Array(x);var M=0,L=0,K=0,N=P.length/3;var J="";var R,Q,O;for(M=0;M<N;++M){R=P[L++];Q=P[L++];O=P[L++];J+=q[R>>2]+q[((R<<4)&63)|(Q>>4)]+(isNaN(Q)?"=":q[((Q<<2)&63)|(O>>6)])+(isNaN(Q+O)?"=":q[O&63])}return J};this.toBase32=function(){var J=new Uint8Array(x),K=D.encode(J);return K};this.toHEX=function(){var J=new Uint8Array(x),L="";for(var K=0;K<J.length;K++){if(J[K]<16){L+="0"+J[K].toString(16)}else{L+=J[K].toString(16)}}return L};this.toASCII=function(){var J=new Uint8Array(x),L="";for(var K=0;K<J.length;K++){L+=String.fromCharCode(J[K])}return L};this.toArray=function(){var J=new Uint8Array(x),K=new Array(J.length);for(var L=0;L<K.length;L++){K[L]=J[L]}return K};return this}var p=function(r,q){return new o(r,q)};n.set("util.encoding",p);n.exp("util.encoding",p)})(c);(function(m){var n={notice:function(o){console.log(o)},error:function(o){console.error(o)}};m.set("util.log",n);m.exp("util.log",n)})(c);(function(u){var m=new Uint32Array(16);function p(F,C){function E(H,G){return(((H)<<(G))|((H)>>>(32-(G))))}var D;var B=m;for(D=0;D<16;D++){B[D]=F[D]}for(D=0;D<32;D++){B[4]^=E(B[0]+B[12],7);B[8]^=E(B[4]+B[0],9);B[12]^=E(B[8]+B[4],13);B[0]^=E(B[12]+B[8],18);B[9]^=E(B[5]+B[1],7);B[13]^=E(B[9]+B[5],9);B[1]^=E(B[13]+B[9],13);B[5]^=E(B[1]+B[13],18);B[14]^=E(B[10]+B[6],7);B[2]^=E(B[14]+B[10],9);B[6]^=E(B[2]+B[14],13);B[10]^=E(B[6]+B[2],18);B[3]^=E(B[15]+B[11],7);B[7]^=E(B[3]+B[15],9);B[11]^=E(B[7]+B[3],13);B[15]^=E(B[11]+B[7],18);B[1]^=E(B[0]+B[3],7);B[2]^=E(B[1]+B[0],9);B[3]^=E(B[2]+B[1],13);B[0]^=E(B[3]+B[2],18);B[6]^=E(B[5]+B[4],7);B[7]^=E(B[6]+B[5],9);B[4]^=E(B[7]+B[6],13);B[5]^=E(B[4]+B[7],18);B[11]^=E(B[10]+B[9],7);B[8]^=E(B[11]+B[10],9);B[9]^=E(B[8]+B[11],13);B[10]^=E(B[9]+B[8],18);B[12]^=E(B[15]+B[14],7);B[13]^=E(B[12]+B[15],9);B[14]^=E(B[13]+B[12],13);B[15]^=E(B[14]+B[13],18)}for(D=0;D<16;D++){C[D]=B[D]+F[D]}}var t=new Uint8Array(16);function y(){for(var B=0;B<16;B++){t[B]=Math.floor(256*Math.random())}}y();var n=new Uint32Array([0,0]);function v(){n[0]=0;n[1]=0}function x(){n[0]+=1;if(0==n[0]){n[1]+=1}if(0==n[1]){y()}}var z=new Uint8Array(32),o=0;function A(B){z[o]=B;o+=1;if(o>=32){v();o=0}}for(var r=0;r<32;r++){A(Math.floor(256*Math.random()))}function q(){A(new Date().getTime()%256)}setInterval(q,100);function s(C){var E=new Uint32Array([1634760805,857760878,2036477234,1797285236]);var B=new Uint32Array(16),D=new Uint32Array(t.buffer),F=new Uint32Array(z.buffer);B[0]=E[0];B[1]=F[0];B[2]=F[1];B[3]=F[2];B[4]=F[3];B[5]=E[1];B[6]=D[0];B[7]=D[1];B[8]=n[0];B[9]=n[1];B[10]=E[2];B[11]=F[4];B[12]=F[5];B[13]=F[6];B[14]=F[7];B[15]=E[3];x();return p(B,C)}function w(){var B=this;var C=new Uint32Array(16);this.touch=function(){q()};this.bytes=function(I){var D=Math.ceil(I/64);var F=new Uint8Array(I),G=0,E=0,J;for(var H=0;H<D;H++){s(C);J=new Uint8Array(C.buffer);for(G=0;G<64;G++){if(E>=I){break}F[E]=J[G];E+=1}}return F.buffer};this.array=function(D){return new Uint8Array(B.bytes(D))};return this}u.set("util.srand",w);u.exp("util.srand",w)})(c);(function(m){function n(o){return{isError:function(){return toString.apply(o)==="[object Error]"},isArray:function(){return toString.apply(o)==="[object Array]"},isDate:function(){return toString.apply(o)==="[object Date]"},isObject:function(){return !!o&&Object.prototype.toString.call(o)==="[object Object]"},isPrimitive:function(){return self.isString(o)||self.isNumber(o)||self.isBoolean(o)},isFunction:function(){return toString.apply(o)==="[object Function]"},isDate:function(){return toString.apply(o)==="[object Date]"},isNumber:function(){return typeof o==="number"&&isFinite(o)},isString:function(){return typeof o==="string"},isBoolean:function(){return typeof o==="boolean"},isArrayBuffer:function(){return toString.apply(o)==="[object ArrayBuffer]"}}}m.set("util.type",n);m.exp("util.type",n)})(c);(function(m){function n(q){var p=this;var o=m.get("util.type");this.pack=function(u){if(!Boolean(u)){u=[]}else{if(u.length>255){throw new Error("invalid-parameter")}for(var t=0;t<u.length;t++){if(!o(u[t]).isArrayBuffer()){throw new Error("invalid-parameter")}}}var v=[];for(var t in u){var r=u[t].byteLength;if(1==q){if(r>255){throw new Error("invalid-parameter")}var s=new Uint8Array([r]).buffer}else{if(2==q){if(r>65535){throw new Error("invalid-parameter")}var s=new Uint16Array([r]).buffer}}v.push(m.get("util.buffer").concat([s,u[t]]))}s=new Uint8Array([u.length]).buffer;v.unshift(s);return m.get("util.buffer").concat(v)};this.unpack=function(u){var s=0,r=0,x;var w=u.slice(0,1);u=u.slice(1);s=new Uint8Array(w)[0];var t=[];for(var v=0;v<s;v++){w=u.slice(0,q);u=u.slice(q);if(1==q){r=new Uint8Array(w)[0]}else{if(2==q){r=new Uint16Array(w)[0]}}x=u.slice(0,r);u=u.slice(r);t.push(x)}return[t,u]};return this}m.set("util.serialize.array",function(o){o.array=function(){return new n(2)};o.shortArray=function(){return new n(1)}})})(c);(function(n){function m(p){var o=this;this.unpack=function(q){var s;var r=q.slice(0,4);if(4==p){s=new Uint32Array(r)[0];q=q.slice(4)}else{if(2==p){s=new Uint16Array(r)[0];q=q.slice(2)}else{if(1==p){s=new Uint8Array(r)[0];q=q.slice(1)}}}if(0==s){return[null,q]}unpackResult=q.slice(0,s);q=q.slice(s);return[unpackResult,q]};this.pack=function(q){if(!Boolean(q)){q=new Uint8Array(0).buffer}if(!n.get("util.type")(q).isArrayBuffer()){throw new Error("invalid-parameter")}packLength=q.byteLength;if((4==p&&packLength>4294967295)||(2==p&&packLength>65535)||(1==p&&packLength>255)){throw new Error("invalid-parameter")}if(4==p){var r=new Uint32Array(1)}else{if(2==p){var r=new Uint16Array(1)}else{if(1==p){var r=new Uint8Array(1)}}}r[0]=packLength;r=r.buffer;return n.get("util.buffer").concat([r,q])};return this}n.set("util.serialize.binary",function(o){o.shortBinary=function(){return new m(1)};o.binary=function(){return new m(2)};o.longBinary=function(){return new m(4)}})})(c);(function(n){function m(){var o=this;this.pack=function(p){if(!n.get("util.type")(p).isBoolean()){throw new Error("invalid-parameter")}var q=new Uint8Array([(p?255:0)]).buffer;return q};this.unpack=function(p){var q=new Uint8Array(p.slice(0,1))[0];p=p.slice(1);return[Boolean(255==q),p]};return this}n.set("util.serialize.boolean",function(o){o["boolean"]=function(){return new m()}})})(c);(function(m){function n(r){var q=this;var o=m.get("util.type");if(!o(r).isArray()){throw new Error("invalid-parameter")}var s=false;r=r[0];if(o(r).isString()){r=m.get("util.encoding")(r).toArrayBuffer();s=true}if(!o(r).isArrayBuffer()){throw new Error("invalid-parameter")}this.pack=function(){return r};this.unpack=function(p){var t=p.slice(0,r.byteLength);p=p.slice(r.byteLength);if(!m.get("util.buffer").equal(t,r)){throw new Error("unexpected-constant")}if(s){t=m.get("util.encoding")(t).toUTF16()}return[t,p]};return this}m.set("util.serialize.constant",function(o){o.constant=function(q){return new n(q)}})})(c);(function(n){function m(){var p=this;var o=n.get("util.type");this.pack=function(t){if(!Boolean(t)){return new Uint8Array([0]).buffer}if(!o(t).isDate()){if(o(t).isString()){try{t=new Date(t)}catch(v){throw new Error("invalid-parameter")}}else{throw new Error("invalid-parameter")}}var u=t.toISOString();var r=n.get("util.encoding")(u,"ascii").toArrayBuffer(),s=r.byteLength,q=new Uint8Array([s]).buffer;return n.get("util.buffer").concat([q,r])};this.unpack=function(u){var r=u.slice(0,1),t=new Uint8Array(r)[0];u=u.slice(1);if(0==t){return[null,u]}var q=u.slice(0,t);u=u.slice(t);var s=new Date(n.get("util.encoding")(q).toASCII());return[s,u]};return this}n.set("util.serialize.datetime",function(o){o.datetime=function(){return new m()}})})(c);(function(m){function n(q){var o=this;if(!m.get("util.type")(q).isArray()||q.length>255){throw new Error("invalid-parameter")}this.pack=function(s){var r=q.indexOf(s);if(r<0){throw new Error("not-enum-item")}var p=new Uint8Array([r]);return p.buffer};this.unpack=function(p){var r=new Uint8Array(p.slice(0,1))[0];p=p.slice(1);if(r>=q.length){throw new Error("invalid-enum-value")}return[q[r],p]};return this}m.set("util.serialize.enum",function(o){o["enum"]=function(q){return new n(q)}})})(c);(function(n){var p=false;function m(r){var y=this;var s=n.get("util.type");if(!s(r).isObject()){throw new Error("invalid-data-structure")}var t=Object.keys(r).sort(),q=[];for(var v in t){var x=t[v];var w,u;if(s(r[x]).isString()){w=r[x];u=[]}else{w=r[x][0];u=r[x].slice(1)}if(!p[w]){throw new Error("invalid-data-structure")}q.push(p[w](u))}this.serialize=function(C){if(!s(C).isObject()){throw new Error("invalid-parameter")}var z=[];for(var B in q){var A=t[B];z.push(q[B].pack(C[A]))}return n.get("util.buffer").concat(z)};this.deserialize=function(A){if(!s(A).isArrayBuffer()){throw new Error("invalid-parameter")}var B={};for(var D in t){var C=t[D];var z=q[D].unpack(A);B[C]=z[0];A=z[1]}return B};return this}var o=function(q){if(false===p){p={};n.get("util.serialize.enum")(p);n.get("util.serialize.binary")(p);n.get("util.serialize.boolean")(p);n.get("util.serialize.constant")(p);n.get("util.serialize.array")(p)}return new m(q)};n.set("util.serialize",o)})(c);(function(n){function o(t,r){if(typeof t==="undefined"){t=32}this.isFinished=false;this.digestLength=32;this.blockLength=64;this.iv=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];if(t<=0){t=this.digestLength}else{if(t>32){throw"digestLength is too large"}}var p=0;if(typeof r=="string"){r=this.stringToUtf8Array(r);p=r.length}else{if(typeof r=="object"){p=r.length}}if(p>32){throw"key too long"}var s=[t&255,p,1,1];this.h=this.iv.slice(0);this.h[0]^=this.load32(s,0);this.x=new Array(64);this.t0=0;this.t1=0;this.f0=0;this.f1=0;this.nx=0;this.digestLength=t;if(p>0){for(var q=0;q<p;q++){this.x[q]=r[q]}for(var q=p;q<64;q++){this.x[q]=0}this.nx=64}}o.prototype.load32=function(q,r){return((q[r]&255)|((q[r+1]&255)<<8)|((q[r+2]&255)<<16)|((q[r+3]&255)<<24))>>>0};o.prototype.store32=function(r,s,q){r[s]=(q>>>0)&255;r[s+1]=(q>>>8)&255;r[s+2]=(q>>>16)&255;r[s+3]=(q>>>24)&255};o.prototype.processBlock=function(A){this.t0+=A;if(this.t0!=this.t0>>>0){this.t0=0;this.t1++}var z=this.h[0],y=this.h[1],x=this.h[2],w=this.h[3],u=this.h[4],s=this.h[5],q=this.h[6],V=this.h[7],T=this.iv[0],R=this.iv[1],O=this.iv[2],L=this.iv[3],I=this.iv[4]^this.t0,F=this.iv[5]^this.t1,D=this.iv[6]^this.f0,B=this.iv[7]^this.f1;var v=this.load32(this.x,0),t=this.load32(this.x,4),r=this.load32(this.x,8),p=this.load32(this.x,12),U=this.load32(this.x,16),S=this.load32(this.x,20),Q=this.load32(this.x,24),N=this.load32(this.x,28),K=this.load32(this.x,32),H=this.load32(this.x,36),P=this.load32(this.x,40),M=this.load32(this.x,44),J=this.load32(this.x,48),G=this.load32(this.x,52),E=this.load32(this.x,56),C=this.load32(this.x,60);z+=v;z+=u;I^=z;I=I<<(32-16)|I>>>16;T+=I;u^=T;u=u<<(32-12)|u>>>12;y+=r;y+=s;F^=y;F=F<<(32-16)|F>>>16;R+=F;s^=R;s=s<<(32-12)|s>>>12;x+=U;x+=q;D^=x;D=D<<(32-16)|D>>>16;O+=D;q^=O;q=q<<(32-12)|q>>>12;w+=Q;w+=V;B^=w;B=B<<(32-16)|B>>>16;L+=B;V^=L;V=V<<(32-12)|V>>>12;x+=S;x+=q;D^=x;D=D<<(32-8)|D>>>8;O+=D;q^=O;q=q<<(32-7)|q>>>7;w+=N;w+=V;B^=w;B=B<<(32-8)|B>>>8;L+=B;V^=L;V=V<<(32-7)|V>>>7;y+=p;y+=s;F^=y;F=F<<(32-8)|F>>>8;R+=F;s^=R;s=s<<(32-7)|s>>>7;z+=t;z+=u;I^=z;I=I<<(32-8)|I>>>8;T+=I;u^=T;u=u<<(32-7)|u>>>7;z+=K;z+=s;B^=z;B=B<<(32-16)|B>>>16;O+=B;s^=O;s=s<<(32-12)|s>>>12;y+=P;y+=q;I^=y;I=I<<(32-16)|I>>>16;L+=I;q^=L;q=q<<(32-12)|q>>>12;x+=J;x+=V;F^=x;F=F<<(32-16)|F>>>16;T+=F;V^=T;V=V<<(32-12)|V>>>12;w+=E;w+=u;D^=w;D=D<<(32-16)|D>>>16;R+=D;u^=R;u=u<<(32-12)|u>>>12;x+=G;x+=V;F^=x;F=F<<(32-8)|F>>>8;T+=F;V^=T;V=V<<(32-7)|V>>>7;w+=C;w+=u;D^=w;D=D<<(32-8)|D>>>8;R+=D;u^=R;u=u<<(32-7)|u>>>7;y+=M;y+=q;I^=y;I=I<<(32-8)|I>>>8;L+=I;q^=L;q=q<<(32-7)|q>>>7;z+=H;z+=s;B^=z;B=B<<(32-8)|B>>>8;O+=B;s^=O;s=s<<(32-7)|s>>>7;z+=E;z+=u;I^=z;I=I<<(32-16)|I>>>16;T+=I;u^=T;u=u<<(32-12)|u>>>12;y+=U;y+=s;F^=y;F=F<<(32-16)|F>>>16;R+=F;s^=R;s=s<<(32-12)|s>>>12;x+=H;x+=q;D^=x;D=D<<(32-16)|D>>>16;O+=D;q^=O;q=q<<(32-12)|q>>>12;w+=G;w+=V;B^=w;B=B<<(32-16)|B>>>16;L+=B;V^=L;V=V<<(32-12)|V>>>12;x+=C;x+=q;D^=x;D=D<<(32-8)|D>>>8;O+=D;q^=O;q=q<<(32-7)|q>>>7;w+=Q;w+=V;B^=w;B=B<<(32-8)|B>>>8;L+=B;V^=L;V=V<<(32-7)|V>>>7;y+=K;y+=s;F^=y;F=F<<(32-8)|F>>>8;R+=F;s^=R;s=s<<(32-7)|s>>>7;z+=P;z+=u;I^=z;I=I<<(32-8)|I>>>8;T+=I;u^=T;u=u<<(32-7)|u>>>7;z+=t;z+=s;B^=z;B=B<<(32-16)|B>>>16;O+=B;s^=O;s=s<<(32-12)|s>>>12;y+=v;y+=q;I^=y;I=I<<(32-16)|I>>>16;L+=I;q^=L;q=q<<(32-12)|q>>>12;x+=M;x+=V;F^=x;F=F<<(32-16)|F>>>16;T+=F;V^=T;V=V<<(32-12)|V>>>12;w+=S;w+=u;D^=w;D=D<<(32-16)|D>>>16;R+=D;u^=R;u=u<<(32-12)|u>>>12;x+=N;x+=V;F^=x;F=F<<(32-8)|F>>>8;T+=F;V^=T;V=V<<(32-7)|V>>>7;w+=p;w+=u;D^=w;D=D<<(32-8)|D>>>8;R+=D;u^=R;u=u<<(32-7)|u>>>7;y+=r;y+=q;I^=y;I=I<<(32-8)|I>>>8;L+=I;q^=L;q=q<<(32-7)|q>>>7;z+=J;z+=s;B^=z;B=B<<(32-8)|B>>>8;O+=B;s^=O;s=s<<(32-7)|s>>>7;z+=M;z+=u;I^=z;I=I<<(32-16)|I>>>16;T+=I;u^=T;u=u<<(32-12)|u>>>12;y+=J;y+=s;F^=y;F=F<<(32-16)|F>>>16;R+=F;s^=R;s=s<<(32-12)|s>>>12;x+=S;x+=q;D^=x;D=D<<(32-16)|D>>>16;O+=D;q^=O;q=q<<(32-12)|q>>>12;w+=C;w+=V;B^=w;B=B<<(32-16)|B>>>16;L+=B;V^=L;V=V<<(32-12)|V>>>12;x+=r;x+=q;D^=x;D=D<<(32-8)|D>>>8;O+=D;q^=O;q=q<<(32-7)|q>>>7;w+=G;w+=V;B^=w;B=B<<(32-8)|B>>>8;L+=B;V^=L;V=V<<(32-7)|V>>>7;y+=v;y+=s;F^=y;F=F<<(32-8)|F>>>8;R+=F;s^=R;s=s<<(32-7)|s>>>7;z+=K;z+=u;I^=z;I=I<<(32-8)|I>>>8;T+=I;u^=T;u=u<<(32-7)|u>>>7;z+=P;z+=s;B^=z;B=B<<(32-16)|B>>>16;O+=B;s^=O;s=s<<(32-12)|s>>>12;y+=p;y+=q;I^=y;I=I<<(32-16)|I>>>16;L+=I;q^=L;q=q<<(32-12)|q>>>12;x+=N;x+=V;F^=x;F=F<<(32-16)|F>>>16;T+=F;V^=T;V=V<<(32-12)|V>>>12;w+=H;w+=u;D^=w;D=D<<(32-16)|D>>>16;R+=D;u^=R;u=u<<(32-12)|u>>>12;x+=t;x+=V;F^=x;F=F<<(32-8)|F>>>8;T+=F;V^=T;V=V<<(32-7)|V>>>7;w+=U;w+=u;D^=w;D=D<<(32-8)|D>>>8;R+=D;u^=R;u=u<<(32-7)|u>>>7;y+=Q;y+=q;I^=y;I=I<<(32-8)|I>>>8;L+=I;q^=L;q=q<<(32-7)|q>>>7;z+=E;z+=s;B^=z;B=B<<(32-8)|B>>>8;O+=B;s^=O;s=s<<(32-7)|s>>>7;z+=N;z+=u;I^=z;I=I<<(32-16)|I>>>16;T+=I;u^=T;u=u<<(32-12)|u>>>12;y+=p;y+=s;F^=y;F=F<<(32-16)|F>>>16;R+=F;s^=R;s=s<<(32-12)|s>>>12;x+=G;x+=q;D^=x;D=D<<(32-16)|D>>>16;O+=D;q^=O;q=q<<(32-12)|q>>>12;w+=M;w+=V;B^=w;B=B<<(32-16)|B>>>16;L+=B;V^=L;V=V<<(32-12)|V>>>12;x+=J;x+=q;D^=x;D=D<<(32-8)|D>>>8;O+=D;q^=O;q=q<<(32-7)|q>>>7;w+=E;w+=V;B^=w;B=B<<(32-8)|B>>>8;L+=B;V^=L;V=V<<(32-7)|V>>>7;y+=t;y+=s;F^=y;F=F<<(32-8)|F>>>8;R+=F;s^=R;s=s<<(32-7)|s>>>7;z+=H;z+=u;I^=z;I=I<<(32-8)|I>>>8;T+=I;u^=T;u=u<<(32-7)|u>>>7;z+=r;z+=s;B^=z;B=B<<(32-16)|B>>>16;O+=B;s^=O;s=s<<(32-12)|s>>>12;y+=S;y+=q;I^=y;I=I<<(32-16)|I>>>16;L+=I;q^=L;q=q<<(32-12)|q>>>12;x+=U;x+=V;F^=x;F=F<<(32-16)|F>>>16;T+=F;V^=T;V=V<<(32-12)|V>>>12;w+=C;w+=u;D^=w;D=D<<(32-16)|D>>>16;R+=D;u^=R;u=u<<(32-12)|u>>>12;x+=v;x+=V;F^=x;F=F<<(32-8)|F>>>8;T+=F;V^=T;V=V<<(32-7)|V>>>7;w+=K;w+=u;D^=w;D=D<<(32-8)|D>>>8;R+=D;u^=R;u=u<<(32-7)|u>>>7;y+=P;y+=q;I^=y;I=I<<(32-8)|I>>>8;L+=I;q^=L;q=q<<(32-7)|q>>>7;z+=Q;z+=s;B^=z;B=B<<(32-8)|B>>>8;O+=B;s^=O;s=s<<(32-7)|s>>>7;z+=H;z+=u;I^=z;I=I<<(32-16)|I>>>16;T+=I;u^=T;u=u<<(32-12)|u>>>12;y+=S;y+=s;F^=y;F=F<<(32-16)|F>>>16;R+=F;s^=R;s=s<<(32-12)|s>>>12;x+=r;x+=q;D^=x;D=D<<(32-16)|D>>>16;O+=D;q^=O;q=q<<(32-12)|q>>>12;w+=P;w+=V;B^=w;B=B<<(32-16)|B>>>16;L+=B;V^=L;V=V<<(32-12)|V>>>12;x+=U;x+=q;D^=x;D=D<<(32-8)|D>>>8;O+=D;q^=O;q=q<<(32-7)|q>>>7;w+=C;w+=V;B^=w;B=B<<(32-8)|B>>>8;L+=B;V^=L;V=V<<(32-7)|V>>>7;y+=N;y+=s;F^=y;F=F<<(32-8)|F>>>8;R+=F;s^=R;s=s<<(32-7)|s>>>7;z+=v;z+=u;I^=z;I=I<<(32-8)|I>>>8;T+=I;u^=T;u=u<<(32-7)|u>>>7;z+=E;z+=s;B^=z;B=B<<(32-16)|B>>>16;O+=B;s^=O;s=s<<(32-12)|s>>>12;y+=M;y+=q;I^=y;I=I<<(32-16)|I>>>16;L+=I;q^=L;q=q<<(32-12)|q>>>12;x+=Q;x+=V;F^=x;F=F<<(32-16)|F>>>16;T+=F;V^=T;V=V<<(32-12)|V>>>12;w+=p;w+=u;D^=w;D=D<<(32-16)|D>>>16;R+=D;u^=R;u=u<<(32-12)|u>>>12;x+=K;x+=V;F^=x;F=F<<(32-8)|F>>>8;T+=F;V^=T;V=V<<(32-7)|V>>>7;w+=G;w+=u;D^=w;D=D<<(32-8)|D>>>8;R+=D;u^=R;u=u<<(32-7)|u>>>7;y+=J;y+=q;I^=y;I=I<<(32-8)|I>>>8;L+=I;q^=L;q=q<<(32-7)|q>>>7;z+=t;z+=s;B^=z;B=B<<(32-8)|B>>>8;O+=B;s^=O;s=s<<(32-7)|s>>>7;z+=r;z+=u;I^=z;I=I<<(32-16)|I>>>16;T+=I;u^=T;u=u<<(32-12)|u>>>12;y+=Q;y+=s;F^=y;F=F<<(32-16)|F>>>16;R+=F;s^=R;s=s<<(32-12)|s>>>12;x+=v;x+=q;D^=x;D=D<<(32-16)|D>>>16;O+=D;q^=O;q=q<<(32-12)|q>>>12;w+=K;w+=V;B^=w;B=B<<(32-16)|B>>>16;L+=B;V^=L;V=V<<(32-12)|V>>>12;x+=M;x+=q;D^=x;D=D<<(32-8)|D>>>8;O+=D;q^=O;q=q<<(32-7)|q>>>7;w+=p;w+=V;B^=w;B=B<<(32-8)|B>>>8;L+=B;V^=L;V=V<<(32-7)|V>>>7;y+=P;y+=s;F^=y;F=F<<(32-8)|F>>>8;R+=F;s^=R;s=s<<(32-7)|s>>>7;z+=J;z+=u;I^=z;I=I<<(32-8)|I>>>8;T+=I;u^=T;u=u<<(32-7)|u>>>7;z+=U;z+=s;B^=z;B=B<<(32-16)|B>>>16;O+=B;s^=O;s=s<<(32-12)|s>>>12;y+=N;y+=q;I^=y;I=I<<(32-16)|I>>>16;L+=I;q^=L;q=q<<(32-12)|q>>>12;x+=C;x+=V;F^=x;F=F<<(32-16)|F>>>16;T+=F;V^=T;V=V<<(32-12)|V>>>12;w+=t;w+=u;D^=w;D=D<<(32-16)|D>>>16;R+=D;u^=R;u=u<<(32-12)|u>>>12;x+=E;x+=V;F^=x;F=F<<(32-8)|F>>>8;T+=F;V^=T;V=V<<(32-7)|V>>>7;w+=H;w+=u;D^=w;D=D<<(32-8)|D>>>8;R+=D;u^=R;u=u<<(32-7)|u>>>7;y+=S;y+=q;I^=y;I=I<<(32-8)|I>>>8;L+=I;q^=L;q=q<<(32-7)|q>>>7;z+=G;z+=s;B^=z;B=B<<(32-8)|B>>>8;O+=B;s^=O;s=s<<(32-7)|s>>>7;z+=J;z+=u;I^=z;I=I<<(32-16)|I>>>16;T+=I;u^=T;u=u<<(32-12)|u>>>12;y+=t;y+=s;F^=y;F=F<<(32-16)|F>>>16;R+=F;s^=R;s=s<<(32-12)|s>>>12;x+=E;x+=q;D^=x;D=D<<(32-16)|D>>>16;O+=D;q^=O;q=q<<(32-12)|q>>>12;w+=U;w+=V;B^=w;B=B<<(32-16)|B>>>16;L+=B;V^=L;V=V<<(32-12)|V>>>12;x+=G;x+=q;D^=x;D=D<<(32-8)|D>>>8;O+=D;q^=O;q=q<<(32-7)|q>>>7;w+=P;w+=V;B^=w;B=B<<(32-8)|B>>>8;L+=B;V^=L;V=V<<(32-7)|V>>>7;y+=C;y+=s;F^=y;F=F<<(32-8)|F>>>8;R+=F;s^=R;s=s<<(32-7)|s>>>7;z+=S;z+=u;I^=z;I=I<<(32-8)|I>>>8;T+=I;u^=T;u=u<<(32-7)|u>>>7;z+=v;z+=s;B^=z;B=B<<(32-16)|B>>>16;O+=B;s^=O;s=s<<(32-12)|s>>>12;y+=Q;y+=q;I^=y;I=I<<(32-16)|I>>>16;L+=I;q^=L;q=q<<(32-12)|q>>>12;x+=H;x+=V;F^=x;F=F<<(32-16)|F>>>16;T+=F;V^=T;V=V<<(32-12)|V>>>12;w+=K;w+=u;D^=w;D=D<<(32-16)|D>>>16;R+=D;u^=R;u=u<<(32-12)|u>>>12;x+=r;x+=V;F^=x;F=F<<(32-8)|F>>>8;T+=F;V^=T;V=V<<(32-7)|V>>>7;w+=M;w+=u;D^=w;D=D<<(32-8)|D>>>8;R+=D;u^=R;u=u<<(32-7)|u>>>7;y+=p;y+=q;I^=y;I=I<<(32-8)|I>>>8;L+=I;q^=L;q=q<<(32-7)|q>>>7;z+=N;z+=s;B^=z;B=B<<(32-8)|B>>>8;O+=B;s^=O;s=s<<(32-7)|s>>>7;z+=G;z+=u;I^=z;I=I<<(32-16)|I>>>16;T+=I;u^=T;u=u<<(32-12)|u>>>12;y+=N;y+=s;F^=y;F=F<<(32-16)|F>>>16;R+=F;s^=R;s=s<<(32-12)|s>>>12;x+=J;x+=q;D^=x;D=D<<(32-16)|D>>>16;O+=D;q^=O;q=q<<(32-12)|q>>>12;w+=p;w+=V;B^=w;B=B<<(32-16)|B>>>16;L+=B;V^=L;V=V<<(32-12)|V>>>12;x+=t;x+=q;D^=x;D=D<<(32-8)|D>>>8;O+=D;q^=O;q=q<<(32-7)|q>>>7;w+=H;w+=V;B^=w;B=B<<(32-8)|B>>>8;L+=B;V^=L;V=V<<(32-7)|V>>>7;y+=E;y+=s;F^=y;F=F<<(32-8)|F>>>8;R+=F;s^=R;s=s<<(32-7)|s>>>7;z+=M;z+=u;I^=z;I=I<<(32-8)|I>>>8;T+=I;u^=T;u=u<<(32-7)|u>>>7;z+=S;z+=s;B^=z;B=B<<(32-16)|B>>>16;O+=B;s^=O;s=s<<(32-12)|s>>>12;y+=C;y+=q;I^=y;I=I<<(32-16)|I>>>16;L+=I;q^=L;q=q<<(32-12)|q>>>12;x+=K;x+=V;F^=x;F=F<<(32-16)|F>>>16;T+=F;V^=T;V=V<<(32-12)|V>>>12;w+=r;w+=u;D^=w;D=D<<(32-16)|D>>>16;R+=D;u^=R;u=u<<(32-12)|u>>>12;x+=Q;x+=V;F^=x;F=F<<(32-8)|F>>>8;T+=F;V^=T;V=V<<(32-7)|V>>>7;w+=P;w+=u;D^=w;D=D<<(32-8)|D>>>8;R+=D;u^=R;u=u<<(32-7)|u>>>7;y+=U;y+=q;I^=y;I=I<<(32-8)|I>>>8;L+=I;q^=L;q=q<<(32-7)|q>>>7;z+=v;z+=s;B^=z;B=B<<(32-8)|B>>>8;O+=B;s^=O;s=s<<(32-7)|s>>>7;z+=Q;z+=u;I^=z;I=I<<(32-16)|I>>>16;T+=I;u^=T;u=u<<(32-12)|u>>>12;y+=E;y+=s;F^=y;F=F<<(32-16)|F>>>16;R+=F;s^=R;s=s<<(32-12)|s>>>12;x+=M;x+=q;D^=x;D=D<<(32-16)|D>>>16;O+=D;q^=O;q=q<<(32-12)|q>>>12;w+=v;w+=V;B^=w;B=B<<(32-16)|B>>>16;L+=B;V^=L;V=V<<(32-12)|V>>>12;x+=p;x+=q;D^=x;D=D<<(32-8)|D>>>8;O+=D;q^=O;q=q<<(32-7)|q>>>7;w+=K;w+=V;B^=w;B=B<<(32-8)|B>>>8;L+=B;V^=L;V=V<<(32-7)|V>>>7;y+=H;y+=s;F^=y;F=F<<(32-8)|F>>>8;R+=F;s^=R;s=s<<(32-7)|s>>>7;z+=C;z+=u;I^=z;I=I<<(32-8)|I>>>8;T+=I;u^=T;u=u<<(32-7)|u>>>7;z+=J;z+=s;B^=z;B=B<<(32-16)|B>>>16;O+=B;s^=O;s=s<<(32-12)|s>>>12;y+=G;y+=q;I^=y;I=I<<(32-16)|I>>>16;L+=I;q^=L;q=q<<(32-12)|q>>>12;x+=t;x+=V;F^=x;F=F<<(32-16)|F>>>16;T+=F;V^=T;V=V<<(32-12)|V>>>12;w+=P;w+=u;D^=w;D=D<<(32-16)|D>>>16;R+=D;u^=R;u=u<<(32-12)|u>>>12;x+=U;x+=V;F^=x;F=F<<(32-8)|F>>>8;T+=F;V^=T;V=V<<(32-7)|V>>>7;w+=S;w+=u;D^=w;D=D<<(32-8)|D>>>8;R+=D;u^=R;u=u<<(32-7)|u>>>7;y+=N;y+=q;I^=y;I=I<<(32-8)|I>>>8;L+=I;q^=L;q=q<<(32-7)|q>>>7;z+=r;z+=s;B^=z;B=B<<(32-8)|B>>>8;O+=B;s^=O;s=s<<(32-7)|s>>>7;z+=P;z+=u;I^=z;I=I<<(32-16)|I>>>16;T+=I;u^=T;u=u<<(32-12)|u>>>12;y+=K;y+=s;F^=y;F=F<<(32-16)|F>>>16;R+=F;s^=R;s=s<<(32-12)|s>>>12;x+=N;x+=q;D^=x;D=D<<(32-16)|D>>>16;O+=D;q^=O;q=q<<(32-12)|q>>>12;w+=t;w+=V;B^=w;B=B<<(32-16)|B>>>16;L+=B;V^=L;V=V<<(32-12)|V>>>12;x+=Q;x+=q;D^=x;D=D<<(32-8)|D>>>8;O+=D;q^=O;q=q<<(32-7)|q>>>7;w+=S;w+=V;B^=w;B=B<<(32-8)|B>>>8;L+=B;V^=L;V=V<<(32-7)|V>>>7;y+=U;y+=s;F^=y;F=F<<(32-8)|F>>>8;R+=F;s^=R;s=s<<(32-7)|s>>>7;z+=r;z+=u;I^=z;I=I<<(32-8)|I>>>8;T+=I;u^=T;u=u<<(32-7)|u>>>7;z+=C;z+=s;B^=z;B=B<<(32-16)|B>>>16;O+=B;s^=O;s=s<<(32-12)|s>>>12;y+=H;y+=q;I^=y;I=I<<(32-16)|I>>>16;L+=I;q^=L;q=q<<(32-12)|q>>>12;x+=p;x+=V;F^=x;F=F<<(32-16)|F>>>16;T+=F;V^=T;V=V<<(32-12)|V>>>12;w+=G;w+=u;D^=w;D=D<<(32-16)|D>>>16;R+=D;u^=R;u=u<<(32-12)|u>>>12;x+=J;x+=V;F^=x;F=F<<(32-8)|F>>>8;T+=F;V^=T;V=V<<(32-7)|V>>>7;w+=v;w+=u;D^=w;D=D<<(32-8)|D>>>8;R+=D;u^=R;u=u<<(32-7)|u>>>7;y+=E;y+=q;I^=y;I=I<<(32-8)|I>>>8;L+=I;q^=L;q=(q<<(32-7))|(q>>>7);z+=M;z+=s;B^=z;B=(B<<(32-8))|(B>>>8);O+=B;s^=O;s=(s<<(32-7))|(s>>>7);this.h[0]^=z^T;this.h[1]^=y^R;this.h[2]^=x^O;this.h[3]^=w^L;this.h[4]^=u^I;this.h[5]^=s^F;this.h[6]^=q^D;this.h[7]^=V^B};o.prototype.stringToUtf8Array=function(r){var p=[];for(var q=0;q<r.length;q++){var t=r.charCodeAt(q);if(t<128){p.push(t)}else{if(t>127&&t<2048){p.push((t>>6)|192);p.push((t&63)|128)}else{p.push((t>>12)|224);p.push(((t>>6)&63)|128);p.push((t&64)|128)}}}return p};o.prototype.update=function(t,u,r){if(typeof u==="undefined"){u=0}if(typeof r==="undefined"){r=t.length}if(this.isFinished){throw"update() after calling digest()"}if(typeof t=="string"){if(u!=0){throw"offset not supported for strings"}t=this.stringToUtf8Array(t);r=t.length;u=0}else{if(typeof t!="object"){throw"unsupported object: string or array required"}}if(r==0){return}var s=64-this.nx;if(r>s){for(var q=0;q<s;q++){this.x[this.nx+q]=t[u+q]}this.processBlock(64);u+=s;r-=s;this.nx=0}while(r>64){for(var q=0;q<64;q++){this.x[q]=t[u+q]}this.processBlock(64);u+=64;r-=64;this.nx=0}for(var q=0;q<r;q++){this.x[this.nx+q]=t[u+q]}this.nx+=r};o.prototype.digest=function(){if(this.isFinished){return this.result}for(var q=this.nx;q<64;q++){this.x[q]=0}this.f0=4294967295;this.processBlock(this.nx);var p=new Array(32);for(var q=0;q<8;q++){var r=this.h[q];p[q*4+0]=(r>>>0)&255;p[q*4+1]=(r>>>8)&255;p[q*4+2]=(r>>>16)&255;p[q*4+3]=(r>>>24)&255}this.result=p.slice(0,this.digestLength);this.isFinished=true;return this.result};function m(r){var p=this;this.name="BLAKE2s";this.blockSize=32;if(r&&n.get("util.type")(r.length).isNumber()&&r.length<=32&&r.length>=1){this.digestSize=Math.floor(r.length)}else{this.digestSize=32}function q(u,t){if(t){var s=new o(p.digestSize,new Uint8Array(t))}else{var s=new o(p.digestSize)}s.update(new Uint8Array(u));return new Uint8Array(s.digest()).buffer}this.mac=function(t,s){if(s.byteLength>32){s=s.slice(0,32)}return q(t,s)};this.hash=function(s){return q(s)};return this}n.set("hash.algorithms.blake2s",m)})(c);(function(n){var o={};function p(t,s){var r=this;this.algorithms=["ripemd160","blake2s","whirlpool"];t=t.toLowerCase();if(this.algorithms.indexOf(t)<0){throw new Error("hash-algorithm-unknown")}var v=n.get("hash.algorithms."+t);function u(w){return{hex:n.get("util.encoding")(w).toHEX(),buffer:w}}this.hash=function(x){if(!n.get("util.type")(x).isArrayBuffer()){throw Error("invalid-parameter")}var w=new v(s);return u(w.hash(x))};this.mac=function(y,z){if(!(n.get("util.type")(z).isArrayBuffer()&&n.get("util.type")(y).isArrayBuffer())){throw Error("invalid-parameter")}var x;var w=new v(s);if(n.get("util.type")(w.mac).isFunction()){x=w.mac(y,z)}else{x=q(w.hash,z,y,w.blockSize)}return u(x)};this.pbkdf2=function(x,w,z,y){if(!(n.get("util.type")(x).isArrayBuffer()&&n.get("util.type")(w).isArrayBuffer()&&z>0&&y>0)){throw Error("invalid-parameter")}return m(r.mac,new v().digestSize,x,w,z,y)};return this}function q(C,t,v,z){if(t.byteLength>z){t=new Uint8Array(C(t))}else{if(t.byteLength<z){var r=new Uint8Array(z),y=new Uint8Array(t);for(var w=0;w<r.length;w++){if(w<t.byteLength){r[w]=y[w]}else{r[w]=0}}t=r}}var D=new Uint8Array(z);var u=new Uint8Array(z);for(var w=0;w<z;w++){D[w]=92^t[w];u[w]=54^t[w]}var s=n.get("util.buffer").concat([u.buffer,v]),A=C(s);var B=n.get("util.buffer").concat([D.buffer,A]),x=C(B);return x}function m(E,C,y,v,t,r){var D=Math.ceil(r/C);var A=new Array(D);for(var x=0;x<D;x++){var z=false;var s=new Uint32Array([x]);var B=n.get("util.buffer").concat([v,s.buffer]);for(var w=0;w<t;w++){var u=E(y,B).buffer;if(false===z){z=u}else{z=n.get("util.buffer").xor(u,z)}B=u}A[x]=z}return n.get("util.buffer").concat(A).slice(0,r)}n.exp("hash",p);n.set("hash",p)})(c);(function(q){var r=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13];var o=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11];var B=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6];var A=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11];var p=[0,1518500249,1859775393,2400959708,2840853838];var D=[1352829926,1548603684,1836072691,2053994217,0];var m=function(F){var H=[];for(var G=0,E=0;G<F.length;G++,E+=8){H[E>>>5]|=F[G]<<(24-E%32)}return H};var s=function(G){var F=[];for(var E=0;E<G.length*32;E+=8){F.push((G[E>>>5]>>>(24-E%32))&255)}return F};var C=function(S,P,J){for(var K=0;K<16;K++){var U=J+K;var Q=P[U];P[U]=((((Q<<8)|(Q>>>24))&16711935)|(((Q<<24)|(Q>>>8))&4278255360))}var N,F,R,L,E;var I,W,O,G,T;I=N=S[0];W=F=S[1];O=R=S[2];G=L=S[3];T=E=S[4];var V;for(var K=0;K<80;K+=1){V=(N+P[J+r[K]])|0;if(K<16){V+=z(F,R,L)+p[0]}else{if(K<32){V+=y(F,R,L)+p[1]}else{if(K<48){V+=x(F,R,L)+p[2]}else{if(K<64){V+=w(F,R,L)+p[3]}else{V+=v(F,R,L)+p[4]}}}}V=V|0;V=u(V,B[K]);V=(V+E)|0;N=E;E=L;L=u(R,10);R=F;F=V;V=(I+P[J+o[K]])|0;if(K<16){V+=v(W,O,G)+D[0]}else{if(K<32){V+=w(W,O,G)+D[1]}else{if(K<48){V+=x(W,O,G)+D[2]}else{if(K<64){V+=y(W,O,G)+D[3]}else{V+=z(W,O,G)+D[4]}}}}V=V|0;V=u(V,A[K]);V=(V+T)|0;I=T;T=G;G=u(O,10);O=W;W=V}V=(S[1]+R+G)|0;S[1]=(S[2]+L+T)|0;S[2]=(S[3]+E+I)|0;S[3]=(S[4]+N+W)|0;S[4]=(S[0]+F+O)|0;S[0]=V};function z(E,G,F){return((E)^(G)^(F))}function y(E,G,F){return(((E)&(G))|((~E)&(F)))}function x(E,G,F){return(((E)|(~(G)))^(F))}function w(E,G,F){return(((E)&(F))|((G)&(~(F))))}function v(E,G,F){return((E)^((G)|(~(F))))}function u(E,F){return(E<<F)|(E>>>(32-F))}function n(M){var L=[1732584193,4023233417,2562383102,271733878,3285377520],N=new Uint8Array(M);var F=m(N);var K=N.length*8;var J=N.length*8;F[K>>>5]|=128<<(24-K%32);F[(((K+64)>>>9)<<4)+14]=((((J<<8)|(J>>>24))&16711935)|(((J<<24)|(J>>>8))&4278255360));for(var G=0;G<F.length;G+=16){C(L,F,G)}var E;for(var G=0;G<5;G++){E=L[G];L[G]=(((E<<8)|(E>>>24))&16711935)|(((E<<24)|(E>>>8))&4278255360)}var I=s(L);return new Uint8Array(I).buffer}function t(){var E=this;this.name="RIPEMD160";this.blockSize=64;this.digestSize=20;this.hash=function(F){return n(F)};return this}q.set("hash.algorithms.ripemd160",t)})(c);(function(s){var Q,v=10,H=[],J=[],F,E,P,I,O,q,p,n,m,U,T,G="\u1823\uc6E8\u87B8\u014F\u36A6\ud2F5\u796F\u9152\u60Bc\u9B8E\uA30c\u7B35\u1dE0\ud7c2\u2E4B\uFE57\u1577\u37E5\u9FF0\u4AdA\u58c9\u290A\uB1A0\u6B85\uBd5d\u10F4\ucB3E\u0567\uE427\u418B\uA77d\u95d8\uFBEE\u7c66\udd17\u479E\ucA2d\uBF07\uAd5A\u8333\u6302\uAA71\uc819\u49d9\uF2E3\u5B88\u9A26\u32B0\uE90F\ud580\uBEcd\u3448\uFF7A\u905F\u2068\u1AAE\uB454\u9322\u64F1\u7312\u4008\uc3Ec\udBA1\u8d3d\u9700\ucF2B\u7682\ud61B\uB5AF\u6A50\u45F3\u30EF\u3F55\uA2EA\u65BA\u2Fc0\udE1c\uFd4d\u9275\u068A\uB2E6\u0E1F\u62d4\uA896\uF9c5\u2559\u8472\u394c\u5E78\u388c\ud1A5\uE261\uB321\u9c1E\u43c7\uFc04\u5199\u6d0d\uFAdF\u7E24\u3BAB\ucE11\u8F4E\uB7EB\u3c81\u94F7\uB913\u2cd3\uE76E\uc403\u5644\u7FA9\u2ABB\uc153\udc0B\u9d6c\u3174\uF646\uAc89\u14E1\u163A\u6909\u70B6\ud0Ed\ucc42\u98A4\u285c\uF886";for(F=8;F-->0;){H[F]=[]}for(E=0;E<256;E++){P=G.charCodeAt(E/2);q=((E&1)==0)?P>>>8:P&255;p=q<<1;if(p>=256){p^=285}n=p<<1;if(n>=256){n^=285}m=n^q;U=n<<1;if(U>=256){U^=285}T=U^q;H[0][E]=[0,0];H[0][E][0]=(q<<24)|(q<<16)|(n<<8)|(q);H[0][E][1]=(U<<24)|(m<<16)|(p<<8)|(T);for(var F=1;F<8;F++){H[F][E]=[0,0];H[F][E][0]=(H[F-1][E][0]>>>8)|((H[F-1][E][1]<<24));H[F][E][1]=(H[F-1][E][1]>>>8)|((H[F-1][E][0]<<24))}}J[0]=[0,0];for(I=1;I<=v;I++){O=8*(I-1);J[I]=[0,0];J[I][0]=(H[0][O][0]&4278190080)^(H[1][O+1][0]&16711680)^(H[2][O+2][0]&65280)^(H[3][O+3][0]&255);J[I][1]=(H[4][O+4][1]&4278190080)^(H[5][O+5][1]&16711680)^(H[6][O+6][1]&65280)^(H[7][O+7][1]&255)}var N=[],M=[],A=0,w=0,o=[],B=[],z=[],y=[],u=[];var S=function(){var K,x,R,L,C;for(K=0,x=0;K<8;K++,x+=8){y[K]=[0,0];y[K][0]=((M[x]&255)<<24)^((M[x+1]&255)<<16)^((M[x+2]&255)<<8)^((M[x+3]&255));y[K][1]=((M[x+4]&255)<<24)^((M[x+5]&255)<<16)^((M[x+6]&255)<<8)^((M[x+7]&255))}for(K=0;K<8;K++){u[K]=[0,0];B[K]=[0,0];u[K][0]=y[K][0]^(B[K][0]=o[K][0]);u[K][1]=y[K][1]^(B[K][1]=o[K][1])}for(R=1;R<=v;R++){for(K=0;K<8;K++){z[K]=[0,0];for(C=0,L=56,x=0;C<8;C++,L-=8,x=L<32?1:0){z[K][0]^=H[C][(B[(K-C)&7][x]>>>(L%32))&255][0];z[K][1]^=H[C][(B[(K-C)&7][x]>>>(L%32))&255][1]}}for(K=0;K<8;K++){B[K][0]=z[K][0];B[K][1]=z[K][1]}B[0][0]^=J[R][0];B[0][1]^=J[R][1];for(K=0;K<8;K++){z[K][0]=B[K][0];z[K][1]=B[K][1];for(C=0,L=56,x=0;C<8;C++,L-=8,x=L<32?1:0){z[K][0]^=H[C][(u[(K-C)&7][x]>>>(L%32))&255][0];z[K][1]^=H[C][(u[(K-C)&7][x]>>>(L%32))&255][1]}}for(K=0;K<8;K++){u[K][0]=z[K][0];u[K][1]=z[K][1]}}for(K=0;K<8;K++){o[K][0]^=u[K][0]^y[K][0];o[K][1]^=u[K][1]^y[K][1]}};Q=Whirlpool=function(r){return Q.init().add(r).finalize()};Q.version="3.0";Q.init=function(){for(var r=32;r-->0;){N[r]=0}A=w=0;M=[0];for(r=8;r-->0;){o[r]=[0,0]}return Q};Q.add=function(L){if(!L){return Q}var r=new Uint8Array(L);var X=r.length*8;var t=0,x=(8-(X&7))&7,K=A&7,C,R,W,V=X;for(C=31,W=0;C>=0;C--){W+=(N[C]&255)+(V%256);N[C]=W&255;W>>>=8;V=Math.floor(V/256)}while(X>8){R=((r[t]<<x)&255)|((r[t+1]&255)>>>(8-x));if(R<0||R>=256){return"Whirlpool requires a byte array"}M[w++]|=R>>>K;A+=8-K;if(A==512){S();A=w=0;M=[]}M[w]=((R<<(8-K))&255);A+=K;X-=8;t++}if(X>0){R=(r[t]<<x)&255;M[w]|=R>>>K}else{R=0}if(K+X<8){A+=X}else{w++;A+=8-K;X-=8-K;if(A==512){S();A=w=0;M=[]}M[w]=((R<<(8-K))&255);A+=X}return Q};Q.finalize=function(){var t,r,x,K="",C=[];M[w]|=128>>>(A&7);w++;if(w>32){while(w<64){M[w++]=0}S();w=0;M=[]}while(w<32){M[w++]=0}M.push.apply(M,N);S();for(t=0,r=0;t<8;t++,r+=8){x=o[t][0];C[r]=x>>>24&255;C[r+1]=x>>>16&255;C[r+2]=x>>>8&255;C[r+3]=x&255;x=o[t][1];C[r+4]=x>>>24&255;C[r+5]=x>>>16&255;C[r+6]=x>>>8&255;C[r+7]=x&255}return new Uint8Array(C).buffer};function D(){var r=this;this.name="WHIRLPOOL";this.blockSize=64;this.digestSize=64;this.hash=function(t){return Whirlpool(t)};return this}s.set("hash.algorithms.whirlpool",D)})(c);(function(bf){var bk;var aY=244837814094590;var aL=((aY&16777215)==15715070);function a7(bp,bo,bq){if(!(this instanceof a7)){return new a7(bp,bo,bq)}if(bp!=null){if("number"==typeof bp){this.fromNumber(bp,bo,bq)}else{if(bo==null&&"string"!=typeof bp){this.fromString(bp,256)}else{this.fromString(bp,bo)}}}}var bh=a7.prototype;function x(){return new a7(null)}function m(bs,bo,bp,br,bu,bt){while(--bt>=0){var bq=bo*this[bs++]+bp[br]+bu;bu=Math.floor(bq/67108864);bp[br++]=bq&67108863}return bu}function bm(bs,bx,by,br,bv,bo){var bu=bx&32767,bw=bx>>15;while(--bo>=0){var bq=this[bs]&32767;var bt=this[bs++]>>15;var bp=bw*bq+bt*bu;bq=bu*bq+((bp&32767)<<15)+by[br]+(bv&1073741823);bv=(bq>>>30)+(bp>>>15)+bw*bt+(bv>>>30);by[br++]=bq&1073741823}return bv}function bl(bs,bx,by,br,bv,bo){var bu=bx&16383,bw=bx>>14;while(--bo>=0){var bq=this[bs]&16383;var bt=this[bs++]>>14;var bp=bw*bq+bt*bu;bq=bu*bq+((bp&16383)<<14)+by[br]+bv;bv=(bq>>28)+(bp>>14)+bw*bt;by[br++]=bq&268435455}return bv}a7.prototype.am=m;bk=26;a7.prototype.DB=bk;a7.prototype.DM=((1<<bk)-1);var av=a7.prototype.DV=(1<<bk);var aM=52;a7.prototype.FV=Math.pow(2,aM);a7.prototype.F1=aM-bk;a7.prototype.F2=2*bk-aM;var aU="0123456789abcdefghijklmnopqrstuvwxyz";var aX=new Array();var a5,M;a5="0".charCodeAt(0);for(M=0;M<=9;++M){aX[a5++]=M}a5="a".charCodeAt(0);for(M=10;M<36;++M){aX[a5++]=M}a5="A".charCodeAt(0);for(M=10;M<36;++M){aX[a5++]=M}function bn(bo){return aU.charAt(bo)}function W(bp,bo){var bq=aX[bp.charCodeAt(bo)];return(bq==null)?-1:bq}function aK(bp){for(var bo=this.t-1;bo>=0;--bo){bp[bo]=this[bo]}bp.t=this.t;bp.s=this.s}function G(bo){this.t=1;this.s=(bo<0)?-1:0;if(bo>0){this[0]=bo}else{if(bo<-1){this[0]=bo+av}else{this.t=0}}}function p(bo){var bp=x();bp.fromInt(bo);return bp}function P(bv,bp){var bs=this;var br;if(bp==16){br=4}else{if(bp==8){br=3}else{if(bp==256){br=8}else{if(bp==2){br=1}else{if(bp==32){br=5}else{if(bp==4){br=2}else{bs.fromRadix(bv,bp);return}}}}}}bs.t=0;bs.s=0;var bu=bv.length,bq=false,bt=0;while(--bu>=0){var bo=(br==8)?bv[bu]&255:W(bv,bu);if(bo<0){if(bv.charAt(bu)=="-"){bq=true}continue}bq=false;if(bt==0){bs[bs.t++]=bo}else{if(bt+br>bs.DB){bs[bs.t-1]|=(bo&((1<<(bs.DB-bt))-1))<<bt;bs[bs.t++]=(bo>>(bs.DB-bt))}else{bs[bs.t-1]|=bo<<bt}}bt+=br;if(bt>=bs.DB){bt-=bs.DB}}if(br==8&&(bv[0]&128)!=0){bs.s=-1;if(bt>0){bs[bs.t-1]|=((1<<(bs.DB-bt))-1)<<bt}}bs.clamp();if(bq){a7.ZERO.subTo(bs,bs)}}function ap(){var bo=this.s&this.DM;while(this.t>0&&this[this.t-1]==bo){--this.t}}function I(bv){var bw=this;if(bw.s<0){return"-"+bw.negate().toString(bv)}var bs;if(bv==16){bs=4}else{if(bv==8){bs=3}else{if(bv==2){bs=1}else{if(bv==32){bs=5}else{if(bv==4){bs=2}else{return bw.toRadix(bv)}}}}}var bp=(1<<bs)-1,bu,br=false,bo="",bt=bw.t;var bq=bw.DB-(bt*bw.DB)%bs;if(bt-->0){if(bq<bw.DB&&(bu=bw[bt]>>bq)>0){br=true;bo=bn(bu)}while(bt>=0){if(bq<bs){bu=(bw[bt]&((1<<bq)-1))<<(bs-bq);bu|=bw[--bt]>>(bq+=bw.DB-bs)}else{bu=(bw[bt]>>(bq-=bs))&bp;if(bq<=0){bq+=bw.DB;--bt}}if(bu>0){br=true}if(br){bo+=bn(bu)}}}return br?bo:"0"}function au(){var bo=x();a7.ZERO.subTo(this,bo);return bo}function a1(){return(this.s<0)?this.negate():this}function ag(bo){var bq=this.s-bo.s;if(bq!=0){return bq}var bp=this.t;bq=bp-bo.t;if(bq!=0){return(this.s<0)?-bq:bq}while(--bp>=0){if((bq=this[bp]-bo[bp])!=0){return bq}}return 0}function C(bo){var bq=1,bp;if((bp=bo>>>16)!=0){bo=bp;bq+=16}if((bp=bo>>8)!=0){bo=bp;bq+=8}if((bp=bo>>4)!=0){bo=bp;bq+=4}if((bp=bo>>2)!=0){bo=bp;bq+=2}if((bp=bo>>1)!=0){bo=bp;bq+=1}return bq}function L(){if(this.t<=0){return 0}return this.DB*(this.t-1)+C(this[this.t-1]^(this.s&this.DM))}function a6(bq,bp){var bo;for(bo=this.t-1;bo>=0;--bo){bp[bo+bq]=this[bo]}for(bo=bq-1;bo>=0;--bo){bp[bo]=0}bp.t=this.t+bq;bp.s=this.s}function aJ(bq,bp){for(var bo=bq;bo<this.t;++bo){bp[bo-bq]=this[bo]}bp.t=Math.max(this.t-bq,0);bp.s=this.s}function K(bq,bo){var bx=this;var bw=bq%bx.DB;var bu=bx.DB-bw;var bp=(1<<bu)-1;var br=Math.floor(bq/bx.DB),bv=(bx.s<<bw)&bx.DM,bt;for(bt=bx.t-1;bt>=0;--bt){bo[bt+br+1]=(bx[bt]>>bu)|bv;bv=(bx[bt]&bp)<<bw}for(bt=br-1;bt>=0;--bt){bo[bt]=0}bo[br]=bv;bo.t=bx.t+br+1;bo.s=bx.s;bo.clamp()}function D(bw,bt){var bo=this;bt.s=bo.s;var bu=Math.floor(bw/bo.DB);if(bu>=bo.t){bt.t=0;return}var bq=bw%bo.DB;var bp=bo.DB-bq;var bv=(1<<bq)-1;bt[0]=bo[bu]>>bq;for(var br=bu+1;br<bo.t;++br){bt[br-bu-1]|=(bo[br]&bv)<<bp;bt[br-bu]=bo[br]>>bq}if(bq>0){bt[bo.t-bu-1]|=(bo.s&bv)<<bp}bt.t=bo.t-bu;bt.clamp()}function aN(bp,bs){var bq=this;var br=0,bt=0,bo=Math.min(bp.t,bq.t);while(br<bo){bt+=bq[br]-bp[br];bs[br++]=bt&bq.DM;bt>>=bq.DB}if(bp.t<bq.t){bt-=bp.s;while(br<bq.t){bt+=bq[br];bs[br++]=bt&bq.DM;bt>>=bq.DB}bt+=bq.s}else{bt+=bq.s;while(br<bp.t){bt-=bp[br];bs[br++]=bt&bq.DM;bt>>=bq.DB}bt-=bp.s}bs.s=(bt<0)?-1:0;if(bt<-1){bs[br++]=bq.DV+bt}else{if(bt>0){bs[br++]=bt}}bs.t=br;bs.clamp()}function ab(bp,br){var bo=this.abs(),bs=bp.abs();var bq=bo.t;br.t=bq+bs.t;while(--bq>=0){br[bq]=0}for(bq=0;bq<bs.t;++bq){br[bq+bo.t]=bo.am(0,bs[bq],br,bq,0,bo.t)}br.s=0;br.clamp();if(this.s!=bp.s){a7.ZERO.subTo(br,br)}}function ar(bq){var bo=this.abs();var bp=bq.t=2*bo.t;while(--bp>=0){bq[bp]=0}for(bp=0;bp<bo.t-1;++bp){var br=bo.am(bp,bo[bp],bq,2*bp,0,1);if((bq[bp+bo.t]+=bo.am(bp+1,2*bo[bp],bq,2*bp+1,br,bo.t-bp-1))>=bo.DV){bq[bp+bo.t]-=bo.DV;bq[bp+bo.t+1]=1}}if(bq.t>0){bq[bq.t-1]+=bo.am(bp,bo[bp],bq,2*bp,0,1)}bq.s=0;bq.clamp()}function ac(by,bv,bt){var bu=this;var bE=by.abs();if(bE.t<=0){return}var bw=bu.abs();if(bw.t<bE.t){if(bv!=null){bv.fromInt(0)}if(bt!=null){bu.copyTo(bt)}return}if(bt==null){bt=x()}var br=x(),bo=bu.s,bx=by.s;var bD=bu.DB-C(bE[bE.t-1]);if(bD>0){bE.lShiftTo(bD,br);bw.lShiftTo(bD,bt)}else{bE.copyTo(br);bw.copyTo(bt)}var bB=br.t;var bp=br[bB-1];if(bp==0){return}var bz=bp*(1<<bu.F1)+((bB>1)?br[bB-2]>>bu.F2:0);var bH=bu.FV/bz,bG=(1<<bu.F1)/bz,bF=1<<bu.F2;var bC=bt.t,bA=bC-bB,bs=(bv==null)?x():bv;br.dlShiftTo(bA,bs);if(bt.compareTo(bs)>=0){bt[bt.t++]=1;bt.subTo(bs,bt)}a7.ONE.dlShiftTo(bB,bs);bs.subTo(br,br);while(br.t<bB){br[br.t++]=0}while(--bA>=0){var bq=(bt[--bC]==bp)?bu.DM:Math.floor(bt[bC]*bH+(bt[bC-1]+bF)*bG);if((bt[bC]+=br.am(0,bq,bt,bA,0,bB))<bq){br.dlShiftTo(bA,bs);bt.subTo(bs,bt);while(bt[bC]<--bq){bt.subTo(bs,bt)}}}if(bv!=null){bt.drShiftTo(bB,bv);if(bo!=bx){a7.ZERO.subTo(bv,bv)}}bt.t=bB;bt.clamp();if(bD>0){bt.rShiftTo(bD,bt)}if(bo<0){a7.ZERO.subTo(bt,bt)}}function ao(bo){var bp=x();this.abs().divRemTo(bo,null,bp);if(this.s<0&&bp.compareTo(a7.ZERO)>0){bo.subTo(bp,bp)}return bp}function ak(bo){this.m=bo}function aF(bo){if(bo.s<0||bo.compareTo(this.m)>=0){return bo.mod(this.m)}else{return bo}}function a0(bo){return bo}function ai(bo){bo.divRemTo(this.m,null,bo)}function ah(bo,bq,bp){bo.multiplyTo(bq,bp);this.reduce(bp)}function bc(bo,bp){bo.squareTo(bp);this.reduce(bp)}ak.prototype.convert=aF;ak.prototype.revert=a0;ak.prototype.reduce=ai;ak.prototype.mulTo=ah;ak.prototype.sqrTo=bc;function Y(){if(this.t<1){return 0}var bo=this[0];if((bo&1)==0){return 0}var bp=bo&3;bp=(bp*(2-(bo&15)*bp))&15;bp=(bp*(2-(bo&255)*bp))&255;bp=(bp*(2-(((bo&65535)*bp)&65535)))&65535;bp=(bp*(2-bo*bp%this.DV))%this.DV;return(bp>0)?this.DV-bp:-bp}function t(bo){this.m=bo;this.mp=bo.invDigit();this.mpl=this.mp&32767;this.mph=this.mp>>15;this.um=(1<<(bo.DB-15))-1;this.mt2=2*bo.t}function aZ(bo){var bp=x();bo.abs().dlShiftTo(this.m.t,bp);bp.divRemTo(this.m,null,bp);if(bo.s<0&&bp.compareTo(a7.ZERO)>0){this.m.subTo(bp,bp)}return bp}function ba(bo){var bp=x();bo.copyTo(bp);this.reduce(bp);return bp}function aq(bo){while(bo.t<=this.mt2){bo[bo.t++]=0}for(var bq=0;bq<this.m.t;++bq){var bp=bo[bq]&32767;var br=(bp*this.mpl+(((bp*this.mph+(bo[bq]>>15)*this.mpl)&this.um)<<15))&bo.DM;bp=bq+this.m.t;bo[bp]+=this.m.am(0,br,bo,bq,0,this.m.t);while(bo[bp]>=bo.DV){bo[bp]-=bo.DV;bo[++bp]++}}bo.clamp();bo.drShiftTo(this.m.t,bo);if(bo.compareTo(this.m)>=0){bo.subTo(this.m,bo)}}function a2(bo,bp){bo.squareTo(bp);this.reduce(bp)}function V(bo,bq,bp){bo.multiplyTo(bq,bp);this.reduce(bp)}t.prototype.convert=aZ;t.prototype.revert=ba;t.prototype.reduce=aq;t.prototype.mulTo=V;t.prototype.sqrTo=a2;function y(){return((this.t>0)?(this[0]&1):this.s)==0}function Q(bt,bu){if(bt>4294967295||bt<1){return a7.ONE}var bs=x(),bo=x(),br=bu.convert(this),bq=C(bt)-1;br.copyTo(bs);while(--bq>=0){bu.sqrTo(bs,bo);if((bt&(1<<bq))>0){bu.mulTo(bo,br,bs)}else{var bp=bs;bs=bo;bo=bp}}return bu.revert(bs)}function a4(bp,bo){var bq;if(bp<256||bo.isEven()){bq=new ak(bo)}else{bq=new t(bo)}return this.exp(bp,bq)}bh.copyTo=aK;bh.fromInt=G;bh.fromString=P;bh.clamp=ap;bh.dlShiftTo=a6;bh.drShiftTo=aJ;bh.lShiftTo=K;bh.rShiftTo=D;bh.subTo=aN;bh.multiplyTo=ab;bh.squareTo=ar;bh.divRemTo=ac;bh.invDigit=Y;bh.isEven=y;bh.exp=Q;bh.toString=I;bh.negate=au;bh.abs=a1;bh.compareTo=ag;bh.bitLength=L;bh.mod=ao;bh.modPowInt=a4;function x(){return new a7(null)}function v(){var bo=x();this.copyTo(bo);return bo}function ae(){if(this.s<0){if(this.t==1){return this[0]-this.DV}else{if(this.t==0){return -1}}}else{if(this.t==1){return this[0]}else{if(this.t==0){return 0}}}return((this[1]&((1<<(32-this.DB))-1))<<this.DB)|this[0]}function aV(){return(this.t==0)?this.s:(this[0]<<24)>>24}function at(){return(this.t==0)?this.s:(this[0]<<16)>>16}function aI(bo){return Math.floor(Math.LN2*this.DB/Math.log(bo))}function a8(){if(this.s<0){return -1}else{if(this.t<=0||(this.t==1&&this[0]<=0)){return 0}else{return 1}}}function T(bo){if(bo==null){bo=10}if(this.signum()==0||bo<2||bo>36){return"0"}var bq=this.chunkSize(bo);var bp=Math.pow(bo,bq);var bt=p(bp),bu=x(),bs=x(),br="";this.divRemTo(bt,bu,bs);while(bu.signum()>0){br=(bp+bs.intValue()).toString(bo).substr(1)+br;bu.divRemTo(bt,bu,bs)}return bs.intValue().toString(bo)+br}function az(bx,bt){var bw=this;bw.fromInt(0);if(bt==null){bt=10}var br=bw.chunkSize(bt);var bs=Math.pow(bt,br),bq=false,bo=0,bv=0;for(var bp=0;bp<bx.length;++bp){var bu=W(bx,bp);if(bu<0){if(bx.charAt(bp)=="-"&&bw.signum()==0){bq=true}continue}bv=bt*bv+bu;if(++bo>=br){bw.dMultiply(bs);bw.dAddOffset(bv,0);bo=0;bv=0}}if(bo>0){bw.dMultiply(Math.pow(bt,bo));bw.dAddOffset(bv,0)}if(bq){a7.ZERO.subTo(bw,bw)}}function aS(bq,bp,bt){var br=this;if("number"==typeof bp){if(bq<2){br.fromInt(1)}else{br.fromNumber(bq,bt);if(!br.testBit(bq-1)){br.bitwiseTo(a7.ONE.shiftLeft(bq-1),al,br)}if(br.isEven()){br.dAddOffset(1,0)}while(!br.isProbablePrime(bp)){br.dAddOffset(2,0);if(br.bitLength()>bq){br.subTo(a7.ONE.shiftLeft(bq-1),br)}}}}else{var bo=new Array(),bs=bq&7;bo.length=(bq>>3)+1;bp.nextBytes(bo);if(bs>0){bo[0]&=((1<<bs)-1)}else{bo[0]=0}br.fromString(bo,256)}}function bg(){var bp=this;var bq=bp.t,br=new Array();br[0]=bp.s;var bs=bp.DB-(bq*bp.DB)%8,bt,bo=0;if(bq-->0){if(bs<bp.DB&&(bt=bp[bq]>>bs)!=(bp.s&bp.DM)>>bs){br[bo++]=bt|(bp.s<<(bp.DB-bs))}while(bq>=0){if(bs<8){bt=(bp[bq]&((1<<bs)-1))<<(8-bs);bt|=bp[--bq]>>(bs+=bp.DB-8)}else{bt=(bp[bq]>>(bs-=8))&255;if(bs<=0){bs+=bp.DB;--bq}}if((bt&128)!=0){bt|=-256}if(bo===0&&(bp.s&128)!=(bt&128)){++bo}if(bo>0||bt!=bp.s){br[bo++]=bt}}}return br}function ax(bo){return(this.compareTo(bo)==0)}function af(bo){return(this.compareTo(bo)<0)?this:bo}function aD(bo){return(this.compareTo(bo)>0)?this:bo}function aT(bp,bu,bs){var bq=this;var br,bt,bo=Math.min(bp.t,bq.t);for(br=0;br<bo;++br){bs[br]=bu(bq[br],bp[br])}if(bp.t<bq.t){bt=bp.s&bq.DM;for(br=bo;br<bq.t;++br){bs[br]=bu(bq[br],bt)}bs.t=bq.t}else{bt=bq.s&bq.DM;for(br=bo;br<bp.t;++br){bs[br]=bu(bt,bp[br])}bs.t=bp.t}bs.s=bu(bq.s,bp.s);bs.clamp()}function U(bo,bp){return bo&bp}function bj(bo){var bp=x();this.bitwiseTo(bo,U,bp);return bp}function al(bo,bp){return bo|bp}function aH(bo){var bp=x();this.bitwiseTo(bo,al,bp);return bp}function Z(bo,bp){return bo^bp}function r(bo){var bp=x();this.bitwiseTo(bo,Z,bp);return bp}function N(bo,bp){return bo&~bp}function E(bo){var bp=x();this.bitwiseTo(bo,N,bp);return bp}function aa(){var bp=x();for(var bo=0;bo<this.t;++bo){bp[bo]=this.DM&~this[bo]}bp.t=this.t;bp.s=~this.s;return bp}function O(bp){var bo=x();if(bp<0){this.rShiftTo(-bp,bo)}else{this.lShiftTo(bp,bo)}return bo}function bi(bp){var bo=x();if(bp<0){this.lShiftTo(-bp,bo)}else{this.rShiftTo(bp,bo)}return bo}function A(bo){if(bo==0){return -1}var bp=0;if((bo&65535)==0){bo>>=16;bp+=16}if((bo&255)==0){bo>>=8;bp+=8}if((bo&15)==0){bo>>=4;bp+=4}if((bo&3)==0){bo>>=2;bp+=2}if((bo&1)==0){++bp}return bp}function H(){for(var bo=0;bo<this.t;++bo){if(this[bo]!=0){return bo*this.DB+A(this[bo])}}if(this.s<0){return this.t*this.DB}return -1}function a3(bo){var bp=0;while(bo!=0){bo&=bo-1;++bp}return bp}function aR(){var bq=0,bo=this.s&this.DM;for(var bp=0;bp<this.t;++bp){bq+=a3(this[bp]^bo)}return bq}function aP(bp){var bo=Math.floor(bp/this.DB);if(bo>=this.t){return(this.s!=0)}return((this[bo]&(1<<(bp%this.DB)))!=0)}function ad(bq,bp){var bo=a7.ONE.shiftLeft(bq);this.bitwiseTo(bo,bp,bo);return bo}function X(bo){return this.changeBit(bo,al)}function F(bo){return this.changeBit(bo,N)}function o(bo){return this.changeBit(bo,Z)}function aA(bp,bs){var bq=this;var br=0,bt=0,bo=Math.min(bp.t,bq.t);while(br<bo){bt+=bq[br]+bp[br];bs[br++]=bt&bq.DM;bt>>=bq.DB}if(bp.t<bq.t){bt+=bp.s;while(br<bq.t){bt+=bq[br];bs[br++]=bt&bq.DM;bt>>=bq.DB}bt+=bq.s}else{bt+=bq.s;while(br<bp.t){bt+=bp[br];bs[br++]=bt&bq.DM;bt>>=bq.DB}bt+=bp.s}bs.s=(bt<0)?-1:0;if(bt>0){bs[br++]=bt}else{if(bt<-1){bs[br++]=bq.DV+bt}}bs.t=br;bs.clamp()}function aC(bo){var bp=x();this.addTo(bo,bp);return bp}function a9(bo){var bp=x();this.subTo(bo,bp);return bp}function aw(bo){var bp=x();this.multiplyTo(bo,bp);return bp}function aO(){var bo=x();this.squareTo(bo);return bo}function q(bo){var bp=x();this.divRemTo(bo,bp,null);return bp}function u(bo){var bp=x();this.divRemTo(bo,null,bp);return bp}function aQ(bo){var bq=x(),bp=x();this.divRemTo(bo,bq,bp);return new Array(bq,bp)}function z(bo){this[this.t]=this.am(0,bo-1,this,0,0,this.t);++this.t;this.clamp()}function an(bp,bo){if(bp==0){return}while(this.t<=bo){this[this.t++]=0}this[bo]+=bp;while(this[bo]>=this.DV){this[bo]-=this.DV;if(++bo>=this.t){this[this.t++]=0}++this[bo]}}function aB(){}function aW(bo){return bo}function B(bo,bq,bp){bo.multiplyTo(bq,bp)}function aG(bo,bp){bo.squareTo(bp)}aB.prototype.convert=aW;aB.prototype.revert=aW;aB.prototype.mulTo=B;aB.prototype.sqrTo=aG;function R(bo){return this.exp(bo,new aB())}function w(bo,bs,br){var bq=Math.min(this.t+bo.t,bs);br.s=0;br.t=bq;while(bq>0){br[--bq]=0}var bp;for(bp=br.t-this.t;bq<bp;++bq){br[bq+this.t]=this.am(0,bo[bq],br,bq,0,this.t)}for(bp=Math.min(bo.t,bs);bq<bp;++bq){this.am(0,bo[bq],br,bq,0,bs-bq)}br.clamp()}function s(bo,br,bq){--br;var bp=bq.t=this.t+bo.t-br;bq.s=0;while(--bp>=0){bq[bp]=0}for(bp=Math.max(br-this.t,0);bp<bo.t;++bp){bq[this.t+bp-br]=this.am(br-bp,bo[bp],bq,0,0,this.t+bp-br)}bq.clamp();bq.drShiftTo(1,bq)}function S(bo){this.r2=x();this.q3=x();a7.ONE.dlShiftTo(2*bo.t,this.r2);this.mu=this.r2.divide(bo);this.m=bo}function aj(bo){if(bo.s<0||bo.t>2*this.m.t){return bo.mod(this.m)}else{if(bo.compareTo(this.m)<0){return bo}else{var bp=x();bo.copyTo(bp);this.reduce(bp);return bp}}}function am(bo){return bo}function bd(bo){var bp=this;bo.drShiftTo(bp.m.t-1,bp.r2);if(bo.t>bp.m.t+1){bo.t=bp.m.t+1;bo.clamp()}bp.mu.multiplyUpperTo(bp.r2,bp.m.t+1,bp.q3);bp.m.multiplyLowerTo(bp.q3,bp.m.t+1,bp.r2);while(bo.compareTo(bp.r2)<0){bo.dAddOffset(1,bp.m.t+1)}bo.subTo(bp.r2,bo);while(bo.compareTo(bp.m)>=0){bo.subTo(bp.m,bo)}}function ay(bo,bp){bo.squareTo(bp);this.reduce(bp)}function be(bo,bq,bp){bo.multiplyTo(bq,bp);this.reduce(bp)}S.prototype.convert=aj;S.prototype.revert=am;S.prototype.reduce=bd;S.prototype.mulTo=be;S.prototype.sqrTo=ay;function aE(bx,bs){var bv=bx.bitLength(),bt,bp=p(1),bA;if(bv<=0){return bp}else{if(bv<18){bt=1}else{if(bv<48){bt=3}else{if(bv<144){bt=4}else{if(bv<768){bt=5}else{bt=6}}}}}if(bv<8){bA=new ak(bs)}else{if(bs.isEven()){bA=new S(bs)}else{bA=new t(bs)}}var bw=new Array(),br=3,by=bt-1,bo=(1<<bt)-1;bw[1]=bA.convert(this);if(bt>1){var bD=x();bA.sqrTo(bw[1],bD);while(br<=bo){bw[br]=x();bA.mulTo(bD,bw[br-2],bw[br]);br+=2}}var bu=bx.t-1,bB,bz=true,bq=x(),bC;bv=C(bx[bu])-1;while(bu>=0){if(bv>=by){bB=(bx[bu]>>(bv-by))&bo}else{bB=(bx[bu]&((1<<(bv+1))-1))<<(by-bv);if(bu>0){bB|=bx[bu-1]>>(this.DB+bv-by)}}br=bt;while((bB&1)==0){bB>>=1;--br}if((bv-=br)<0){bv+=this.DB;--bu}if(bz){bw[bB].copyTo(bp);bz=false}else{while(br>1){bA.sqrTo(bp,bq);bA.sqrTo(bq,bp);br-=2}if(br>0){bA.sqrTo(bp,bq)}else{bC=bp;bp=bq;bq=bC}bA.mulTo(bq,bw[bB],bp)}while(bu>=0&&(bx[bu]&(1<<bv))==0){bA.sqrTo(bp,bq);bC=bp;bp=bq;bq=bC;if(--bv<0){bv=this.DB-1;--bu}}}return bA.revert(bp)}function bb(bp){var bo=(this.s<0)?this.negate():this.clone();var bt=(bp.s<0)?bp.negate():bp.clone();if(bo.compareTo(bt)<0){var br=bo;bo=bt;bt=br}var bq=bo.getLowestSetBit(),bs=bt.getLowestSetBit();if(bs<0){return bo}if(bq<bs){bs=bq}if(bs>0){bo.rShiftTo(bs,bo);bt.rShiftTo(bs,bt)}while(bo.signum()>0){if((bq=bo.getLowestSetBit())>0){bo.rShiftTo(bq,bo)}if((bq=bt.getLowestSetBit())>0){bt.rShiftTo(bq,bt)}if(bo.compareTo(bt)>=0){bo.subTo(bt,bo);bo.rShiftTo(1,bo)}else{bt.subTo(bo,bt);bt.rShiftTo(1,bt)}}if(bs>0){bt.lShiftTo(bs,bt)}return bt}function J(br){if(br<=0){return 0}var bq=this.DV%br,bp=(this.s<0)?br-1:0;if(this.t>0){if(bq==0){bp=this[0]%br}else{for(var bo=this.t-1;bo>=0;--bo){bp=(bq*bp+this[bo])%br}}}return bp}function n(bp){var bt=bp.isEven();if((this.isEven()&&bt)||bp.signum()==0){return a7.ZERO}var bs=bp.clone(),br=this.clone();var bq=p(1),bo=p(0),bv=p(0),bu=p(1);while(bs.signum()!=0){while(bs.isEven()){bs.rShiftTo(1,bs);if(bt){if(!bq.isEven()||!bo.isEven()){bq.addTo(this,bq);bo.subTo(bp,bo)}bq.rShiftTo(1,bq)}else{if(!bo.isEven()){bo.subTo(bp,bo)}}bo.rShiftTo(1,bo)}while(br.isEven()){br.rShiftTo(1,br);if(bt){if(!bv.isEven()||!bu.isEven()){bv.addTo(this,bv);bu.subTo(bp,bu)}bv.rShiftTo(1,bv)}else{if(!bu.isEven()){bu.subTo(bp,bu)}}bu.rShiftTo(1,bu)}if(bs.compareTo(br)>=0){bs.subTo(br,bs);if(bt){bq.subTo(bv,bq)}bo.subTo(bu,bo)}else{br.subTo(bs,br);if(bt){bv.subTo(bq,bv)}bu.subTo(bo,bu)}}if(br.compareTo(a7.ONE)!=0){return a7.ZERO}if(bu.compareTo(bp)>=0){return bu.subtract(bp)}if(bu.signum()<0){bu.addTo(bp,bu)}else{return bu}if(bu.signum()<0){return bu.add(bp)}else{return bu}}bh.chunkSize=aI;bh.toRadix=T;bh.fromRadix=az;bh.fromNumber=aS;bh.bitwiseTo=aT;bh.changeBit=ad;bh.addTo=aA;bh.dMultiply=z;bh.dAddOffset=an;bh.multiplyLowerTo=w;bh.multiplyUpperTo=s;bh.modInt=J;bh.clone=v;bh.intValue=ae;bh.byteValue=aV;bh.shortValue=at;bh.signum=a8;bh.toByteArray=bg;bh.equals=ax;bh.min=af;bh.max=aD;bh.and=bj;bh.or=aH;bh.xor=r;bh.andNot=E;bh.not=aa;bh.shiftLeft=O;bh.shiftRight=bi;bh.getLowestSetBit=H;bh.bitCount=aR;bh.testBit=aP;bh.setBit=X;bh.clearBit=F;bh.flipBit=o;bh.add=aC;bh.subtract=a9;bh.multiply=aw;bh.divide=q;bh.remainder=u;bh.divideAndRemainder=aQ;bh.modPow=aE;bh.modInverse=n;bh.pow=R;bh.gcd=bb;bh.square=aO;a7.ZERO=p(0);a7.ONE=p(1);a7.valueOf=p;a7.fromByteArrayUnsigned=function(bo){if(!bo.length){return new a7.valueOf(0)}else{if(bo[0]&128){return new a7([0].concat(bo))}else{return new a7(bo)}}};a7.fromByteArraySigned=function(bo){if(bo[0]&128){bo[0]&=127;return a7.fromByteArrayUnsigned(bo).negate()}else{return a7.fromByteArrayUnsigned(bo)}};a7.prototype.toByteArrayUnsigned=function(){var bp=this.abs().toByteArray();if(!bp.length){return bp}if(bp[0]===0){bp=bp.slice(1)}for(var bo=0;bo<bp.length;++bo){bp[bo]=(bp[bo]<0)?bp[bo]+256:bp[bo]}return bp};a7.prototype.toByteArraySigned=function(){var bo=this.toByteArrayUnsigned();var bp=this.s<0;if(bo[0]&128){bo.unshift((bp)?128:0)}else{if(bp){bo[0]|=128}}return bo};bf.set("cipher.asymmetric.ec.bigi",a7)})(c);(function(n){function m(s,r){var o=s.ECPointFp;function p(z,v,y,u){var t=Math.max(v.bitLength(),u.bitLength());var A=z.add2D(y);var x=z.curve.getInfinity();for(var w=t-1;w>=0;--w){x=x.twice2D();x.z=r.ONE;if(v.testBit(w)){if(u.testBit(w)){x=x.add2D(A)}else{x=x.add2D(z)}}else{if(u.testBit(w)){x=x.add2D(y)}}}return x}function q(A){var C=this;var B=null;var z=new n.get("util.srand")();var t={nextBytes:function(D){var F=z.bytes(D.length);for(var E=0;E<F.length;++E){D[E]=F[E]}}};this.sign=function(H,M){var K=M;var E=A.getN();var J=r.fromByteArrayUnsigned(H);var F=x(E);var L=A.getG();var I=L.multiply(F);var D=I.getX().toBigInteger().mod(E);var N=F.modInverse(E).multiply(J.add(K.multiply(D))).mod(E);if(N.compareTo(E.divide(r.valueOf(2)))>0){N=E.subtract(N)}return u(D,N)};this.verify=function(J,K,E){var G,D;if(Array.isArray(K)){var I=w(K);G=I.r;D=I.s}else{throw new Error("Invalid value for signature")}var F;if(E instanceof o){F=E}else{if(Array.isArray(E)){F=o.decodeFrom(A.getCurve(),E)}else{throw new Error("Invalid format for pubkey value, must be byte array or ECPointFp")}}var H=r.fromByteArrayUnsigned(J);return y(H,G,D,F)};function y(J,D,O,I){var H=A.getN();var N=A.getG();if(D.compareTo(r.ONE)<0||D.compareTo(H)>=0){return false}if(O.compareTo(r.ONE)<0||O.compareTo(H)>=0){return false}var K=O.modInverse(H);var F=J.multiply(K).mod(H);var E=D.multiply(K).mod(H);var L=N.multiply(F).add(I.multiply(E));var M=L.getX().toBigInteger().mod(H);return M.equals(D)}function v(G){if(G.length!==65){throw new Error("Signature has the wrong length")}var D=G[0]-27;if(D<0||D>7){throw new Error("Invalid signature type")}var H=A.getN();var F=r.fromByteArrayUnsigned(G.slice(1,33)).mod(H);var E=r.fromByteArrayUnsigned(G.slice(33,65)).mod(H);return{r:F,s:E,i:D}}function x(D){return new r(D.bitLength(),t).mod(D.subtract(r.ONE)).add(r.ONE)}function u(F,E){var G=F.toByteArraySigned();var D=E.toByteArraySigned();var H=[];H.push(2);H.push(G.length);H=H.concat(G);H.push(2);H.push(D.length);H=H.concat(D);H.unshift(H.length);H.unshift(48);return H}function w(I){var H;if(I[0]!=48){throw new Error("Signature not a valid DERSequence")}H=2;if(I[H]!=2){throw new Error("First element in signature must be a DERInteger")}var G=I.slice(H+2,H+2+I[H+1]);H+=2+I[H+1];if(I[H]!=2){throw new Error("Second element in signature must be a DERInteger")}var D=I.slice(H+2,H+2+I[H+1]);H+=2+I[H+1];var F=r.fromByteArrayUnsigned(G);var E=r.fromByteArrayUnsigned(D);return{r:F,s:E}}return this}return q}n.set("cipher.asymmetric.ec.ecdsa",function(q){var o=m(n.get("cipher.asymmetric.ec.ecurve"),n.get("cipher.asymmetric.ec.bigi"));return new o(q)})})(c);(function(m){function n(u){var y=this;var t=m.get("cipher.asymmetric.ec.ecparams"),q=m.get("cipher.asymmetric.ec.ecdsa"),v=m.get("cipher.asymmetric.ec.ecurve"),s=m.get("cipher.asymmetric.ec.bigi");var F=null,E=null;var G=t(u);if(!G){throw Error("unknown-ec-curve-name")}var x=q(G);function B(J){var K=new Array(J.length);for(var I=0;I<K.length;I++){K[I]=J[I]}return K}this.setPrivateKey=function(I){D(m.get("util.encoding")(I).toArray())};this.setPublicKey=function(I){A(m.get("util.encoding")(I).toArray())};function C(I){if(I){y.sign=H;y.decrypt=r;y._computeSecret=w}y.verify=p;y.encrypt=z;y.getPublicKey=function(){return new Uint8Array(E).buffer};delete y.setPrivateKey;delete y.setPublicKey}function A(I){F=null;E=I;C(false)}function D(J){F=s.fromByteArrayUnsigned(J);var I=G.getG().multiply(F);E=I.getEncoded(false);C(true)}function H(J){if(!m.get("util.type")(J).isArrayBuffer()){throw new Error("invalid-parameter")}var I=x.sign(m.get("util.encoding")(J).toArray(),F);return m.get("util.encoding")(I).toArrayBuffer()}function p(J,L){if(!(m.get("util.type")(J).isArrayBuffer()&&m.get("util.type")(L).isArrayBuffer())){throw new Error("invalid-parameter")}try{var M=m.get("util.encoding")(L).toArray(),N=m.get("util.encoding")(J).toArray();var I=x.verify(N,M,E)}catch(K){console.log(K);return false}return I}function w(J){if(!m.get("util.type")(J).isArrayBuffer()){throw Error("invalid-parameter")}var I=m.get("util.encoding")(J).toArray();var L=v.ECPointFp.decodeFrom(G.getCurve(),I);var K=L.multiply(F);var M=K.getEncoded().slice(1);return m.get("util.encoding")(M).toArrayBuffer()}function z(L){if(!m.get("util.type")(L).isArrayBuffer()){throw new Error("invalid-parameter")}var K=new n(u);K.setPrivateKey(new m.get("util.srand")().bytes(64));var O=K._computeSecret(y.getPublicKey()),N=K.getPublicKey();var I=new m.get("cipher.symmetric")().key(O),M=I.encrypt(L);var J=new Uint16Array([N.byteLength]);return m.get("util.buffer").concat([J.buffer,N,M])}function r(M){if(!(m.get("util.type")(M).isArrayBuffer()&&M.byteLength>2)){throw new Error("invalid-parameter")}var I=M.slice(0,2),M=M.slice(2);var K=new Uint16Array(I)[0];if(M.length<=K){throw new Error("invalid-ciphertext")}var P=M.slice(0,K),N=M.slice(K);var O=w(P);var L=new m.get("cipher.symmetric")().key(O);var J=L.decrypt(N);return J}return this}var o={name:"EC",constructor:function(q){return new n(q.curve)}};m.set("cipher.asymmetric.ec",o)})(c);(function(u){var o,m;"use strict";function w(z,y,A,x){this.curve=z;this.g=y;this.n=A;this.h=x}w.prototype.getCurve=function v(){return this.curve};w.prototype.getG=function t(){return this.g};w.prototype.getN=function p(){return this.n};w.prototype.getH=function r(){return this.h};function s(x){x=x.replace(/[^0-9a-f]/ig,"").toUpperCase();return new o(x,16)}var q={secp128r1:function(){var B=s("FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFF");var y=s("FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFC");var x=s("E87579C11079F43DD824993C2CEE5ED3");var D=s("FFFFFFFE0000000075A30D1B9038A115");var A=o.ONE;var C=new m(B,y,x);var z=C.decodePointHex("04161FF7528B899B2D0C28607CA52C5B86CF5AC8395BAFEB13C02DA292DDED7A83");return new w(C,z,D,A)},secp160k1:function(){var B=s("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFAC73");var y=o.ZERO;var x=s("7");var D=s("0100000000000000000001B8FA16DFAB9ACA16B6B3");var A=o.ONE;var C=new m(B,y,x);var z=C.decodePointHex("043B4C382CE37AA192A4019E763036F4F5DD4D7EBB938CF935318FDCED6BC28286531733C3F03C4FEE");return new w(C,z,D,A)},secp160r1:function(){var B=s("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFF");var y=s("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFC");var x=s("1C97BEFC54BD7A8B65ACF89F81D4D4ADC565FA45");var D=s("0100000000000000000001F4C8F927AED3CA752257");var A=o.ONE;var C=new m(B,y,x);var z=C.decodePointHex("044A96B5688EF573284664698968C38BB913CBFC8223A628553168947D59DCC912042351377AC5FB32");return new w(C,z,D,A)},secp192k1:function(){var B=s("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFEE37");var y=o.ZERO;var x=s("3");var D=s("FFFFFFFFFFFFFFFFFFFFFFFE26F2FC170F69466A74DEFD8D");var A=o.ONE;var C=new m(B,y,x);var z=C.decodePointHex("04DB4FF10EC057E9AE26B07D0280B7F4341DA5D1B1EAE06C7D9B2F2F6D9C5628A7844163D015BE86344082AA88D95E2F9D");return new w(C,z,D,A)},secp192r1:function(){var B=s("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFF");var y=s("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFC");var x=s("64210519E59C80E70FA7E9AB72243049FEB8DEECC146B9B1");var D=s("FFFFFFFFFFFFFFFFFFFFFFFF99DEF836146BC9B1B4D22831");var A=o.ONE;var C=new m(B,y,x);var z=C.decodePointHex("04188DA80EB03090F67CBF20EB43A18800F4FF0AFD82FF101207192B95FFC8DA78631011ED6B24CDD573F977A11E794811");return new w(C,z,D,A)},secp224r1:function(){var B=s("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF000000000000000000000001");var y=s("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFE");var x=s("B4050A850C04B3ABF54132565044B0B7D7BFD8BA270B39432355FFB4");var D=s("FFFFFFFFFFFFFFFFFFFFFFFFFFFF16A2E0B8F03E13DD29455C5C2A3D");var A=o.ONE;var C=new m(B,y,x);var z=C.decodePointHex("04B70E0CBD6BB4BF7F321390B94A03C1D356C21122343280D6115C1D21BD376388B5F723FB4C22DFE6CD4375A05A07476444D5819985007E34");return new w(C,z,D,A)},secp256k1:function(){var B=s("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F");var y=o.ZERO;var x=s("7");var D=s("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141");var A=o.ONE;var C=new m(B,y,x);var z=C.decodePointHex("0479BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8");return new w(C,z,D,A)},secp256r1:function(){var B=s("FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF");var y=s("FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC");var x=s("5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B");var D=s("FFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551");var A=o.ONE;var C=new m(B,y,x);var z=C.decodePointHex("046B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C2964FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5");return new w(C,z,D,A)},secp384r1:function(){var B=s("FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFe FFFFFFFF 00000000 00000000 FFFFFFFF");var y=s("FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFe FFFFFFFF 00000000 00000000 FFFFFFFC");var x=s("B3312FA7 E23EE7E4 988E056B E3F82D19 181D9C6E FE814112 0314088F 5013875A C656398D 8A2ED19D 2A85C8ED D3EC2AEF");var D=s("FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF C7634D81 F4372DDF 581A0DB2 48B0A77A ECEC196A CCC52973");var A=o.ONE;var C=new m(B,y,x);var z=C.decodePointHex("04AA87CA22 BE8B0537 8EB1C71E F320AD74 6E1D3B62 8BA79B98 59F741E0 82542A38 5502F25D BF55296C 3A545E38 72760AB73617DE4A 96262C6F 5D9E98BF 9292DC29 F8F41DBD 289A147C E9DA3113 B5F0B8C0 0A60B1CE 1D7E819D 7A431D7C 90EA0E5F");return new w(C,z,D,A)},secp521r1:function(){var B=s("    01FF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFF FFFFFFFF");var y=s("    01FF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFF FFFFFFFC");var x=s("    0051 953EB961 8E1C9A1F 929A21A0 B68540EE A2DA725B 99B315F3B8B48991 8EF109E1 56193951 EC7E937B 1652C0BD 3BB1BF07 3573DF883D2C34F1 EF451FD4 6B503F00");var D=s("    01FF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFA 51868783 BF2F966B 7FCC0148 F709A5D0 3BB5C9B8899C47AE BB6FB71E 91386409");var A=o.ONE;var C=new m(B,y,x);var z=C.decodePointHex("      04 00C6858E 06B70404 E9CD9E3E CB662395 B4429C64 8139053FB521F828 AF606B4D 3DBAA14B 5E77EFE7 5928FE1D C127A2FF A8DE3348B3C1856A 429BF97E 7E31C2E5 BD660118 39296A78 9A3BC004 5C8A5FB42C7D1BD9 98F54449 579B4468 17AFBD17 273E662C 97EE7299 5EF42640C550B901 3FAD0761 353C7086 A272C240 88BE9476 9FD16650");return new w(C,z,D,A)}};u.set("cipher.asymmetric.ec.ecparams",function n(x){if(!o){o=u.get("cipher.asymmetric.ec.bigi"),m=u.get("cipher.asymmetric.ec.ecurve")}return(typeof q[x]=="function")?q[x]():null})})(c);"use strict";(function(m){var s;function q(v,t){var u=v.toByteArrayUnsigned();if(t<u.length){u=u.slice(u.length-t)}else{while(t>u.length){u.unshift(0)}}return u}var p=function p(u,t){this.x=t;this.q=u};p.prototype.equals=function(t){if(t==this){return true}return(this.q.equals(t.q)&&this.x.equals(t.x))};p.prototype.toBigInteger=function(){return this.x};p.prototype.negate=function(){return new p(this.q,this.x.negate().mod(this.q))};p.prototype.add=function(t){return new p(this.q,this.x.add(t.toBigInteger()).mod(this.q))};p.prototype.subtract=function(t){return new p(this.q,this.x.subtract(t.toBigInteger()).mod(this.q))};p.prototype.multiply=function(t){return new p(this.q,this.x.multiply(t.toBigInteger()).mod(this.q))};p.prototype.square=function(){return new p(this.q,this.x.square().mod(this.q))};p.prototype.divide=function n(t){return new p(this.q,this.x.multiply(t.toBigInteger().modInverse(this.q)).mod(this.q))};p.prototype.getByteLength=function(){return Math.floor((this.toBigInteger().bitLength()+7)/8)};var o=function o(v,t,w,u){if(!s){s=m.get("cipher.asymmetric.ec.bigi")}this.curve=v;this.x=t;this.y=w;if(u==null){this.z=s.ONE}else{this.z=u}this.zinv=null};o.prototype.getX=function(){if(this.zinv==null){this.zinv=this.z.modInverse(this.curve.q)}return this.curve.fromBigInteger(this.x.toBigInteger().multiply(this.zinv).mod(this.curve.q))};o.prototype.getY=function(){if(this.zinv==null){this.zinv=this.z.modInverse(this.curve.q)}return this.curve.fromBigInteger(this.y.toBigInteger().multiply(this.zinv).mod(this.curve.q))};o.prototype.equals=function(t){if(t==this){return true}if(this.isInfinity()){return t.isInfinity()}if(t.isInfinity()){return this.isInfinity()}var x,w;x=t.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(t.z)).mod(this.curve.q);if(!x.equals(s.ZERO)){return false}w=t.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(t.z)).mod(this.curve.q);return w.equals(s.ZERO)};o.prototype.isInfinity=function(){if((this.x==null)&&(this.y==null)){return true}return this.z.equals(s.ZERO)&&!this.y.toBigInteger().equals(s.ZERO)};o.prototype.negate=function(){return new o(this.curve,this.x,this.y.negate(),this.z)};o.prototype.add=function(F){if(this.isInfinity()){return F}if(F.isInfinity()){return this}var J=F.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(F.z)).mod(this.curve.q);var I=F.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(F.z)).mod(this.curve.q);if(s.ZERO.equals(I)){if(s.ZERO.equals(J)){return this.twice()}return this.curve.getInfinity()}var D=new s("3");var y=this.x.toBigInteger();var H=this.y.toBigInteger();var w=F.x.toBigInteger();var E=F.y.toBigInteger();var G=I.square();var C=G.multiply(I);var x=y.multiply(G);var A=J.square().multiply(this.z);var t=A.subtract(x.shiftLeft(1)).multiply(F.z).subtract(C).multiply(I).mod(this.curve.q);var B=x.multiply(D).multiply(J).subtract(H.multiply(C)).subtract(A.multiply(J)).multiply(F.z).add(J.multiply(C)).mod(this.curve.q);var z=C.multiply(this.z).multiply(F.z).mod(this.curve.q);return new o(this.curve,this.curve.fromBigInteger(t),this.curve.fromBigInteger(B),z)};o.prototype.twice=function(){if(this.isInfinity()){return this}if(this.y.toBigInteger().signum()==0){return this.curve.getInfinity()}var z=new s("3");var u=this.x.toBigInteger();var A=this.y.toBigInteger();var x=A.multiply(this.z);var C=x.multiply(A).mod(this.curve.q);var B=this.curve.a.toBigInteger();var D=u.square().multiply(z);if(!s.ZERO.equals(B)){D=D.add(this.z.square().multiply(B))}D=D.mod(this.curve.q);var t=D.square().subtract(u.shiftLeft(3).multiply(C)).shiftLeft(1).multiply(x).mod(this.curve.q);var y=D.multiply(z).multiply(u).subtract(C.shiftLeft(1)).shiftLeft(2).multiply(C).subtract(D.square().multiply(D)).mod(this.curve.q);var v=x.square().multiply(x).shiftLeft(3).mod(this.curve.q);return new o(this.curve,this.curve.fromBigInteger(t),this.curve.fromBigInteger(y),v)};o.prototype.multiply=function(u){if(this.isInfinity()){return this}if(u.signum()==0){return this.curve.getInfinity()}var y=u;var x=y.multiply(new s("3"));var A=this.negate();var w=this;var v;for(v=x.bitLength()-2;v>0;--v){w=w.twice();var t=x.testBit(v);var z=y.testBit(v);if(t!=z){w=w.add(t?this:A)}}return w};o.prototype.multiplyTwo=function(v,t,u){var w;if(v.bitLength()>u.bitLength()){w=v.bitLength()-1}else{w=u.bitLength()-1}var z=this.curve.getInfinity();var y=this.add(t);while(w>=0){z=z.twice();if(v.testBit(w)){if(u.testBit(w)){z=z.add(y)}else{z=z.add(this)}}else{if(u.testBit(w)){z=z.add(t)}}--w}return z};o.prototype.getEncoded=function(w){if(this.isInfinity()){return[0]}var t=this.getX().toBigInteger();var z=this.getY().toBigInteger();var v=Math.floor((this.curve.getQ().bitLength()+7)/8);var u=q(t,v);if(w){if(z.isEven()){u.unshift(2)}else{u.unshift(3)}}else{u.unshift(4);u=u.concat(q(z,v))}return u};o.decodeFrom=function(B,v){var A=v[0];var z=v.length-1;var w=v.slice(1,1+z/2);var u=v.slice(1+z/2,1+z);w.unshift(0);u.unshift(0);var t=new s(w);var C=new s(u);return new o(B,B.fromBigInteger(t),B.fromBigInteger(C))};o.prototype.add2D=function(u){if(this.isInfinity()){return u}if(u.isInfinity()){return this}if(this.x.equals(u.x)){if(this.y.equals(u.y)){return this.twice()}return this.curve.getInfinity()}var y=u.x.subtract(this.x);var w=u.y.subtract(this.y);var t=w.divide(y);var v=t.square().subtract(this.x).subtract(u.x);var x=t.multiply(this.x.subtract(v)).subtract(this.y);return new o(this.curve,v,x)};o.prototype.twice2D=function(){if(this.isInfinity()){return this}if(this.y.toBigInteger().signum()==0){return this.curve.getInfinity()}var u=this.curve.fromBigInteger(s.valueOf(2));var x=this.curve.fromBigInteger(s.valueOf(3));var t=this.x.square().multiply(x).add(this.curve.a).divide(this.y.multiply(u));var v=t.square().subtract(this.x.multiply(u));var w=t.multiply(this.x.subtract(v)).subtract(this.y);return new o(this.curve,v,w)};o.prototype.multiply2D=function(u){if(this.isInfinity()){return this}if(u.signum()==0){return this.curve.getInfinity()}var y=u;var x=y.multiply(new s("3"));var A=this.negate();var w=this;var v;for(v=x.bitLength()-2;v>0;--v){w=w.twice();var t=x.testBit(v);var z=y.testBit(v);if(t!=z){w=w.add2D(t?this:A)}}return w};o.prototype.isOnCurve=function(){if(this.isInfinity()){return true}var u=this.getX().toBigInteger();var B=this.getY().toBigInteger();var w=this.curve.getA().toBigInteger();var t=this.curve.getB().toBigInteger();var A=this.curve.getQ();var v=B.multiply(B).mod(A);var z=u.multiply(u).multiply(u).add(w.multiply(u)).add(t).mod(A);return v.equals(z)};o.prototype.toString=function(){if(this.isInfinity()){return"(INFINITY)"}return"("+this.getX().toBigInteger().toString()+","+this.getY().toBigInteger().toString()+")"};o.prototype.validate=function(){var v=this.curve.getQ();if(this.isInfinity()){throw new Error("Point is at infinity.")}var t=this.getX().toBigInteger();var u=this.getY().toBigInteger();if(t.compareTo(s.ONE)<0||t.compareTo(v.subtract(s.ONE))>0){throw new Error("x coordinate out of bounds")}if(u.compareTo(s.ONE)<0||u.compareTo(v.subtract(s.ONE))>0){throw new Error("y coordinate out of bounds")}if(!this.isOnCurve()){throw new Error("Point is not on the curve.")}if(this.multiply(v).isInfinity()){throw new Error("Point is not a scalar multiple of G.")}return true};var r=function r(v,u,t){this.q=v;this.a=this.fromBigInteger(u);this.b=this.fromBigInteger(t);this.infinity=new o(this,null,null)};r.prototype.getQ=function(){return this.q};r.prototype.getA=function(){return this.a};r.prototype.getB=function(){return this.b};r.prototype.equals=function(t){if(t==this){return true}return(this.q.equals(t.q)&&this.a.equals(t.a)&&this.b.equals(t.b))};r.prototype.getInfinity=function(){return this.infinity};r.prototype.fromBigInteger=function(t){return new p(this.q,t)};r.prototype.decodePointHex=function(w){w=w.replace(/[^0-9a-f]/ig,"");switch(parseInt(w.substr(0,2),16)){case 0:return this.infinity;case 2:case 3:return null;case 4:case 6:case 7:var t=(w.length-2)/2;var v=w.substr(2,t);var u=w.substr(t+2,t);return new o(this,this.fromBigInteger(new s(v,16)),this.fromBigInteger(new s(u,16)));default:return null}};r.ECPointFp=o;m.set("cipher.asymmetric.ec.ecurve",r)})(c);(function(m){var q={};var n={NECRAC256:{name:"NECRAC256",secretLength:64,sign:{algorithm:"ec",parameters:{curve:"secp521r1"},secretLength:64},crypt:{algorithm:"ec",parameters:{curve:"secp521r1"},secretLength:64},hashAlgorithm:"WHIRLPOOL"},NECRAC192:{name:"NECRAC192",secretLength:48,sign:{algorithm:"ec",parameters:{curve:"secp384r1"},secretLength:48},crypt:{algorithm:"ec",parameters:{curve:"secp384r1"},secretLength:48},hashAlgorithm:"BLAKE2s"},NECRAC128:{name:"NECRAC128",secretLength:32,sign:{algorithm:"ec",parameters:{curve:"secp256r1"},secretLength:32},crypt:{algorithm:"ec",parameters:{curve:"secp256k1"},secretLength:32},hashAlgorithm:"BLAKE2s"},NECRAC112:{name:"NECRAC112",secretLength:28,sign:{algorithm:"ec",parameters:{curve:"secp224r1"},secretLength:28},crypt:{algorithm:"ec",parameters:{curve:"secp224r1"},secretLength:28},hashAlgorithm:"RIPEMD160"},NECRAC96:{name:"NECRAC96",secretLength:24,sign:{algorithm:"ec",parameters:{curve:"secp192k1"},secretLength:24},crypt:{algorithm:"ec",parameters:{curve:"secp192r1"},secretLength:24},hashAlgorithm:"RIPEMD160"}};function r(x){var E=this;var y=n[x];var C,w;if(!y){throw new Error("invalid-algorithm-choice")}function s(G){var F=new m.get("hash")(y.hashAlgorithm);return F.hash(G).buffer}function B(F){var G=m.get("cipher.asymmetric."+F.algorithm).constructor;return G(F.parameters)}C=B(y.sign);w=B(y.crypt);function D(F){if(F){E.sign=u;E.decrypt=t}E.verify=A;E.encrypt=z;E.getPublicKey=v;delete E.setPrivateKey;delete E.setPublicKey}function v(){var G=C.getPublicKey(),F=w.getPublicKey();return m.get("util.buffer").concat([new Uint16Array([G.byteLength]).buffer,G,F])}function u(G){if(!m.get("util.type")(G).isArrayBuffer()){throw new Error("invalid-parameter")}var F=s(G);return C.sign(F)}function A(H,F){if(!(m.get("util.type")(H).isArrayBuffer()&&m.get("util.type")(F).isArrayBuffer())){throw new Error("invalid-parameter")}var G=s(H);return C.verify(G,F)}function z(F){if(!m.get("util.type")(F).isArrayBuffer()){throw new Error("invalid-parameter")}return w.encrypt(F)}function t(F){if(!m.get("util.type")(F).isArrayBuffer()){throw new Error("invalid-parameter")}return w.decrypt(F)}this.setPrivateKey=function(F){if(!m.get("util.type")(F).isArrayBuffer()){throw new Error("invalid-parameter")}var J=new m.get("hash")(y.hashAlgorithm).pbkdf2;var I=J(F,m.get("util.encoding")("derivation-of-signing-key","ascii").toArrayBuffer(),4,y.sign.secretLength);var G=J(F,m.get("util.encoding")("derivation-of-encrypting-key","ascii").toArrayBuffer(),4,y.crypt.secretLength);try{C.setPrivateKey(I);w.setPrivateKey(G)}catch(H){throw new Error("invalid-private-key")}D(true)};this.setPublicKey=function(G){if(!(m.get("util.type")(G).isArrayBuffer()&&G.byteLength>2)){throw new Error("invalid-public-key")}var H=new Uint16Array(G.slice(0,2))[0];G=G.slice(2);if(G.byteLength<=H){throw new Error("invalid-public-key")}var J=G.slice(0,H),F=G.slice(H);try{C.setPublicKey(J);w.setPublicKey(F)}catch(I){throw new Error("invalid-public-key")}D(false)};return this}function o(s){if(s){m.get("util.log").notice("Load asymmetric cipher component: ["+s.name+"]");q[s.name]=s.constructor;return}if("undefined"!=typeof q.EC){m.get("util.log").notice("Asymmetric ciphers ready.");return function(t){return new r(t)}}return null}var p=function(s){return new r(s)};m.set("cipher.asymmetric",p);m.set("cipher.asymmetric.definition",function(s){return n[s]||null});m.exp("cipher.asymmetric",p)})(c);(function(m){function n(){var I=16;var J=4;var w=4;var s=[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22];var v=[82,9,106,213,48,54,165,56,191,64,163,158,129,243,215,251,124,227,57,130,155,47,255,135,52,142,67,68,196,222,233,203,84,123,148,50,166,194,35,61,238,76,149,11,66,250,195,78,8,46,161,102,40,217,36,178,118,91,162,73,109,139,209,37,114,248,246,100,134,104,152,22,212,164,92,204,93,101,182,146,108,112,72,80,253,237,185,218,94,21,70,87,167,141,157,132,144,216,171,0,140,188,211,10,247,228,88,5,184,179,69,6,208,44,30,143,202,63,15,2,193,175,189,3,1,19,138,107,58,145,17,65,79,103,220,234,151,242,207,206,240,180,230,115,150,172,116,34,231,173,53,133,226,249,55,232,28,117,223,110,71,241,26,113,29,41,197,137,111,183,98,14,170,24,190,27,252,86,62,75,198,210,121,32,154,219,192,254,120,205,90,244,31,221,168,51,136,7,199,49,177,18,16,89,39,128,236,95,96,81,127,169,25,181,74,13,45,229,122,159,147,201,156,239,160,224,59,77,174,42,245,176,200,235,187,60,131,83,153,97,23,43,4,126,186,119,214,38,225,105,20,99,85,33,12,125];var H=[0,16777216,33554432,67108864,134217728,268435456,536870912,1073741824,2147483648,452984832,905969664];function K(M,L){var O=0;var N;while(M){if((M&1)){O=O^L}N=L&128;L<<=1;if(N){L^=27}M>>=1}return O}function t(N){var M=new Array(256);for(var L=0;L<256;L++){M[L]=K(N,L)&255}return M}var F=t(2);var D=t(3);var x=t(9);var E=t(11);var C=t(13);var B=t(14);function G(L){var M=s;return(M[L>>>24]<<24|M[(L>>>16)&255]<<16|M[(L>>>8)&255]<<8|M[L&255])}function z(L){return L>>>24|L<<8}function u(L){return L>>>24|(L&16711680)>>>8|(L&65280)<<8|(L&255)<<24}var y=((new Uint8Array((new Uint32Array([1])).buffer))[0]==1);function A(R){var L=H;var N=new Uint8Array(R);var P=N.length/4;var S=P+6;var M=new Uint32Array(w*(S+1));for(var Q=0;Q<P;Q++){M[Q]=(N[Q*4]<<24|N[Q*4+1]<<16|N[Q*4+2]<<8|N[Q*4+3])}for(var Q=P;Q<w*(S+1);Q++){var O=M[Q-1];if(Q%P==0){O=G(z(O))^L[Q/P]}else{if(P>6&&Q%P==4){O=G(O)}}M[Q]=M[Q-P]^O}if(y){for(var Q=0;Q<M.length;Q++){M[Q]=u(M[Q])}}return M}function q(L,U){var R=(U.length/w-1)*4;var Y,W,T,S;var P,O,N,M;var ab,aa,X,V;var Q=s;Y=(L[0]^U[0])>>>0;W=(L[1]^U[1])>>>0;T=(L[2]^U[2])>>>0;S=(L[3]^U[3])>>>0;for(var Z=4;Z<R;Z+=4){P=Y;O=W;N=T;M=S;ab=Q[P&255]>>>0;aa=Q[(O>>>8)&255]>>>0;X=Q[(N>>>16)&255]>>>0;V=Q[M>>>24]>>>0;Y=(((F[ab]^D[aa]^X^V)|(ab^F[aa]^D[X]^V)<<8|(ab^aa^F[X]^D[V])<<16|(D[ab]^aa^X^F[V])<<24)^U[Z])>>>0;ab=Q[O&255]>>>0;aa=Q[(N>>>8)&255]>>>0;X=Q[(M>>>16)&255]>>>0;V=Q[P>>>24]>>>0;W=(((F[ab]^D[aa]^X^V)|(ab^F[aa]^D[X]^V)<<8|(ab^aa^F[X]^D[V])<<16|(D[ab]^aa^X^F[V])<<24)^U[Z+1])>>>0;ab=Q[N&255]>>>0;aa=Q[(M>>>8)&255]>>>0;X=Q[(P>>>16)&255]>>>0;V=Q[O>>>24]>>>0;T=(((F[ab]^D[aa]^X^V)|(ab^F[aa]^D[X]^V)<<8|(ab^aa^F[X]^D[V])<<16|(D[ab]^aa^X^F[V])<<24)^U[Z+2])>>>0;ab=Q[M&255]>>>0;aa=Q[(P>>>8)&255]>>>0;X=Q[(O>>>16)&255]>>>0;V=Q[N>>>24]>>>0;S=(((F[ab]^D[aa]^X^V)|(ab^F[aa]^D[X]^V)<<8|(ab^aa^F[X]^D[V])<<16|(D[ab]^aa^X^F[V])<<24)^U[Z+3])>>>0}L[0]=U[R]^(Q[Y&255]|Q[(W>>>8)&255]<<8|Q[(T>>>16)&255]<<16|Q[S>>>24]<<24);L[1]=U[R+1]^(Q[W&255]|Q[(T>>>8)&255]<<8|Q[(S>>>16)&255]<<16|Q[Y>>>24]<<24);L[2]=U[R+2]^(Q[T&255]|Q[(S>>>8)&255]<<8|Q[(Y>>>16)&255]<<16|Q[W>>>24]<<24);L[3]=U[R+3]^(Q[S&255]|Q[(Y>>>8)&255]<<8|Q[(W>>>16)&255]<<16|Q[T>>>24]<<24)}function r(L,U){var M=v;var R=(U.length/w-1)*4;var W,V,T,S;var Q,P,O,N;W=(L[0]^U[R])>>>0;V=(L[1]^U[R+1])>>>0;T=(L[2]^U[R+2])>>>0;S=(L[3]^U[R+3])>>>0;for(var X=R-4;X>0;X-=4){Q=W;P=V;O=T;N=S;W=((M[Q&255]|M[(N>>>8)&255]<<8|M[(O>>>16)&255]<<16|M[P>>>24]<<24)^U[X])>>>0;V=((M[P&255]|M[(Q>>>8)&255]<<8|M[(N>>>16)&255]<<16|M[O>>>24]<<24)^U[X+1])>>>0;T=((M[O&255]|M[(P>>>8)&255]<<8|M[(Q>>>16)&255]<<16|M[N>>>24]<<24)^U[X+2])>>>0;S=((M[N&255]|M[(O>>>8)&255]<<8|M[(P>>>16)&255]<<16|M[Q>>>24]<<24)^U[X+3])>>>0;Q=W&255>>>0;P=((W>>>8)&255)>>>0;O=((W>>>16)&255)>>>0;N=W>>>24;W=((B[Q]^E[P]^C[O]^x[N])|(x[Q]^B[P]^E[O]^C[N])<<8|(C[Q]^x[P]^B[O]^E[N])<<16|(E[Q]^C[P]^x[O]^B[N])<<24)>>>0;Q=(V&255)>>>0;P=((V>>>8)&255)>>>0;O=((V>>>16)&255)>>>0;N=V>>>24;V=((B[Q]^E[P]^C[O]^x[N])|(x[Q]^B[P]^E[O]^C[N])<<8|(C[Q]^x[P]^B[O]^E[N])<<16|(E[Q]^C[P]^x[O]^B[N])<<24)>>>0;Q=(T&255)>>>0;P=((T>>>8)&255)>>>0;O=((T>>>16)&255)>>>0;N=T>>>24;T=((B[Q]^E[P]^C[O]^x[N])|(x[Q]^B[P]^E[O]^C[N])<<8|(C[Q]^x[P]^B[O]^E[N])<<16|(E[Q]^C[P]^x[O]^B[N])<<24)>>>0;Q=(S&255)>>>0;P=((S>>>8)&255)>>>0;O=((S>>>16)&255)>>>0;N=S>>>24;S=((B[Q]^E[P]^C[O]^x[N])|(x[Q]^B[P]^E[O]^C[N])<<8|(C[Q]^x[P]^B[O]^E[N])<<16|(E[Q]^C[P]^x[O]^B[N])<<24)>>>0}L[0]=U[0]^(M[W&255]|M[(S>>>8)&255]<<8|M[(T>>>16)&255]<<16|M[V>>>24]<<24);L[1]=U[1]^(M[V&255]|M[(W>>>8)&255]<<8|M[(S>>>16)&255]<<16|M[T>>>24]<<24);L[2]=U[2]^(M[T&255]|M[(V>>>8)&255]<<8|M[(W>>>16)&255]<<16|M[S>>>24]<<24);L[3]=U[3]^(M[S&255]|M[(T>>>8)&255]<<8|M[(V>>>16)&255]<<16|M[W>>>24]<<24)}return{block_size_bytes:I,block_size_words:J,endian_swap32:u,is_little_endian:y,key_expansion:A,cipher:q,inv_cipher:r}}function p(){var q=this;var s=new n(),t;function r(x){if(!(m.get("util.type")(x).isArrayBuffer()&&0==x.byteLength%s.block_size_bytes)){throw new Error("invalid-input")}var B=new Uint32Array(x);var C=new Uint32Array(B.length);var z=new Uint32Array(s.block_size_words);var v=s.key_expansion(t);var A,y;for(A=0;A<B.length;A+=s.block_size_words){for(y=0;y<s.block_size_words;y++){z[y]=B[A+y]}s.cipher(z,v);C.set(z,A)}return C.buffer}function u(x){if(!(m.get("util.type")(x).isArrayBuffer()&&0==x.byteLength%s.block_size_bytes)){throw new Error("invalid-input")}var B=new Uint32Array(x);var C=new Uint32Array(B.length);var z=new Uint32Array(s.block_size_words);var D=new Uint32Array(s.block_size_words);var v=s.key_expansion(t),A,y;for(A=0;A<B.length;A+=s.block_size_words){for(y=0;y<s.block_size_words;y++){D[y]=B[A+y]}z.set(D);s.inv_cipher(z,v);C.set(z,A)}return C.buffer}this.key=function(w){if(!m.get("util.type")(w).isArrayBuffer()){throw new Error("invalid-key")}var v=w.byteLength;if(v>32){w=w.slice(0,32)}else{if(v>24){w=w.slice(0,24)}else{if(v>16){w=w.slice(0,16)}else{throw new Error("invalid-key-length")}}}t=new Uint32Array(w);q.encrypt=r;q.decrypt=u;delete q.key;return q};return this}var o={name:"AESECB",constructor:function(){return new p()}};m.set("cipher.symmetric.aes",o)})(c);(function(n){function m(A){var B=this;if(!A||A<10){A=10}var z=new Uint32Array(16);function s(H,E){function G(J,I){return(((J)<<(I))|((J)>>>(32-(I))))}var F;var D=z;for(F=0;F<16;F++){D[F]=H[F]}for(F=0;F<A;F++){D[4]^=G(D[0]+D[12],7);D[8]^=G(D[4]+D[0],9);D[12]^=G(D[8]+D[4],13);D[0]^=G(D[12]+D[8],18);D[9]^=G(D[5]+D[1],7);D[13]^=G(D[9]+D[5],9);D[1]^=G(D[13]+D[9],13);D[5]^=G(D[1]+D[13],18);D[14]^=G(D[10]+D[6],7);D[2]^=G(D[14]+D[10],9);D[6]^=G(D[2]+D[14],13);D[10]^=G(D[6]+D[2],18);D[3]^=G(D[15]+D[11],7);D[7]^=G(D[3]+D[15],9);D[11]^=G(D[7]+D[3],13);D[15]^=G(D[11]+D[7],18);D[1]^=G(D[0]+D[3],7);D[2]^=G(D[1]+D[0],9);D[3]^=G(D[2]+D[1],13);D[0]^=G(D[3]+D[2],18);D[6]^=G(D[5]+D[4],7);D[7]^=G(D[6]+D[5],9);D[4]^=G(D[7]+D[6],13);D[5]^=G(D[4]+D[7],18);D[11]^=G(D[10]+D[9],7);D[8]^=G(D[11]+D[10],9);D[9]^=G(D[8]+D[11],13);D[10]^=G(D[9]+D[8],18);D[12]^=G(D[15]+D[14],7);D[13]^=G(D[12]+D[15],9);D[14]^=G(D[13]+D[12],13);D[15]^=G(D[14]+D[13],18)}for(F=0;F<16;F++){E[F]=D[F]+H[F]}}var v=new Uint32Array(16);function r(E,G){var D=v,F=new Uint32Array([1634760805,857760878,2036477234,1797285236]);D[0]=F[0];D[1]=G[0];D[2]=G[1];D[3]=G[2];D[4]=G[3];D[5]=F[1];D[6]=E[0];D[7]=E[1];D[10]=F[2];D[11]=G[4];D[12]=G[5];D[13]=G[6];D[14]=G[7];D[15]=F[3]}function t(F,E){var D=v;D[8]=F[0];D[9]=F[1];return s(D,E)}function r(F,E){var D=v;tau=new Uint32Array([1634760805,824206446,2036477238,1797285236]);D[0]=tau[0];D[1]=E[0];D[2]=E[1];D[3]=E[2];D[4]=E[3];D[5]=tau[1];D[6]=F[0];D[7]=F[1];D[10]=tau[2];D[11]=E[0];D[12]=E[1];D[13]=E[2];D[14]=E[3];D[15]=tau[3]}function x(F,E){var D=v;D[8]=F[0];D[9]=F[1];return s(D,E)}var p=new Uint32Array(2);var w;function y(){p[0]=0;p[1]=0}function C(){p[0]+=1;if(0==p[0]){p[1]+=1}}function u(D,G){var F=new Uint32Array(D);if(32==G.byteLength){var E=new Uint32Array(G);r(F,E);w=(function(){return function(H){t(p,H);C()}})()}else{if(16==G.byteLength){var E=new Uint32Array(G);_salsa20BufferFillKey4(F,E);w=(function(){return function(H){x(p,H);C()}})()}else{throw new Error("invalid-key-length")}}}function q(J){if(!n.get("util.type")(J).isArrayBuffer()){throw new Error("invalid-input")}var D=J.byteLength,H=Math.ceil(D/64),E=new Uint32Array(16);var K=new Uint8Array(J),L=new Uint8Array(K.length+64);var I=0,G,F;y();for(G=0;G<H;G++){w(E);for(F=0;F<16;F++){L[I++]=(E[F]>>24)&255;L[I++]=(E[F]>>16)&255;L[I++]=(E[F]>>8)&255;L[I++]=E[F]&255}}for(G=0;G<D;G++){K[G]^=L[G]}return K.buffer}this.key=function(E){if(!n.get("util.type")(E).isArrayBuffer()){throw new Error("invalid-key")}var F=E.byteLength;if(F<24){throw new Error("invalid-key")}var D=E.slice(0,8);if(F<40){u(D,E.slice(8,24))}else{u(D,E.slice(8,40))}B.encrypt=q;B.decrypt=q;delete B.key;return B};return this}var o={name:"Salsa20/20",constructor:function(){return new m(20)}};n.set("cipher.symmetric.salsa20",o)})(c);(function(o){function n(){var B=this;function A(E,G){var I=E.byteLength,H=G-(I%G),J=I+H,D=new Uint8Array(E),C=new Uint8Array(J);for(var F=0;F<J;F++){if(F<I){C[F]=D[F]}else{C[F]=H}}return C.buffer}function z(D){var C=new Uint8Array(D);var E=C[C.length-1];if(C.length<E){return null}return D.slice(0,D.byteLength-E)}function w(C){return C}function t(C){return C}var v=null;function x(F,D,G){var I=64;var H=new o.get("hash")("BLAKE2s").pbkdf2(F,D,4,G*I);var C=new Array(G);for(var E=0;E<G;E++){C[E]=new o.get("hash")("WHIRLPOOL").hash(H.slice(E*I,(E+1)*I)).buffer}return C}var y=function(E){if(!o.get("util.type")(E).isArrayBuffer()){throw new Error("invalid-parameter")}var D=new o.get("util.srand")().bytes(10);var F=x(v,D,5);var G=new o.get("hash")("BLAKE2s",{length:6}).mac(E,F[0]).buffer;E=o.get("util.buffer").concat([G,E]);var C=E;C=w(C);C=A(C,16);C=m(F[1],C);C=s(F[2],C);return o.get("util.buffer").concat([D,C])};var u=function(E){if(!(o.get("util.type")(E).isArrayBuffer()&&E.byteLength>=26)){throw new Error("invalid-parameter")}var G=E.slice(0,10);E=E.slice(10);var H=x(v,G,5);var D=E;D=q(H[2],D);D=p(H[1],D);D=z(D,16);if(!o.get("util.type")(D).isArrayBuffer()){return null}D=t(D);if(!o.get("util.type")(D).isArrayBuffer()){return null}var F=D.slice(0,6);D=D.slice(6);var C=new o.get("hash")("BLAKE2s",{length:6}).mac(D,H[0]).buffer;if(o.get("util.buffer").equal(F,C)){return D}return null};this.key=function(C){if(!o.get("util.type")(C).isArrayBuffer()){throw new Error("invalid-key")}v=C;delete B.key;B.encrypt=y;B.decrypt=u;return B};return this}var s=function(t,v){try{var u=o.get("cipher.symmetric.aes").constructor;return u().key(t).encrypt(v)}catch(w){o.get("util.log").error(w);return new Error("unable-to-encrypt",w)}};var q=function(t,v){try{var u=o.get("cipher.symmetric.aes").constructor;return u().key(t).decrypt(v)}catch(w){o.get("util.log").error(w);return new Error("unable-to-decrypt",w)}};var m=function(t,u){try{var w=o.get("cipher.symmetric.salsa20").constructor;return w().key(t).encrypt(u)}catch(v){o.get("util.log").error(v);return new Error("unable-to-encrypt")}};var p=function(t,u){try{var w=o.get("cipher.symmetric.salsa20").constructor;return w().key(t).decrypt(u)}catch(v){o.get("util.log").error(v);return new Error("unable-to-decrypt",v)}};function r(){return new n()}o.set("cipher.symmetric",r);o.exp("cipher.symmetric",r)})(c);(function(m){function n(){var o=this;return this}})(c);(function(o){var n={defaultAlgorithmName:"NECRAC128",subjectRule:/^[0-9a-z\s]{8,255}$/i};var p={_:["constant",new Uint8Array([69,73]).buffer],subject:"shortBinary",algorithm:["enum","NECRAC96","NECRAC112","NECRAC128","NECRAC192","NECRAC256"],"public":"binary",secret:"shortBinary",signature:"binary"};function m(){var G=this;var v=o.get("hash");var I=o.get("util.buffer");var r=o.get("cipher.asymmetric.definition");var E=o.get("util.type");var L=o.get("util.serialize")(p);var K,w,z,C,B,N;var F=false;function x(){if(F){return F}F=v("WHIRLPOOL").mac(z,K).buffer;return F}function u(P){G.exportPublic=J;G.verify=s;G.encrypt=H;G.getFingerprint=y;G.getHash=x;G.getSubject=D;if(P){G.decrypt=t;G.sign=O;G.exportPrivate=A}G.isPrivate=function(){return Boolean(P)};delete G.generate;delete G.loadPublic;delete G.loadPrivate}this.generate=function(R,Q){if(!Q){Q={}}if(!n.subjectRule.test(R)){throw new Error("enigma-invalid-input")}K=o.get("util.encoding")(R,"ascii").toArrayBuffer();C=Q.algorithm||n.defaultAlgorithmName;var P=r(C);if(!P){C=defaults.algorithmName;P=r(algorithmname)}w=o.get("util.srand")().bytes(P.secretLength);N=o.get("cipher.asymmetric")(P.name);N.setPrivateKey(w);z=N.getPublicKey();B=N.sign(x());u(true)};function M(P,Z){if(!E(P).isArrayBuffer()){throw new Error("enigma-invalid-input")}if(Z&&!E(Z).isArrayBuffer()){throw new Error("enigma-invalid-input")}try{var V=L.deserialize(P)}catch(U){throw new Error("enigma-invalid-input")}var W=V.subject,S=V.algorithm,T=V.signature,Q=V["public"],Y=V.secret;if(!n.subjectRule.test(o.get("util.encoding")(W).toASCII())){throw new Error("enigma-invalid-input")}K=W;C=S;B=T;z=Q;N=o.get("cipher.asymmetric")(C);if(Z){try{w=o.get("cipher.symmetric")().key(Z).decrypt(Y)}catch(U){throw new Error("enigma-invalid-pinkey")}N.setPrivateKey(w);var R=N.getPublicKey();if(!o.get("util.buffer").equal(R,z)){throw new Error("enigma-identity-invalid")}}else{N.setPublicKey(z)}var X=N.verify(x(),B);if(!X){throw new Error("enigma-identity-invalid")}return true}this.loadPublic=function(P){if(M(P)){u(false)}};this.loadPrivate=function(Q,P){if(M(Q,P)){u(true)}};function D(){return o.get("util.encoding")(K).toASCII()}function y(Q){var P=x().slice(0,10);if(Q){return o.get("util.encoding")(P).toBase32()}return P}function J(){var P=L.serialize({subject:K,algorithm:C,"public":z,secret:new Uint8Array(0).buffer,signature:B});return P}function A(P){if(!(E(P).isArrayBuffer()&&P.byteLength>=32)){throw new Error("enigma-invalid-pinkey")}var R=o.get("cipher.symmetric")().key(P).encrypt(w);var Q=L.serialize({subject:K,algorithm:C,"public":z,secret:R,signature:B});return Q}function s(Q,P){if(!(E(Q).isArrayBuffer()&&E(P).isArrayBuffer())){throw new Error("enigma-invalid-input")}try{return true===N.verify(Q,P)}catch(R){return false}}function O(P){if(!E(P).isArrayBuffer()){throw new Error("enigma-invalid-input")}try{return N.sign(P)}catch(Q){throw new Error("enigma-identity-unable-to-sign")}}function H(P){if(!E(P).isArrayBuffer()){throw new Error("enigma-invalid-input")}try{return N.encrypt(P)}catch(Q){throw new Error("enigma-identity-unable-to-encrypt")}}function t(P){if(!E(P).isArrayBuffer()){throw new Error("enigma-invalid-input")}try{return N.decrypt(P)}catch(Q){throw new Error("enigma-identity-unable-to-decrypt")}}return this}var q=function(){return new m()};o.set("enigma.identity",q);o.exp("enigma.identity",q)})(c);(function(o){var m={_:["constant",new Uint8Array([69,112]).buffer],signers:"shortArray",signatures:"array",content:"longBinary"};var n={_:["constant",new Uint8Array([69,67]).buffer],compression:["enum",false,"lzw"],receivers:"shortArray",decryptors:"array",payload:"longBinary"};function p(){var C=this;var A=o.get("util.type");var z=o.get("util.serialize")(m),x=o.get("util.serialize")(n);var y,F,I=[],u=[],G=[],v=[],J=false;var L,M;this.write=function(O,N){if(!A(O).isArrayBuffer()){throw new Error("enigma-invalid-input")}y=O;F=new o.get("util.srand")().bytes(64);J=(N&&true===N.clearsign);delete C.write;delete C.read;C.sign=K;if(!J){C.encrypt=E}C.done=D};this.read=function(R){if(!A(R).isArrayBuffer()){throw new Error("enigma-invalid-input")}var P=true;try{var O=x.deserialize(R)}catch(S){P=false}if(P){var U=O.receivers,Q=O.decryptors,T=O.compression,N=O.payload;L=N;M=T;if(U.length!=Q.length){throw new Error("enigma-invalid-input")}if(U.length>0){u=Q;I=U;C.decrypt=t;C.getReceivers=r;delete C.write;delete C.read;return}}else{M=false;L=R}w();console.log("************************");delete C.write;delete C.read};function w(){if("lzw"==M){try{L=o.get("util.decompress")(L)}catch(R){throw new Error("enigma-invalid-input")}}else{if(false!==M){throw new Error("enigma-invalid-input")}}try{var P=z.deserialize(L)}catch(R){throw new Error("enigma-invalid-input")}var Q=P.signatures,O=P.signers,N=P.content;if(Q.length!=O.length){throw new Error("enigma-invalid-input")}y=N;C.getPlaintext=B;if(O.length>0){G=Q;v=O;C.verify=s;C.getSigners=H}}function K(P){if(!P.isPrivate()){throw new Error("enigma-invalid-identity-for-sign")}var O=P.getFingerprint();var N=P.sign(y);v.push(O);G.push(N);if(v.length>=255){delete C.sign}}function E(N){var O=N.encrypt(F);var P=N.getFingerprint();I.push(P);u.push(O);if(I.length>=255){delete C.encrypt}return true}function D(){delete C.sign;delete C.encrypt;var P=z.serialize({signers:v,signatures:G,content:y});if(J){return P}var N="lzw";if(N){P=o.get("util.compress")(P)}var Q=(u.length>0);if(Q){P=o.get("cipher.symmetric")().key(F).encrypt(P)}var O=x.serialize({compression:N||false,receivers:I,decryptors:u,payload:P});return O}function t(T){if(!T.isPrivate()){throw new Error("enigma-invalid-identity-for-decrypt")}var P=T.getFingerprint(),R=false;for(var O=0;O<I.length;O++){if(o.get("util.buffer").equal(P,I[O])){R=true;break}}if(!R){throw new Error("enigma-invalid-identity-for-decrypt")}var Q=u[O];try{var N=T.decrypt(Q)}catch(S){throw new Error("enigma-invalid-identity-for-decrypt")}try{L=o.get("cipher.symmetric")().key(N).decrypt(L)}catch(S){throw new Error("enigma-message-corrupted")}w(L);delete C.decrypt;delete C.getReceivers}function s(S){var P=S.getFingerprint(),Q=false;for(var O=0;O<v.length;O++){if(o.get("util.buffer").equal(P,v[O])){Q=true;break}}if(!Q){throw new Error("enigma-invalid-identity-for-verify")}var N=G[O];try{return S.verify(y,N)}catch(R){throw new Error("enigma-invalid-identity-for-verify")}}function B(){return y}function r(){return I}function H(){return v}return this}function q(){return new p()}o.set("enigma.message",q);o.exp("enigma.message",q)})(c);(function(n){if(!n.get("env.isNode")){return}try{var r=require("crypto").createHash,m=require("buffer")}catch(q){return}var p=true;try{r("whirlpool")}catch(q){p=false}var o=true;try{r("ripemd160")}catch(q){o=false}if(p){n.acc("hash.algorithms.whirlpool",function(){var s=this;this.name="WHIRLPOOL";this.blockSize=64;this.digestSize=64;this.hash=function(x){var v=r("whirlpool");v.update(new m.Buffer(new Uint8Array(x)));var t=v.digest(),w=new Uint8Array(t.length);for(var u=0;u<w.length;u++){w[u]=t[u]}return w.buffer};return this})}if(p){n.acc("hash.algorithms.ripemd160",function(){var s=this;this.name="RIPEMD160";this.blockSize=64;this.digestSize=20;this.hash=function(x){var v=r("ripemd160");v.update(new m.Buffer(new Uint8Array(x)));var t=v.digest(),w=new Uint8Array(t.length);for(var u=0;u<w.length;u++){w[u]=t[u]}return w.buffer};return this})}})(c);var g=c.get("enigma.identity")(),f=c.get("enigma.identity")(),d=c.get("enigma.identity")(),k=new c.get("util.srand")().bytes(32);g.generate("abcdefghijklmn",{algorithm:"NECRAC96"});console.log(g.getFingerprint(true),"******************************");f.loadPublic(g.exportPublic());var i=g.exportPrivate(k);d.loadPrivate(i,k);var l=c.get("enigma.message")();l.write(c.get("util.encoding")("The first enigma message.","ascii").toArrayBuffer());l.encrypt(f);var b=l.done();var a=c.get("enigma.message")();a.read(b);a.decrypt(d);console.log(a);console.log(a.getPlaintext());process.exit();if("undefined"!=typeof module&&"undefined"!=module.exports){module.exports=j}else{define([],function(){return j})}})();