(function(){var e={},h={},l={};var c={get:function(n){if(true){if(h[n]){return h[n]}}return e[n]},set:function(o,n){e[o]=n},exp:function(p,n){var r=p.split(".");var q=l;for(var o in r){if("undefined"==typeof q[r[o]]){if(o==r.length-1){q[r[o]]=n;break}q[r[o]]={}}q=q[r[o]]}},acc:function(o,n){h[o]=n}};c.set("env.isNode",("undefined"!=typeof module&&"undefined"!=typeof process&&"undefined"!=typeof process.title&&"node"===process.title));(function(t){var o="0123456789abcdefghjkmnpqrtuvwxyz";var r={o:0,i:1,l:1,s:5};var p=function(){var y={};for(var x=0;x<o.length;x++){y[o[x]]=x}for(var w in r){if(!r.hasOwnProperty(w)){continue}y[w]=y[""+r[w]]}p=function(){return y};return y};function q(){var w=0;var x=0;this.output="";this.readByte=function(y){if(w<0){x|=(y>>(-w))}else{x=(y<<w)&248}if(w>3){w-=8;return 1}if(w<4){this.output+=o[x>>3];w+=5}return 0};this.finish=function(){var y=this.output+(w<0?o[x>>3]:"");this.output="";return y}}q.prototype.update=function(y,w){for(var z=0;z<y.length;){z+=this.readByte(y[z])}var x=this.output;this.output="";if(w){x+=this.finish()}return x};function v(){var w=0;var x=0;this.output=[];this.readChar=function(y){var z=p()[y];if(typeof z=="undefined"){throw Error('Could not find character "'+y+'" in lookup table.')}z<<=3;x|=z>>>w;w+=5;if(w>=8){this.output.push(x);w-=8;if(w>0){x=(z<<(5-w))&255}else{x=0}}};this.finish=function(){if(w<0){this.output.push(o[bits>>3])}return this.output}}v.prototype.update=function(y,w){for(var z=0;z<y.length;z++){this.readChar(y[z])}var x=this.output;this.output="";if(w){x.concat(this.finish())}return x};function s(x){var y=new q();var w=y.update(x,true);return w}function n(x){var y=new v();x=x.toLowerCase();var w=y.update(x,true);return w}var u={encode:s,decode:n};t.set("util.encoding.base32",u)})(c);(function(p){function s(w){var v,u,x=0,t;for(v=0;v<w.length;v++){x+=w[v].byteLength}var y=new Uint8Array(x),z=0;for(v=0;v<w.length;v++){t=new Uint8Array(w[v]);for(u=0;u<t.length;u++){y[z]=t[u];z+=1}}return y.buffer}function n(u,t){if(u.byteLength!=t.byteLength){throw Error("xor-unequal-length-buffer")}var x=new Uint8Array(u.byteLength),w=new Uint8Array(u),y=new Uint8Array(t);for(var v=0;v<x.length;v++){x[v]=w[v]^y[v]}return x.buffer}function q(v,u){try{var t=new Uint8Array(v),A=new Uint8Array(u)}catch(z){return false}if(t.length!=A.length){return false}for(var w=0;w<t.length;w++){if(t[w]!=A[w]){return false}}return true}function o(v){var x=new Uint8Array(v);var u=x.length-1,y=Math.floor(u/2);var A=u,z;for(var w=0;w<=y;w++){z=x[w];x[w]=x[A];x[A]=z;A-=1}return x.buffer}var r={concat:s,xor:n,equal:q,reverse:o};p.set("util.buffer",r);p.exp("util.buffer",r)})(c);(function(p){function q(y){var v=4-y.length%4;if(4==v){v=0}for(var w=0;w<v;w++){y.push(0)}var C=[v],u,t,s,B,x;function z(D){if(D<=255){return 0}else{if(D<=65535){return 1}else{if(D<=16777215){return 2}else{if(D<=4294967295){return 3}else{throw Error("uncompressible: "+D)}}}}}function A(E,D){if(D<=255){E.push(D)}else{if(D<=65535){E.push((D&65280)>>8,D&255)}else{if(D<=16777215){E.push((D&16711680)>>16,(D&65280)>>8,D&255)}else{if(D<=4294967295){E.push((D&4278190080)>>24(D&16711680)>>16,(D&65280)>>8,(D&255))}}}}}for(var w=0;w<y.length;w+=4){u=y[w];t=y[w+1];s=y[w+2];B=y[w+3];x=(z(u)<<6)+(z(t)<<4)+(z(s)<<2)+(z(B));C.push(x);A(C,u);A(C,t);A(C,s);A(C,B)}return C}function r(x){var s=x[0];if(s>=4){throw new Error("invalid-input")}var u=1,t;var v,D,B,A,y;function z(F,E){return((F>>(E*2))&3)+1}function C(G){var F=0;for(var E=0;E<G.length;E++){F=(F<<8);F|=(G[E]&255)}return F}var w=[];while(u<x.length){v=x[u];u++;t=z(v,3);D=C(x.slice(u,u+t));u+=t;t=z(v,2);B=C(x.slice(u,u+t));u+=t;t=z(v,1);A=C(x.slice(u,u+t));u+=t;t=z(v,0);y=C(x.slice(u,u+t));u+=t;w.push(D,B,A,y)}return w.slice(0,w.length-s)}function n(A){if(!p.get("util.type")(A).isArrayBuffer()){throw Error("invalid-input")}var s=new Uint8Array(A);var u,y={},x,t,z="",B=[],v=256;for(u=0;u<256;u+=1){y[String.fromCharCode(u)]=u}for(u=0;u<s.length;u+=1){x=String.fromCharCode(s[u]);t=z+x;if(y.hasOwnProperty(t)){z=t}else{B.push(y[z]);y[t]=v++;z=String(x)}}if(""!==z){B.push(y[z])}return new Uint8Array(q(B)).buffer}function o(y){if(!p.get("util.type")(y).isArrayBuffer()){throw Error("invalid-input")}var s=new Uint8Array(y);s=r(s);var u,z=[],B,C,t,A="",v=256;for(u=0;u<256;u+=1){z[u]=String.fromCharCode(u)}B=String.fromCharCode(s[0]);C=B;for(u=1;u<s.length;u+=1){t=s[u];if(z[t]){A=z[t]}else{if(t===v){A=B+B.charAt(0)}else{return null}}C+=A;z[v++]=B+A.charAt(0);B=A}var x=new Uint8Array(C.length);for(var u=0;u<x.length;u++){x[u]=C.charCodeAt(u)}return x.buffer}p.exp("util.compress",n);p.exp("util.decompress",o);p.set("util.compress",n);p.set("util.decompress",o)})(c);(function(o){function n(x){if(!0==x.byteLength%2){throw new Error("decoding-error")}var x=new Uint16Array(x),t=0,v,r,w,u="";while(t<x.length){v=x[t];if((v>=0&&v<=55295)||(v>=57344&&v<=65535)){u+=String.fromCharCode(v);t+=1}else{if(v>=55296&&v<=56319){w=v;r=x[t+1];t+=2;if(r>=56320&&r<=57343){u+=String.fromCharCode(w)+String.fromCharCode(r)}else{throw new Error("decoding-error")}}else{throw new Error("decoding-error")}}}return u}function p(t,C){var u=this;var y=null;var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",A="0123456789abcdef";var s=o.get("util.type")(t),E=o.get("util.encoding.base32");if(s.isArrayBuffer()){y=t}else{if(s.isArray()){var x=new Uint8Array(t.length);for(var B=0;B<x.length;B++){x[B]=t[B]&255}y=x.buffer}else{if(s.isString()){if(!C){C=""}switch(C.toLowerCase()){case"hex":if(!/^[0-9a-f]+$/i.test(t)||0!=t.length%2){throw Error("invalid-encoding-choosen")}t=t.toLowerCase();var v=new Uint8Array(t.length/2);for(var B=0;B<v.length;B++){v[B]=A.indexOf(t[2*B])*16+A.indexOf(t[2*B+1])}y=v.buffer;break;case"base64":if(/(=[^=]+|={3,})$/.test(t)){throw Error("invalid-encoding-choosen")}t=t.replace(/=/g,"");var w=t.length&3;if(1==w){throw Error("invalid-encoding-choosen")}var B=0,z=0,D=Math.ceil(t.length/4);var v=new Uint8Array(D*3);var J,I,H,F;for(B=0;B<D;B++){J=r.indexOf(t[z++]||"A");I=r.indexOf(t[z++]||"A");H=r.indexOf(t[z++]||"A");F=r.indexOf(t[z++]||"A");if((J|I|H|F)<0){throw Error("invalid-encoding-choosen")}v[B*3]=((J<<2)|(I>>4))&255;v[B*3+1]=((I<<4)|(H>>2))&255;v[B*3+2]=((H<<6)|F)&255}y=v.buffer.slice(0,v.length+w-4);break;case"base32":if(!/^[0-9a-z=]+$/.test(t)){throw Error("invalid-encoding-choosen")}var G=E.decode(t);y=new Uint8Array(G).buffer;break;case"ascii":var v=new Uint8Array(t.length);for(var B=0;B<v.length;B++){v[B]=t.charCodeAt(B)&255}y=v.buffer;break;default:var v=new Uint16Array(t.length);for(var B=0;B<t.length;B++){v[B]=t.charCodeAt(B)}y=v.buffer;break}}else{throw Error("unknown-encoding")}}}this.toArrayBuffer=function(){return y};this.toUTF16=function(){return n(y)};this.toBase64=function(){var Q=new Uint8Array(y);var N=0,M=0,L=0,O=Q.length/3;var K="";var S,R,P;for(N=0;N<O;++N){S=Q[M++];R=Q[M++];P=Q[M++];K+=r[S>>2]+r[((S<<4)&63)|(R>>4)]+(isNaN(R)?"=":r[((R<<2)&63)|(P>>6)])+(isNaN(R+P)?"=":r[P&63])}console.log(Q.length);return K};this.toBase32=function(){var K=new Uint8Array(y),L=E.encode(K);return L};this.toHEX=function(){var K=new Uint8Array(y),M="";for(var L=0;L<K.length;L++){if(K[L]<16){M+="0"+K[L].toString(16)}else{M+=K[L].toString(16)}}return M};this.toASCII=function(){var K=new Uint8Array(y),M="";for(var L=0;L<K.length;L++){M+=String.fromCharCode(K[L])}return M};this.toArray=function(){var K=new Uint8Array(y),L=new Array(K.length);for(var M=0;M<L.length;M++){L[M]=K[M]}return L};return this}var q=function(s,r){return new p(s,r)};o.set("util.encoding",q);o.exp("util.encoding",q)})(c);(function(n){var o={notice:function(p){console.log(p)},error:function(p){console.error(p)}};n.set("util.log",o);n.exp("util.log",o)})(c);(function(v){var n=new Uint32Array(16);function q(G,D){function F(I,H){return(((I)<<(H))|((I)>>>(32-(H))))}var E;var C=n;for(E=0;E<16;E++){C[E]=G[E]}for(E=0;E<32;E++){C[4]^=F(C[0]+C[12],7);C[8]^=F(C[4]+C[0],9);C[12]^=F(C[8]+C[4],13);C[0]^=F(C[12]+C[8],18);C[9]^=F(C[5]+C[1],7);C[13]^=F(C[9]+C[5],9);C[1]^=F(C[13]+C[9],13);C[5]^=F(C[1]+C[13],18);C[14]^=F(C[10]+C[6],7);C[2]^=F(C[14]+C[10],9);C[6]^=F(C[2]+C[14],13);C[10]^=F(C[6]+C[2],18);C[3]^=F(C[15]+C[11],7);C[7]^=F(C[3]+C[15],9);C[11]^=F(C[7]+C[3],13);C[15]^=F(C[11]+C[7],18);C[1]^=F(C[0]+C[3],7);C[2]^=F(C[1]+C[0],9);C[3]^=F(C[2]+C[1],13);C[0]^=F(C[3]+C[2],18);C[6]^=F(C[5]+C[4],7);C[7]^=F(C[6]+C[5],9);C[4]^=F(C[7]+C[6],13);C[5]^=F(C[4]+C[7],18);C[11]^=F(C[10]+C[9],7);C[8]^=F(C[11]+C[10],9);C[9]^=F(C[8]+C[11],13);C[10]^=F(C[9]+C[8],18);C[12]^=F(C[15]+C[14],7);C[13]^=F(C[12]+C[15],9);C[14]^=F(C[13]+C[12],13);C[15]^=F(C[14]+C[13],18)}for(E=0;E<16;E++){D[E]=C[E]+G[E]}}var u=new Uint8Array(16);function z(){for(var C=0;C<16;C++){u[C]=Math.floor(256*Math.random())}}z();var o=new Uint32Array([0,0]);function w(){o[0]=0;o[1]=0}function y(){o[0]+=1;if(0==o[0]){o[1]+=1}if(0==o[1]){z()}}var A=new Uint8Array(32),p=0;function B(C){A[p]=C;p+=1;if(p>=32){w();p=0}}for(var s=0;s<32;s++){B(Math.floor(256*Math.random()))}function r(){B(new Date().getTime()%256)}setInterval(r,100);function t(D){var F=new Uint32Array([1634760805,857760878,2036477234,1797285236]);var C=new Uint32Array(16),E=new Uint32Array(u.buffer),G=new Uint32Array(A.buffer);C[0]=F[0];C[1]=G[0];C[2]=G[1];C[3]=G[2];C[4]=G[3];C[5]=F[1];C[6]=E[0];C[7]=E[1];C[8]=o[0];C[9]=o[1];C[10]=F[2];C[11]=G[4];C[12]=G[5];C[13]=G[6];C[14]=G[7];C[15]=F[3];y();return q(C,D)}function x(){var C=this;var D=new Uint32Array(16);this.touch=function(){r()};this.bytes=function(J){var E=Math.ceil(J/64);var G=new Uint8Array(J),H=0,F=0,K;for(var I=0;I<E;I++){t(D);K=new Uint8Array(D.buffer);for(H=0;H<64;H++){if(F>=J){break}G[F]=K[H];F+=1}}return G.buffer};this.array=function(E){return new Uint8Array(C.bytes(E))};return this}v.set("util.srand",x);v.exp("util.srand",x)})(c);(function(n){function o(p){return{isError:function(){return toString.apply(p)==="[object Error]"},isArray:function(){return toString.apply(p)==="[object Array]"},isDate:function(){return toString.apply(p)==="[object Date]"},isObject:function(){return !!p&&Object.prototype.toString.call(p)==="[object Object]"},isPrimitive:function(){return self.isString(p)||self.isNumber(p)||self.isBoolean(p)},isFunction:function(){return toString.apply(p)==="[object Function]"},isDate:function(){return toString.apply(p)==="[object Date]"},isNumber:function(){return typeof p==="number"&&isFinite(p)},isString:function(){return typeof p==="string"},isBoolean:function(){return typeof p==="boolean"},isArrayBuffer:function(){return toString.apply(p)==="[object ArrayBuffer]"}}}n.set("util.type",o);n.exp("util.type",o)})(c);(function(n){function o(r){var q=this;var p=n.get("util.type");this.pack=function(v){if(!Boolean(v)){v=[]}else{if(v.length>255){throw new Error("invalid-parameter")}for(var u=0;u<v.length;u++){if(!p(v[u]).isArrayBuffer()){throw new Error("invalid-parameter")}}}var w=[];for(var u in v){var s=v[u].byteLength;if(1==r){if(s>255){throw new Error("invalid-parameter")}var t=new Uint8Array([s]).buffer}else{if(2==r){if(s>65535){throw new Error("invalid-parameter")}var t=new Uint16Array([s]).buffer}}w.push(n.get("util.buffer").concat([t,v[u]]))}t=new Uint8Array([v.length]).buffer;w.unshift(t);return n.get("util.buffer").concat(w)};this.unpack=function(v){var t=0,s=0,y;var x=v.slice(0,1);v=v.slice(1);t=new Uint8Array(x)[0];var u=[];for(var w=0;w<t;w++){x=v.slice(0,r);v=v.slice(r);if(1==r){s=new Uint8Array(x)[0]}else{if(2==r){s=new Uint16Array(x)[0]}}y=v.slice(0,s);v=v.slice(s);u.push(y)}return[u,v]};return this}n.set("util.serialize.array",function(p){p.array=function(){return new o(2)};p.shortArray=function(){return new o(1)}})})(c);(function(o){function n(q){var p=this;this.unpack=function(r){var t;var s=r.slice(0,4);if(4==q){t=new Uint32Array(s)[0];r=r.slice(4)}else{if(2==q){t=new Uint16Array(s)[0];r=r.slice(2)}else{if(1==q){t=new Uint8Array(s)[0];r=r.slice(1)}}}if(0==t){return[null,r]}unpackResult=r.slice(0,t);r=r.slice(t);return[unpackResult,r]};this.pack=function(r){if(!Boolean(r)){r=new Uint8Array(0).buffer}if(!o.get("util.type")(r).isArrayBuffer()){throw new Error("invalid-parameter")}packLength=r.byteLength;if((4==q&&packLength>4294967295)||(2==q&&packLength>65535)||(1==q&&packLength>255)){throw new Error("invalid-parameter")}if(4==q){var s=new Uint32Array(1)}else{if(2==q){var s=new Uint16Array(1)}else{if(1==q){var s=new Uint8Array(1)}}}s[0]=packLength;s=s.buffer;return o.get("util.buffer").concat([s,r])};return this}o.set("util.serialize.binary",function(p){p.shortBinary=function(){return new n(1)};p.binary=function(){return new n(2)};p.longBinary=function(){return new n(4)}})})(c);(function(o){function n(){var p=this;this.pack=function(q){if(!o.get("util.type")(q).isBoolean()){throw new Error("invalid-parameter")}var r=new Uint8Array([(q?255:0)]).buffer;return r};this.unpack=function(q){var r=new Uint8Array(q.slice(0,1))[0];q=q.slice(1);return[Boolean(255==r),q]};return this}o.set("util.serialize.boolean",function(p){p["boolean"]=function(){return new n()}})})(c);(function(n){function o(s){var r=this;var q=n.get("util.type");if(!q(s).isArray()){throw new Error("invalid-parameter")}var t=false;s=s[0];if(q(s).isString()){s=n.get("util.encoding")(s).toArrayBuffer();t=true}if(!q(s).isArrayBuffer()){throw new Error("invalid-parameter")}this.pack=function(){return s};this.unpack=function(p){var u=p.slice(0,s.byteLength);p=p.slice(s.byteLength);if(!n.get("util.buffer").equal(u,s)){throw new Error("unexpected-constant")}if(t){u=n.get("util.encoding")(u).toUTF16()}return[u,p]};return this}n.set("util.serialize.constant",function(p){p.constant=function(q){return new o(q)}})})(c);module.exports=function(n){n.datetime=function(){return new i()}};function i(){var n=this;this.pack=function(r){if(!Boolean(r)){return new $.node.buffer.Buffer("00","hex")}if(!$.tools.type.isDate(r)){if($.tools.type.isString(r)){try{r=new Date(r)}catch(s){throw $.error("invalid-parameter","date")}}else{throw $.error("invalid-parameter","date")}}var p=new $.node.buffer.Buffer(r.toISOString(),"ascii"),q=p.length,o=new $.node.buffer.Buffer(1);o.writeUInt8(q,0);return $.node.buffer.Buffer.concat([o,p])};this.unpack=function(s){var p=s.slice(0,1),r=p.readUInt8(0);s=s.slice(1);if(0==r){return[null,s]}var o=s.slice(0,r);s=s.slice(r);var q=new Date(o.toString("ascii"));return[q,s]};return this}(function(n){function o(r){var q=this;if(!n.get("util.type")(r).isArray()||r.length>255){throw new Error("invalid-parameter")}this.pack=function(t){var s=r.indexOf(t);if(s<0){throw new Error("not-enum-item")}var p=new Uint8Array([s]);return p.buffer};this.unpack=function(p){var s=new Uint8Array(p.slice(0,1))[0];p=p.slice(1);if(s>=r.length){throw new Error("invalid-enum-value")}return[r[s],p]};return this}n.set("util.serialize.enum",function(p){p["enum"]=function(q){return new o(q)}})})(c);(function(o){var q=false;function n(s){var z=this;var t=o.get("util.type");if(!t(s).isObject()){throw new Error("invalid-data-structure")}var u=Object.keys(s).sort(),r=[];for(var w in u){var y=u[w];var x,v;if(t(s[y]).isString()){x=s[y];v=[]}else{x=s[y][0];v=s[y].slice(1)}if(!q[x]){throw new Error("invalid-data-structure")}r.push(q[x](v))}this.serialize=function(D){if(!t(D).isObject()){throw new Error("invalid-parameter")}var A=[];for(var C in r){var B=u[C];A.push(r[C].pack(D[B]))}return o.get("util.buffer").concat(A)};this.deserialize=function(B){if(!t(B).isArrayBuffer()){throw new Error("invalid-parameter")}var C={};for(var E in u){var D=u[E];var A=r[E].unpack(B);C[D]=A[0];B=A[1]}return C};return this}var p=function(r){if(false===q){q={};o.get("util.serialize.enum")(q);o.get("util.serialize.binary")(q);o.get("util.serialize.boolean")(q);o.get("util.serialize.constant")(q);o.get("util.serialize.array")(q)}return new n(r)};o.set("util.serialize",p)})(c);(function(o){function p(u,s){if(typeof u==="undefined"){u=32}this.isFinished=false;this.digestLength=32;this.blockLength=64;this.iv=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];if(u<=0){u=this.digestLength}else{if(u>32){throw"digestLength is too large"}}var q=0;if(typeof s=="string"){s=this.stringToUtf8Array(s);q=s.length}else{if(typeof s=="object"){q=s.length}}if(q>32){throw"key too long"}var t=[u&255,q,1,1];this.h=this.iv.slice(0);this.h[0]^=this.load32(t,0);this.x=new Array(64);this.t0=0;this.t1=0;this.f0=0;this.f1=0;this.nx=0;this.digestLength=u;if(q>0){for(var r=0;r<q;r++){this.x[r]=s[r]}for(var r=q;r<64;r++){this.x[r]=0}this.nx=64}}p.prototype.load32=function(q,r){return((q[r]&255)|((q[r+1]&255)<<8)|((q[r+2]&255)<<16)|((q[r+3]&255)<<24))>>>0};p.prototype.store32=function(r,s,q){r[s]=(q>>>0)&255;r[s+1]=(q>>>8)&255;r[s+2]=(q>>>16)&255;r[s+3]=(q>>>24)&255};p.prototype.processBlock=function(B){this.t0+=B;if(this.t0!=this.t0>>>0){this.t0=0;this.t1++}var A=this.h[0],z=this.h[1],y=this.h[2],x=this.h[3],v=this.h[4],t=this.h[5],r=this.h[6],W=this.h[7],U=this.iv[0],S=this.iv[1],P=this.iv[2],M=this.iv[3],J=this.iv[4]^this.t0,G=this.iv[5]^this.t1,E=this.iv[6]^this.f0,C=this.iv[7]^this.f1;var w=this.load32(this.x,0),u=this.load32(this.x,4),s=this.load32(this.x,8),q=this.load32(this.x,12),V=this.load32(this.x,16),T=this.load32(this.x,20),R=this.load32(this.x,24),O=this.load32(this.x,28),L=this.load32(this.x,32),I=this.load32(this.x,36),Q=this.load32(this.x,40),N=this.load32(this.x,44),K=this.load32(this.x,48),H=this.load32(this.x,52),F=this.load32(this.x,56),D=this.load32(this.x,60);A+=w;A+=v;J^=A;J=J<<(32-16)|J>>>16;U+=J;v^=U;v=v<<(32-12)|v>>>12;z+=s;z+=t;G^=z;G=G<<(32-16)|G>>>16;S+=G;t^=S;t=t<<(32-12)|t>>>12;y+=V;y+=r;E^=y;E=E<<(32-16)|E>>>16;P+=E;r^=P;r=r<<(32-12)|r>>>12;x+=R;x+=W;C^=x;C=C<<(32-16)|C>>>16;M+=C;W^=M;W=W<<(32-12)|W>>>12;y+=T;y+=r;E^=y;E=E<<(32-8)|E>>>8;P+=E;r^=P;r=r<<(32-7)|r>>>7;x+=O;x+=W;C^=x;C=C<<(32-8)|C>>>8;M+=C;W^=M;W=W<<(32-7)|W>>>7;z+=q;z+=t;G^=z;G=G<<(32-8)|G>>>8;S+=G;t^=S;t=t<<(32-7)|t>>>7;A+=u;A+=v;J^=A;J=J<<(32-8)|J>>>8;U+=J;v^=U;v=v<<(32-7)|v>>>7;A+=L;A+=t;C^=A;C=C<<(32-16)|C>>>16;P+=C;t^=P;t=t<<(32-12)|t>>>12;z+=Q;z+=r;J^=z;J=J<<(32-16)|J>>>16;M+=J;r^=M;r=r<<(32-12)|r>>>12;y+=K;y+=W;G^=y;G=G<<(32-16)|G>>>16;U+=G;W^=U;W=W<<(32-12)|W>>>12;x+=F;x+=v;E^=x;E=E<<(32-16)|E>>>16;S+=E;v^=S;v=v<<(32-12)|v>>>12;y+=H;y+=W;G^=y;G=G<<(32-8)|G>>>8;U+=G;W^=U;W=W<<(32-7)|W>>>7;x+=D;x+=v;E^=x;E=E<<(32-8)|E>>>8;S+=E;v^=S;v=v<<(32-7)|v>>>7;z+=N;z+=r;J^=z;J=J<<(32-8)|J>>>8;M+=J;r^=M;r=r<<(32-7)|r>>>7;A+=I;A+=t;C^=A;C=C<<(32-8)|C>>>8;P+=C;t^=P;t=t<<(32-7)|t>>>7;A+=F;A+=v;J^=A;J=J<<(32-16)|J>>>16;U+=J;v^=U;v=v<<(32-12)|v>>>12;z+=V;z+=t;G^=z;G=G<<(32-16)|G>>>16;S+=G;t^=S;t=t<<(32-12)|t>>>12;y+=I;y+=r;E^=y;E=E<<(32-16)|E>>>16;P+=E;r^=P;r=r<<(32-12)|r>>>12;x+=H;x+=W;C^=x;C=C<<(32-16)|C>>>16;M+=C;W^=M;W=W<<(32-12)|W>>>12;y+=D;y+=r;E^=y;E=E<<(32-8)|E>>>8;P+=E;r^=P;r=r<<(32-7)|r>>>7;x+=R;x+=W;C^=x;C=C<<(32-8)|C>>>8;M+=C;W^=M;W=W<<(32-7)|W>>>7;z+=L;z+=t;G^=z;G=G<<(32-8)|G>>>8;S+=G;t^=S;t=t<<(32-7)|t>>>7;A+=Q;A+=v;J^=A;J=J<<(32-8)|J>>>8;U+=J;v^=U;v=v<<(32-7)|v>>>7;A+=u;A+=t;C^=A;C=C<<(32-16)|C>>>16;P+=C;t^=P;t=t<<(32-12)|t>>>12;z+=w;z+=r;J^=z;J=J<<(32-16)|J>>>16;M+=J;r^=M;r=r<<(32-12)|r>>>12;y+=N;y+=W;G^=y;G=G<<(32-16)|G>>>16;U+=G;W^=U;W=W<<(32-12)|W>>>12;x+=T;x+=v;E^=x;E=E<<(32-16)|E>>>16;S+=E;v^=S;v=v<<(32-12)|v>>>12;y+=O;y+=W;G^=y;G=G<<(32-8)|G>>>8;U+=G;W^=U;W=W<<(32-7)|W>>>7;x+=q;x+=v;E^=x;E=E<<(32-8)|E>>>8;S+=E;v^=S;v=v<<(32-7)|v>>>7;z+=s;z+=r;J^=z;J=J<<(32-8)|J>>>8;M+=J;r^=M;r=r<<(32-7)|r>>>7;A+=K;A+=t;C^=A;C=C<<(32-8)|C>>>8;P+=C;t^=P;t=t<<(32-7)|t>>>7;A+=N;A+=v;J^=A;J=J<<(32-16)|J>>>16;U+=J;v^=U;v=v<<(32-12)|v>>>12;z+=K;z+=t;G^=z;G=G<<(32-16)|G>>>16;S+=G;t^=S;t=t<<(32-12)|t>>>12;y+=T;y+=r;E^=y;E=E<<(32-16)|E>>>16;P+=E;r^=P;r=r<<(32-12)|r>>>12;x+=D;x+=W;C^=x;C=C<<(32-16)|C>>>16;M+=C;W^=M;W=W<<(32-12)|W>>>12;y+=s;y+=r;E^=y;E=E<<(32-8)|E>>>8;P+=E;r^=P;r=r<<(32-7)|r>>>7;x+=H;x+=W;C^=x;C=C<<(32-8)|C>>>8;M+=C;W^=M;W=W<<(32-7)|W>>>7;z+=w;z+=t;G^=z;G=G<<(32-8)|G>>>8;S+=G;t^=S;t=t<<(32-7)|t>>>7;A+=L;A+=v;J^=A;J=J<<(32-8)|J>>>8;U+=J;v^=U;v=v<<(32-7)|v>>>7;A+=Q;A+=t;C^=A;C=C<<(32-16)|C>>>16;P+=C;t^=P;t=t<<(32-12)|t>>>12;z+=q;z+=r;J^=z;J=J<<(32-16)|J>>>16;M+=J;r^=M;r=r<<(32-12)|r>>>12;y+=O;y+=W;G^=y;G=G<<(32-16)|G>>>16;U+=G;W^=U;W=W<<(32-12)|W>>>12;x+=I;x+=v;E^=x;E=E<<(32-16)|E>>>16;S+=E;v^=S;v=v<<(32-12)|v>>>12;y+=u;y+=W;G^=y;G=G<<(32-8)|G>>>8;U+=G;W^=U;W=W<<(32-7)|W>>>7;x+=V;x+=v;E^=x;E=E<<(32-8)|E>>>8;S+=E;v^=S;v=v<<(32-7)|v>>>7;z+=R;z+=r;J^=z;J=J<<(32-8)|J>>>8;M+=J;r^=M;r=r<<(32-7)|r>>>7;A+=F;A+=t;C^=A;C=C<<(32-8)|C>>>8;P+=C;t^=P;t=t<<(32-7)|t>>>7;A+=O;A+=v;J^=A;J=J<<(32-16)|J>>>16;U+=J;v^=U;v=v<<(32-12)|v>>>12;z+=q;z+=t;G^=z;G=G<<(32-16)|G>>>16;S+=G;t^=S;t=t<<(32-12)|t>>>12;y+=H;y+=r;E^=y;E=E<<(32-16)|E>>>16;P+=E;r^=P;r=r<<(32-12)|r>>>12;x+=N;x+=W;C^=x;C=C<<(32-16)|C>>>16;M+=C;W^=M;W=W<<(32-12)|W>>>12;y+=K;y+=r;E^=y;E=E<<(32-8)|E>>>8;P+=E;r^=P;r=r<<(32-7)|r>>>7;x+=F;x+=W;C^=x;C=C<<(32-8)|C>>>8;M+=C;W^=M;W=W<<(32-7)|W>>>7;z+=u;z+=t;G^=z;G=G<<(32-8)|G>>>8;S+=G;t^=S;t=t<<(32-7)|t>>>7;A+=I;A+=v;J^=A;J=J<<(32-8)|J>>>8;U+=J;v^=U;v=v<<(32-7)|v>>>7;A+=s;A+=t;C^=A;C=C<<(32-16)|C>>>16;P+=C;t^=P;t=t<<(32-12)|t>>>12;z+=T;z+=r;J^=z;J=J<<(32-16)|J>>>16;M+=J;r^=M;r=r<<(32-12)|r>>>12;y+=V;y+=W;G^=y;G=G<<(32-16)|G>>>16;U+=G;W^=U;W=W<<(32-12)|W>>>12;x+=D;x+=v;E^=x;E=E<<(32-16)|E>>>16;S+=E;v^=S;v=v<<(32-12)|v>>>12;y+=w;y+=W;G^=y;G=G<<(32-8)|G>>>8;U+=G;W^=U;W=W<<(32-7)|W>>>7;x+=L;x+=v;E^=x;E=E<<(32-8)|E>>>8;S+=E;v^=S;v=v<<(32-7)|v>>>7;z+=Q;z+=r;J^=z;J=J<<(32-8)|J>>>8;M+=J;r^=M;r=r<<(32-7)|r>>>7;A+=R;A+=t;C^=A;C=C<<(32-8)|C>>>8;P+=C;t^=P;t=t<<(32-7)|t>>>7;A+=I;A+=v;J^=A;J=J<<(32-16)|J>>>16;U+=J;v^=U;v=v<<(32-12)|v>>>12;z+=T;z+=t;G^=z;G=G<<(32-16)|G>>>16;S+=G;t^=S;t=t<<(32-12)|t>>>12;y+=s;y+=r;E^=y;E=E<<(32-16)|E>>>16;P+=E;r^=P;r=r<<(32-12)|r>>>12;x+=Q;x+=W;C^=x;C=C<<(32-16)|C>>>16;M+=C;W^=M;W=W<<(32-12)|W>>>12;y+=V;y+=r;E^=y;E=E<<(32-8)|E>>>8;P+=E;r^=P;r=r<<(32-7)|r>>>7;x+=D;x+=W;C^=x;C=C<<(32-8)|C>>>8;M+=C;W^=M;W=W<<(32-7)|W>>>7;z+=O;z+=t;G^=z;G=G<<(32-8)|G>>>8;S+=G;t^=S;t=t<<(32-7)|t>>>7;A+=w;A+=v;J^=A;J=J<<(32-8)|J>>>8;U+=J;v^=U;v=v<<(32-7)|v>>>7;A+=F;A+=t;C^=A;C=C<<(32-16)|C>>>16;P+=C;t^=P;t=t<<(32-12)|t>>>12;z+=N;z+=r;J^=z;J=J<<(32-16)|J>>>16;M+=J;r^=M;r=r<<(32-12)|r>>>12;y+=R;y+=W;G^=y;G=G<<(32-16)|G>>>16;U+=G;W^=U;W=W<<(32-12)|W>>>12;x+=q;x+=v;E^=x;E=E<<(32-16)|E>>>16;S+=E;v^=S;v=v<<(32-12)|v>>>12;y+=L;y+=W;G^=y;G=G<<(32-8)|G>>>8;U+=G;W^=U;W=W<<(32-7)|W>>>7;x+=H;x+=v;E^=x;E=E<<(32-8)|E>>>8;S+=E;v^=S;v=v<<(32-7)|v>>>7;z+=K;z+=r;J^=z;J=J<<(32-8)|J>>>8;M+=J;r^=M;r=r<<(32-7)|r>>>7;A+=u;A+=t;C^=A;C=C<<(32-8)|C>>>8;P+=C;t^=P;t=t<<(32-7)|t>>>7;A+=s;A+=v;J^=A;J=J<<(32-16)|J>>>16;U+=J;v^=U;v=v<<(32-12)|v>>>12;z+=R;z+=t;G^=z;G=G<<(32-16)|G>>>16;S+=G;t^=S;t=t<<(32-12)|t>>>12;y+=w;y+=r;E^=y;E=E<<(32-16)|E>>>16;P+=E;r^=P;r=r<<(32-12)|r>>>12;x+=L;x+=W;C^=x;C=C<<(32-16)|C>>>16;M+=C;W^=M;W=W<<(32-12)|W>>>12;y+=N;y+=r;E^=y;E=E<<(32-8)|E>>>8;P+=E;r^=P;r=r<<(32-7)|r>>>7;x+=q;x+=W;C^=x;C=C<<(32-8)|C>>>8;M+=C;W^=M;W=W<<(32-7)|W>>>7;z+=Q;z+=t;G^=z;G=G<<(32-8)|G>>>8;S+=G;t^=S;t=t<<(32-7)|t>>>7;A+=K;A+=v;J^=A;J=J<<(32-8)|J>>>8;U+=J;v^=U;v=v<<(32-7)|v>>>7;A+=V;A+=t;C^=A;C=C<<(32-16)|C>>>16;P+=C;t^=P;t=t<<(32-12)|t>>>12;z+=O;z+=r;J^=z;J=J<<(32-16)|J>>>16;M+=J;r^=M;r=r<<(32-12)|r>>>12;y+=D;y+=W;G^=y;G=G<<(32-16)|G>>>16;U+=G;W^=U;W=W<<(32-12)|W>>>12;x+=u;x+=v;E^=x;E=E<<(32-16)|E>>>16;S+=E;v^=S;v=v<<(32-12)|v>>>12;y+=F;y+=W;G^=y;G=G<<(32-8)|G>>>8;U+=G;W^=U;W=W<<(32-7)|W>>>7;x+=I;x+=v;E^=x;E=E<<(32-8)|E>>>8;S+=E;v^=S;v=v<<(32-7)|v>>>7;z+=T;z+=r;J^=z;J=J<<(32-8)|J>>>8;M+=J;r^=M;r=r<<(32-7)|r>>>7;A+=H;A+=t;C^=A;C=C<<(32-8)|C>>>8;P+=C;t^=P;t=t<<(32-7)|t>>>7;A+=K;A+=v;J^=A;J=J<<(32-16)|J>>>16;U+=J;v^=U;v=v<<(32-12)|v>>>12;z+=u;z+=t;G^=z;G=G<<(32-16)|G>>>16;S+=G;t^=S;t=t<<(32-12)|t>>>12;y+=F;y+=r;E^=y;E=E<<(32-16)|E>>>16;P+=E;r^=P;r=r<<(32-12)|r>>>12;x+=V;x+=W;C^=x;C=C<<(32-16)|C>>>16;M+=C;W^=M;W=W<<(32-12)|W>>>12;y+=H;y+=r;E^=y;E=E<<(32-8)|E>>>8;P+=E;r^=P;r=r<<(32-7)|r>>>7;x+=Q;x+=W;C^=x;C=C<<(32-8)|C>>>8;M+=C;W^=M;W=W<<(32-7)|W>>>7;z+=D;z+=t;G^=z;G=G<<(32-8)|G>>>8;S+=G;t^=S;t=t<<(32-7)|t>>>7;A+=T;A+=v;J^=A;J=J<<(32-8)|J>>>8;U+=J;v^=U;v=v<<(32-7)|v>>>7;A+=w;A+=t;C^=A;C=C<<(32-16)|C>>>16;P+=C;t^=P;t=t<<(32-12)|t>>>12;z+=R;z+=r;J^=z;J=J<<(32-16)|J>>>16;M+=J;r^=M;r=r<<(32-12)|r>>>12;y+=I;y+=W;G^=y;G=G<<(32-16)|G>>>16;U+=G;W^=U;W=W<<(32-12)|W>>>12;x+=L;x+=v;E^=x;E=E<<(32-16)|E>>>16;S+=E;v^=S;v=v<<(32-12)|v>>>12;y+=s;y+=W;G^=y;G=G<<(32-8)|G>>>8;U+=G;W^=U;W=W<<(32-7)|W>>>7;x+=N;x+=v;E^=x;E=E<<(32-8)|E>>>8;S+=E;v^=S;v=v<<(32-7)|v>>>7;z+=q;z+=r;J^=z;J=J<<(32-8)|J>>>8;M+=J;r^=M;r=r<<(32-7)|r>>>7;A+=O;A+=t;C^=A;C=C<<(32-8)|C>>>8;P+=C;t^=P;t=t<<(32-7)|t>>>7;A+=H;A+=v;J^=A;J=J<<(32-16)|J>>>16;U+=J;v^=U;v=v<<(32-12)|v>>>12;z+=O;z+=t;G^=z;G=G<<(32-16)|G>>>16;S+=G;t^=S;t=t<<(32-12)|t>>>12;y+=K;y+=r;E^=y;E=E<<(32-16)|E>>>16;P+=E;r^=P;r=r<<(32-12)|r>>>12;x+=q;x+=W;C^=x;C=C<<(32-16)|C>>>16;M+=C;W^=M;W=W<<(32-12)|W>>>12;y+=u;y+=r;E^=y;E=E<<(32-8)|E>>>8;P+=E;r^=P;r=r<<(32-7)|r>>>7;x+=I;x+=W;C^=x;C=C<<(32-8)|C>>>8;M+=C;W^=M;W=W<<(32-7)|W>>>7;z+=F;z+=t;G^=z;G=G<<(32-8)|G>>>8;S+=G;t^=S;t=t<<(32-7)|t>>>7;A+=N;A+=v;J^=A;J=J<<(32-8)|J>>>8;U+=J;v^=U;v=v<<(32-7)|v>>>7;A+=T;A+=t;C^=A;C=C<<(32-16)|C>>>16;P+=C;t^=P;t=t<<(32-12)|t>>>12;z+=D;z+=r;J^=z;J=J<<(32-16)|J>>>16;M+=J;r^=M;r=r<<(32-12)|r>>>12;y+=L;y+=W;G^=y;G=G<<(32-16)|G>>>16;U+=G;W^=U;W=W<<(32-12)|W>>>12;x+=s;x+=v;E^=x;E=E<<(32-16)|E>>>16;S+=E;v^=S;v=v<<(32-12)|v>>>12;y+=R;y+=W;G^=y;G=G<<(32-8)|G>>>8;U+=G;W^=U;W=W<<(32-7)|W>>>7;x+=Q;x+=v;E^=x;E=E<<(32-8)|E>>>8;S+=E;v^=S;v=v<<(32-7)|v>>>7;z+=V;z+=r;J^=z;J=J<<(32-8)|J>>>8;M+=J;r^=M;r=r<<(32-7)|r>>>7;A+=w;A+=t;C^=A;C=C<<(32-8)|C>>>8;P+=C;t^=P;t=t<<(32-7)|t>>>7;A+=R;A+=v;J^=A;J=J<<(32-16)|J>>>16;U+=J;v^=U;v=v<<(32-12)|v>>>12;z+=F;z+=t;G^=z;G=G<<(32-16)|G>>>16;S+=G;t^=S;t=t<<(32-12)|t>>>12;y+=N;y+=r;E^=y;E=E<<(32-16)|E>>>16;P+=E;r^=P;r=r<<(32-12)|r>>>12;x+=w;x+=W;C^=x;C=C<<(32-16)|C>>>16;M+=C;W^=M;W=W<<(32-12)|W>>>12;y+=q;y+=r;E^=y;E=E<<(32-8)|E>>>8;P+=E;r^=P;r=r<<(32-7)|r>>>7;x+=L;x+=W;C^=x;C=C<<(32-8)|C>>>8;M+=C;W^=M;W=W<<(32-7)|W>>>7;z+=I;z+=t;G^=z;G=G<<(32-8)|G>>>8;S+=G;t^=S;t=t<<(32-7)|t>>>7;A+=D;A+=v;J^=A;J=J<<(32-8)|J>>>8;U+=J;v^=U;v=v<<(32-7)|v>>>7;A+=K;A+=t;C^=A;C=C<<(32-16)|C>>>16;P+=C;t^=P;t=t<<(32-12)|t>>>12;z+=H;z+=r;J^=z;J=J<<(32-16)|J>>>16;M+=J;r^=M;r=r<<(32-12)|r>>>12;y+=u;y+=W;G^=y;G=G<<(32-16)|G>>>16;U+=G;W^=U;W=W<<(32-12)|W>>>12;x+=Q;x+=v;E^=x;E=E<<(32-16)|E>>>16;S+=E;v^=S;v=v<<(32-12)|v>>>12;y+=V;y+=W;G^=y;G=G<<(32-8)|G>>>8;U+=G;W^=U;W=W<<(32-7)|W>>>7;x+=T;x+=v;E^=x;E=E<<(32-8)|E>>>8;S+=E;v^=S;v=v<<(32-7)|v>>>7;z+=O;z+=r;J^=z;J=J<<(32-8)|J>>>8;M+=J;r^=M;r=r<<(32-7)|r>>>7;A+=s;A+=t;C^=A;C=C<<(32-8)|C>>>8;P+=C;t^=P;t=t<<(32-7)|t>>>7;A+=Q;A+=v;J^=A;J=J<<(32-16)|J>>>16;U+=J;v^=U;v=v<<(32-12)|v>>>12;z+=L;z+=t;G^=z;G=G<<(32-16)|G>>>16;S+=G;t^=S;t=t<<(32-12)|t>>>12;y+=O;y+=r;E^=y;E=E<<(32-16)|E>>>16;P+=E;r^=P;r=r<<(32-12)|r>>>12;x+=u;x+=W;C^=x;C=C<<(32-16)|C>>>16;M+=C;W^=M;W=W<<(32-12)|W>>>12;y+=R;y+=r;E^=y;E=E<<(32-8)|E>>>8;P+=E;r^=P;r=r<<(32-7)|r>>>7;x+=T;x+=W;C^=x;C=C<<(32-8)|C>>>8;M+=C;W^=M;W=W<<(32-7)|W>>>7;z+=V;z+=t;G^=z;G=G<<(32-8)|G>>>8;S+=G;t^=S;t=t<<(32-7)|t>>>7;A+=s;A+=v;J^=A;J=J<<(32-8)|J>>>8;U+=J;v^=U;v=v<<(32-7)|v>>>7;A+=D;A+=t;C^=A;C=C<<(32-16)|C>>>16;P+=C;t^=P;t=t<<(32-12)|t>>>12;z+=I;z+=r;J^=z;J=J<<(32-16)|J>>>16;M+=J;r^=M;r=r<<(32-12)|r>>>12;y+=q;y+=W;G^=y;G=G<<(32-16)|G>>>16;U+=G;W^=U;W=W<<(32-12)|W>>>12;x+=H;x+=v;E^=x;E=E<<(32-16)|E>>>16;S+=E;v^=S;v=v<<(32-12)|v>>>12;y+=K;y+=W;G^=y;G=G<<(32-8)|G>>>8;U+=G;W^=U;W=W<<(32-7)|W>>>7;x+=w;x+=v;E^=x;E=E<<(32-8)|E>>>8;S+=E;v^=S;v=v<<(32-7)|v>>>7;z+=F;z+=r;J^=z;J=J<<(32-8)|J>>>8;M+=J;r^=M;r=(r<<(32-7))|(r>>>7);A+=N;A+=t;C^=A;C=(C<<(32-8))|(C>>>8);P+=C;t^=P;t=(t<<(32-7))|(t>>>7);this.h[0]^=A^U;this.h[1]^=z^S;this.h[2]^=y^P;this.h[3]^=x^M;this.h[4]^=v^J;this.h[5]^=t^G;this.h[6]^=r^E;this.h[7]^=W^C};p.prototype.stringToUtf8Array=function(t){var q=[];for(var r=0;r<t.length;r++){var u=t.charCodeAt(r);if(u<128){q.push(u)}else{if(u>127&&u<2048){q.push((u>>6)|192);q.push((u&63)|128)}else{q.push((u>>12)|224);q.push(((u>>6)&63)|128);q.push((u&64)|128)}}}return q};p.prototype.update=function(t,u,r){if(typeof u==="undefined"){u=0}if(typeof r==="undefined"){r=t.length}if(this.isFinished){throw"update() after calling digest()"}if(typeof t=="string"){if(u!=0){throw"offset not supported for strings"}t=this.stringToUtf8Array(t);r=t.length;u=0}else{if(typeof t!="object"){throw"unsupported object: string or array required"}}if(r==0){return}var s=64-this.nx;if(r>s){for(var q=0;q<s;q++){this.x[this.nx+q]=t[u+q]}this.processBlock(64);u+=s;r-=s;this.nx=0}while(r>64){for(var q=0;q<64;q++){this.x[q]=t[u+q]}this.processBlock(64);u+=64;r-=64;this.nx=0}for(var q=0;q<r;q++){this.x[this.nx+q]=t[u+q]}this.nx+=r};p.prototype.digest=function(){if(this.isFinished){return this.result}for(var r=this.nx;r<64;r++){this.x[r]=0}this.f0=4294967295;this.processBlock(this.nx);var q=new Array(32);for(var r=0;r<8;r++){var s=this.h[r];q[r*4+0]=(s>>>0)&255;q[r*4+1]=(s>>>8)&255;q[r*4+2]=(s>>>16)&255;q[r*4+3]=(s>>>24)&255}this.result=q.slice(0,this.digestLength);this.isFinished=true;return this.result};function n(s){var q=this;this.name="BLAKE2s";this.blockSize=32;if(s&&o.get("util.type")(s.length).isNumber()&&s.length<=32&&s.length>=1){this.digestSize=Math.floor(s.length)}else{this.digestSize=32}function r(v,u){if(u){var t=new p(q.digestSize,new Uint8Array(u))}else{var t=new p(q.digestSize)}t.update(new Uint8Array(v));return new Uint8Array(t.digest()).buffer}this.mac=function(u,t){if(t.byteLength>32){t=t.slice(0,32)}return r(u,t)};this.hash=function(t){return r(t)};return this}o.set("hash.algorithms.blake2s",n)})(c);(function(o){var p={};function q(u,t){var s=this;this.algorithms=["ripemd160","blake2s","whirlpool"];u=u.toLowerCase();if(this.algorithms.indexOf(u)<0){throw new Error("hash-algorithm-unknown")}var w=o.get("hash.algorithms."+u);function v(x){return{hex:o.get("util.encoding")(x).toHEX(),buffer:x}}this.hash=function(y){if(!o.get("util.type")(y).isArrayBuffer()){throw Error("invalid-parameter")}var x=new w(t);return v(x.hash(y))};this.mac=function(z,A){if(!(o.get("util.type")(A).isArrayBuffer()&&o.get("util.type")(z).isArrayBuffer())){throw Error("invalid-parameter")}var y;var x=new w(t);if(o.get("util.type")(x.mac).isFunction()){y=x.mac(z,A)}else{y=r(x.hash,A,z,x.blockSize)}return v(y)};this.pbkdf2=function(y,x,A,z){if(!(o.get("util.type")(y).isArrayBuffer()&&o.get("util.type")(x).isArrayBuffer()&&A>0&&z>0)){throw Error("invalid-parameter")}return n(s.mac,new w().digestSize,y,x,A,z)};return this}function r(D,u,w,A){if(u.byteLength>A){u=new Uint8Array(D(u))}else{if(u.byteLength<A){var s=new Uint8Array(A),z=new Uint8Array(u);for(var x=0;x<s.length;x++){if(x<u.byteLength){s[x]=z[x]}else{s[x]=0}}u=s}}var E=new Uint8Array(A);var v=new Uint8Array(A);for(var x=0;x<A;x++){E[x]=92^u[x];v[x]=54^u[x]}var t=o.get("util.buffer").concat([v.buffer,w]),B=D(t);var C=o.get("util.buffer").concat([E.buffer,B]),y=D(C);return y}function n(F,D,z,w,u,s){var E=Math.ceil(s/D);var B=new Array(E);for(var y=0;y<E;y++){var A=false;var t=new Uint32Array([y]);var C=o.get("util.buffer").concat([w,t.buffer]);for(var x=0;x<u;x++){var v=F(z,C).buffer;if(false===A){A=v}else{A=o.get("util.buffer").xor(v,A)}C=v}B[y]=A}return o.get("util.buffer").concat(B).slice(0,s)}o.exp("hash",q);o.set("hash",q)})(c);(function(r){var s=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13];var p=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11];var C=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6];var B=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11];var q=[0,1518500249,1859775393,2400959708,2840853838];var E=[1352829926,1548603684,1836072691,2053994217,0];var n=function(G){var I=[];for(var H=0,F=0;H<G.length;H++,F+=8){I[F>>>5]|=G[H]<<(24-F%32)}return I};var t=function(H){var G=[];for(var F=0;F<H.length*32;F+=8){G.push((H[F>>>5]>>>(24-F%32))&255)}return G};var D=function(T,Q,K){for(var L=0;L<16;L++){var V=K+L;var R=Q[V];Q[V]=((((R<<8)|(R>>>24))&16711935)|(((R<<24)|(R>>>8))&4278255360))}var O,G,S,N,F;var J,X,P,I,U;J=O=T[0];X=G=T[1];P=S=T[2];I=N=T[3];U=F=T[4];var W;for(var L=0;L<80;L+=1){W=(O+Q[K+s[L]])|0;if(L<16){W+=A(G,S,N)+q[0]}else{if(L<32){W+=z(G,S,N)+q[1]}else{if(L<48){W+=y(G,S,N)+q[2]}else{if(L<64){W+=x(G,S,N)+q[3]}else{W+=w(G,S,N)+q[4]}}}}W=W|0;W=v(W,C[L]);W=(W+F)|0;O=F;F=N;N=v(S,10);S=G;G=W;W=(J+Q[K+p[L]])|0;if(L<16){W+=w(X,P,I)+E[0]}else{if(L<32){W+=x(X,P,I)+E[1]}else{if(L<48){W+=y(X,P,I)+E[2]}else{if(L<64){W+=z(X,P,I)+E[3]}else{W+=A(X,P,I)+E[4]}}}}W=W|0;W=v(W,B[L]);W=(W+U)|0;J=U;U=I;I=v(P,10);P=X;X=W}W=(T[1]+S+I)|0;T[1]=(T[2]+N+U)|0;T[2]=(T[3]+F+J)|0;T[3]=(T[4]+O+X)|0;T[4]=(T[0]+G+P)|0;T[0]=W};function A(F,H,G){return((F)^(H)^(G))}function z(F,H,G){return(((F)&(H))|((~F)&(G)))}function y(F,H,G){return(((F)|(~(H)))^(G))}function x(F,H,G){return(((F)&(G))|((H)&(~(G))))}function w(F,H,G){return((F)^((H)|(~(G))))}function v(F,G){return(F<<G)|(F>>>(32-G))}function o(N){var M=[1732584193,4023233417,2562383102,271733878,3285377520],O=new Uint8Array(N);var G=n(O);var L=O.length*8;var K=O.length*8;G[L>>>5]|=128<<(24-L%32);G[(((L+64)>>>9)<<4)+14]=((((K<<8)|(K>>>24))&16711935)|(((K<<24)|(K>>>8))&4278255360));for(var I=0;I<G.length;I+=16){D(M,G,I)}var F;for(var I=0;I<5;I++){F=M[I];M[I]=(((F<<8)|(F>>>24))&16711935)|(((F<<24)|(F>>>8))&4278255360)}var J=t(M);return new Uint8Array(J).buffer}function u(){var F=this;this.name="RIPEMD160";this.blockSize=64;this.digestSize=20;this.hash=function(G){return o(G)};return this}r.set("hash.algorithms.ripemd160",u)})(c);(function(u){var S,w=10,I=[],M=[],G,F,Q,J,P,s,q,o,n,V,U,H="\u1823\uc6E8\u87B8\u014F\u36A6\ud2F5\u796F\u9152\u60Bc\u9B8E\uA30c\u7B35\u1dE0\ud7c2\u2E4B\uFE57\u1577\u37E5\u9FF0\u4AdA\u58c9\u290A\uB1A0\u6B85\uBd5d\u10F4\ucB3E\u0567\uE427\u418B\uA77d\u95d8\uFBEE\u7c66\udd17\u479E\ucA2d\uBF07\uAd5A\u8333\u6302\uAA71\uc819\u49d9\uF2E3\u5B88\u9A26\u32B0\uE90F\ud580\uBEcd\u3448\uFF7A\u905F\u2068\u1AAE\uB454\u9322\u64F1\u7312\u4008\uc3Ec\udBA1\u8d3d\u9700\ucF2B\u7682\ud61B\uB5AF\u6A50\u45F3\u30EF\u3F55\uA2EA\u65BA\u2Fc0\udE1c\uFd4d\u9275\u068A\uB2E6\u0E1F\u62d4\uA896\uF9c5\u2559\u8472\u394c\u5E78\u388c\ud1A5\uE261\uB321\u9c1E\u43c7\uFc04\u5199\u6d0d\uFAdF\u7E24\u3BAB\ucE11\u8F4E\uB7EB\u3c81\u94F7\uB913\u2cd3\uE76E\uc403\u5644\u7FA9\u2ABB\uc153\udc0B\u9d6c\u3174\uF646\uAc89\u14E1\u163A\u6909\u70B6\ud0Ed\ucc42\u98A4\u285c\uF886";for(G=8;G-->0;){I[G]=[]}for(F=0;F<256;F++){Q=H.charCodeAt(F/2);s=((F&1)==0)?Q>>>8:Q&255;q=s<<1;if(q>=256){q^=285}o=q<<1;if(o>=256){o^=285}n=o^s;V=o<<1;if(V>=256){V^=285}U=V^s;I[0][F]=[0,0];I[0][F][0]=(s<<24)|(s<<16)|(o<<8)|(s);I[0][F][1]=(V<<24)|(n<<16)|(q<<8)|(U);for(var G=1;G<8;G++){I[G][F]=[0,0];I[G][F][0]=(I[G-1][F][0]>>>8)|((I[G-1][F][1]<<24));I[G][F][1]=(I[G-1][F][1]>>>8)|((I[G-1][F][0]<<24))}}M[0]=[0,0];for(J=1;J<=w;J++){P=8*(J-1);M[J]=[0,0];M[J][0]=(I[0][P][0]&4278190080)^(I[1][P+1][0]&16711680)^(I[2][P+2][0]&65280)^(I[3][P+3][0]&255);M[J][1]=(I[4][P+4][1]&4278190080)^(I[5][P+5][1]&16711680)^(I[6][P+6][1]&65280)^(I[7][P+7][1]&255)}var O=[],N=[],B=0,y=0,p=[],D=[],A=[],z=[],v=[];var T=function(){var K,x,R,L,C;for(K=0,x=0;K<8;K++,x+=8){z[K]=[0,0];z[K][0]=((N[x]&255)<<24)^((N[x+1]&255)<<16)^((N[x+2]&255)<<8)^((N[x+3]&255));z[K][1]=((N[x+4]&255)<<24)^((N[x+5]&255)<<16)^((N[x+6]&255)<<8)^((N[x+7]&255))}for(K=0;K<8;K++){v[K]=[0,0];D[K]=[0,0];v[K][0]=z[K][0]^(D[K][0]=p[K][0]);v[K][1]=z[K][1]^(D[K][1]=p[K][1])}for(R=1;R<=w;R++){for(K=0;K<8;K++){A[K]=[0,0];for(C=0,L=56,x=0;C<8;C++,L-=8,x=L<32?1:0){A[K][0]^=I[C][(D[(K-C)&7][x]>>>(L%32))&255][0];A[K][1]^=I[C][(D[(K-C)&7][x]>>>(L%32))&255][1]}}for(K=0;K<8;K++){D[K][0]=A[K][0];D[K][1]=A[K][1]}D[0][0]^=M[R][0];D[0][1]^=M[R][1];for(K=0;K<8;K++){A[K][0]=D[K][0];A[K][1]=D[K][1];for(C=0,L=56,x=0;C<8;C++,L-=8,x=L<32?1:0){A[K][0]^=I[C][(v[(K-C)&7][x]>>>(L%32))&255][0];A[K][1]^=I[C][(v[(K-C)&7][x]>>>(L%32))&255][1]}}for(K=0;K<8;K++){v[K][0]=A[K][0];v[K][1]=A[K][1]}}for(K=0;K<8;K++){p[K][0]^=v[K][0]^z[K][0];p[K][1]^=v[K][1]^z[K][1]}};S=Whirlpool=function(r){return S.init().add(r).finalize()};S.version="3.0";S.init=function(){for(var r=32;r-->0;){O[r]=0}B=y=0;N=[0];for(r=8;r-->0;){p[r]=[0,0]}return S};S.add=function(L){if(!L){return S}var r=new Uint8Array(L);var Y=r.length*8;var t=0,x=(8-(Y&7))&7,K=B&7,C,R,X,W=Y;for(C=31,X=0;C>=0;C--){X+=(O[C]&255)+(W%256);O[C]=X&255;X>>>=8;W=Math.floor(W/256)}while(Y>8){R=((r[t]<<x)&255)|((r[t+1]&255)>>>(8-x));if(R<0||R>=256){return"Whirlpool requires a byte array"}N[y++]|=R>>>K;B+=8-K;if(B==512){T();B=y=0;N=[]}N[y]=((R<<(8-K))&255);B+=K;Y-=8;t++}if(Y>0){R=(r[t]<<x)&255;N[y]|=R>>>K}else{R=0}if(K+Y<8){B+=Y}else{y++;B+=8-K;Y-=8-K;if(B==512){T();B=y=0;N=[]}N[y]=((R<<(8-K))&255);B+=Y}return S};S.finalize=function(){var t,r,x,K="",C=[];N[y]|=128>>>(B&7);y++;if(y>32){while(y<64){N[y++]=0}T();y=0;N=[]}while(y<32){N[y++]=0}N.push.apply(N,O);T();for(t=0,r=0;t<8;t++,r+=8){x=p[t][0];C[r]=x>>>24&255;C[r+1]=x>>>16&255;C[r+2]=x>>>8&255;C[r+3]=x&255;x=p[t][1];C[r+4]=x>>>24&255;C[r+5]=x>>>16&255;C[r+6]=x>>>8&255;C[r+7]=x&255}return new Uint8Array(C).buffer};function E(){var r=this;this.name="WHIRLPOOL";this.blockSize=64;this.digestSize=64;this.hash=function(t){return Whirlpool(t)};return this}u.set("hash.algorithms.whirlpool",E)})(c);(function(bg){var bl;var aZ=244837814094590;var aM=((aZ&16777215)==15715070);function a8(bq,bp,br){if(!(this instanceof a8)){return new a8(bq,bp,br)}if(bq!=null){if("number"==typeof bq){this.fromNumber(bq,bp,br)}else{if(bp==null&&"string"!=typeof bq){this.fromString(bq,256)}else{this.fromString(bq,bp)}}}}var bi=a8.prototype;function y(){return new a8(null)}function n(bt,bp,bq,bs,bv,bu){while(--bu>=0){var br=bp*this[bt++]+bq[bs]+bv;bv=Math.floor(br/67108864);bq[bs++]=br&67108863}return bv}function bn(bt,by,bz,bs,bw,bp){var bv=by&32767,bx=by>>15;while(--bp>=0){var br=this[bt]&32767;var bu=this[bt++]>>15;var bq=bx*br+bu*bv;br=bv*br+((bq&32767)<<15)+bz[bs]+(bw&1073741823);bw=(br>>>30)+(bq>>>15)+bx*bu+(bw>>>30);bz[bs++]=br&1073741823}return bw}function bm(bt,by,bz,bs,bw,bp){var bv=by&16383,bx=by>>14;while(--bp>=0){var br=this[bt]&16383;var bu=this[bt++]>>14;var bq=bx*br+bu*bv;br=bv*br+((bq&16383)<<14)+bz[bs]+bw;bw=(br>>28)+(bq>>14)+bx*bu;bz[bs++]=br&268435455}return bw}a8.prototype.am=n;bl=26;a8.prototype.DB=bl;a8.prototype.DM=((1<<bl)-1);var aw=a8.prototype.DV=(1<<bl);var aN=52;a8.prototype.FV=Math.pow(2,aN);a8.prototype.F1=aN-bl;a8.prototype.F2=2*bl-aN;var aV="0123456789abcdefghijklmnopqrstuvwxyz";var aY=new Array();var a6,N;a6="0".charCodeAt(0);for(N=0;N<=9;++N){aY[a6++]=N}a6="a".charCodeAt(0);for(N=10;N<36;++N){aY[a6++]=N}a6="A".charCodeAt(0);for(N=10;N<36;++N){aY[a6++]=N}function bo(bp){return aV.charAt(bp)}function X(bq,bp){var br=aY[bq.charCodeAt(bp)];return(br==null)?-1:br}function aL(bq){for(var bp=this.t-1;bp>=0;--bp){bq[bp]=this[bp]}bq.t=this.t;bq.s=this.s}function H(bp){this.t=1;this.s=(bp<0)?-1:0;if(bp>0){this[0]=bp}else{if(bp<-1){this[0]=bp+aw}else{this.t=0}}}function q(bp){var bq=y();bq.fromInt(bp);return bq}function Q(bw,bq){var bt=this;var bs;if(bq==16){bs=4}else{if(bq==8){bs=3}else{if(bq==256){bs=8}else{if(bq==2){bs=1}else{if(bq==32){bs=5}else{if(bq==4){bs=2}else{bt.fromRadix(bw,bq);return}}}}}}bt.t=0;bt.s=0;var bv=bw.length,br=false,bu=0;while(--bv>=0){var bp=(bs==8)?bw[bv]&255:X(bw,bv);if(bp<0){if(bw.charAt(bv)=="-"){br=true}continue}br=false;if(bu==0){bt[bt.t++]=bp}else{if(bu+bs>bt.DB){bt[bt.t-1]|=(bp&((1<<(bt.DB-bu))-1))<<bu;bt[bt.t++]=(bp>>(bt.DB-bu))}else{bt[bt.t-1]|=bp<<bu}}bu+=bs;if(bu>=bt.DB){bu-=bt.DB}}if(bs==8&&(bw[0]&128)!=0){bt.s=-1;if(bu>0){bt[bt.t-1]|=((1<<(bt.DB-bu))-1)<<bu}}bt.clamp();if(br){a8.ZERO.subTo(bt,bt)}}function aq(){var bp=this.s&this.DM;while(this.t>0&&this[this.t-1]==bp){--this.t}}function J(bw){var bx=this;if(bx.s<0){return"-"+bx.negate().toString(bw)}var bt;if(bw==16){bt=4}else{if(bw==8){bt=3}else{if(bw==2){bt=1}else{if(bw==32){bt=5}else{if(bw==4){bt=2}else{return bx.toRadix(bw)}}}}}var bq=(1<<bt)-1,bv,bs=false,bp="",bu=bx.t;var br=bx.DB-(bu*bx.DB)%bt;if(bu-->0){if(br<bx.DB&&(bv=bx[bu]>>br)>0){bs=true;bp=bo(bv)}while(bu>=0){if(br<bt){bv=(bx[bu]&((1<<br)-1))<<(bt-br);bv|=bx[--bu]>>(br+=bx.DB-bt)}else{bv=(bx[bu]>>(br-=bt))&bq;if(br<=0){br+=bx.DB;--bu}}if(bv>0){bs=true}if(bs){bp+=bo(bv)}}}return bs?bp:"0"}function av(){var bp=y();a8.ZERO.subTo(this,bp);return bp}function a2(){return(this.s<0)?this.negate():this}function ah(bp){var br=this.s-bp.s;if(br!=0){return br}var bq=this.t;br=bq-bp.t;if(br!=0){return(this.s<0)?-br:br}while(--bq>=0){if((br=this[bq]-bp[bq])!=0){return br}}return 0}function D(bp){var br=1,bq;if((bq=bp>>>16)!=0){bp=bq;br+=16}if((bq=bp>>8)!=0){bp=bq;br+=8}if((bq=bp>>4)!=0){bp=bq;br+=4}if((bq=bp>>2)!=0){bp=bq;br+=2}if((bq=bp>>1)!=0){bp=bq;br+=1}return br}function M(){if(this.t<=0){return 0}return this.DB*(this.t-1)+D(this[this.t-1]^(this.s&this.DM))}function a7(br,bq){var bp;for(bp=this.t-1;bp>=0;--bp){bq[bp+br]=this[bp]}for(bp=br-1;bp>=0;--bp){bq[bp]=0}bq.t=this.t+br;bq.s=this.s}function aK(br,bq){for(var bp=br;bp<this.t;++bp){bq[bp-br]=this[bp]}bq.t=Math.max(this.t-br,0);bq.s=this.s}function L(br,bp){var by=this;var bx=br%by.DB;var bv=by.DB-bx;var bq=(1<<bv)-1;var bt=Math.floor(br/by.DB),bw=(by.s<<bx)&by.DM,bu;for(bu=by.t-1;bu>=0;--bu){bp[bu+bt+1]=(by[bu]>>bv)|bw;bw=(by[bu]&bq)<<bx}for(bu=bt-1;bu>=0;--bu){bp[bu]=0}bp[bt]=bw;bp.t=by.t+bt+1;bp.s=by.s;bp.clamp()}function E(bx,bu){var bp=this;bu.s=bp.s;var bv=Math.floor(bx/bp.DB);if(bv>=bp.t){bu.t=0;return}var br=bx%bp.DB;var bq=bp.DB-br;var bw=(1<<br)-1;bu[0]=bp[bv]>>br;for(var bt=bv+1;bt<bp.t;++bt){bu[bt-bv-1]|=(bp[bt]&bw)<<bq;bu[bt-bv]=bp[bt]>>br}if(br>0){bu[bp.t-bv-1]|=(bp.s&bw)<<bq}bu.t=bp.t-bv;bu.clamp()}function aO(bq,bt){var br=this;var bs=0,bu=0,bp=Math.min(bq.t,br.t);while(bs<bp){bu+=br[bs]-bq[bs];bt[bs++]=bu&br.DM;bu>>=br.DB}if(bq.t<br.t){bu-=bq.s;while(bs<br.t){bu+=br[bs];bt[bs++]=bu&br.DM;bu>>=br.DB}bu+=br.s}else{bu+=br.s;while(bs<bq.t){bu-=bq[bs];bt[bs++]=bu&br.DM;bu>>=br.DB}bu-=bq.s}bt.s=(bu<0)?-1:0;if(bu<-1){bt[bs++]=br.DV+bu}else{if(bu>0){bt[bs++]=bu}}bt.t=bs;bt.clamp()}function ac(bq,bs){var bp=this.abs(),bt=bq.abs();var br=bp.t;bs.t=br+bt.t;while(--br>=0){bs[br]=0}for(br=0;br<bt.t;++br){bs[br+bp.t]=bp.am(0,bt[br],bs,br,0,bp.t)}bs.s=0;bs.clamp();if(this.s!=bq.s){a8.ZERO.subTo(bs,bs)}}function at(br){var bp=this.abs();var bq=br.t=2*bp.t;while(--bq>=0){br[bq]=0}for(bq=0;bq<bp.t-1;++bq){var bs=bp.am(bq,bp[bq],br,2*bq,0,1);if((br[bq+bp.t]+=bp.am(bq+1,2*bp[bq],br,2*bq+1,bs,bp.t-bq-1))>=bp.DV){br[bq+bp.t]-=bp.DV;br[bq+bp.t+1]=1}}if(br.t>0){br[br.t-1]+=bp.am(bq,bp[bq],br,2*bq,0,1)}br.s=0;br.clamp()}function ad(bz,bw,bu){var bv=this;var bF=bz.abs();if(bF.t<=0){return}var bx=bv.abs();if(bx.t<bF.t){if(bw!=null){bw.fromInt(0)}if(bu!=null){bv.copyTo(bu)}return}if(bu==null){bu=y()}var bs=y(),bp=bv.s,by=bz.s;var bE=bv.DB-D(bF[bF.t-1]);if(bE>0){bF.lShiftTo(bE,bs);bx.lShiftTo(bE,bu)}else{bF.copyTo(bs);bx.copyTo(bu)}var bC=bs.t;var bq=bs[bC-1];if(bq==0){return}var bA=bq*(1<<bv.F1)+((bC>1)?bs[bC-2]>>bv.F2:0);var bI=bv.FV/bA,bH=(1<<bv.F1)/bA,bG=1<<bv.F2;var bD=bu.t,bB=bD-bC,bt=(bw==null)?y():bw;bs.dlShiftTo(bB,bt);if(bu.compareTo(bt)>=0){bu[bu.t++]=1;bu.subTo(bt,bu)}a8.ONE.dlShiftTo(bC,bt);bt.subTo(bs,bs);while(bs.t<bC){bs[bs.t++]=0}while(--bB>=0){var br=(bu[--bD]==bq)?bv.DM:Math.floor(bu[bD]*bI+(bu[bD-1]+bG)*bH);if((bu[bD]+=bs.am(0,br,bu,bB,0,bC))<br){bs.dlShiftTo(bB,bt);bu.subTo(bt,bu);while(bu[bD]<--br){bu.subTo(bt,bu)}}}if(bw!=null){bu.drShiftTo(bC,bw);if(bp!=by){a8.ZERO.subTo(bw,bw)}}bu.t=bC;bu.clamp();if(bE>0){bu.rShiftTo(bE,bu)}if(bp<0){a8.ZERO.subTo(bu,bu)}}function ap(bp){var bq=y();this.abs().divRemTo(bp,null,bq);if(this.s<0&&bq.compareTo(a8.ZERO)>0){bp.subTo(bq,bq)}return bq}function al(bp){this.m=bp}function aG(bp){if(bp.s<0||bp.compareTo(this.m)>=0){return bp.mod(this.m)}else{return bp}}function a1(bp){return bp}function aj(bp){bp.divRemTo(this.m,null,bp)}function ai(bp,br,bq){bp.multiplyTo(br,bq);this.reduce(bq)}function bd(bp,bq){bp.squareTo(bq);this.reduce(bq)}al.prototype.convert=aG;al.prototype.revert=a1;al.prototype.reduce=aj;al.prototype.mulTo=ai;al.prototype.sqrTo=bd;function Z(){if(this.t<1){return 0}var bp=this[0];if((bp&1)==0){return 0}var bq=bp&3;bq=(bq*(2-(bp&15)*bq))&15;bq=(bq*(2-(bp&255)*bq))&255;bq=(bq*(2-(((bp&65535)*bq)&65535)))&65535;bq=(bq*(2-bp*bq%this.DV))%this.DV;return(bq>0)?this.DV-bq:-bq}function u(bp){this.m=bp;this.mp=bp.invDigit();this.mpl=this.mp&32767;this.mph=this.mp>>15;this.um=(1<<(bp.DB-15))-1;this.mt2=2*bp.t}function a0(bp){var bq=y();bp.abs().dlShiftTo(this.m.t,bq);bq.divRemTo(this.m,null,bq);if(bp.s<0&&bq.compareTo(a8.ZERO)>0){this.m.subTo(bq,bq)}return bq}function bb(bp){var bq=y();bp.copyTo(bq);this.reduce(bq);return bq}function ar(bp){while(bp.t<=this.mt2){bp[bp.t++]=0}for(var br=0;br<this.m.t;++br){var bq=bp[br]&32767;var bs=(bq*this.mpl+(((bq*this.mph+(bp[br]>>15)*this.mpl)&this.um)<<15))&bp.DM;bq=br+this.m.t;bp[bq]+=this.m.am(0,bs,bp,br,0,this.m.t);while(bp[bq]>=bp.DV){bp[bq]-=bp.DV;bp[++bq]++}}bp.clamp();bp.drShiftTo(this.m.t,bp);if(bp.compareTo(this.m)>=0){bp.subTo(this.m,bp)}}function a3(bp,bq){bp.squareTo(bq);this.reduce(bq)}function W(bp,br,bq){bp.multiplyTo(br,bq);this.reduce(bq)}u.prototype.convert=a0;u.prototype.revert=bb;u.prototype.reduce=ar;u.prototype.mulTo=W;u.prototype.sqrTo=a3;function z(){return((this.t>0)?(this[0]&1):this.s)==0}function R(bu,bv){if(bu>4294967295||bu<1){return a8.ONE}var bt=y(),bp=y(),bs=bv.convert(this),br=D(bu)-1;bs.copyTo(bt);while(--br>=0){bv.sqrTo(bt,bp);if((bu&(1<<br))>0){bv.mulTo(bp,bs,bt)}else{var bq=bt;bt=bp;bp=bq}}return bv.revert(bt)}function a5(bq,bp){var br;if(bq<256||bp.isEven()){br=new al(bp)}else{br=new u(bp)}return this.exp(bq,br)}bi.copyTo=aL;bi.fromInt=H;bi.fromString=Q;bi.clamp=aq;bi.dlShiftTo=a7;bi.drShiftTo=aK;bi.lShiftTo=L;bi.rShiftTo=E;bi.subTo=aO;bi.multiplyTo=ac;bi.squareTo=at;bi.divRemTo=ad;bi.invDigit=Z;bi.isEven=z;bi.exp=R;bi.toString=J;bi.negate=av;bi.abs=a2;bi.compareTo=ah;bi.bitLength=M;bi.mod=ap;bi.modPowInt=a5;function y(){return new a8(null)}function w(){var bp=y();this.copyTo(bp);return bp}function af(){if(this.s<0){if(this.t==1){return this[0]-this.DV}else{if(this.t==0){return -1}}}else{if(this.t==1){return this[0]}else{if(this.t==0){return 0}}}return((this[1]&((1<<(32-this.DB))-1))<<this.DB)|this[0]}function aW(){return(this.t==0)?this.s:(this[0]<<24)>>24}function au(){return(this.t==0)?this.s:(this[0]<<16)>>16}function aJ(bp){return Math.floor(Math.LN2*this.DB/Math.log(bp))}function a9(){if(this.s<0){return -1}else{if(this.t<=0||(this.t==1&&this[0]<=0)){return 0}else{return 1}}}function U(bp){if(bp==null){bp=10}if(this.signum()==0||bp<2||bp>36){return"0"}var br=this.chunkSize(bp);var bq=Math.pow(bp,br);var bu=q(bq),bv=y(),bt=y(),bs="";this.divRemTo(bu,bv,bt);while(bv.signum()>0){bs=(bq+bt.intValue()).toString(bp).substr(1)+bs;bv.divRemTo(bu,bv,bt)}return bt.intValue().toString(bp)+bs}function aA(by,bu){var bx=this;bx.fromInt(0);if(bu==null){bu=10}var bs=bx.chunkSize(bu);var bt=Math.pow(bu,bs),br=false,bp=0,bw=0;for(var bq=0;bq<by.length;++bq){var bv=X(by,bq);if(bv<0){if(by.charAt(bq)=="-"&&bx.signum()==0){br=true}continue}bw=bu*bw+bv;if(++bp>=bs){bx.dMultiply(bt);bx.dAddOffset(bw,0);bp=0;bw=0}}if(bp>0){bx.dMultiply(Math.pow(bu,bp));bx.dAddOffset(bw,0)}if(br){a8.ZERO.subTo(bx,bx)}}function aT(br,bq,bu){var bs=this;if("number"==typeof bq){if(br<2){bs.fromInt(1)}else{bs.fromNumber(br,bu);if(!bs.testBit(br-1)){bs.bitwiseTo(a8.ONE.shiftLeft(br-1),am,bs)}if(bs.isEven()){bs.dAddOffset(1,0)}while(!bs.isProbablePrime(bq)){bs.dAddOffset(2,0);if(bs.bitLength()>br){bs.subTo(a8.ONE.shiftLeft(br-1),bs)}}}}else{var bp=new Array(),bt=br&7;bp.length=(br>>3)+1;bq.nextBytes(bp);if(bt>0){bp[0]&=((1<<bt)-1)}else{bp[0]=0}bs.fromString(bp,256)}}function bh(){var bq=this;var br=bq.t,bs=new Array();bs[0]=bq.s;var bt=bq.DB-(br*bq.DB)%8,bu,bp=0;if(br-->0){if(bt<bq.DB&&(bu=bq[br]>>bt)!=(bq.s&bq.DM)>>bt){bs[bp++]=bu|(bq.s<<(bq.DB-bt))}while(br>=0){if(bt<8){bu=(bq[br]&((1<<bt)-1))<<(8-bt);bu|=bq[--br]>>(bt+=bq.DB-8)}else{bu=(bq[br]>>(bt-=8))&255;if(bt<=0){bt+=bq.DB;--br}}if((bu&128)!=0){bu|=-256}if(bp===0&&(bq.s&128)!=(bu&128)){++bp}if(bp>0||bu!=bq.s){bs[bp++]=bu}}}return bs}function ay(bp){return(this.compareTo(bp)==0)}function ag(bp){return(this.compareTo(bp)<0)?this:bp}function aE(bp){return(this.compareTo(bp)>0)?this:bp}function aU(bq,bv,bt){var br=this;var bs,bu,bp=Math.min(bq.t,br.t);for(bs=0;bs<bp;++bs){bt[bs]=bv(br[bs],bq[bs])}if(bq.t<br.t){bu=bq.s&br.DM;for(bs=bp;bs<br.t;++bs){bt[bs]=bv(br[bs],bu)}bt.t=br.t}else{bu=br.s&br.DM;for(bs=bp;bs<bq.t;++bs){bt[bs]=bv(bu,bq[bs])}bt.t=bq.t}bt.s=bv(br.s,bq.s);bt.clamp()}function V(bp,bq){return bp&bq}function bk(bp){var bq=y();this.bitwiseTo(bp,V,bq);return bq}function am(bp,bq){return bp|bq}function aI(bp){var bq=y();this.bitwiseTo(bp,am,bq);return bq}function aa(bp,bq){return bp^bq}function s(bp){var bq=y();this.bitwiseTo(bp,aa,bq);return bq}function O(bp,bq){return bp&~bq}function F(bp){var bq=y();this.bitwiseTo(bp,O,bq);return bq}function ab(){var bq=y();for(var bp=0;bp<this.t;++bp){bq[bp]=this.DM&~this[bp]}bq.t=this.t;bq.s=~this.s;return bq}function P(bq){var bp=y();if(bq<0){this.rShiftTo(-bq,bp)}else{this.lShiftTo(bq,bp)}return bp}function bj(bq){var bp=y();if(bq<0){this.lShiftTo(-bq,bp)}else{this.rShiftTo(bq,bp)}return bp}function B(bp){if(bp==0){return -1}var bq=0;if((bp&65535)==0){bp>>=16;bq+=16}if((bp&255)==0){bp>>=8;bq+=8}if((bp&15)==0){bp>>=4;bq+=4}if((bp&3)==0){bp>>=2;bq+=2}if((bp&1)==0){++bq}return bq}function I(){for(var bp=0;bp<this.t;++bp){if(this[bp]!=0){return bp*this.DB+B(this[bp])}}if(this.s<0){return this.t*this.DB}return -1}function a4(bp){var bq=0;while(bp!=0){bp&=bp-1;++bq}return bq}function aS(){var br=0,bp=this.s&this.DM;for(var bq=0;bq<this.t;++bq){br+=a4(this[bq]^bp)}return br}function aQ(bq){var bp=Math.floor(bq/this.DB);if(bp>=this.t){return(this.s!=0)}return((this[bp]&(1<<(bq%this.DB)))!=0)}function ae(br,bq){var bp=a8.ONE.shiftLeft(br);this.bitwiseTo(bp,bq,bp);return bp}function Y(bp){return this.changeBit(bp,am)}function G(bp){return this.changeBit(bp,O)}function p(bp){return this.changeBit(bp,aa)}function aB(bq,bt){var br=this;var bs=0,bu=0,bp=Math.min(bq.t,br.t);while(bs<bp){bu+=br[bs]+bq[bs];bt[bs++]=bu&br.DM;bu>>=br.DB}if(bq.t<br.t){bu+=bq.s;while(bs<br.t){bu+=br[bs];bt[bs++]=bu&br.DM;bu>>=br.DB}bu+=br.s}else{bu+=br.s;while(bs<bq.t){bu+=bq[bs];bt[bs++]=bu&br.DM;bu>>=br.DB}bu+=bq.s}bt.s=(bu<0)?-1:0;if(bu>0){bt[bs++]=bu}else{if(bu<-1){bt[bs++]=br.DV+bu}}bt.t=bs;bt.clamp()}function aD(bp){var bq=y();this.addTo(bp,bq);return bq}function ba(bp){var bq=y();this.subTo(bp,bq);return bq}function ax(bp){var bq=y();this.multiplyTo(bp,bq);return bq}function aP(){var bp=y();this.squareTo(bp);return bp}function r(bp){var bq=y();this.divRemTo(bp,bq,null);return bq}function v(bp){var bq=y();this.divRemTo(bp,null,bq);return bq}function aR(bp){var br=y(),bq=y();this.divRemTo(bp,br,bq);return new Array(br,bq)}function A(bp){this[this.t]=this.am(0,bp-1,this,0,0,this.t);++this.t;this.clamp()}function ao(bq,bp){if(bq==0){return}while(this.t<=bp){this[this.t++]=0}this[bp]+=bq;while(this[bp]>=this.DV){this[bp]-=this.DV;if(++bp>=this.t){this[this.t++]=0}++this[bp]}}function aC(){}function aX(bp){return bp}function C(bp,br,bq){bp.multiplyTo(br,bq)}function aH(bp,bq){bp.squareTo(bq)}aC.prototype.convert=aX;aC.prototype.revert=aX;aC.prototype.mulTo=C;aC.prototype.sqrTo=aH;function S(bp){return this.exp(bp,new aC())}function x(bp,bt,bs){var br=Math.min(this.t+bp.t,bt);bs.s=0;bs.t=br;while(br>0){bs[--br]=0}var bq;for(bq=bs.t-this.t;br<bq;++br){bs[br+this.t]=this.am(0,bp[br],bs,br,0,this.t)}for(bq=Math.min(bp.t,bt);br<bq;++br){this.am(0,bp[br],bs,br,0,bt-br)}bs.clamp()}function t(bp,bs,br){--bs;var bq=br.t=this.t+bp.t-bs;br.s=0;while(--bq>=0){br[bq]=0}for(bq=Math.max(bs-this.t,0);bq<bp.t;++bq){br[this.t+bq-bs]=this.am(bs-bq,bp[bq],br,0,0,this.t+bq-bs)}br.clamp();br.drShiftTo(1,br)}function T(bp){this.r2=y();this.q3=y();a8.ONE.dlShiftTo(2*bp.t,this.r2);this.mu=this.r2.divide(bp);this.m=bp}function ak(bp){if(bp.s<0||bp.t>2*this.m.t){return bp.mod(this.m)}else{if(bp.compareTo(this.m)<0){return bp}else{var bq=y();bp.copyTo(bq);this.reduce(bq);return bq}}}function an(bp){return bp}function be(bp){var bq=this;bp.drShiftTo(bq.m.t-1,bq.r2);if(bp.t>bq.m.t+1){bp.t=bq.m.t+1;bp.clamp()}bq.mu.multiplyUpperTo(bq.r2,bq.m.t+1,bq.q3);bq.m.multiplyLowerTo(bq.q3,bq.m.t+1,bq.r2);while(bp.compareTo(bq.r2)<0){bp.dAddOffset(1,bq.m.t+1)}bp.subTo(bq.r2,bp);while(bp.compareTo(bq.m)>=0){bp.subTo(bq.m,bp)}}function az(bp,bq){bp.squareTo(bq);this.reduce(bq)}function bf(bp,br,bq){bp.multiplyTo(br,bq);this.reduce(bq)}T.prototype.convert=ak;T.prototype.revert=an;T.prototype.reduce=be;T.prototype.mulTo=bf;T.prototype.sqrTo=az;function aF(by,bt){var bw=by.bitLength(),bu,bq=q(1),bB;if(bw<=0){return bq}else{if(bw<18){bu=1}else{if(bw<48){bu=3}else{if(bw<144){bu=4}else{if(bw<768){bu=5}else{bu=6}}}}}if(bw<8){bB=new al(bt)}else{if(bt.isEven()){bB=new T(bt)}else{bB=new u(bt)}}var bx=new Array(),bs=3,bz=bu-1,bp=(1<<bu)-1;bx[1]=bB.convert(this);if(bu>1){var bE=y();bB.sqrTo(bx[1],bE);while(bs<=bp){bx[bs]=y();bB.mulTo(bE,bx[bs-2],bx[bs]);bs+=2}}var bv=by.t-1,bC,bA=true,br=y(),bD;bw=D(by[bv])-1;while(bv>=0){if(bw>=bz){bC=(by[bv]>>(bw-bz))&bp}else{bC=(by[bv]&((1<<(bw+1))-1))<<(bz-bw);if(bv>0){bC|=by[bv-1]>>(this.DB+bw-bz)}}bs=bu;while((bC&1)==0){bC>>=1;--bs}if((bw-=bs)<0){bw+=this.DB;--bv}if(bA){bx[bC].copyTo(bq);bA=false}else{while(bs>1){bB.sqrTo(bq,br);bB.sqrTo(br,bq);bs-=2}if(bs>0){bB.sqrTo(bq,br)}else{bD=bq;bq=br;br=bD}bB.mulTo(br,bx[bC],bq)}while(bv>=0&&(by[bv]&(1<<bw))==0){bB.sqrTo(bq,br);bD=bq;bq=br;br=bD;if(--bw<0){bw=this.DB-1;--bv}}}return bB.revert(bq)}function bc(bq){var bp=(this.s<0)?this.negate():this.clone();var bu=(bq.s<0)?bq.negate():bq.clone();if(bp.compareTo(bu)<0){var bs=bp;bp=bu;bu=bs}var br=bp.getLowestSetBit(),bt=bu.getLowestSetBit();if(bt<0){return bp}if(br<bt){bt=br}if(bt>0){bp.rShiftTo(bt,bp);bu.rShiftTo(bt,bu)}while(bp.signum()>0){if((br=bp.getLowestSetBit())>0){bp.rShiftTo(br,bp)}if((br=bu.getLowestSetBit())>0){bu.rShiftTo(br,bu)}if(bp.compareTo(bu)>=0){bp.subTo(bu,bp);bp.rShiftTo(1,bp)}else{bu.subTo(bp,bu);bu.rShiftTo(1,bu)}}if(bt>0){bu.lShiftTo(bt,bu)}return bu}function K(bs){if(bs<=0){return 0}var br=this.DV%bs,bq=(this.s<0)?bs-1:0;if(this.t>0){if(br==0){bq=this[0]%bs}else{for(var bp=this.t-1;bp>=0;--bp){bq=(br*bq+this[bp])%bs}}}return bq}function o(bq){var bu=bq.isEven();if((this.isEven()&&bu)||bq.signum()==0){return a8.ZERO}var bt=bq.clone(),bs=this.clone();var br=q(1),bp=q(0),bw=q(0),bv=q(1);while(bt.signum()!=0){while(bt.isEven()){bt.rShiftTo(1,bt);if(bu){if(!br.isEven()||!bp.isEven()){br.addTo(this,br);bp.subTo(bq,bp)}br.rShiftTo(1,br)}else{if(!bp.isEven()){bp.subTo(bq,bp)}}bp.rShiftTo(1,bp)}while(bs.isEven()){bs.rShiftTo(1,bs);if(bu){if(!bw.isEven()||!bv.isEven()){bw.addTo(this,bw);bv.subTo(bq,bv)}bw.rShiftTo(1,bw)}else{if(!bv.isEven()){bv.subTo(bq,bv)}}bv.rShiftTo(1,bv)}if(bt.compareTo(bs)>=0){bt.subTo(bs,bt);if(bu){br.subTo(bw,br)}bp.subTo(bv,bp)}else{bs.subTo(bt,bs);if(bu){bw.subTo(br,bw)}bv.subTo(bp,bv)}}if(bs.compareTo(a8.ONE)!=0){return a8.ZERO}if(bv.compareTo(bq)>=0){return bv.subtract(bq)}if(bv.signum()<0){bv.addTo(bq,bv)}else{return bv}if(bv.signum()<0){return bv.add(bq)}else{return bv}}bi.chunkSize=aJ;bi.toRadix=U;bi.fromRadix=aA;bi.fromNumber=aT;bi.bitwiseTo=aU;bi.changeBit=ae;bi.addTo=aB;bi.dMultiply=A;bi.dAddOffset=ao;bi.multiplyLowerTo=x;bi.multiplyUpperTo=t;bi.modInt=K;bi.clone=w;bi.intValue=af;bi.byteValue=aW;bi.shortValue=au;bi.signum=a9;bi.toByteArray=bh;bi.equals=ay;bi.min=ag;bi.max=aE;bi.and=bk;bi.or=aI;bi.xor=s;bi.andNot=F;bi.not=ab;bi.shiftLeft=P;bi.shiftRight=bj;bi.getLowestSetBit=I;bi.bitCount=aS;bi.testBit=aQ;bi.setBit=Y;bi.clearBit=G;bi.flipBit=p;bi.add=aD;bi.subtract=ba;bi.multiply=ax;bi.divide=r;bi.remainder=v;bi.divideAndRemainder=aR;bi.modPow=aF;bi.modInverse=o;bi.pow=S;bi.gcd=bc;bi.square=aP;a8.ZERO=q(0);a8.ONE=q(1);a8.valueOf=q;a8.fromByteArrayUnsigned=function(bp){if(!bp.length){return new a8.valueOf(0)}else{if(bp[0]&128){return new a8([0].concat(bp))}else{return new a8(bp)}}};a8.fromByteArraySigned=function(bp){if(bp[0]&128){bp[0]&=127;return a8.fromByteArrayUnsigned(bp).negate()}else{return a8.fromByteArrayUnsigned(bp)}};a8.prototype.toByteArrayUnsigned=function(){var bq=this.abs().toByteArray();if(!bq.length){return bq}if(bq[0]===0){bq=bq.slice(1)}for(var bp=0;bp<bq.length;++bp){bq[bp]=(bq[bp]<0)?bq[bp]+256:bq[bp]}return bq};a8.prototype.toByteArraySigned=function(){var bp=this.toByteArrayUnsigned();var bq=this.s<0;if(bp[0]&128){bp.unshift((bq)?128:0)}else{if(bq){bp[0]|=128}}return bp};bg.set("cipher.asymmetric.ec.bigi",a8)})(c);(function(o){function n(t,s){var p=t.ECPointFp;function q(A,w,z,v){var u=Math.max(w.bitLength(),v.bitLength());var B=A.add2D(z);var y=A.curve.getInfinity();for(var x=u-1;x>=0;--x){y=y.twice2D();y.z=s.ONE;if(w.testBit(x)){if(v.testBit(x)){y=y.add2D(B)}else{y=y.add2D(A)}}else{if(v.testBit(x)){y=y.add2D(z)}}}return y}function r(B){var D=this;var C=null;var A=new o.get("util.srand")();var u={nextBytes:function(E){var G=A.bytes(E.length);for(var F=0;F<G.length;++F){E[F]=G[F]}}};this.sign=function(I,N){var L=N;var F=B.getN();var K=s.fromByteArrayUnsigned(I);var H=y(F);var M=B.getG();var J=M.multiply(H);var E=J.getX().toBigInteger().mod(F);var O=H.modInverse(F).multiply(K.add(L.multiply(E))).mod(F);if(O.compareTo(F.divide(s.valueOf(2)))>0){O=F.subtract(O)}return v(E,O)};this.verify=function(K,L,F){var H,E;if(Array.isArray(L)){var J=x(L);H=J.r;E=J.s}else{throw new Error("Invalid value for signature")}var G;if(F instanceof p){G=F}else{if(Array.isArray(F)){G=p.decodeFrom(B.getCurve(),F)}else{throw new Error("Invalid format for pubkey value, must be byte array or ECPointFp")}}var I=s.fromByteArrayUnsigned(K);return z(I,H,E,G)};function z(K,E,P,J){var I=B.getN();var O=B.getG();if(E.compareTo(s.ONE)<0||E.compareTo(I)>=0){return false}if(P.compareTo(s.ONE)<0||P.compareTo(I)>=0){return false}var L=P.modInverse(I);var H=K.multiply(L).mod(I);var F=E.multiply(L).mod(I);var M=O.multiply(H).add(J.multiply(F));var N=M.getX().toBigInteger().mod(I);return N.equals(E)}function w(H){if(H.length!==65){throw new Error("Signature has the wrong length")}var E=H[0]-27;if(E<0||E>7){throw new Error("Invalid signature type")}var I=B.getN();var G=s.fromByteArrayUnsigned(H.slice(1,33)).mod(I);var F=s.fromByteArrayUnsigned(H.slice(33,65)).mod(I);return{r:G,s:F,i:E}}function y(E){return new s(E.bitLength(),u).mod(E.subtract(s.ONE)).add(s.ONE)}function v(G,F){var H=G.toByteArraySigned();var E=F.toByteArraySigned();var I=[];I.push(2);I.push(H.length);I=I.concat(H);I.push(2);I.push(E.length);I=I.concat(E);I.unshift(I.length);I.unshift(48);return I}function x(J){var I;if(J[0]!=48){throw new Error("Signature not a valid DERSequence")}I=2;if(J[I]!=2){throw new Error("First element in signature must be a DERInteger")}var H=J.slice(I+2,I+2+J[I+1]);I+=2+J[I+1];if(J[I]!=2){throw new Error("Second element in signature must be a DERInteger")}var E=J.slice(I+2,I+2+J[I+1]);I+=2+J[I+1];var G=s.fromByteArrayUnsigned(H);var F=s.fromByteArrayUnsigned(E);return{r:G,s:F}}return this}return r}o.set("cipher.asymmetric.ec.ecdsa",function(r){var q=n(o.get("cipher.asymmetric.ec.ecurve"),o.get("cipher.asymmetric.ec.bigi"));return new q(r)})})(c);(function(n){function o(v){var z=this;var u=n.get("cipher.asymmetric.ec.ecparams"),r=n.get("cipher.asymmetric.ec.ecdsa"),w=n.get("cipher.asymmetric.ec.ecurve"),t=n.get("cipher.asymmetric.ec.bigi");var G=null,F=null;var H=u(v);if(!H){throw Error("unknown-ec-curve-name")}var y=r(H);function C(K){var L=new Array(K.length);for(var J=0;J<L.length;J++){L[J]=K[J]}return L}this.setPrivateKey=function(J){E(n.get("util.encoding")(J).toArray())};this.setPublicKey=function(J){B(n.get("util.encoding")(J).toArray())};function D(J){if(J){z.sign=I;z.decrypt=s;z._computeSecret=x}z.verify=q;z.encrypt=A;z.getPublicKey=function(){return new Uint8Array(F).buffer};delete z.setPrivateKey;delete z.setPublicKey}function B(J){G=null;F=J;D(false)}function E(K){G=t.fromByteArrayUnsigned(K);var J=H.getG().multiply(G);F=J.getEncoded(false);D(true)}function I(K){if(!n.get("util.type")(K).isArrayBuffer()){throw new Error("invalid-parameter")}var J=y.sign(n.get("util.encoding")(K).toArray(),G);return n.get("util.encoding")(J).toArrayBuffer()}function q(K,M){if(!(n.get("util.type")(K).isArrayBuffer()&&n.get("util.type")(M).isArrayBuffer())){throw new Error("invalid-parameter")}try{var N=n.get("util.encoding")(M).toArray(),O=n.get("util.encoding")(K).toArray();var J=y.verify(O,N,F)}catch(L){console.log(L);return false}return J}function x(K){if(!n.get("util.type")(K).isArrayBuffer()){throw Error("invalid-parameter")}var J=n.get("util.encoding")(K).toArray();var M=w.ECPointFp.decodeFrom(H.getCurve(),J);var L=M.multiply(G);var N=L.getEncoded().slice(1);return n.get("util.encoding")(N).toArrayBuffer()}function A(M){if(!n.get("util.type")(M).isArrayBuffer()){throw new Error("invalid-parameter")}var L=new o(v);L.setPrivateKey(new n.get("util.srand")().bytes(64));var P=L._computeSecret(z.getPublicKey()),O=L.getPublicKey();var J=new n.get("cipher.symmetric")().key(P),N=J.encrypt(M);var K=new Uint16Array([O.byteLength]);return n.get("util.buffer").concat([K.buffer,O,N])}function s(N){if(!(n.get("util.type")(N).isArrayBuffer()&&N.byteLength>2)){throw new Error("invalid-parameter")}var J=N.slice(0,2),N=N.slice(2);var L=new Uint16Array(J)[0];if(N.length<=L){throw new Error("invalid-ciphertext")}var Q=N.slice(0,L),O=N.slice(L);var P=x(Q);var M=new n.get("cipher.symmetric")().key(P);var K=M.decrypt(O);return K}return this}var p={name:"EC",constructor:function(q){return new o(q.curve)}};n.set("cipher.asymmetric.ec",p)})(c);(function(v){var p,n;"use strict";function x(A,z,B,y){this.curve=A;this.g=z;this.n=B;this.h=y}x.prototype.getCurve=function w(){return this.curve};x.prototype.getG=function u(){return this.g};x.prototype.getN=function q(){return this.n};x.prototype.getH=function s(){return this.h};function t(y){y=y.replace(/[^0-9a-f]/ig,"").toUpperCase();return new p(y,16)}var r={secp128r1:function(){var C=t("FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFF");var z=t("FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFC");var y=t("E87579C11079F43DD824993C2CEE5ED3");var E=t("FFFFFFFE0000000075A30D1B9038A115");var B=p.ONE;var D=new n(C,z,y);var A=D.decodePointHex("04161FF7528B899B2D0C28607CA52C5B86CF5AC8395BAFEB13C02DA292DDED7A83");return new x(D,A,E,B)},secp160k1:function(){var C=t("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFAC73");var z=p.ZERO;var y=t("7");var E=t("0100000000000000000001B8FA16DFAB9ACA16B6B3");var B=p.ONE;var D=new n(C,z,y);var A=D.decodePointHex("043B4C382CE37AA192A4019E763036F4F5DD4D7EBB938CF935318FDCED6BC28286531733C3F03C4FEE");return new x(D,A,E,B)},secp160r1:function(){var C=t("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFF");var z=t("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFC");var y=t("1C97BEFC54BD7A8B65ACF89F81D4D4ADC565FA45");var E=t("0100000000000000000001F4C8F927AED3CA752257");var B=p.ONE;var D=new n(C,z,y);var A=D.decodePointHex("044A96B5688EF573284664698968C38BB913CBFC8223A628553168947D59DCC912042351377AC5FB32");return new x(D,A,E,B)},secp192k1:function(){var C=t("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFEE37");var z=p.ZERO;var y=t("3");var E=t("FFFFFFFFFFFFFFFFFFFFFFFE26F2FC170F69466A74DEFD8D");var B=p.ONE;var D=new n(C,z,y);var A=D.decodePointHex("04DB4FF10EC057E9AE26B07D0280B7F4341DA5D1B1EAE06C7D9B2F2F6D9C5628A7844163D015BE86344082AA88D95E2F9D");return new x(D,A,E,B)},secp192r1:function(){var C=t("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFF");var z=t("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFC");var y=t("64210519E59C80E70FA7E9AB72243049FEB8DEECC146B9B1");var E=t("FFFFFFFFFFFFFFFFFFFFFFFF99DEF836146BC9B1B4D22831");var B=p.ONE;var D=new n(C,z,y);var A=D.decodePointHex("04188DA80EB03090F67CBF20EB43A18800F4FF0AFD82FF101207192B95FFC8DA78631011ED6B24CDD573F977A11E794811");return new x(D,A,E,B)},secp224r1:function(){var C=t("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF000000000000000000000001");var z=t("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFE");var y=t("B4050A850C04B3ABF54132565044B0B7D7BFD8BA270B39432355FFB4");var E=t("FFFFFFFFFFFFFFFFFFFFFFFFFFFF16A2E0B8F03E13DD29455C5C2A3D");var B=p.ONE;var D=new n(C,z,y);var A=D.decodePointHex("04B70E0CBD6BB4BF7F321390B94A03C1D356C21122343280D6115C1D21BD376388B5F723FB4C22DFE6CD4375A05A07476444D5819985007E34");return new x(D,A,E,B)},secp256k1:function(){var C=t("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F");var z=p.ZERO;var y=t("7");var E=t("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141");var B=p.ONE;var D=new n(C,z,y);var A=D.decodePointHex("0479BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8");return new x(D,A,E,B)},secp256r1:function(){var C=t("FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF");var z=t("FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC");var y=t("5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B");var E=t("FFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551");var B=p.ONE;var D=new n(C,z,y);var A=D.decodePointHex("046B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C2964FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5");return new x(D,A,E,B)},secp384r1:function(){var C=t("FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFe FFFFFFFF 00000000 00000000 FFFFFFFF");var z=t("FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFe FFFFFFFF 00000000 00000000 FFFFFFFC");var y=t("B3312FA7 E23EE7E4 988E056B E3F82D19 181D9C6E FE814112 0314088F 5013875A C656398D 8A2ED19D 2A85C8ED D3EC2AEF");var E=t("FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF C7634D81 F4372DDF 581A0DB2 48B0A77A ECEC196A CCC52973");var B=p.ONE;var D=new n(C,z,y);var A=D.decodePointHex("04AA87CA22 BE8B0537 8EB1C71E F320AD74 6E1D3B62 8BA79B98 59F741E0 82542A38 5502F25D BF55296C 3A545E38 72760AB73617DE4A 96262C6F 5D9E98BF 9292DC29 F8F41DBD 289A147C E9DA3113 B5F0B8C0 0A60B1CE 1D7E819D 7A431D7C 90EA0E5F");return new x(D,A,E,B)},secp521r1:function(){var C=t("    01FF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFF FFFFFFFF");var z=t("    01FF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFF FFFFFFFC");var y=t("    0051 953EB961 8E1C9A1F 929A21A0 B68540EE A2DA725B 99B315F3B8B48991 8EF109E1 56193951 EC7E937B 1652C0BD 3BB1BF07 3573DF883D2C34F1 EF451FD4 6B503F00");var E=t("    01FF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFA 51868783 BF2F966B 7FCC0148 F709A5D0 3BB5C9B8899C47AE BB6FB71E 91386409");var B=p.ONE;var D=new n(C,z,y);var A=D.decodePointHex("      04 00C6858E 06B70404 E9CD9E3E CB662395 B4429C64 8139053FB521F828 AF606B4D 3DBAA14B 5E77EFE7 5928FE1D C127A2FF A8DE3348B3C1856A 429BF97E 7E31C2E5 BD660118 39296A78 9A3BC004 5C8A5FB42C7D1BD9 98F54449 579B4468 17AFBD17 273E662C 97EE7299 5EF42640C550B901 3FAD0761 353C7086 A272C240 88BE9476 9FD16650");return new x(D,A,E,B)}};v.set("cipher.asymmetric.ec.ecparams",function o(y){if(!p){p=v.get("cipher.asymmetric.ec.bigi"),n=v.get("cipher.asymmetric.ec.ecurve")}return(typeof r[y]=="function")?r[y]():null})})(c);"use strict";(function(n){var t;function r(w,u){var v=w.toByteArrayUnsigned();if(u<v.length){v=v.slice(v.length-u)}else{while(u>v.length){v.unshift(0)}}return v}var q=function q(v,u){this.x=u;this.q=v};q.prototype.equals=function(u){if(u==this){return true}return(this.q.equals(u.q)&&this.x.equals(u.x))};q.prototype.toBigInteger=function(){return this.x};q.prototype.negate=function(){return new q(this.q,this.x.negate().mod(this.q))};q.prototype.add=function(u){return new q(this.q,this.x.add(u.toBigInteger()).mod(this.q))};q.prototype.subtract=function(u){return new q(this.q,this.x.subtract(u.toBigInteger()).mod(this.q))};q.prototype.multiply=function(u){return new q(this.q,this.x.multiply(u.toBigInteger()).mod(this.q))};q.prototype.square=function(){return new q(this.q,this.x.square().mod(this.q))};q.prototype.divide=function o(u){return new q(this.q,this.x.multiply(u.toBigInteger().modInverse(this.q)).mod(this.q))};q.prototype.getByteLength=function(){return Math.floor((this.toBigInteger().bitLength()+7)/8)};var p=function p(w,u,A,v){if(!t){t=n.get("cipher.asymmetric.ec.bigi")}this.curve=w;this.x=u;this.y=A;if(v==null){this.z=t.ONE}else{this.z=v}this.zinv=null};p.prototype.getX=function(){if(this.zinv==null){this.zinv=this.z.modInverse(this.curve.q)}return this.curve.fromBigInteger(this.x.toBigInteger().multiply(this.zinv).mod(this.curve.q))};p.prototype.getY=function(){if(this.zinv==null){this.zinv=this.z.modInverse(this.curve.q)}return this.curve.fromBigInteger(this.y.toBigInteger().multiply(this.zinv).mod(this.curve.q))};p.prototype.equals=function(w){if(w==this){return true}if(this.isInfinity()){return w.isInfinity()}if(w.isInfinity()){return this.isInfinity()}var y,x;y=w.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(w.z)).mod(this.curve.q);if(!y.equals(t.ZERO)){return false}x=w.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(w.z)).mod(this.curve.q);return x.equals(t.ZERO)};p.prototype.isInfinity=function(){if((this.x==null)&&(this.y==null)){return true}return this.z.equals(t.ZERO)&&!this.y.toBigInteger().equals(t.ZERO)};p.prototype.negate=function(){return new p(this.curve,this.x,this.y.negate(),this.z)};p.prototype.add=function(G){if(this.isInfinity()){return G}if(G.isInfinity()){return this}var K=G.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(G.z)).mod(this.curve.q);var J=G.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(G.z)).mod(this.curve.q);if(t.ZERO.equals(J)){if(t.ZERO.equals(K)){return this.twice()}return this.curve.getInfinity()}var E=new t("3");var z=this.x.toBigInteger();var I=this.y.toBigInteger();var x=G.x.toBigInteger();var F=G.y.toBigInteger();var H=J.square();var D=H.multiply(J);var y=z.multiply(H);var B=K.square().multiply(this.z);var w=B.subtract(y.shiftLeft(1)).multiply(G.z).subtract(D).multiply(J).mod(this.curve.q);var C=y.multiply(E).multiply(K).subtract(I.multiply(D)).subtract(B.multiply(K)).multiply(G.z).add(K.multiply(D)).mod(this.curve.q);var A=D.multiply(this.z).multiply(G.z).mod(this.curve.q);return new p(this.curve,this.curve.fromBigInteger(w),this.curve.fromBigInteger(C),A)};p.prototype.twice=function(){if(this.isInfinity()){return this}if(this.y.toBigInteger().signum()==0){return this.curve.getInfinity()}var A=new t("3");var v=this.x.toBigInteger();var B=this.y.toBigInteger();var y=B.multiply(this.z);var D=y.multiply(B).mod(this.curve.q);var C=this.curve.a.toBigInteger();var E=v.square().multiply(A);if(!t.ZERO.equals(C)){E=E.add(this.z.square().multiply(C))}E=E.mod(this.curve.q);var u=E.square().subtract(v.shiftLeft(3).multiply(D)).shiftLeft(1).multiply(y).mod(this.curve.q);var z=E.multiply(A).multiply(v).subtract(D.shiftLeft(1)).shiftLeft(2).multiply(D).subtract(E.square().multiply(E)).mod(this.curve.q);var x=y.square().multiply(y).shiftLeft(3).mod(this.curve.q);return new p(this.curve,this.curve.fromBigInteger(u),this.curve.fromBigInteger(z),x)};p.prototype.multiply=function(v){if(this.isInfinity()){return this}if(v.signum()==0){return this.curve.getInfinity()}var z=v;var y=z.multiply(new t("3"));var B=this.negate();var x=this;var w;for(w=y.bitLength()-2;w>0;--w){x=x.twice();var u=y.testBit(w);var A=z.testBit(w);if(u!=A){x=x.add(u?this:B)}}return x};p.prototype.multiplyTwo=function(w,u,v){var y;if(w.bitLength()>v.bitLength()){y=w.bitLength()-1}else{y=v.bitLength()-1}var A=this.curve.getInfinity();var z=this.add(u);while(y>=0){A=A.twice();if(w.testBit(y)){if(v.testBit(y)){A=A.add(z)}else{A=A.add(this)}}else{if(v.testBit(y)){A=A.add(u)}}--y}return A};p.prototype.getEncoded=function(z){if(this.isInfinity()){return[0]}var u=this.getX().toBigInteger();var A=this.getY().toBigInteger();var w=Math.floor((this.curve.getQ().bitLength()+7)/8);var v=r(u,w);if(z){if(A.isEven()){v.unshift(2)}else{v.unshift(3)}}else{v.unshift(4);v=v.concat(r(A,w))}return v};p.decodeFrom=function(C,w){var B=w[0];var A=w.length-1;var z=w.slice(1,1+A/2);var v=w.slice(1+A/2,1+A);z.unshift(0);v.unshift(0);var u=new t(z);var D=new t(v);return new p(C,C.fromBigInteger(u),C.fromBigInteger(D))};p.prototype.add2D=function(v){if(this.isInfinity()){return v}if(v.isInfinity()){return this}if(this.x.equals(v.x)){if(this.y.equals(v.y)){return this.twice()}return this.curve.getInfinity()}var z=v.x.subtract(this.x);var x=v.y.subtract(this.y);var u=x.divide(z);var w=u.square().subtract(this.x).subtract(v.x);var y=u.multiply(this.x.subtract(w)).subtract(this.y);return new p(this.curve,w,y)};p.prototype.twice2D=function(){if(this.isInfinity()){return this}if(this.y.toBigInteger().signum()==0){return this.curve.getInfinity()}var v=this.curve.fromBigInteger(t.valueOf(2));var y=this.curve.fromBigInteger(t.valueOf(3));var u=this.x.square().multiply(y).add(this.curve.a).divide(this.y.multiply(v));var w=u.square().subtract(this.x.multiply(v));var x=u.multiply(this.x.subtract(w)).subtract(this.y);return new p(this.curve,w,x)};p.prototype.multiply2D=function(v){if(this.isInfinity()){return this}if(v.signum()==0){return this.curve.getInfinity()}var z=v;var y=z.multiply(new t("3"));var B=this.negate();var x=this;var w;for(w=y.bitLength()-2;w>0;--w){x=x.twice();var u=y.testBit(w);var A=z.testBit(w);if(u!=A){x=x.add2D(u?this:B)}}return x};p.prototype.isOnCurve=function(){if(this.isInfinity()){return true}var v=this.getX().toBigInteger();var C=this.getY().toBigInteger();var z=this.curve.getA().toBigInteger();var u=this.curve.getB().toBigInteger();var B=this.curve.getQ();var w=C.multiply(C).mod(B);var A=v.multiply(v).multiply(v).add(z.multiply(v)).add(u).mod(B);return w.equals(A)};p.prototype.toString=function(){if(this.isInfinity()){return"(INFINITY)"}return"("+this.getX().toBigInteger().toString()+","+this.getY().toBigInteger().toString()+")"};p.prototype.validate=function(){var w=this.curve.getQ();if(this.isInfinity()){throw new Error("Point is at infinity.")}var u=this.getX().toBigInteger();var v=this.getY().toBigInteger();if(u.compareTo(t.ONE)<0||u.compareTo(w.subtract(t.ONE))>0){throw new Error("x coordinate out of bounds")}if(v.compareTo(t.ONE)<0||v.compareTo(w.subtract(t.ONE))>0){throw new Error("y coordinate out of bounds")}if(!this.isOnCurve()){throw new Error("Point is not on the curve.")}if(this.multiply(w).isInfinity()){throw new Error("Point is not a scalar multiple of G.")}return true};var s=function s(w,v,u){this.q=w;this.a=this.fromBigInteger(v);this.b=this.fromBigInteger(u);this.infinity=new p(this,null,null)};s.prototype.getQ=function(){return this.q};s.prototype.getA=function(){return this.a};s.prototype.getB=function(){return this.b};s.prototype.equals=function(u){if(u==this){return true}return(this.q.equals(u.q)&&this.a.equals(u.a)&&this.b.equals(u.b))};s.prototype.getInfinity=function(){return this.infinity};s.prototype.fromBigInteger=function(u){return new q(this.q,u)};s.prototype.decodePointHex=function(x){x=x.replace(/[^0-9a-f]/ig,"");switch(parseInt(x.substr(0,2),16)){case 0:return this.infinity;case 2:case 3:return null;case 4:case 6:case 7:var u=(x.length-2)/2;var w=x.substr(2,u);var v=x.substr(u+2,u);return new p(this,this.fromBigInteger(new t(w,16)),this.fromBigInteger(new t(v,16)));default:return null}};s.ECPointFp=p;n.set("cipher.asymmetric.ec.ecurve",s)})(c);(function(n){var r={};var o={NECRAC256:{name:"NECRAC256",secretLength:64,sign:{algorithm:"ec",parameters:{curve:"secp521r1"},secretLength:64},crypt:{algorithm:"ec",parameters:{curve:"secp521r1"},secretLength:64},hashAlgorithm:"WHIRLPOOL"},NECRAC192:{name:"NECRAC192",secretLength:48,sign:{algorithm:"ec",parameters:{curve:"secp384r1"},secretLength:48},crypt:{algorithm:"ec",parameters:{curve:"secp384r1"},secretLength:48},hashAlgorithm:"BLAKE2s"},NECRAC128:{name:"NECRAC128",secretLength:32,sign:{algorithm:"ec",parameters:{curve:"secp256r1"},secretLength:32},crypt:{algorithm:"ec",parameters:{curve:"secp256k1"},secretLength:32},hashAlgorithm:"BLAKE2s"},NECRAC112:{name:"NECRAC112",secretLength:28,sign:{algorithm:"ec",parameters:{curve:"secp224r1"},secretLength:28},crypt:{algorithm:"ec",parameters:{curve:"secp224r1"},secretLength:28},hashAlgorithm:"RIPEMD160"},NECRAC96:{name:"NECRAC96",secretLength:24,sign:{algorithm:"ec",parameters:{curve:"secp192k1"},secretLength:24},crypt:{algorithm:"ec",parameters:{curve:"secp192r1"},secretLength:24},hashAlgorithm:"RIPEMD160"}};function s(y){var F=this;var z=o[y];var D,x;if(!z){throw new Error("invalid-algorithm-choice")}function t(H){var G=new n.get("hash")(z.hashAlgorithm);return G.hash(H).buffer}function C(G){var H=n.get("cipher.asymmetric."+G.algorithm).constructor;return H(G.parameters)}D=C(z.sign);x=C(z.crypt);function E(G){if(G){F.sign=v;F.decrypt=u}F.verify=B;F.encrypt=A;F.getPublicKey=w;delete F.setPrivateKey;delete F.setPublicKey}function w(){var H=D.getPublicKey(),G=x.getPublicKey();return n.get("util.buffer").concat([new Uint16Array([H.byteLength]).buffer,H,G])}function v(H){if(!n.get("util.type")(H).isArrayBuffer()){throw new Error("invalid-parameter")}var G=t(H);return D.sign(G)}function B(I,G){if(!(n.get("util.type")(I).isArrayBuffer()&&n.get("util.type")(G).isArrayBuffer())){throw new Error("invalid-parameter")}var H=t(I);return D.verify(H,G)}function A(G){if(!n.get("util.type")(G).isArrayBuffer()){throw new Error("invalid-parameter")}return x.encrypt(G)}function u(G){if(!n.get("util.type")(G).isArrayBuffer()){throw new Error("invalid-parameter")}return x.decrypt(G)}this.setPrivateKey=function(G){if(!n.get("util.type")(G).isArrayBuffer()){throw new Error("invalid-parameter")}var K=new n.get("hash")(z.hashAlgorithm).pbkdf2;var J=K(G,n.get("util.encoding")("derivation-of-signing-key","ascii").toArrayBuffer(),4,z.sign.secretLength);var H=K(G,n.get("util.encoding")("derivation-of-encrypting-key","ascii").toArrayBuffer(),4,z.crypt.secretLength);try{D.setPrivateKey(J);x.setPrivateKey(H)}catch(I){throw new Error("invalid-private-key")}E(true)};this.setPublicKey=function(H){if(!(n.get("util.type")(H).isArrayBuffer()&&H.byteLength>2)){throw new Error("invalid-public-key")}var I=new Uint16Array(H.slice(0,2))[0];H=H.slice(2);if(H.byteLength<=I){throw new Error("invalid-public-key")}var K=H.slice(0,I),G=H.slice(I);try{D.setPublicKey(K);x.setPublicKey(G)}catch(J){throw new Error("invalid-public-key")}E(false)};return this}function p(t){if(t){n.get("util.log").notice("Load asymmetric cipher component: ["+t.name+"]");r[t.name]=t.constructor;return}if("undefined"!=typeof r.EC){n.get("util.log").notice("Asymmetric ciphers ready.");return function(u){return new s(u)}}return null}var q=function(t){return new s(t)};n.set("cipher.asymmetric",q);n.set("cipher.asymmetric.definition",function(t){return o[t]||null});n.exp("cipher.asymmetric",q)})(c);(function(n){function o(){var J=16;var K=4;var x=4;var t=[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22];var w=[82,9,106,213,48,54,165,56,191,64,163,158,129,243,215,251,124,227,57,130,155,47,255,135,52,142,67,68,196,222,233,203,84,123,148,50,166,194,35,61,238,76,149,11,66,250,195,78,8,46,161,102,40,217,36,178,118,91,162,73,109,139,209,37,114,248,246,100,134,104,152,22,212,164,92,204,93,101,182,146,108,112,72,80,253,237,185,218,94,21,70,87,167,141,157,132,144,216,171,0,140,188,211,10,247,228,88,5,184,179,69,6,208,44,30,143,202,63,15,2,193,175,189,3,1,19,138,107,58,145,17,65,79,103,220,234,151,242,207,206,240,180,230,115,150,172,116,34,231,173,53,133,226,249,55,232,28,117,223,110,71,241,26,113,29,41,197,137,111,183,98,14,170,24,190,27,252,86,62,75,198,210,121,32,154,219,192,254,120,205,90,244,31,221,168,51,136,7,199,49,177,18,16,89,39,128,236,95,96,81,127,169,25,181,74,13,45,229,122,159,147,201,156,239,160,224,59,77,174,42,245,176,200,235,187,60,131,83,153,97,23,43,4,126,186,119,214,38,225,105,20,99,85,33,12,125];var I=[0,16777216,33554432,67108864,134217728,268435456,536870912,1073741824,2147483648,452984832,905969664];function L(N,M){var P=0;var O;while(N){if((N&1)){P=P^M}O=M&128;M<<=1;if(O){M^=27}N>>=1}return P}function u(O){var N=new Array(256);for(var M=0;M<256;M++){N[M]=L(O,M)&255}return N}var G=u(2);var E=u(3);var y=u(9);var F=u(11);var D=u(13);var C=u(14);function H(M){var N=t;return(N[M>>>24]<<24|N[(M>>>16)&255]<<16|N[(M>>>8)&255]<<8|N[M&255])}function A(M){return M>>>24|M<<8}function v(M){return M>>>24|(M&16711680)>>>8|(M&65280)<<8|(M&255)<<24}var z=((new Uint8Array((new Uint32Array([1])).buffer))[0]==1);function B(S){var M=I;var O=new Uint8Array(S);var Q=O.length/4;var T=Q+6;var N=new Uint32Array(x*(T+1));for(var R=0;R<Q;R++){N[R]=(O[R*4]<<24|O[R*4+1]<<16|O[R*4+2]<<8|O[R*4+3])}for(var R=Q;R<x*(T+1);R++){var P=N[R-1];if(R%Q==0){P=H(A(P))^M[R/Q]}else{if(Q>6&&R%Q==4){P=H(P)}}N[R]=N[R-Q]^P}if(z){for(var R=0;R<N.length;R++){N[R]=v(N[R])}}return N}function r(M,V){var S=(V.length/x-1)*4;var Z,X,U,T;var Q,P,O,N;var ac,ab,Y,W;var R=t;Z=(M[0]^V[0])>>>0;X=(M[1]^V[1])>>>0;U=(M[2]^V[2])>>>0;T=(M[3]^V[3])>>>0;for(var aa=4;aa<S;aa+=4){Q=Z;P=X;O=U;N=T;ac=R[Q&255]>>>0;ab=R[(P>>>8)&255]>>>0;Y=R[(O>>>16)&255]>>>0;W=R[N>>>24]>>>0;Z=(((G[ac]^E[ab]^Y^W)|(ac^G[ab]^E[Y]^W)<<8|(ac^ab^G[Y]^E[W])<<16|(E[ac]^ab^Y^G[W])<<24)^V[aa])>>>0;ac=R[P&255]>>>0;ab=R[(O>>>8)&255]>>>0;Y=R[(N>>>16)&255]>>>0;W=R[Q>>>24]>>>0;X=(((G[ac]^E[ab]^Y^W)|(ac^G[ab]^E[Y]^W)<<8|(ac^ab^G[Y]^E[W])<<16|(E[ac]^ab^Y^G[W])<<24)^V[aa+1])>>>0;ac=R[O&255]>>>0;ab=R[(N>>>8)&255]>>>0;Y=R[(Q>>>16)&255]>>>0;W=R[P>>>24]>>>0;U=(((G[ac]^E[ab]^Y^W)|(ac^G[ab]^E[Y]^W)<<8|(ac^ab^G[Y]^E[W])<<16|(E[ac]^ab^Y^G[W])<<24)^V[aa+2])>>>0;ac=R[N&255]>>>0;ab=R[(Q>>>8)&255]>>>0;Y=R[(P>>>16)&255]>>>0;W=R[O>>>24]>>>0;T=(((G[ac]^E[ab]^Y^W)|(ac^G[ab]^E[Y]^W)<<8|(ac^ab^G[Y]^E[W])<<16|(E[ac]^ab^Y^G[W])<<24)^V[aa+3])>>>0}M[0]=V[S]^(R[Z&255]|R[(X>>>8)&255]<<8|R[(U>>>16)&255]<<16|R[T>>>24]<<24);M[1]=V[S+1]^(R[X&255]|R[(U>>>8)&255]<<8|R[(T>>>16)&255]<<16|R[Z>>>24]<<24);M[2]=V[S+2]^(R[U&255]|R[(T>>>8)&255]<<8|R[(Z>>>16)&255]<<16|R[X>>>24]<<24);M[3]=V[S+3]^(R[T&255]|R[(Z>>>8)&255]<<8|R[(X>>>16)&255]<<16|R[U>>>24]<<24)}function s(M,V){var N=w;var S=(V.length/x-1)*4;var X,W,U,T;var R,Q,P,O;X=(M[0]^V[S])>>>0;W=(M[1]^V[S+1])>>>0;U=(M[2]^V[S+2])>>>0;T=(M[3]^V[S+3])>>>0;for(var Y=S-4;Y>0;Y-=4){R=X;Q=W;P=U;O=T;X=((N[R&255]|N[(O>>>8)&255]<<8|N[(P>>>16)&255]<<16|N[Q>>>24]<<24)^V[Y])>>>0;W=((N[Q&255]|N[(R>>>8)&255]<<8|N[(O>>>16)&255]<<16|N[P>>>24]<<24)^V[Y+1])>>>0;U=((N[P&255]|N[(Q>>>8)&255]<<8|N[(R>>>16)&255]<<16|N[O>>>24]<<24)^V[Y+2])>>>0;T=((N[O&255]|N[(P>>>8)&255]<<8|N[(Q>>>16)&255]<<16|N[R>>>24]<<24)^V[Y+3])>>>0;R=X&255>>>0;Q=((X>>>8)&255)>>>0;P=((X>>>16)&255)>>>0;O=X>>>24;X=((C[R]^F[Q]^D[P]^y[O])|(y[R]^C[Q]^F[P]^D[O])<<8|(D[R]^y[Q]^C[P]^F[O])<<16|(F[R]^D[Q]^y[P]^C[O])<<24)>>>0;R=(W&255)>>>0;Q=((W>>>8)&255)>>>0;P=((W>>>16)&255)>>>0;O=W>>>24;W=((C[R]^F[Q]^D[P]^y[O])|(y[R]^C[Q]^F[P]^D[O])<<8|(D[R]^y[Q]^C[P]^F[O])<<16|(F[R]^D[Q]^y[P]^C[O])<<24)>>>0;R=(U&255)>>>0;Q=((U>>>8)&255)>>>0;P=((U>>>16)&255)>>>0;O=U>>>24;U=((C[R]^F[Q]^D[P]^y[O])|(y[R]^C[Q]^F[P]^D[O])<<8|(D[R]^y[Q]^C[P]^F[O])<<16|(F[R]^D[Q]^y[P]^C[O])<<24)>>>0;R=(T&255)>>>0;Q=((T>>>8)&255)>>>0;P=((T>>>16)&255)>>>0;O=T>>>24;T=((C[R]^F[Q]^D[P]^y[O])|(y[R]^C[Q]^F[P]^D[O])<<8|(D[R]^y[Q]^C[P]^F[O])<<16|(F[R]^D[Q]^y[P]^C[O])<<24)>>>0}M[0]=V[0]^(N[X&255]|N[(T>>>8)&255]<<8|N[(U>>>16)&255]<<16|N[W>>>24]<<24);M[1]=V[1]^(N[W&255]|N[(X>>>8)&255]<<8|N[(T>>>16)&255]<<16|N[U>>>24]<<24);M[2]=V[2]^(N[U&255]|N[(W>>>8)&255]<<8|N[(X>>>16)&255]<<16|N[T>>>24]<<24);M[3]=V[3]^(N[T&255]|N[(U>>>8)&255]<<8|N[(W>>>16)&255]<<16|N[X>>>24]<<24)}return{block_size_bytes:J,block_size_words:K,endian_swap32:v,is_little_endian:z,key_expansion:B,cipher:r,inv_cipher:s}}function q(){var r=this;var t=new o(),u;function s(y){if(!(n.get("util.type")(y).isArrayBuffer()&&0==y.byteLength%t.block_size_bytes)){throw new Error("invalid-input")}var C=new Uint32Array(y);var D=new Uint32Array(C.length);var A=new Uint32Array(t.block_size_words);var x=t.key_expansion(u);var B,z;for(B=0;B<C.length;B+=t.block_size_words){for(z=0;z<t.block_size_words;z++){A[z]=C[B+z]}t.cipher(A,x);D.set(A,B)}return D.buffer}function v(y){if(!(n.get("util.type")(y).isArrayBuffer()&&0==y.byteLength%t.block_size_bytes)){throw new Error("invalid-input")}var C=new Uint32Array(y);var D=new Uint32Array(C.length);var A=new Uint32Array(t.block_size_words);var E=new Uint32Array(t.block_size_words);var x=t.key_expansion(u),B,z;for(B=0;B<C.length;B+=t.block_size_words){for(z=0;z<t.block_size_words;z++){E[z]=C[B+z]}A.set(E);t.inv_cipher(A,x);D.set(A,B)}return D.buffer}this.key=function(x){if(!n.get("util.type")(x).isArrayBuffer()){throw new Error("invalid-key")}var w=x.byteLength;if(w>32){x=x.slice(0,32)}else{if(w>24){x=x.slice(0,24)}else{if(w>16){x=x.slice(0,16)}else{throw new Error("invalid-key-length")}}}u=new Uint32Array(x);r.encrypt=s;r.decrypt=v;delete r.key;return r};return this}var p={name:"AESECB",constructor:function(){return new q()}};n.set("cipher.symmetric.aes",p)})(c);(function(o){function n(B){var C=this;if(!B||B<10){B=10}var A=new Uint32Array(16);function t(I,F){function H(K,J){return(((K)<<(J))|((K)>>>(32-(J))))}var G;var E=A;for(G=0;G<16;G++){E[G]=I[G]}for(G=0;G<B;G++){E[4]^=H(E[0]+E[12],7);E[8]^=H(E[4]+E[0],9);E[12]^=H(E[8]+E[4],13);E[0]^=H(E[12]+E[8],18);E[9]^=H(E[5]+E[1],7);E[13]^=H(E[9]+E[5],9);E[1]^=H(E[13]+E[9],13);E[5]^=H(E[1]+E[13],18);E[14]^=H(E[10]+E[6],7);E[2]^=H(E[14]+E[10],9);E[6]^=H(E[2]+E[14],13);E[10]^=H(E[6]+E[2],18);E[3]^=H(E[15]+E[11],7);E[7]^=H(E[3]+E[15],9);E[11]^=H(E[7]+E[3],13);E[15]^=H(E[11]+E[7],18);E[1]^=H(E[0]+E[3],7);E[2]^=H(E[1]+E[0],9);E[3]^=H(E[2]+E[1],13);E[0]^=H(E[3]+E[2],18);E[6]^=H(E[5]+E[4],7);E[7]^=H(E[6]+E[5],9);E[4]^=H(E[7]+E[6],13);E[5]^=H(E[4]+E[7],18);E[11]^=H(E[10]+E[9],7);E[8]^=H(E[11]+E[10],9);E[9]^=H(E[8]+E[11],13);E[10]^=H(E[9]+E[8],18);E[12]^=H(E[15]+E[14],7);E[13]^=H(E[12]+E[15],9);E[14]^=H(E[13]+E[12],13);E[15]^=H(E[14]+E[13],18)}for(G=0;G<16;G++){F[G]=E[G]+I[G]}}var w=new Uint32Array(16);function s(F,H){var E=w,G=new Uint32Array([1634760805,857760878,2036477234,1797285236]);E[0]=G[0];E[1]=H[0];E[2]=H[1];E[3]=H[2];E[4]=H[3];E[5]=G[1];E[6]=F[0];E[7]=F[1];E[10]=G[2];E[11]=H[4];E[12]=H[5];E[13]=H[6];E[14]=H[7];E[15]=G[3]}function u(G,F){var E=w;E[8]=G[0];E[9]=G[1];return t(E,F)}function s(G,F){var E=w;tau=new Uint32Array([1634760805,824206446,2036477238,1797285236]);E[0]=tau[0];E[1]=F[0];E[2]=F[1];E[3]=F[2];E[4]=F[3];E[5]=tau[1];E[6]=G[0];E[7]=G[1];E[10]=tau[2];E[11]=F[0];E[12]=F[1];E[13]=F[2];E[14]=F[3];E[15]=tau[3]}function y(G,F){var E=w;E[8]=G[0];E[9]=G[1];return t(E,F)}var q=new Uint32Array(2);var x;function z(){q[0]=0;q[1]=0}function D(){q[0]+=1;if(0==q[0]){q[1]+=1}}function v(E,H){var G=new Uint32Array(E);if(32==H.byteLength){var F=new Uint32Array(H);s(G,F);x=(function(){return function(I){u(q,I);D()}})()}else{if(16==H.byteLength){var F=new Uint32Array(H);_salsa20BufferFillKey4(G,F);x=(function(){return function(I){y(q,I);D()}})()}else{throw new Error("invalid-key-length")}}}function r(K){if(!o.get("util.type")(K).isArrayBuffer()){throw new Error("invalid-input")}var E=K.byteLength,I=Math.ceil(E/64),F=new Uint32Array(16);var L=new Uint8Array(K),M=new Uint8Array(L.length+64);var J=0,H,G;z();for(H=0;H<I;H++){x(F);for(G=0;G<16;G++){M[J++]=(F[G]>>24)&255;M[J++]=(F[G]>>16)&255;M[J++]=(F[G]>>8)&255;M[J++]=F[G]&255}}for(H=0;H<E;H++){L[H]^=M[H]}return L.buffer}this.key=function(F){if(!o.get("util.type")(F).isArrayBuffer()){throw new Error("invalid-key")}var G=F.byteLength;if(G<24){throw new Error("invalid-key")}var E=F.slice(0,8);if(G<40){v(E,F.slice(8,24))}else{v(E,F.slice(8,40))}C.encrypt=r;C.decrypt=r;delete C.key;return C};return this}var p={name:"Salsa20/20",constructor:function(){return new n(20)}};o.set("cipher.symmetric.salsa20",p)})(c);(function(p){function o(){var C=this;function B(F,H){var J=F.byteLength,I=H-(J%H),K=J+I,E=new Uint8Array(F),D=new Uint8Array(K);for(var G=0;G<K;G++){if(G<J){D[G]=E[G]}else{D[G]=I}}return D.buffer}function A(E){var D=new Uint8Array(E);var F=D[D.length-1];if(D.length<F){return null}return E.slice(0,E.byteLength-F)}function x(D){return D}function u(D){return D}var w=null;function y(G,E,H){var J=64;var I=new p.get("hash")("BLAKE2s").pbkdf2(G,E,4,H*J);var D=new Array(H);for(var F=0;F<H;F++){D[F]=new p.get("hash")("WHIRLPOOL").hash(I.slice(F*J,(F+1)*J)).buffer}return D}var z=function(F){if(!p.get("util.type")(F).isArrayBuffer()){throw new Error("invalid-parameter")}var E=new p.get("util.srand")().bytes(10);var G=y(w,E,5);var H=new p.get("hash")("BLAKE2s",{length:6}).mac(F,G[0]).buffer;F=p.get("util.buffer").concat([H,F]);var D=F;D=x(D);D=B(D,16);D=n(G[1],D);D=t(G[2],D);return p.get("util.buffer").concat([E,D])};var v=function(F){if(!(p.get("util.type")(F).isArrayBuffer()&&F.byteLength>=26)){throw new Error("invalid-parameter")}var H=F.slice(0,10);F=F.slice(10);var I=y(w,H,5);var E=F;E=r(I[2],E);E=q(I[1],E);E=A(E,16);if(!p.get("util.type")(E).isArrayBuffer()){return null}E=u(E);if(!p.get("util.type")(E).isArrayBuffer()){return null}var G=E.slice(0,6);E=E.slice(6);var D=new p.get("hash")("BLAKE2s",{length:6}).mac(E,I[0]).buffer;if(p.get("util.buffer").equal(G,D)){return E}return null};this.key=function(D){if(!p.get("util.type")(D).isArrayBuffer()){throw new Error("invalid-key")}w=D;delete C.key;C.encrypt=z;C.decrypt=v;return C};return this}var t=function(u,w){try{var v=p.get("cipher.symmetric.aes").constructor;return v().key(u).encrypt(w)}catch(x){p.get("util.log").error(x);return new Error("unable-to-encrypt",x)}};var r=function(u,w){try{var v=p.get("cipher.symmetric.aes").constructor;return v().key(u).decrypt(w)}catch(x){p.get("util.log").error(x);return new Error("unable-to-decrypt",x)}};var n=function(u,v){try{var x=p.get("cipher.symmetric.salsa20").constructor;return x().key(u).encrypt(v)}catch(w){p.get("util.log").error(w);return new Error("unable-to-encrypt")}};var q=function(u,v){try{var x=p.get("cipher.symmetric.salsa20").constructor;return x().key(u).decrypt(v)}catch(w){p.get("util.log").error(w);return new Error("unable-to-decrypt",w)}};function s(){return new o()}p.set("cipher.symmetric",s);p.exp("cipher.symmetric",s)})(c);(function(n){function o(){var p=this;return this}})(c);(function(p){var o={defaultAlgorithmName:"NECRAC128",subjectRule:/^[0-9a-z\s]{8,255}$/i};var q={_:["constant",new Uint8Array([69,73]).buffer],subject:"shortBinary",algorithm:["enum","NECRAC96","NECRAC112","NECRAC128","NECRAC192","NECRAC256"],"public":"binary",secret:"shortBinary",signature:"binary"};function n(){var G=this;var w=p.get("hash");var I=p.get("util.buffer");var s=p.get("cipher.asymmetric.definition");var E=p.get("util.type");var L=p.get("util.serialize")(q);var K,x,A,D,C,N;var F=false;function y(){if(F){return F}F=w("WHIRLPOOL").mac(A,K).buffer;return F}function v(P){G.exportPublic=J;G.verify=t;G.encrypt=H;G.getFingerprint=z;if(P){G.decrypt=u;G.sign=O;G.exportPrivate=B}G.isPrivate=function(){return Boolean(P)};delete G.generate;delete G.loadPublic;delete G.loadPrivate}this.generate=function(R,Q){if(!Q){Q={}}if(!o.subjectRule.test(R)){throw new Error("enigma-invalid-input")}K=p.get("util.encoding")(R,"ascii").toArrayBuffer();D=Q.algorithm||o.defaultAlgorithmName;var P=s(D);if(!P){D=defaults.algorithmName;P=s(algorithmname)}x=p.get("util.srand")().bytes(P.secretLength);N=p.get("cipher.asymmetric")(P.name);N.setPrivateKey(x);A=N.getPublicKey();C=N.sign(y());v(true)};function M(P,Z){if(!E(P).isArrayBuffer()){throw new Error("enigma-invalid-input")}if(Z&&!E(Z).isArrayBuffer()){throw new Error("enigma-invalid-input")}try{var V=L.deserialize(P)}catch(U){throw new Error("enigma-invalid-input")}var W=V.subject,S=V.algorithm,T=V.signature,Q=V["public"],Y=V.secret;if(!o.subjectRule.test(p.get("util.encoding")(W).toASCII())){throw new Error("enigma-invalid-input")}K=W;D=S;C=T;A=Q;N=p.get("cipher.asymmetric")(D);if(Z){try{x=p.get("cipher.symmetric")().key(Z).decrypt(Y)}catch(U){throw new Error("enigma-invalid-pinkey")}N.setPrivateKey(x);var R=N.getPublicKey();if(!p.get("util.buffer").equal(R,A)){throw new Error("enigma-identity-invalid")}}else{N.setPublicKey(A)}var X=N.verify(y(),C);if(!X){throw new Error("enigma-identity-invalid")}return true}this.loadPublic=function(P){if(M(P)){v(false)}};this.loadPrivate=function(Q,P){if(M(Q,P)){v(true)}};function z(){return y().slice(0,8)}function J(){var P=L.serialize({subject:K,algorithm:D,"public":A,secret:new Uint8Array(0).buffer,signature:C});return P}function B(P){if(!(E(P).isArrayBuffer()&&P.byteLength>=32)){throw new Error("enigma-invalid-pinkey")}var R=p.get("cipher.symmetric")().key(P).encrypt(x);var Q=L.serialize({subject:K,algorithm:D,"public":A,secret:R,signature:C});return Q}function t(Q,P){if(!(E(Q).isArrayBuffer()&&E(P).isArrayBuffer())){throw new Error("enigma-invalid-input")}try{return true===N.verify(Q,P)}catch(R){return false}}function O(P){if(!E(P).isArrayBuffer()){throw new Error("enigma-invalid-input")}try{return N.sign(P)}catch(Q){throw new Error("enigma-identity-unable-to-sign")}}function H(P){if(!E(P).isArrayBuffer()){throw new Error("enigma-invalid-input")}try{return N.encrypt(P)}catch(Q){throw new Error("enigma-identity-unable-to-encrypt")}}function u(P){if(!E(P).isArrayBuffer()){throw new Error("enigma-invalid-input")}try{return N.decrypt(P)}catch(Q){throw new Error("enigma-identity-unable-to-decrypt")}}return this}var r=function(){return new n()};p.set("enigma.identity",r);p.exp("enigma.identity",r)})(c);(function(p){var n={_:["constant",new Uint8Array([69,112]).buffer],signers:"shortArray",signatures:"array",content:"longBinary"};var o={_:["constant",new Uint8Array([69,67]).buffer],compression:["enum",false,"lzw"],receivers:"shortArray",decryptors:"array",payload:"longBinary"};function q(){var D=this;var B=p.get("util.type");var A=p.get("util.serialize")(n),y=p.get("util.serialize")(o);var z,G,J=[],v=[],H=[],w=[],K=false;var M,N;this.write=function(P,O){if(!B(P).isArrayBuffer()){throw new Error("enigma-invalid-input")}z=P;G=new p.get("util.srand")().bytes(64);K=(O&&true===O.clearsign);delete D.write;delete D.read;D.sign=L;if(!K){D.encrypt=F}D.done=E};this.read=function(S){if(!B(S).isArrayBuffer()){throw new Error("enigma-invalid-input")}var Q=true;try{var P=y.deserialize(S)}catch(T){Q=false}if(Q){var V=P.receivers,R=P.decryptors,U=P.compression,O=P.payload;M=O;N=U;if(V.length!=R.length){throw new Error("enigma-invalid-input")}if(V.length>0){v=R;J=V;D.decrypt=u;D.getReceivers=s;delete D.write;delete D.read;return}}else{N=false;M=S}x();console.log("************************");delete D.write;delete D.read};function x(){if("lzw"==N){try{M=p.get("util.decompress")(M)}catch(S){throw new Error("enigma-invalid-input")}}else{if(false!==N){throw new Error("enigma-invalid-input")}}try{var Q=A.deserialize(M)}catch(S){throw new Error("enigma-invalid-input")}var R=Q.signatures,P=Q.signers,O=Q.content;if(R.length!=P.length){throw new Error("enigma-invalid-input")}z=O;D.getPlaintext=C;if(P.length>0){H=R;w=P;D.verify=t;D.getSigners=I}}function L(Q){if(!Q.isPrivate()){throw new Error("enigma-invalid-identity-for-sign")}var P=Q.getFingerprint();var O=Q.sign(z);w.push(P);H.push(O);if(w.length>=255){delete D.sign}}function F(O){var P=O.encrypt(G);var Q=O.getFingerprint();J.push(Q);v.push(P);if(J.length>=255){delete D.encrypt}return true}function E(){delete D.sign;delete D.encrypt;var Q=A.serialize({signers:w,signatures:H,content:z});if(K){return Q}var O="lzw";if(O){Q=p.get("util.compress")(Q)}var R=(v.length>0);if(R){Q=p.get("cipher.symmetric")().key(G).encrypt(Q)}var P=y.serialize({compression:O||false,receivers:J,decryptors:v,payload:Q});return P}function u(U){if(!U.isPrivate()){throw new Error("enigma-invalid-identity-for-decrypt")}var Q=U.getFingerprint(),S=false;for(var P=0;P<J.length;P++){if(p.get("util.buffer").equal(Q,J[P])){S=true;break}}if(!S){throw new Error("enigma-invalid-identity-for-decrypt")}var R=v[P];try{var O=U.decrypt(R)}catch(T){throw new Error("enigma-invalid-identity-for-decrypt")}try{M=p.get("cipher.symmetric")().key(O).decrypt(M)}catch(T){throw new Error("enigma-message-corrupted")}x(M);delete D.decrypt;delete D.getReceivers}function t(T){var Q=T.getFingerprint(),R=false;for(var P=0;P<w.length;P++){if(p.get("util.buffer").equal(Q,w[P])){R=true;break}}if(!R){throw new Error("enigma-invalid-identity-for-verify")}var O=H[P];try{return T.verify(z,O)}catch(S){throw new Error("enigma-invalid-identity-for-verify")}}function C(){return z}function s(){return J}function I(){return w}return this}function r(){return new q()}p.set("enigma.message",r);p.exp("enigma.message",r)})(c);(function(o){if(!o.get("env.isNode")){return}var s=require("crypto").createHash,n=require("buffer");var r=true;try{s("whirlpool")}catch(q){r=false}var p=true;try{s("ripemd160")}catch(q){p=false}if(r){o.acc("hash.algorithms.whirlpool",function(){var t=this;this.name="WHIRLPOOL";this.blockSize=64;this.digestSize=64;this.hash=function(y){var w=s("whirlpool");w.update(new n.Buffer(new Uint8Array(y)));var u=w.digest(),x=new Uint8Array(u.length);for(var v=0;v<x.length;v++){x[v]=u[v]}return x.buffer};return this})}if(r){o.acc("hash.algorithms.ripemd160",function(){var t=this;this.name="RIPEMD160";this.blockSize=64;this.digestSize=20;this.hash=function(y){var w=s("ripemd160");w.update(new n.Buffer(new Uint8Array(y)));var u=w.digest(),x=new Uint8Array(u.length);for(var v=0;v<x.length;v++){x[v]=u[v]}return x.buffer};return this})}})(c);var g=c.get("enigma.identity")(),f=c.get("enigma.identity")(),d=c.get("enigma.identity")(),k=new c.get("util.srand")().bytes(32);g.generate("abcdefghijklmn",{algorithm:"NECRAC96"});f.loadPublic(g.exportPublic());var j=g.exportPrivate(k);d.loadPrivate(j,k);var m=c.get("enigma.message")();m.write(c.get("util.encoding")("The first enigma message.","ascii").toArrayBuffer());m.encrypt(f);var b=m.done();var a=c.get("enigma.message")();a.read(b);a.decrypt(d);console.log(a);console.log(a.getPlaintext());if("undefined"!=typeof module&&"undefined"!=module.exports){module.exports=l}else{define([],function(){return l})}})();