(function(){var d={},e={};var b={get:function(h){return d[h]},set:function(i,h){d[i]=h},exp:function(k,h){var m=k.split(".");var l=e;for(var j in m){if("undefined"==typeof l[m[j]]){if(j==m.length-1){l[m[j]]=h;break}l[m[j]]={}}l=l[m[j]]}}};(function(n){var i="0123456789abcdefghjkmnpqrtuvwxyz";var l={o:0,i:1,l:1,s:5};var j=function(){var s={};for(var r=0;r<i.length;r++){s[i[r]]=r}for(var q in l){if(!l.hasOwnProperty(q)){continue}s[q]=s[""+l[q]]}j=function(){return s};return s};function k(){var q=0;var r=0;this.output="";this.readByte=function(s){if(q<0){r|=(s>>(-q))}else{r=(s<<q)&248}if(q>3){q-=8;return 1}if(q<4){this.output+=i[r>>3];q+=5}return 0};this.finish=function(){var s=this.output+(q<0?i[r>>3]:"");this.output="";return s}}k.prototype.update=function(s,q){for(var t=0;t<s.length;){t+=this.readByte(s[t])}var r=this.output;this.output="";if(q){r+=this.finish()}return r};function p(){var q=0;var r=0;this.output=[];this.readChar=function(s){var t=j()[s];if(typeof t=="undefined"){throw Error('Could not find character "'+s+'" in lookup table.')}t<<=3;r|=t>>>q;q+=5;if(q>=8){this.output.push(r);q-=8;if(q>0){r=(t<<(5-q))&255}else{r=0}}};this.finish=function(){if(q<0){this.output.push(i[bits>>3])}return this.output}}p.prototype.update=function(s,q){for(var t=0;t<s.length;t++){this.readChar(s[t])}var r=this.output;this.output="";if(q){r.concat(this.finish())}return r};function m(r){var s=new k();var q=s.update(r,true);return q}function h(r){var s=new p();r=r.toLowerCase();var q=s.update(r,true);return q}var o={encode:m,decode:h};n.set("util.encoding.base32",o)})(b);(function(j){function m(q){var p,o,r=0,n;for(p=0;p<q.length;p++){r+=q[p].byteLength}var s=new Uint8Array(r),t=0;for(p=0;p<q.length;p++){n=new Uint8Array(q[p]);for(o=0;o<n.length;o++){s[t]=n[o];t+=1}}return s.buffer}function h(o,n){if(o.byteLength!=n.byteLength){throw Error("xor-unequal-length-buffer")}var r=new Uint8Array(o.byteLength),q=new Uint8Array(o),s=new Uint8Array(n);for(var p=0;p<r.length;p++){r[p]=q[p]^s[p]}return r.buffer}function k(p,o){try{var n=new Uint8Array(p),s=new Uint8Array(o)}catch(r){return false}if(n.length!=s.length){return false}for(var q=0;q<n.length;q++){if(n[q]!=s[q]){return false}}return true}function i(o){var q=new Uint8Array(o);var n=q.length-1,s=Math.floor(n/2);var v=n,u;for(var p=0;p<=s;p++){u=q[p];q[p]=q[v];q[v]=u;v-=1}return q.buffer}var l={concat:m,xor:h,equal:k,reverse:i};j.set("util.buffer",l);j.exp("util.buffer",l)})(b);(function(j){function k(s){var p=4-s.length%4;if(4==p){p=0}for(var q=0;q<p;q++){s.push(0)}var w=[p],o,n,m,v,r;function t(x){if(x<=255){return 0}else{if(x<=65535){return 1}else{if(x<=16777215){return 2}else{if(x<=4294967295){return 3}else{throw Error("uncompressible: "+x)}}}}}function u(y,x){if(x<=255){y.push(x)}else{if(x<=65535){y.push((x&65280)>>8,x&255)}else{if(x<=16777215){y.push((x&16711680)>>16,(x&65280)>>8,x&255)}else{if(x<=4294967295){y.push((x&4278190080)>>24(x&16711680)>>16,(x&65280)>>8,(x&255))}}}}}for(var q=0;q<s.length;q+=4){o=s[q];n=s[q+1];m=s[q+2];v=s[q+3];r=(t(o)<<6)+(t(n)<<4)+(t(m)<<2)+(t(v));w.push(r);u(w,o);u(w,n);u(w,m);u(w,v)}return w}function l(r){var m=r[0];if(m>=4){throw new Error("invalid-input")}var o=1,n;var p,x,v,u,s;function t(z,y){return((z>>(y*2))&3)+1}function w(A){var z=0;for(var y=0;y<A.length;y++){z=(z<<8);z|=(A[y]&255)}return z}var q=[];while(o<r.length){p=r[o];o++;n=t(p,3);x=w(r.slice(o,o+n));o+=n;n=t(p,2);v=w(r.slice(o,o+n));o+=n;n=t(p,1);u=w(r.slice(o,o+n));o+=n;n=t(p,0);s=w(r.slice(o,o+n));o+=n;q.push(x,v,u,s)}return q.slice(0,q.length-m)}function h(t){if(!j.get("util.type")(t).isArrayBuffer()){throw Error("invalid-input")}var m=new Uint8Array(t);var o,r={},q,n,s="",u=[],p=256;for(o=0;o<256;o+=1){r[String.fromCharCode(o)]=o}for(o=0;o<m.length;o+=1){q=String.fromCharCode(m[o]);n=s+q;if(r.hasOwnProperty(n)){s=n}else{u.push(r[s]);r[n]=p++;s=String(q)}}if(""!==s){u.push(r[s])}return new Uint8Array(k(u)).buffer}function i(r){if(!j.get("util.type")(r).isArrayBuffer()){throw Error("invalid-input")}var m=new Uint8Array(r);m=l(m);var o,s=[],u,v,n,t="",p=256;for(o=0;o<256;o+=1){s[o]=String.fromCharCode(o)}u=String.fromCharCode(m[0]);v=u;for(o=1;o<m.length;o+=1){n=m[o];if(s[n]){t=s[n]}else{if(n===p){t=u+u.charAt(0)}else{return null}}v+=t;s[p++]=u+t.charAt(0);u=t}var q=new Uint8Array(v.length);for(var o=0;o<q.length;o++){q[o]=v.charCodeAt(o)}return q.buffer}j.exp("util.compress",h);j.exp("util.decompress",i);j.set("util.compress",h);j.set("util.decompress",i)})(b);(function(i){function h(q){if(!0==q.byteLength%2){throw new Error("decoding-error")}var q=new Uint16Array(q),m=0,o,l,p,n="";while(m<q.length){o=q[m];if((o>=0&&o<=55295)||(o>=57344&&o<=65535)){n+=String.fromCharCode(o);m+=1}else{if(o>=55296&&o<=56319){p=o;l=q[m+1];m+=2;if(l>=56320&&l<=57343){n+=String.fromCharCode(p)+String.fromCharCode(l)}else{throw new Error("decoding-error")}}else{throw new Error("decoding-error")}}}return n}function j(o,x){var p=this;var t=null;var l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",v="0123456789abcdef";var m=i.get("util.type")(o),z=i.get("util.encoding.base32");if(m.isArrayBuffer()){t=o}else{if(m.isArray()){var s=new Uint8Array(o.length);for(var w=0;w<s.length;w++){s[w]=o[w]&255}t=s.buffer}else{if(m.isString()){if(!x){x=""}switch(x.toLowerCase()){case"hex":if(!/^[0-9a-f]+$/i.test(o)||0!=o.length%2){throw Error("invalid-encoding-choosen")}o=o.toLowerCase();var q=new Uint8Array(o.length/2);for(var w=0;w<q.length;w++){q[w]=v.indexOf(o[2*w])*16+v.indexOf(o[2*w+1])}t=q.buffer;break;case"base64":if(/(=[^=]+|={3,})$/.test(o)){throw Error("invalid-encoding-choosen")}o=o.replace(/=/g,"");var r=o.length&3;if(1==r){throw Error("invalid-encoding-choosen")}var w=0,u=0,y=Math.ceil(o.length/4);var q=new Uint8Array(y*3);var E,D,C,A;for(w=0;w<y;w++){E=l.indexOf(o[u++]||"A");D=l.indexOf(o[u++]||"A");C=l.indexOf(o[u++]||"A");A=l.indexOf(o[u++]||"A");if((E|D|C|A)<0){throw Error("invalid-encoding-choosen")}q[w*3]=((E<<2)|(D>>4))&255;q[w*3+1]=((D<<4)|(C>>2))&255;q[w*3+2]=((C<<6)|A)&255}t=q.buffer.slice(0,q.length+r-4);break;case"base32":if(!/^[0-9a-z=]+$/.test(o)){throw Error("invalid-encoding-choosen")}var B=z.decode(o);t=new Uint8Array(B).buffer;break;case"ascii":var q=new Uint8Array(o.length);for(var w=0;w<q.length;w++){q[w]=o.charCodeAt(w)&255}t=q.buffer;break;default:var q=new Uint16Array(o.length);for(var w=0;w<o.length;w++){q[w]=o.charCodeAt(w)}t=q.buffer;break}}else{throw Error("unknown-encoding")}}}this.toArrayBuffer=function(){return t};this.toUTF16=function(){return h(t)};this.toBase64=function(){var K=new Uint8Array(t);var H=0,G=0,F=0,I=K.length/3;var n="";var M,L,J;for(H=0;H<I;++H){M=K[G++];L=K[G++];J=K[G++];n+=l[M>>2]+l[((M<<4)&63)|(L>>4)]+(isNaN(L)?"=":l[((L<<2)&63)|(J>>6)])+(isNaN(L+J)?"=":l[J&63])}console.log(K.length);return n};this.toBase32=function(){var n=new Uint8Array(t),F=z.encode(n);return F};this.toHEX=function(){var n=new Uint8Array(t),G="";for(var F=0;F<n.length;F++){if(n[F]<16){G+="0"+n[F].toString(16)}else{G+=n[F].toString(16)}}return G};this.toASCII=function(){var n=new Uint8Array(t),G="";for(var F=0;F<n.length;F++){G+=String.fromCharCode(n[F])}return G};this.toArray=function(){var n=new Uint8Array(t),F=new Array(n.length);for(var G=0;G<F.length;G++){F[G]=n[G]}return F};return this}var k=function(m,l){return new j(m,l)};i.set("util.encoding",k);i.exp("util.encoding",k)})(b);(function(h){var i={notice:function(j){console.log(j)},error:function(j){console.error(j)}};h.set("util.log",i);h.exp("util.log",i)})(b);(function(q){var h=new Uint32Array(16);function l(C,z){function B(x,i){return(((x)<<(i))|((x)>>>(32-(i))))}var A;var y=h;for(A=0;A<16;A++){y[A]=C[A]}for(A=0;A<32;A++){y[4]^=B(y[0]+y[12],7);y[8]^=B(y[4]+y[0],9);y[12]^=B(y[8]+y[4],13);y[0]^=B(y[12]+y[8],18);y[9]^=B(y[5]+y[1],7);y[13]^=B(y[9]+y[5],9);y[1]^=B(y[13]+y[9],13);y[5]^=B(y[1]+y[13],18);y[14]^=B(y[10]+y[6],7);y[2]^=B(y[14]+y[10],9);y[6]^=B(y[2]+y[14],13);y[10]^=B(y[6]+y[2],18);y[3]^=B(y[15]+y[11],7);y[7]^=B(y[3]+y[15],9);y[11]^=B(y[7]+y[3],13);y[15]^=B(y[11]+y[7],18);y[1]^=B(y[0]+y[3],7);y[2]^=B(y[1]+y[0],9);y[3]^=B(y[2]+y[1],13);y[0]^=B(y[3]+y[2],18);y[6]^=B(y[5]+y[4],7);y[7]^=B(y[6]+y[5],9);y[4]^=B(y[7]+y[6],13);y[5]^=B(y[4]+y[7],18);y[11]^=B(y[10]+y[9],7);y[8]^=B(y[11]+y[10],9);y[9]^=B(y[8]+y[11],13);y[10]^=B(y[9]+y[8],18);y[12]^=B(y[15]+y[14],7);y[13]^=B(y[12]+y[15],9);y[14]^=B(y[13]+y[12],13);y[15]^=B(y[14]+y[13],18)}for(A=0;A<16;A++){z[A]=y[A]+C[A]}}var p=new Uint8Array(16);function u(){for(var x=0;x<16;x++){p[x]=Math.floor(256*Math.random())}}u();var j=new Uint32Array([0,0]);function r(){j[0]=0;j[1]=0}function t(){j[0]+=1;if(0==j[0]){j[1]+=1}if(0==j[1]){u()}}var v=new Uint8Array(32),k=0;function w(i){v[k]=i;k+=1;if(k>=32){r();k=0}}for(var n=0;n<32;n++){w(Math.floor(256*Math.random()))}function m(){w(new Date().getTime()%256)}setInterval(m,100);function o(x){var z=new Uint32Array([1634760805,857760878,2036477234,1797285236]);var i=new Uint32Array(16),y=new Uint32Array(p.buffer),A=new Uint32Array(v.buffer);i[0]=z[0];i[1]=A[0];i[2]=A[1];i[3]=A[2];i[4]=A[3];i[5]=z[1];i[6]=y[0];i[7]=y[1];i[8]=j[0];i[9]=j[1];i[10]=z[2];i[11]=A[4];i[12]=A[5];i[13]=A[6];i[14]=A[7];i[15]=z[3];t();return l(i,x)}function s(){var i=this;var x=new Uint32Array(16);this.touch=function(){m()};this.bytes=function(D){var y=Math.ceil(D/64);var A=new Uint8Array(D),B=0,z=0,E;for(var C=0;C<y;C++){o(x);E=new Uint8Array(x.buffer);for(B=0;B<64;B++){if(z>=D){break}A[z]=E[B];z+=1}}return A.buffer};this.array=function(y){return new Uint8Array(i.bytes(y))};return this}q.set("util.srand",s);q.exp("util.srand",s)})(b);(function(h){function i(j){return{isError:function(){return toString.apply(j)==="[object Error]"},isArray:function(){return toString.apply(j)==="[object Array]"},isDate:function(){return toString.apply(j)==="[object Date]"},isObject:function(){return !!j&&Object.prototype.toString.call(j)==="[object Object]"},isPrimitive:function(){return self.isString(j)||self.isNumber(j)||self.isBoolean(j)},isFunction:function(){return toString.apply(j)==="[object Function]"},isDate:function(){return toString.apply(j)==="[object Date]"},isNumber:function(){return typeof j==="number"&&isFinite(j)},isString:function(){return typeof j==="string"},isBoolean:function(){return typeof j==="boolean"},isArrayBuffer:function(){return toString.apply(j)==="[object ArrayBuffer]"}}}h.set("util.type",i);h.exp("util.type",i)})(b);(function(h){function i(){var k=this;var j=h.get("util.type");this.pack=function(o){if(!Boolean(o)){o=[]}else{if(!$.tools.type.areBuffers(o)||o.length>255){throw $.error("invalid-parameter","not-buffers-items")}}var p=[];for(var n in o){var l=o[n].length,m=new $.node.buffer.Buffer(2);if(l>65535){throw $.error("invalid-parameter","data-too-long")}m.writeUInt16BE(l,0);p.push($.node.buffer.Buffer.concat([m,o[n]]))}m=new $.node.buffer.Buffer(2);m.writeUInt16BE(o.length,0);p.unshift(m);return $.node.buffer.Buffer.concat(p)};this.unpack=function(o){var m=0,l=0,r;var q=o.slice(0,2);o=o.slice(2);m=q.readUInt16BE(0);var n=[];for(var p=0;p<m;p++){q=o.slice(0,2);o=o.slice(2);l=q.readUInt16BE(0);r=o.slice(0,l);o=o.slice(l);n.push(r)}return[n,o]};return this}h.set("util.serialize.array",function(j){j.array=function(){return new i()}})})(b);(function(i){function h(k){var j=this;this.unpack=function(l){var m;if(4==k){m=new Uint32Array(l)[0];l=l.slice(4)}else{if(2==k){m=new Uint16Array(l)[0];l=l.slice(2)}else{if(1==k){m=new Uint8Array(l)[0];l=l.slice(1)}}}if(0==m){return[null,l]}unpackResult=l.slice(0,m);l=l.slice(m);return[unpackResult,l]};this.pack=function(l){if(!Boolean(l)){l=new Uint8Array(0).buffer}if(!i.get("util.type")(l).isArrayBuffer()){throw new Error("invalid-parameter")}packLength=l.byteLength;if((4==k&&packLength>4294967295)||(2==k&&packLength>65535)||(1==k&&packLength>255)){throw new Error("invalid-parameter")}if(4==k){var m=new Uint32Array(1)}else{if(2==k){var m=new Uint16Array(1)}else{if(1==k){var m=new Uint8Array(1)}}}m[0]=packLength;m=m.buffer;return i.get("util.buffer").concat([m,l])};return this}i.set("util.serialize.binary",function(j){j.shortBinary=function(){return new h(1)};j.binary=function(){return new h(2)};j.longBinary=function(){return new h(4)}})})(b);(function(i){function h(){var j=this;this.pack=function(k){if(!i.get("util.type")(k).isBoolean()){throw new Error("invalid-parameter")}var l=new Uint8Array([(k?255:0)]).buffer;return l};this.unpack=function(k){var l=new Uint8Array(k.slice(0,1))[0];k=k.slice(1);return[Boolean(255==l),k]};return this}i.set("util.serialize.boolean",function(j){j["boolean"]=function(){return new h()}})})(b);(function(h){function i(l){var k=this;var j=h.get("util.type");if(!j(l).isArray()){throw new Error("invalid-parameter")}var m=false;l=l[0];if(j(l).isString()){l=h.get("util.encoding")(l).toArrayBuffer();m=true}if(!j(l).isArrayBuffer()){throw new Error("invalid-parameter")}this.pack=function(){return l};this.unpack=function(n){var o=n.slice(0,l.byteLength);n=n.slice(l.byteLength);if(!h.get("util.buffer").equal(o,l)){throw new Error("unexpected-constant")}if(m){o=h.get("util.encoding")(o).toUTF16()}return[o,n]};return this}h.set("util.serialize.constant",function(j){j.constant=function(k){return new i(k)}})})(b);module.exports=function(h){h.datetime=function(){return new a()}};function a(){var h=this;this.pack=function(l){if(!Boolean(l)){return new $.node.buffer.Buffer("00","hex")}if(!$.tools.type.isDate(l)){if($.tools.type.isString(l)){try{l=new Date(l)}catch(m){throw $.error("invalid-parameter","date")}}else{throw $.error("invalid-parameter","date")}}var j=new $.node.buffer.Buffer(l.toISOString(),"ascii"),k=j.length,i=new $.node.buffer.Buffer(1);i.writeUInt8(k,0);return $.node.buffer.Buffer.concat([i,j])};this.unpack=function(m){var j=m.slice(0,1),l=j.readUInt8(0);m=m.slice(1);if(0==l){return[null,m]}var i=m.slice(0,l);m=m.slice(l);var k=new Date(i.toString("ascii"));return[k,m]};return this}(function(h){function i(k){var j=this;if(!h.get("util.type")(k).isArray()||k.length>255){throw new Error("invalid-parameter")}this.pack=function(n){var m=k.indexOf(n);if(m<0){throw new Error("not-enum-item")}var l=new Uint8Array([m]);return l.buffer};this.unpack=function(l){var m=new Uint8Array(l.slice(0,1))[0];l=l.slice(1);if(m>=k.length){throw new Error("invalid-enum-value")}return[k[m],l]};return this}h.set("util.serialize.enum",function(j){j["enum"]=function(k){return new i(k)}})})(b);(function(i){var k=false;function h(m){var t=this;var n=i.get("util.type");if(!n(m).isObject()){throw new Error("invalid-data-structure")}var o=Object.keys(m).sort(),l=[];for(var q in o){var s=o[q];var r,p;if(n(m[s]).isString()){r=m[s];p=[]}else{r=m[s][0];p=m[s].slice(1)}if(!k[r]){throw new Error("invalid-data-structure")}l.push(k[r](p))}this.serialize=function(x){if(!n(x).isObject()){throw new Error("invalid-parameter")}var u=[];for(var w in l){var v=o[w];u.push(l[w].pack(x[v]))}return i.get("util.buffer").concat(u)};this.deserialize=function(v){if(!n(v).isArrayBuffer()){throw new Error("invalid-parameter")}var w={};for(var y in o){var x=o[y];var u=l[y].unpack(v);w[x]=u[0];v=u[1]}return w};return this}var j=function(l){if(false===k){k={};i.get("util.serialize.enum")(k);i.get("util.serialize.binary")(k);i.get("util.serialize.boolean")(k);i.get("util.serialize.constant")(k)}return new h(l)};i.set("util.serialize",j)})(b);(function(i){function j(o,m){if(typeof o==="undefined"){o=32}this.isFinished=false;this.digestLength=32;this.blockLength=64;this.iv=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];if(o<=0){o=this.digestLength}else{if(o>32){throw"digestLength is too large"}}var k=0;if(typeof m=="string"){m=this.stringToUtf8Array(m);k=m.length}else{if(typeof m=="object"){k=m.length}}if(k>32){throw"key too long"}var n=[o&255,k,1,1];this.h=this.iv.slice(0);this.h[0]^=this.load32(n,0);this.x=new Array(64);this.t0=0;this.t1=0;this.f0=0;this.f1=0;this.nx=0;this.digestLength=o;if(k>0){for(var l=0;l<k;l++){this.x[l]=m[l]}for(var l=k;l<64;l++){this.x[l]=0}this.nx=64}}j.prototype.load32=function(k,l){return((k[l]&255)|((k[l+1]&255)<<8)|((k[l+2]&255)<<16)|((k[l+3]&255)<<24))>>>0};j.prototype.store32=function(l,m,k){l[m]=(k>>>0)&255;l[m+1]=(k>>>8)&255;l[m+2]=(k>>>16)&255;l[m+3]=(k>>>24)&255};j.prototype.processBlock=function(v){this.t0+=v;if(this.t0!=this.t0>>>0){this.t0=0;this.t1++}var u=this.h[0],t=this.h[1],s=this.h[2],r=this.h[3],p=this.h[4],n=this.h[5],l=this.h[6],Q=this.h[7],O=this.iv[0],M=this.iv[1],J=this.iv[2],G=this.iv[3],D=this.iv[4]^this.t0,A=this.iv[5]^this.t1,y=this.iv[6]^this.f0,w=this.iv[7]^this.f1;var q=this.load32(this.x,0),o=this.load32(this.x,4),m=this.load32(this.x,8),k=this.load32(this.x,12),P=this.load32(this.x,16),N=this.load32(this.x,20),L=this.load32(this.x,24),I=this.load32(this.x,28),F=this.load32(this.x,32),C=this.load32(this.x,36),K=this.load32(this.x,40),H=this.load32(this.x,44),E=this.load32(this.x,48),B=this.load32(this.x,52),z=this.load32(this.x,56),x=this.load32(this.x,60);u+=q;u+=p;D^=u;D=D<<(32-16)|D>>>16;O+=D;p^=O;p=p<<(32-12)|p>>>12;t+=m;t+=n;A^=t;A=A<<(32-16)|A>>>16;M+=A;n^=M;n=n<<(32-12)|n>>>12;s+=P;s+=l;y^=s;y=y<<(32-16)|y>>>16;J+=y;l^=J;l=l<<(32-12)|l>>>12;r+=L;r+=Q;w^=r;w=w<<(32-16)|w>>>16;G+=w;Q^=G;Q=Q<<(32-12)|Q>>>12;s+=N;s+=l;y^=s;y=y<<(32-8)|y>>>8;J+=y;l^=J;l=l<<(32-7)|l>>>7;r+=I;r+=Q;w^=r;w=w<<(32-8)|w>>>8;G+=w;Q^=G;Q=Q<<(32-7)|Q>>>7;t+=k;t+=n;A^=t;A=A<<(32-8)|A>>>8;M+=A;n^=M;n=n<<(32-7)|n>>>7;u+=o;u+=p;D^=u;D=D<<(32-8)|D>>>8;O+=D;p^=O;p=p<<(32-7)|p>>>7;u+=F;u+=n;w^=u;w=w<<(32-16)|w>>>16;J+=w;n^=J;n=n<<(32-12)|n>>>12;t+=K;t+=l;D^=t;D=D<<(32-16)|D>>>16;G+=D;l^=G;l=l<<(32-12)|l>>>12;s+=E;s+=Q;A^=s;A=A<<(32-16)|A>>>16;O+=A;Q^=O;Q=Q<<(32-12)|Q>>>12;r+=z;r+=p;y^=r;y=y<<(32-16)|y>>>16;M+=y;p^=M;p=p<<(32-12)|p>>>12;s+=B;s+=Q;A^=s;A=A<<(32-8)|A>>>8;O+=A;Q^=O;Q=Q<<(32-7)|Q>>>7;r+=x;r+=p;y^=r;y=y<<(32-8)|y>>>8;M+=y;p^=M;p=p<<(32-7)|p>>>7;t+=H;t+=l;D^=t;D=D<<(32-8)|D>>>8;G+=D;l^=G;l=l<<(32-7)|l>>>7;u+=C;u+=n;w^=u;w=w<<(32-8)|w>>>8;J+=w;n^=J;n=n<<(32-7)|n>>>7;u+=z;u+=p;D^=u;D=D<<(32-16)|D>>>16;O+=D;p^=O;p=p<<(32-12)|p>>>12;t+=P;t+=n;A^=t;A=A<<(32-16)|A>>>16;M+=A;n^=M;n=n<<(32-12)|n>>>12;s+=C;s+=l;y^=s;y=y<<(32-16)|y>>>16;J+=y;l^=J;l=l<<(32-12)|l>>>12;r+=B;r+=Q;w^=r;w=w<<(32-16)|w>>>16;G+=w;Q^=G;Q=Q<<(32-12)|Q>>>12;s+=x;s+=l;y^=s;y=y<<(32-8)|y>>>8;J+=y;l^=J;l=l<<(32-7)|l>>>7;r+=L;r+=Q;w^=r;w=w<<(32-8)|w>>>8;G+=w;Q^=G;Q=Q<<(32-7)|Q>>>7;t+=F;t+=n;A^=t;A=A<<(32-8)|A>>>8;M+=A;n^=M;n=n<<(32-7)|n>>>7;u+=K;u+=p;D^=u;D=D<<(32-8)|D>>>8;O+=D;p^=O;p=p<<(32-7)|p>>>7;u+=o;u+=n;w^=u;w=w<<(32-16)|w>>>16;J+=w;n^=J;n=n<<(32-12)|n>>>12;t+=q;t+=l;D^=t;D=D<<(32-16)|D>>>16;G+=D;l^=G;l=l<<(32-12)|l>>>12;s+=H;s+=Q;A^=s;A=A<<(32-16)|A>>>16;O+=A;Q^=O;Q=Q<<(32-12)|Q>>>12;r+=N;r+=p;y^=r;y=y<<(32-16)|y>>>16;M+=y;p^=M;p=p<<(32-12)|p>>>12;s+=I;s+=Q;A^=s;A=A<<(32-8)|A>>>8;O+=A;Q^=O;Q=Q<<(32-7)|Q>>>7;r+=k;r+=p;y^=r;y=y<<(32-8)|y>>>8;M+=y;p^=M;p=p<<(32-7)|p>>>7;t+=m;t+=l;D^=t;D=D<<(32-8)|D>>>8;G+=D;l^=G;l=l<<(32-7)|l>>>7;u+=E;u+=n;w^=u;w=w<<(32-8)|w>>>8;J+=w;n^=J;n=n<<(32-7)|n>>>7;u+=H;u+=p;D^=u;D=D<<(32-16)|D>>>16;O+=D;p^=O;p=p<<(32-12)|p>>>12;t+=E;t+=n;A^=t;A=A<<(32-16)|A>>>16;M+=A;n^=M;n=n<<(32-12)|n>>>12;s+=N;s+=l;y^=s;y=y<<(32-16)|y>>>16;J+=y;l^=J;l=l<<(32-12)|l>>>12;r+=x;r+=Q;w^=r;w=w<<(32-16)|w>>>16;G+=w;Q^=G;Q=Q<<(32-12)|Q>>>12;s+=m;s+=l;y^=s;y=y<<(32-8)|y>>>8;J+=y;l^=J;l=l<<(32-7)|l>>>7;r+=B;r+=Q;w^=r;w=w<<(32-8)|w>>>8;G+=w;Q^=G;Q=Q<<(32-7)|Q>>>7;t+=q;t+=n;A^=t;A=A<<(32-8)|A>>>8;M+=A;n^=M;n=n<<(32-7)|n>>>7;u+=F;u+=p;D^=u;D=D<<(32-8)|D>>>8;O+=D;p^=O;p=p<<(32-7)|p>>>7;u+=K;u+=n;w^=u;w=w<<(32-16)|w>>>16;J+=w;n^=J;n=n<<(32-12)|n>>>12;t+=k;t+=l;D^=t;D=D<<(32-16)|D>>>16;G+=D;l^=G;l=l<<(32-12)|l>>>12;s+=I;s+=Q;A^=s;A=A<<(32-16)|A>>>16;O+=A;Q^=O;Q=Q<<(32-12)|Q>>>12;r+=C;r+=p;y^=r;y=y<<(32-16)|y>>>16;M+=y;p^=M;p=p<<(32-12)|p>>>12;s+=o;s+=Q;A^=s;A=A<<(32-8)|A>>>8;O+=A;Q^=O;Q=Q<<(32-7)|Q>>>7;r+=P;r+=p;y^=r;y=y<<(32-8)|y>>>8;M+=y;p^=M;p=p<<(32-7)|p>>>7;t+=L;t+=l;D^=t;D=D<<(32-8)|D>>>8;G+=D;l^=G;l=l<<(32-7)|l>>>7;u+=z;u+=n;w^=u;w=w<<(32-8)|w>>>8;J+=w;n^=J;n=n<<(32-7)|n>>>7;u+=I;u+=p;D^=u;D=D<<(32-16)|D>>>16;O+=D;p^=O;p=p<<(32-12)|p>>>12;t+=k;t+=n;A^=t;A=A<<(32-16)|A>>>16;M+=A;n^=M;n=n<<(32-12)|n>>>12;s+=B;s+=l;y^=s;y=y<<(32-16)|y>>>16;J+=y;l^=J;l=l<<(32-12)|l>>>12;r+=H;r+=Q;w^=r;w=w<<(32-16)|w>>>16;G+=w;Q^=G;Q=Q<<(32-12)|Q>>>12;s+=E;s+=l;y^=s;y=y<<(32-8)|y>>>8;J+=y;l^=J;l=l<<(32-7)|l>>>7;r+=z;r+=Q;w^=r;w=w<<(32-8)|w>>>8;G+=w;Q^=G;Q=Q<<(32-7)|Q>>>7;t+=o;t+=n;A^=t;A=A<<(32-8)|A>>>8;M+=A;n^=M;n=n<<(32-7)|n>>>7;u+=C;u+=p;D^=u;D=D<<(32-8)|D>>>8;O+=D;p^=O;p=p<<(32-7)|p>>>7;u+=m;u+=n;w^=u;w=w<<(32-16)|w>>>16;J+=w;n^=J;n=n<<(32-12)|n>>>12;t+=N;t+=l;D^=t;D=D<<(32-16)|D>>>16;G+=D;l^=G;l=l<<(32-12)|l>>>12;s+=P;s+=Q;A^=s;A=A<<(32-16)|A>>>16;O+=A;Q^=O;Q=Q<<(32-12)|Q>>>12;r+=x;r+=p;y^=r;y=y<<(32-16)|y>>>16;M+=y;p^=M;p=p<<(32-12)|p>>>12;s+=q;s+=Q;A^=s;A=A<<(32-8)|A>>>8;O+=A;Q^=O;Q=Q<<(32-7)|Q>>>7;r+=F;r+=p;y^=r;y=y<<(32-8)|y>>>8;M+=y;p^=M;p=p<<(32-7)|p>>>7;t+=K;t+=l;D^=t;D=D<<(32-8)|D>>>8;G+=D;l^=G;l=l<<(32-7)|l>>>7;u+=L;u+=n;w^=u;w=w<<(32-8)|w>>>8;J+=w;n^=J;n=n<<(32-7)|n>>>7;u+=C;u+=p;D^=u;D=D<<(32-16)|D>>>16;O+=D;p^=O;p=p<<(32-12)|p>>>12;t+=N;t+=n;A^=t;A=A<<(32-16)|A>>>16;M+=A;n^=M;n=n<<(32-12)|n>>>12;s+=m;s+=l;y^=s;y=y<<(32-16)|y>>>16;J+=y;l^=J;l=l<<(32-12)|l>>>12;r+=K;r+=Q;w^=r;w=w<<(32-16)|w>>>16;G+=w;Q^=G;Q=Q<<(32-12)|Q>>>12;s+=P;s+=l;y^=s;y=y<<(32-8)|y>>>8;J+=y;l^=J;l=l<<(32-7)|l>>>7;r+=x;r+=Q;w^=r;w=w<<(32-8)|w>>>8;G+=w;Q^=G;Q=Q<<(32-7)|Q>>>7;t+=I;t+=n;A^=t;A=A<<(32-8)|A>>>8;M+=A;n^=M;n=n<<(32-7)|n>>>7;u+=q;u+=p;D^=u;D=D<<(32-8)|D>>>8;O+=D;p^=O;p=p<<(32-7)|p>>>7;u+=z;u+=n;w^=u;w=w<<(32-16)|w>>>16;J+=w;n^=J;n=n<<(32-12)|n>>>12;t+=H;t+=l;D^=t;D=D<<(32-16)|D>>>16;G+=D;l^=G;l=l<<(32-12)|l>>>12;s+=L;s+=Q;A^=s;A=A<<(32-16)|A>>>16;O+=A;Q^=O;Q=Q<<(32-12)|Q>>>12;r+=k;r+=p;y^=r;y=y<<(32-16)|y>>>16;M+=y;p^=M;p=p<<(32-12)|p>>>12;s+=F;s+=Q;A^=s;A=A<<(32-8)|A>>>8;O+=A;Q^=O;Q=Q<<(32-7)|Q>>>7;r+=B;r+=p;y^=r;y=y<<(32-8)|y>>>8;M+=y;p^=M;p=p<<(32-7)|p>>>7;t+=E;t+=l;D^=t;D=D<<(32-8)|D>>>8;G+=D;l^=G;l=l<<(32-7)|l>>>7;u+=o;u+=n;w^=u;w=w<<(32-8)|w>>>8;J+=w;n^=J;n=n<<(32-7)|n>>>7;u+=m;u+=p;D^=u;D=D<<(32-16)|D>>>16;O+=D;p^=O;p=p<<(32-12)|p>>>12;t+=L;t+=n;A^=t;A=A<<(32-16)|A>>>16;M+=A;n^=M;n=n<<(32-12)|n>>>12;s+=q;s+=l;y^=s;y=y<<(32-16)|y>>>16;J+=y;l^=J;l=l<<(32-12)|l>>>12;r+=F;r+=Q;w^=r;w=w<<(32-16)|w>>>16;G+=w;Q^=G;Q=Q<<(32-12)|Q>>>12;s+=H;s+=l;y^=s;y=y<<(32-8)|y>>>8;J+=y;l^=J;l=l<<(32-7)|l>>>7;r+=k;r+=Q;w^=r;w=w<<(32-8)|w>>>8;G+=w;Q^=G;Q=Q<<(32-7)|Q>>>7;t+=K;t+=n;A^=t;A=A<<(32-8)|A>>>8;M+=A;n^=M;n=n<<(32-7)|n>>>7;u+=E;u+=p;D^=u;D=D<<(32-8)|D>>>8;O+=D;p^=O;p=p<<(32-7)|p>>>7;u+=P;u+=n;w^=u;w=w<<(32-16)|w>>>16;J+=w;n^=J;n=n<<(32-12)|n>>>12;t+=I;t+=l;D^=t;D=D<<(32-16)|D>>>16;G+=D;l^=G;l=l<<(32-12)|l>>>12;s+=x;s+=Q;A^=s;A=A<<(32-16)|A>>>16;O+=A;Q^=O;Q=Q<<(32-12)|Q>>>12;r+=o;r+=p;y^=r;y=y<<(32-16)|y>>>16;M+=y;p^=M;p=p<<(32-12)|p>>>12;s+=z;s+=Q;A^=s;A=A<<(32-8)|A>>>8;O+=A;Q^=O;Q=Q<<(32-7)|Q>>>7;r+=C;r+=p;y^=r;y=y<<(32-8)|y>>>8;M+=y;p^=M;p=p<<(32-7)|p>>>7;t+=N;t+=l;D^=t;D=D<<(32-8)|D>>>8;G+=D;l^=G;l=l<<(32-7)|l>>>7;u+=B;u+=n;w^=u;w=w<<(32-8)|w>>>8;J+=w;n^=J;n=n<<(32-7)|n>>>7;u+=E;u+=p;D^=u;D=D<<(32-16)|D>>>16;O+=D;p^=O;p=p<<(32-12)|p>>>12;t+=o;t+=n;A^=t;A=A<<(32-16)|A>>>16;M+=A;n^=M;n=n<<(32-12)|n>>>12;s+=z;s+=l;y^=s;y=y<<(32-16)|y>>>16;J+=y;l^=J;l=l<<(32-12)|l>>>12;r+=P;r+=Q;w^=r;w=w<<(32-16)|w>>>16;G+=w;Q^=G;Q=Q<<(32-12)|Q>>>12;s+=B;s+=l;y^=s;y=y<<(32-8)|y>>>8;J+=y;l^=J;l=l<<(32-7)|l>>>7;r+=K;r+=Q;w^=r;w=w<<(32-8)|w>>>8;G+=w;Q^=G;Q=Q<<(32-7)|Q>>>7;t+=x;t+=n;A^=t;A=A<<(32-8)|A>>>8;M+=A;n^=M;n=n<<(32-7)|n>>>7;u+=N;u+=p;D^=u;D=D<<(32-8)|D>>>8;O+=D;p^=O;p=p<<(32-7)|p>>>7;u+=q;u+=n;w^=u;w=w<<(32-16)|w>>>16;J+=w;n^=J;n=n<<(32-12)|n>>>12;t+=L;t+=l;D^=t;D=D<<(32-16)|D>>>16;G+=D;l^=G;l=l<<(32-12)|l>>>12;s+=C;s+=Q;A^=s;A=A<<(32-16)|A>>>16;O+=A;Q^=O;Q=Q<<(32-12)|Q>>>12;r+=F;r+=p;y^=r;y=y<<(32-16)|y>>>16;M+=y;p^=M;p=p<<(32-12)|p>>>12;s+=m;s+=Q;A^=s;A=A<<(32-8)|A>>>8;O+=A;Q^=O;Q=Q<<(32-7)|Q>>>7;r+=H;r+=p;y^=r;y=y<<(32-8)|y>>>8;M+=y;p^=M;p=p<<(32-7)|p>>>7;t+=k;t+=l;D^=t;D=D<<(32-8)|D>>>8;G+=D;l^=G;l=l<<(32-7)|l>>>7;u+=I;u+=n;w^=u;w=w<<(32-8)|w>>>8;J+=w;n^=J;n=n<<(32-7)|n>>>7;u+=B;u+=p;D^=u;D=D<<(32-16)|D>>>16;O+=D;p^=O;p=p<<(32-12)|p>>>12;t+=I;t+=n;A^=t;A=A<<(32-16)|A>>>16;M+=A;n^=M;n=n<<(32-12)|n>>>12;s+=E;s+=l;y^=s;y=y<<(32-16)|y>>>16;J+=y;l^=J;l=l<<(32-12)|l>>>12;r+=k;r+=Q;w^=r;w=w<<(32-16)|w>>>16;G+=w;Q^=G;Q=Q<<(32-12)|Q>>>12;s+=o;s+=l;y^=s;y=y<<(32-8)|y>>>8;J+=y;l^=J;l=l<<(32-7)|l>>>7;r+=C;r+=Q;w^=r;w=w<<(32-8)|w>>>8;G+=w;Q^=G;Q=Q<<(32-7)|Q>>>7;t+=z;t+=n;A^=t;A=A<<(32-8)|A>>>8;M+=A;n^=M;n=n<<(32-7)|n>>>7;u+=H;u+=p;D^=u;D=D<<(32-8)|D>>>8;O+=D;p^=O;p=p<<(32-7)|p>>>7;u+=N;u+=n;w^=u;w=w<<(32-16)|w>>>16;J+=w;n^=J;n=n<<(32-12)|n>>>12;t+=x;t+=l;D^=t;D=D<<(32-16)|D>>>16;G+=D;l^=G;l=l<<(32-12)|l>>>12;s+=F;s+=Q;A^=s;A=A<<(32-16)|A>>>16;O+=A;Q^=O;Q=Q<<(32-12)|Q>>>12;r+=m;r+=p;y^=r;y=y<<(32-16)|y>>>16;M+=y;p^=M;p=p<<(32-12)|p>>>12;s+=L;s+=Q;A^=s;A=A<<(32-8)|A>>>8;O+=A;Q^=O;Q=Q<<(32-7)|Q>>>7;r+=K;r+=p;y^=r;y=y<<(32-8)|y>>>8;M+=y;p^=M;p=p<<(32-7)|p>>>7;t+=P;t+=l;D^=t;D=D<<(32-8)|D>>>8;G+=D;l^=G;l=l<<(32-7)|l>>>7;u+=q;u+=n;w^=u;w=w<<(32-8)|w>>>8;J+=w;n^=J;n=n<<(32-7)|n>>>7;u+=L;u+=p;D^=u;D=D<<(32-16)|D>>>16;O+=D;p^=O;p=p<<(32-12)|p>>>12;t+=z;t+=n;A^=t;A=A<<(32-16)|A>>>16;M+=A;n^=M;n=n<<(32-12)|n>>>12;s+=H;s+=l;y^=s;y=y<<(32-16)|y>>>16;J+=y;l^=J;l=l<<(32-12)|l>>>12;r+=q;r+=Q;w^=r;w=w<<(32-16)|w>>>16;G+=w;Q^=G;Q=Q<<(32-12)|Q>>>12;s+=k;s+=l;y^=s;y=y<<(32-8)|y>>>8;J+=y;l^=J;l=l<<(32-7)|l>>>7;r+=F;r+=Q;w^=r;w=w<<(32-8)|w>>>8;G+=w;Q^=G;Q=Q<<(32-7)|Q>>>7;t+=C;t+=n;A^=t;A=A<<(32-8)|A>>>8;M+=A;n^=M;n=n<<(32-7)|n>>>7;u+=x;u+=p;D^=u;D=D<<(32-8)|D>>>8;O+=D;p^=O;p=p<<(32-7)|p>>>7;u+=E;u+=n;w^=u;w=w<<(32-16)|w>>>16;J+=w;n^=J;n=n<<(32-12)|n>>>12;t+=B;t+=l;D^=t;D=D<<(32-16)|D>>>16;G+=D;l^=G;l=l<<(32-12)|l>>>12;s+=o;s+=Q;A^=s;A=A<<(32-16)|A>>>16;O+=A;Q^=O;Q=Q<<(32-12)|Q>>>12;r+=K;r+=p;y^=r;y=y<<(32-16)|y>>>16;M+=y;p^=M;p=p<<(32-12)|p>>>12;s+=P;s+=Q;A^=s;A=A<<(32-8)|A>>>8;O+=A;Q^=O;Q=Q<<(32-7)|Q>>>7;r+=N;r+=p;y^=r;y=y<<(32-8)|y>>>8;M+=y;p^=M;p=p<<(32-7)|p>>>7;t+=I;t+=l;D^=t;D=D<<(32-8)|D>>>8;G+=D;l^=G;l=l<<(32-7)|l>>>7;u+=m;u+=n;w^=u;w=w<<(32-8)|w>>>8;J+=w;n^=J;n=n<<(32-7)|n>>>7;u+=K;u+=p;D^=u;D=D<<(32-16)|D>>>16;O+=D;p^=O;p=p<<(32-12)|p>>>12;t+=F;t+=n;A^=t;A=A<<(32-16)|A>>>16;M+=A;n^=M;n=n<<(32-12)|n>>>12;s+=I;s+=l;y^=s;y=y<<(32-16)|y>>>16;J+=y;l^=J;l=l<<(32-12)|l>>>12;r+=o;r+=Q;w^=r;w=w<<(32-16)|w>>>16;G+=w;Q^=G;Q=Q<<(32-12)|Q>>>12;s+=L;s+=l;y^=s;y=y<<(32-8)|y>>>8;J+=y;l^=J;l=l<<(32-7)|l>>>7;r+=N;r+=Q;w^=r;w=w<<(32-8)|w>>>8;G+=w;Q^=G;Q=Q<<(32-7)|Q>>>7;t+=P;t+=n;A^=t;A=A<<(32-8)|A>>>8;M+=A;n^=M;n=n<<(32-7)|n>>>7;u+=m;u+=p;D^=u;D=D<<(32-8)|D>>>8;O+=D;p^=O;p=p<<(32-7)|p>>>7;u+=x;u+=n;w^=u;w=w<<(32-16)|w>>>16;J+=w;n^=J;n=n<<(32-12)|n>>>12;t+=C;t+=l;D^=t;D=D<<(32-16)|D>>>16;G+=D;l^=G;l=l<<(32-12)|l>>>12;s+=k;s+=Q;A^=s;A=A<<(32-16)|A>>>16;O+=A;Q^=O;Q=Q<<(32-12)|Q>>>12;r+=B;r+=p;y^=r;y=y<<(32-16)|y>>>16;M+=y;p^=M;p=p<<(32-12)|p>>>12;s+=E;s+=Q;A^=s;A=A<<(32-8)|A>>>8;O+=A;Q^=O;Q=Q<<(32-7)|Q>>>7;r+=q;r+=p;y^=r;y=y<<(32-8)|y>>>8;M+=y;p^=M;p=p<<(32-7)|p>>>7;t+=z;t+=l;D^=t;D=D<<(32-8)|D>>>8;G+=D;l^=G;l=(l<<(32-7))|(l>>>7);u+=H;u+=n;w^=u;w=(w<<(32-8))|(w>>>8);J+=w;n^=J;n=(n<<(32-7))|(n>>>7);this.h[0]^=u^O;this.h[1]^=t^M;this.h[2]^=s^J;this.h[3]^=r^G;this.h[4]^=p^D;this.h[5]^=n^A;this.h[6]^=l^y;this.h[7]^=Q^w};j.prototype.stringToUtf8Array=function(m){var k=[];for(var l=0;l<m.length;l++){var n=m.charCodeAt(l);if(n<128){k.push(n)}else{if(n>127&&n<2048){k.push((n>>6)|192);k.push((n&63)|128)}else{k.push((n>>12)|224);k.push(((n>>6)&63)|128);k.push((n&64)|128)}}}return k};j.prototype.update=function(n,o,l){if(typeof o==="undefined"){o=0}if(typeof l==="undefined"){l=n.length}if(this.isFinished){throw"update() after calling digest()"}if(typeof n=="string"){if(o!=0){throw"offset not supported for strings"}n=this.stringToUtf8Array(n);l=n.length;o=0}else{if(typeof n!="object"){throw"unsupported object: string or array required"}}if(l==0){return}var m=64-this.nx;if(l>m){for(var k=0;k<m;k++){this.x[this.nx+k]=n[o+k]}this.processBlock(64);o+=m;l-=m;this.nx=0}while(l>64){for(var k=0;k<64;k++){this.x[k]=n[o+k]}this.processBlock(64);o+=64;l-=64;this.nx=0}for(var k=0;k<l;k++){this.x[this.nx+k]=n[o+k]}this.nx+=l};j.prototype.digest=function(){if(this.isFinished){return this.result}for(var l=this.nx;l<64;l++){this.x[l]=0}this.f0=4294967295;this.processBlock(this.nx);var k=new Array(32);for(var l=0;l<8;l++){var m=this.h[l];k[l*4+0]=(m>>>0)&255;k[l*4+1]=(m>>>8)&255;k[l*4+2]=(m>>>16)&255;k[l*4+3]=(m>>>24)&255}this.result=k.slice(0,this.digestLength);this.isFinished=true;return this.result};function h(m){var k=this;this.name="BLAKE2s";this.blockSize=32;if(m&&i.get("util.type")(m.length).isNumber()&&m.length<=32&&m.length>=1){this.digestSize=Math.floor(m.length)}else{this.digestSize=32}function l(p,o){if(o){var n=new j(k.digestSize,new Uint8Array(o))}else{var n=new j(k.digestSize)}n.update(new Uint8Array(p));return new Uint8Array(n.digest()).buffer}this.mac=function(o,n){if(n.byteLength>32){n=n.slice(0,32)}return l(o,n)};this.hash=function(n){return l(n)};return this}i.set("hash.algorithms.blake2s",h)})(b);(function(i){var j={};function k(o,n){var m=this;this.algorithms=["ripemd160","blake2s","whirlpool"];o=o.toLowerCase();if(this.algorithms.indexOf(o)<0){throw new Error("hash-algorithm-unknown")}var q=i.get("hash.algorithms."+o);function p(r){return{hex:i.get("util.encoding")(r).toHEX(),buffer:r}}this.hash=function(s){if(!i.get("util.type")(s).isArrayBuffer()){throw Error("invalid-parameter")}var r=new q(n);return p(r.hash(s))};this.mac=function(t,u){if(!(i.get("util.type")(u).isArrayBuffer()&&i.get("util.type")(t).isArrayBuffer())){throw Error("invalid-parameter")}var s;var r=new q(n);if(i.get("util.type")(r.mac).isFunction()){s=r.mac(t,u)}else{s=l(r.hash,u,t,r.blockSize)}return p(s)};this.pbkdf2=function(s,r,u,t){if(!(i.get("util.type")(s).isArrayBuffer()&&i.get("util.type")(r).isArrayBuffer()&&u>0&&t>0)){throw Error("invalid-parameter")}return h(m.mac,new q().digestSize,s,r,u,t)};return this}function l(x,o,q,u){if(o.byteLength>u){o=new Uint8Array(x(o))}else{if(o.byteLength<u){var m=new Uint8Array(u),t=new Uint8Array(o);for(var r=0;r<m.length;r++){if(r<o.byteLength){m[r]=t[r]}else{m[r]=0}}o=m}}var y=new Uint8Array(u);var p=new Uint8Array(u);for(var r=0;r<u;r++){y[r]=92^o[r];p[r]=54^o[r]}var n=i.get("util.buffer").concat([p.buffer,q]),v=x(n);var w=i.get("util.buffer").concat([y.buffer,v]),s=x(w);return s}function h(z,x,t,q,o,m){var y=Math.ceil(m/x);var v=new Array(y);for(var s=0;s<y;s++){var u=false;var n=new Uint32Array([s]);var w=i.get("util.buffer").concat([q,n.buffer]);for(var r=0;r<o;r++){var p=z(t,w).buffer;if(false===u){u=p}else{u=i.get("util.buffer").xor(p,u)}w=p}v[s]=u}return i.get("util.buffer").concat(v).slice(0,m)}i.exp("hash",k);i.set("hash",k)})(b);(function(l){var m=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13];var j=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11];var w=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6];var v=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11];var k=[0,1518500249,1859775393,2400959708,2840853838];var y=[1352829926,1548603684,1836072691,2053994217,0];var h=function(A){var C=[];for(var B=0,z=0;B<A.length;B++,z+=8){C[z>>>5]|=A[B]<<(24-z%32)}return C};var n=function(B){var A=[];for(var z=0;z<B.length*32;z+=8){A.push((B[z>>>5]>>>(24-z%32))&255)}return A};var x=function(N,J,D){for(var E=0;E<16;E++){var P=D+E;var K=J[P];J[P]=((((K<<8)|(K>>>24))&16711935)|(((K<<24)|(K>>>8))&4278255360))}var G,A,L,F,z;var C,R,I,B,O;C=G=N[0];R=A=N[1];I=L=N[2];B=F=N[3];O=z=N[4];var Q;for(var E=0;E<80;E+=1){Q=(G+J[D+m[E]])|0;if(E<16){Q+=u(A,L,F)+k[0]}else{if(E<32){Q+=t(A,L,F)+k[1]}else{if(E<48){Q+=s(A,L,F)+k[2]}else{if(E<64){Q+=r(A,L,F)+k[3]}else{Q+=q(A,L,F)+k[4]}}}}Q=Q|0;Q=p(Q,w[E]);Q=(Q+z)|0;G=z;z=F;F=p(L,10);L=A;A=Q;Q=(C+J[D+j[E]])|0;if(E<16){Q+=q(R,I,B)+y[0]}else{if(E<32){Q+=r(R,I,B)+y[1]}else{if(E<48){Q+=s(R,I,B)+y[2]}else{if(E<64){Q+=t(R,I,B)+y[3]}else{Q+=u(R,I,B)+y[4]}}}}Q=Q|0;Q=p(Q,v[E]);Q=(Q+O)|0;C=O;O=B;B=p(I,10);I=R;R=Q}Q=(N[1]+L+B)|0;N[1]=(N[2]+F+O)|0;N[2]=(N[3]+z+C)|0;N[3]=(N[4]+G+R)|0;N[4]=(N[0]+A+I)|0;N[0]=Q};function u(A,C,B){return((A)^(C)^(B))}function t(A,C,B){return(((A)&(C))|((~A)&(B)))}function s(A,C,B){return(((A)|(~(C)))^(B))}function r(A,C,B){return(((A)&(B))|((C)&(~(B))))}function q(A,C,B){return((A)^((C)|(~(B))))}function p(z,A){return(z<<A)|(z>>>(32-A))}function i(G){var F=[1732584193,4023233417,2562383102,271733878,3285377520],I=new Uint8Array(G);var A=h(I);var E=I.length*8;var D=I.length*8;A[E>>>5]|=128<<(24-E%32);A[(((E+64)>>>9)<<4)+14]=((((D<<8)|(D>>>24))&16711935)|(((D<<24)|(D>>>8))&4278255360));for(var B=0;B<A.length;B+=16){x(F,A,B)}var z;for(var B=0;B<5;B++){z=F[B];F[B]=(((z<<8)|(z>>>24))&16711935)|(((z<<24)|(z>>>8))&4278255360)}var C=n(F);return new Uint8Array(C).buffer}function o(){var z=this;this.name="RIPEMD160";this.blockSize=64;this.digestSize=20;this.hash=function(A){return i(A)};return this}l.set("hash.algorithms.ripemd160",o)})(b);(function(n){var M,p=10,D=[],F=[],A,z,J,E,I,m,l,j,h,P,O,B="\u1823\uc6E8\u87B8\u014F\u36A6\ud2F5\u796F\u9152\u60Bc\u9B8E\uA30c\u7B35\u1dE0\ud7c2\u2E4B\uFE57\u1577\u37E5\u9FF0\u4AdA\u58c9\u290A\uB1A0\u6B85\uBd5d\u10F4\ucB3E\u0567\uE427\u418B\uA77d\u95d8\uFBEE\u7c66\udd17\u479E\ucA2d\uBF07\uAd5A\u8333\u6302\uAA71\uc819\u49d9\uF2E3\u5B88\u9A26\u32B0\uE90F\ud580\uBEcd\u3448\uFF7A\u905F\u2068\u1AAE\uB454\u9322\u64F1\u7312\u4008\uc3Ec\udBA1\u8d3d\u9700\ucF2B\u7682\ud61B\uB5AF\u6A50\u45F3\u30EF\u3F55\uA2EA\u65BA\u2Fc0\udE1c\uFd4d\u9275\u068A\uB2E6\u0E1F\u62d4\uA896\uF9c5\u2559\u8472\u394c\u5E78\u388c\ud1A5\uE261\uB321\u9c1E\u43c7\uFc04\u5199\u6d0d\uFAdF\u7E24\u3BAB\ucE11\u8F4E\uB7EB\u3c81\u94F7\uB913\u2cd3\uE76E\uc403\u5644\u7FA9\u2ABB\uc153\udc0B\u9d6c\u3174\uF646\uAc89\u14E1\u163A\u6909\u70B6\ud0Ed\ucc42\u98A4\u285c\uF886";for(A=8;A-->0;){D[A]=[]}for(z=0;z<256;z++){J=B.charCodeAt(z/2);m=((z&1)==0)?J>>>8:J&255;l=m<<1;if(l>=256){l^=285}j=l<<1;if(j>=256){j^=285}h=j^m;P=j<<1;if(P>=256){P^=285}O=P^m;D[0][z]=[0,0];D[0][z][0]=(m<<24)|(m<<16)|(j<<8)|(m);D[0][z][1]=(P<<24)|(h<<16)|(l<<8)|(O);for(var A=1;A<8;A++){D[A][z]=[0,0];D[A][z][0]=(D[A-1][z][0]>>>8)|((D[A-1][z][1]<<24));D[A][z][1]=(D[A-1][z][1]>>>8)|((D[A-1][z][0]<<24))}}F[0]=[0,0];for(E=1;E<=p;E++){I=8*(E-1);F[E]=[0,0];F[E][0]=(D[0][I][0]&4278190080)^(D[1][I+1][0]&16711680)^(D[2][I+2][0]&65280)^(D[3][I+3][0]&255);F[E][1]=(D[4][I+4][1]&4278190080)^(D[5][I+5][1]&16711680)^(D[6][I+6][1]&65280)^(D[7][I+7][1]&255)}var H=[],G=[],v=0,q=0,k=[],w=[],u=[],s=[],o=[];var N=function(){var K,x,Q,L,C;for(K=0,x=0;K<8;K++,x+=8){s[K]=[0,0];s[K][0]=((G[x]&255)<<24)^((G[x+1]&255)<<16)^((G[x+2]&255)<<8)^((G[x+3]&255));s[K][1]=((G[x+4]&255)<<24)^((G[x+5]&255)<<16)^((G[x+6]&255)<<8)^((G[x+7]&255))}for(K=0;K<8;K++){o[K]=[0,0];w[K]=[0,0];o[K][0]=s[K][0]^(w[K][0]=k[K][0]);o[K][1]=s[K][1]^(w[K][1]=k[K][1])}for(Q=1;Q<=p;Q++){for(K=0;K<8;K++){u[K]=[0,0];for(C=0,L=56,x=0;C<8;C++,L-=8,x=L<32?1:0){u[K][0]^=D[C][(w[(K-C)&7][x]>>>(L%32))&255][0];u[K][1]^=D[C][(w[(K-C)&7][x]>>>(L%32))&255][1]}}for(K=0;K<8;K++){w[K][0]=u[K][0];w[K][1]=u[K][1]}w[0][0]^=F[Q][0];w[0][1]^=F[Q][1];for(K=0;K<8;K++){u[K][0]=w[K][0];u[K][1]=w[K][1];for(C=0,L=56,x=0;C<8;C++,L-=8,x=L<32?1:0){u[K][0]^=D[C][(o[(K-C)&7][x]>>>(L%32))&255][0];u[K][1]^=D[C][(o[(K-C)&7][x]>>>(L%32))&255][1]}}for(K=0;K<8;K++){o[K][0]=u[K][0];o[K][1]=u[K][1]}}for(K=0;K<8;K++){k[K][0]^=o[K][0]^s[K][0];k[K][1]^=o[K][1]^s[K][1]}};M=Whirlpool=function(i){return M.init().add(i).finalize()};M.version="3.0";M.init=function(){for(var r=32;r-->0;){H[r]=0}v=q=0;G=[0];for(r=8;r-->0;){k[r]=[0,0]}return M};M.add=function(L){if(!L){return M}var r=new Uint8Array(L);var T=r.length*8;var t=0,x=(8-(T&7))&7,K=v&7,C,Q,S,R=T;for(C=31,S=0;C>=0;C--){S+=(H[C]&255)+(R%256);H[C]=S&255;S>>>=8;R=Math.floor(R/256)}while(T>8){Q=((r[t]<<x)&255)|((r[t+1]&255)>>>(8-x));if(Q<0||Q>=256){return"Whirlpool requires a byte array"}G[q++]|=Q>>>K;v+=8-K;if(v==512){N();v=q=0;G=[]}G[q]=((Q<<(8-K))&255);v+=K;T-=8;t++}if(T>0){Q=(r[t]<<x)&255;G[q]|=Q>>>K}else{Q=0}if(K+T<8){v+=T}else{q++;v+=8-K;T-=8-K;if(v==512){N();v=q=0;G=[]}G[q]=((Q<<(8-K))&255);v+=T}return M};M.finalize=function(){var t,r,x,K="",C=[];G[q]|=128>>>(v&7);q++;if(q>32){while(q<64){G[q++]=0}N();q=0;G=[]}while(q<32){G[q++]=0}G.push.apply(G,H);N();for(t=0,r=0;t<8;t++,r+=8){x=k[t][0];C[r]=x>>>24&255;C[r+1]=x>>>16&255;C[r+2]=x>>>8&255;C[r+3]=x&255;x=k[t][1];C[r+4]=x>>>24&255;C[r+5]=x>>>16&255;C[r+6]=x>>>8&255;C[r+7]=x&255}return new Uint8Array(C).buffer};function y(){var i=this;this.name="WHIRLPOOL";this.blockSize=64;this.digestSize=64;this.hash=function(r){return Whirlpool(r)};return this}n.set("hash.algorithms.whirlpool",y)})(b);(function(ba){var bf;var aT=244837814094590;var aG=((aT&16777215)==15715070);function a2(bk,bj,bl){if(!(this instanceof a2)){return new a2(bk,bj,bl)}if(bk!=null){if("number"==typeof bk){this.fromNumber(bk,bj,bl)}else{if(bj==null&&"string"!=typeof bk){this.fromString(bk,256)}else{this.fromString(bk,bj)}}}}var bc=a2.prototype;function s(){return new a2(null)}function h(bn,bj,bk,bm,bp,bo){while(--bo>=0){var bl=bj*this[bn++]+bk[bm]+bp;bp=Math.floor(bl/67108864);bk[bm++]=bl&67108863}return bp}function bh(bn,bs,bt,bm,bq,bj){var bp=bs&32767,br=bs>>15;while(--bj>=0){var bl=this[bn]&32767;var bo=this[bn++]>>15;var bk=br*bl+bo*bp;bl=bp*bl+((bk&32767)<<15)+bt[bm]+(bq&1073741823);bq=(bl>>>30)+(bk>>>15)+br*bo+(bq>>>30);bt[bm++]=bl&1073741823}return bq}function bg(bn,bs,bt,bm,bq,bj){var bp=bs&16383,br=bs>>14;while(--bj>=0){var bl=this[bn]&16383;var bo=this[bn++]>>14;var bk=br*bl+bo*bp;bl=bp*bl+((bk&16383)<<14)+bt[bm]+bq;bq=(bl>>28)+(bk>>14)+br*bo;bt[bm++]=bl&268435455}return bq}a2.prototype.am=h;bf=26;a2.prototype.DB=bf;a2.prototype.DM=((1<<bf)-1);var ap=a2.prototype.DV=(1<<bf);var aH=52;a2.prototype.FV=Math.pow(2,aH);a2.prototype.F1=aH-bf;a2.prototype.F2=2*bf-aH;var aP="0123456789abcdefghijklmnopqrstuvwxyz";var aS=new Array();var a0,H;a0="0".charCodeAt(0);for(H=0;H<=9;++H){aS[a0++]=H}a0="a".charCodeAt(0);for(H=10;H<36;++H){aS[a0++]=H}a0="A".charCodeAt(0);for(H=10;H<36;++H){aS[a0++]=H}function bi(bj){return aP.charAt(bj)}function R(bk,bj){var bl=aS[bk.charCodeAt(bj)];return(bl==null)?-1:bl}function aF(bk){for(var bj=this.t-1;bj>=0;--bj){bk[bj]=this[bj]}bk.t=this.t;bk.s=this.s}function B(bj){this.t=1;this.s=(bj<0)?-1:0;if(bj>0){this[0]=bj}else{if(bj<-1){this[0]=bj+ap}else{this.t=0}}}function k(bj){var bk=s();bk.fromInt(bj);return bk}function K(bq,bk){var bn=this;var bm;if(bk==16){bm=4}else{if(bk==8){bm=3}else{if(bk==256){bm=8}else{if(bk==2){bm=1}else{if(bk==32){bm=5}else{if(bk==4){bm=2}else{bn.fromRadix(bq,bk);return}}}}}}bn.t=0;bn.s=0;var bp=bq.length,bl=false,bo=0;while(--bp>=0){var bj=(bm==8)?bq[bp]&255:R(bq,bp);if(bj<0){if(bq.charAt(bp)=="-"){bl=true}continue}bl=false;if(bo==0){bn[bn.t++]=bj}else{if(bo+bm>bn.DB){bn[bn.t-1]|=(bj&((1<<(bn.DB-bo))-1))<<bo;bn[bn.t++]=(bj>>(bn.DB-bo))}else{bn[bn.t-1]|=bj<<bo}}bo+=bm;if(bo>=bn.DB){bo-=bn.DB}}if(bm==8&&(bq[0]&128)!=0){bn.s=-1;if(bo>0){bn[bn.t-1]|=((1<<(bn.DB-bo))-1)<<bo}}bn.clamp();if(bl){a2.ZERO.subTo(bn,bn)}}function ak(){var bj=this.s&this.DM;while(this.t>0&&this[this.t-1]==bj){--this.t}}function D(bq){var br=this;if(br.s<0){return"-"+br.negate().toString(bq)}var bn;if(bq==16){bn=4}else{if(bq==8){bn=3}else{if(bq==2){bn=1}else{if(bq==32){bn=5}else{if(bq==4){bn=2}else{return br.toRadix(bq)}}}}}var bk=(1<<bn)-1,bp,bm=false,bj="",bo=br.t;var bl=br.DB-(bo*br.DB)%bn;if(bo-->0){if(bl<br.DB&&(bp=br[bo]>>bl)>0){bm=true;bj=bi(bp)}while(bo>=0){if(bl<bn){bp=(br[bo]&((1<<bl)-1))<<(bn-bl);bp|=br[--bo]>>(bl+=br.DB-bn)}else{bp=(br[bo]>>(bl-=bn))&bk;if(bl<=0){bl+=br.DB;--bo}}if(bp>0){bm=true}if(bm){bj+=bi(bp)}}}return bm?bj:"0"}function ao(){var bj=s();a2.ZERO.subTo(this,bj);return bj}function aW(){return(this.s<0)?this.negate():this}function ab(bj){var bl=this.s-bj.s;if(bl!=0){return bl}var bk=this.t;bl=bk-bj.t;if(bl!=0){return(this.s<0)?-bl:bl}while(--bk>=0){if((bl=this[bk]-bj[bk])!=0){return bl}}return 0}function x(bj){var bl=1,bk;if((bk=bj>>>16)!=0){bj=bk;bl+=16}if((bk=bj>>8)!=0){bj=bk;bl+=8}if((bk=bj>>4)!=0){bj=bk;bl+=4}if((bk=bj>>2)!=0){bj=bk;bl+=2}if((bk=bj>>1)!=0){bj=bk;bl+=1}return bl}function G(){if(this.t<=0){return 0}return this.DB*(this.t-1)+x(this[this.t-1]^(this.s&this.DM))}function a1(bl,bk){var bj;for(bj=this.t-1;bj>=0;--bj){bk[bj+bl]=this[bj]}for(bj=bl-1;bj>=0;--bj){bk[bj]=0}bk.t=this.t+bl;bk.s=this.s}function aE(bl,bk){for(var bj=bl;bj<this.t;++bj){bk[bj-bl]=this[bj]}bk.t=Math.max(this.t-bl,0);bk.s=this.s}function F(bl,bj){var bt=this;var br=bl%bt.DB;var bp=bt.DB-br;var bk=(1<<bp)-1;var bn=Math.floor(bl/bt.DB),bq=(bt.s<<br)&bt.DM,bo;for(bo=bt.t-1;bo>=0;--bo){bj[bo+bn+1]=(bt[bo]>>bp)|bq;bq=(bt[bo]&bk)<<br}for(bo=bn-1;bo>=0;--bo){bj[bo]=0}bj[bn]=bq;bj.t=bt.t+bn+1;bj.s=bt.s;bj.clamp()}function y(br,bo){var bj=this;bo.s=bj.s;var bp=Math.floor(br/bj.DB);if(bp>=bj.t){bo.t=0;return}var bl=br%bj.DB;var bk=bj.DB-bl;var bq=(1<<bl)-1;bo[0]=bj[bp]>>bl;for(var bn=bp+1;bn<bj.t;++bn){bo[bn-bp-1]|=(bj[bn]&bq)<<bk;bo[bn-bp]=bj[bn]>>bl}if(bl>0){bo[bj.t-bp-1]|=(bj.s&bq)<<bk}bo.t=bj.t-bp;bo.clamp()}function aI(bk,bn){var bl=this;var bm=0,bo=0,bj=Math.min(bk.t,bl.t);while(bm<bj){bo+=bl[bm]-bk[bm];bn[bm++]=bo&bl.DM;bo>>=bl.DB}if(bk.t<bl.t){bo-=bk.s;while(bm<bl.t){bo+=bl[bm];bn[bm++]=bo&bl.DM;bo>>=bl.DB}bo+=bl.s}else{bo+=bl.s;while(bm<bk.t){bo-=bk[bm];bn[bm++]=bo&bl.DM;bo>>=bl.DB}bo-=bk.s}bn.s=(bo<0)?-1:0;if(bo<-1){bn[bm++]=bl.DV+bo}else{if(bo>0){bn[bm++]=bo}}bn.t=bm;bn.clamp()}function W(bk,bm){var bj=this.abs(),bn=bk.abs();var bl=bj.t;bm.t=bl+bn.t;while(--bl>=0){bm[bl]=0}for(bl=0;bl<bn.t;++bl){bm[bl+bj.t]=bj.am(0,bn[bl],bm,bl,0,bj.t)}bm.s=0;bm.clamp();if(this.s!=bk.s){a2.ZERO.subTo(bm,bm)}}function am(bl){var bj=this.abs();var bk=bl.t=2*bj.t;while(--bk>=0){bl[bk]=0}for(bk=0;bk<bj.t-1;++bk){var bm=bj.am(bk,bj[bk],bl,2*bk,0,1);if((bl[bk+bj.t]+=bj.am(bk+1,2*bj[bk],bl,2*bk+1,bm,bj.t-bk-1))>=bj.DV){bl[bk+bj.t]-=bj.DV;bl[bk+bj.t+1]=1}}if(bl.t>0){bl[bl.t-1]+=bj.am(bk,bj[bk],bl,2*bk,0,1)}bl.s=0;bl.clamp()}function X(bt,bq,bo){var bp=this;var bz=bt.abs();if(bz.t<=0){return}var br=bp.abs();if(br.t<bz.t){if(bq!=null){bq.fromInt(0)}if(bo!=null){bp.copyTo(bo)}return}if(bo==null){bo=s()}var bm=s(),bj=bp.s,bs=bt.s;var by=bp.DB-x(bz[bz.t-1]);if(by>0){bz.lShiftTo(by,bm);br.lShiftTo(by,bo)}else{bz.copyTo(bm);br.copyTo(bo)}var bw=bm.t;var bk=bm[bw-1];if(bk==0){return}var bu=bk*(1<<bp.F1)+((bw>1)?bm[bw-2]>>bp.F2:0);var bC=bp.FV/bu,bB=(1<<bp.F1)/bu,bA=1<<bp.F2;var bx=bo.t,bv=bx-bw,bn=(bq==null)?s():bq;bm.dlShiftTo(bv,bn);if(bo.compareTo(bn)>=0){bo[bo.t++]=1;bo.subTo(bn,bo)}a2.ONE.dlShiftTo(bw,bn);bn.subTo(bm,bm);while(bm.t<bw){bm[bm.t++]=0}while(--bv>=0){var bl=(bo[--bx]==bk)?bp.DM:Math.floor(bo[bx]*bC+(bo[bx-1]+bA)*bB);if((bo[bx]+=bm.am(0,bl,bo,bv,0,bw))<bl){bm.dlShiftTo(bv,bn);bo.subTo(bn,bo);while(bo[bx]<--bl){bo.subTo(bn,bo)}}}if(bq!=null){bo.drShiftTo(bw,bq);if(bj!=bs){a2.ZERO.subTo(bq,bq)}}bo.t=bw;bo.clamp();if(by>0){bo.rShiftTo(by,bo)}if(bj<0){a2.ZERO.subTo(bo,bo)}}function aj(bj){var bk=s();this.abs().divRemTo(bj,null,bk);if(this.s<0&&bk.compareTo(a2.ZERO)>0){bj.subTo(bk,bk)}return bk}function af(bj){this.m=bj}function aA(bj){if(bj.s<0||bj.compareTo(this.m)>=0){return bj.mod(this.m)}else{return bj}}function aV(bj){return bj}function ad(bj){bj.divRemTo(this.m,null,bj)}function ac(bj,bl,bk){bj.multiplyTo(bl,bk);this.reduce(bk)}function a7(bj,bk){bj.squareTo(bk);this.reduce(bk)}af.prototype.convert=aA;af.prototype.revert=aV;af.prototype.reduce=ad;af.prototype.mulTo=ac;af.prototype.sqrTo=a7;function T(){if(this.t<1){return 0}var bj=this[0];if((bj&1)==0){return 0}var bk=bj&3;bk=(bk*(2-(bj&15)*bk))&15;bk=(bk*(2-(bj&255)*bk))&255;bk=(bk*(2-(((bj&65535)*bk)&65535)))&65535;bk=(bk*(2-bj*bk%this.DV))%this.DV;return(bk>0)?this.DV-bk:-bk}function o(bj){this.m=bj;this.mp=bj.invDigit();this.mpl=this.mp&32767;this.mph=this.mp>>15;this.um=(1<<(bj.DB-15))-1;this.mt2=2*bj.t}function aU(bj){var bk=s();bj.abs().dlShiftTo(this.m.t,bk);bk.divRemTo(this.m,null,bk);if(bj.s<0&&bk.compareTo(a2.ZERO)>0){this.m.subTo(bk,bk)}return bk}function a5(bj){var bk=s();bj.copyTo(bk);this.reduce(bk);return bk}function al(bj){while(bj.t<=this.mt2){bj[bj.t++]=0}for(var bl=0;bl<this.m.t;++bl){var bk=bj[bl]&32767;var bm=(bk*this.mpl+(((bk*this.mph+(bj[bl]>>15)*this.mpl)&this.um)<<15))&bj.DM;bk=bl+this.m.t;bj[bk]+=this.m.am(0,bm,bj,bl,0,this.m.t);while(bj[bk]>=bj.DV){bj[bk]-=bj.DV;bj[++bk]++}}bj.clamp();bj.drShiftTo(this.m.t,bj);if(bj.compareTo(this.m)>=0){bj.subTo(this.m,bj)}}function aX(bj,bk){bj.squareTo(bk);this.reduce(bk)}function Q(bj,bl,bk){bj.multiplyTo(bl,bk);this.reduce(bk)}o.prototype.convert=aU;o.prototype.revert=a5;o.prototype.reduce=al;o.prototype.mulTo=Q;o.prototype.sqrTo=aX;function t(){return((this.t>0)?(this[0]&1):this.s)==0}function L(bo,bp){if(bo>4294967295||bo<1){return a2.ONE}var bn=s(),bj=s(),bm=bp.convert(this),bl=x(bo)-1;bm.copyTo(bn);while(--bl>=0){bp.sqrTo(bn,bj);if((bo&(1<<bl))>0){bp.mulTo(bj,bm,bn)}else{var bk=bn;bn=bj;bj=bk}}return bp.revert(bn)}function aZ(bk,bj){var bl;if(bk<256||bj.isEven()){bl=new af(bj)}else{bl=new o(bj)}return this.exp(bk,bl)}bc.copyTo=aF;bc.fromInt=B;bc.fromString=K;bc.clamp=ak;bc.dlShiftTo=a1;bc.drShiftTo=aE;bc.lShiftTo=F;bc.rShiftTo=y;bc.subTo=aI;bc.multiplyTo=W;bc.squareTo=am;bc.divRemTo=X;bc.invDigit=T;bc.isEven=t;bc.exp=L;bc.toString=D;bc.negate=ao;bc.abs=aW;bc.compareTo=ab;bc.bitLength=G;bc.mod=aj;bc.modPowInt=aZ;function s(){return new a2(null)}function q(){var bj=s();this.copyTo(bj);return bj}function Z(){if(this.s<0){if(this.t==1){return this[0]-this.DV}else{if(this.t==0){return -1}}}else{if(this.t==1){return this[0]}else{if(this.t==0){return 0}}}return((this[1]&((1<<(32-this.DB))-1))<<this.DB)|this[0]}function aQ(){return(this.t==0)?this.s:(this[0]<<24)>>24}function an(){return(this.t==0)?this.s:(this[0]<<16)>>16}function aD(bj){return Math.floor(Math.LN2*this.DB/Math.log(bj))}function a3(){if(this.s<0){return -1}else{if(this.t<=0||(this.t==1&&this[0]<=0)){return 0}else{return 1}}}function O(bj){if(bj==null){bj=10}if(this.signum()==0||bj<2||bj>36){return"0"}var bl=this.chunkSize(bj);var bk=Math.pow(bj,bl);var bo=k(bk),bp=s(),bn=s(),bm="";this.divRemTo(bo,bp,bn);while(bp.signum()>0){bm=(bk+bn.intValue()).toString(bj).substr(1)+bm;bp.divRemTo(bo,bp,bn)}return bn.intValue().toString(bj)+bm}function au(bs,bo){var br=this;br.fromInt(0);if(bo==null){bo=10}var bm=br.chunkSize(bo);var bn=Math.pow(bo,bm),bl=false,bj=0,bq=0;for(var bk=0;bk<bs.length;++bk){var bp=R(bs,bk);if(bp<0){if(bs.charAt(bk)=="-"&&br.signum()==0){bl=true}continue}bq=bo*bq+bp;if(++bj>=bm){br.dMultiply(bn);br.dAddOffset(bq,0);bj=0;bq=0}}if(bj>0){br.dMultiply(Math.pow(bo,bj));br.dAddOffset(bq,0)}if(bl){a2.ZERO.subTo(br,br)}}function aN(bl,bk,bo){var bm=this;if("number"==typeof bk){if(bl<2){bm.fromInt(1)}else{bm.fromNumber(bl,bo);if(!bm.testBit(bl-1)){bm.bitwiseTo(a2.ONE.shiftLeft(bl-1),ag,bm)}if(bm.isEven()){bm.dAddOffset(1,0)}while(!bm.isProbablePrime(bk)){bm.dAddOffset(2,0);if(bm.bitLength()>bl){bm.subTo(a2.ONE.shiftLeft(bl-1),bm)}}}}else{var bj=new Array(),bn=bl&7;bj.length=(bl>>3)+1;bk.nextBytes(bj);if(bn>0){bj[0]&=((1<<bn)-1)}else{bj[0]=0}bm.fromString(bj,256)}}function bb(){var bk=this;var bl=bk.t,bm=new Array();bm[0]=bk.s;var bn=bk.DB-(bl*bk.DB)%8,bo,bj=0;if(bl-->0){if(bn<bk.DB&&(bo=bk[bl]>>bn)!=(bk.s&bk.DM)>>bn){bm[bj++]=bo|(bk.s<<(bk.DB-bn))}while(bl>=0){if(bn<8){bo=(bk[bl]&((1<<bn)-1))<<(8-bn);bo|=bk[--bl]>>(bn+=bk.DB-8)}else{bo=(bk[bl]>>(bn-=8))&255;if(bn<=0){bn+=bk.DB;--bl}}if((bo&128)!=0){bo|=-256}if(bj===0&&(bk.s&128)!=(bo&128)){++bj}if(bj>0||bo!=bk.s){bm[bj++]=bo}}}return bm}function ar(bj){return(this.compareTo(bj)==0)}function aa(bj){return(this.compareTo(bj)<0)?this:bj}function ay(bj){return(this.compareTo(bj)>0)?this:bj}function aO(bk,bp,bn){var bl=this;var bm,bo,bj=Math.min(bk.t,bl.t);for(bm=0;bm<bj;++bm){bn[bm]=bp(bl[bm],bk[bm])}if(bk.t<bl.t){bo=bk.s&bl.DM;for(bm=bj;bm<bl.t;++bm){bn[bm]=bp(bl[bm],bo)}bn.t=bl.t}else{bo=bl.s&bl.DM;for(bm=bj;bm<bk.t;++bm){bn[bm]=bp(bo,bk[bm])}bn.t=bk.t}bn.s=bp(bl.s,bk.s);bn.clamp()}function P(bj,bk){return bj&bk}function be(bj){var bk=s();this.bitwiseTo(bj,P,bk);return bk}function ag(bj,bk){return bj|bk}function aC(bj){var bk=s();this.bitwiseTo(bj,ag,bk);return bk}function U(bj,bk){return bj^bk}function m(bj){var bk=s();this.bitwiseTo(bj,U,bk);return bk}function I(bj,bk){return bj&~bk}function z(bj){var bk=s();this.bitwiseTo(bj,I,bk);return bk}function V(){var bk=s();for(var bj=0;bj<this.t;++bj){bk[bj]=this.DM&~this[bj]}bk.t=this.t;bk.s=~this.s;return bk}function J(bk){var bj=s();if(bk<0){this.rShiftTo(-bk,bj)}else{this.lShiftTo(bk,bj)}return bj}function bd(bk){var bj=s();if(bk<0){this.lShiftTo(-bk,bj)}else{this.rShiftTo(bk,bj)}return bj}function v(bj){if(bj==0){return -1}var bk=0;if((bj&65535)==0){bj>>=16;bk+=16}if((bj&255)==0){bj>>=8;bk+=8}if((bj&15)==0){bj>>=4;bk+=4}if((bj&3)==0){bj>>=2;bk+=2}if((bj&1)==0){++bk}return bk}function C(){for(var bj=0;bj<this.t;++bj){if(this[bj]!=0){return bj*this.DB+v(this[bj])}}if(this.s<0){return this.t*this.DB}return -1}function aY(bj){var bk=0;while(bj!=0){bj&=bj-1;++bk}return bk}function aM(){var bl=0,bj=this.s&this.DM;for(var bk=0;bk<this.t;++bk){bl+=aY(this[bk]^bj)}return bl}function aK(bk){var bj=Math.floor(bk/this.DB);if(bj>=this.t){return(this.s!=0)}return((this[bj]&(1<<(bk%this.DB)))!=0)}function Y(bl,bk){var bj=a2.ONE.shiftLeft(bl);this.bitwiseTo(bj,bk,bj);return bj}function S(bj){return this.changeBit(bj,ag)}function A(bj){return this.changeBit(bj,I)}function j(bj){return this.changeBit(bj,U)}function av(bk,bn){var bl=this;var bm=0,bo=0,bj=Math.min(bk.t,bl.t);while(bm<bj){bo+=bl[bm]+bk[bm];bn[bm++]=bo&bl.DM;bo>>=bl.DB}if(bk.t<bl.t){bo+=bk.s;while(bm<bl.t){bo+=bl[bm];bn[bm++]=bo&bl.DM;bo>>=bl.DB}bo+=bl.s}else{bo+=bl.s;while(bm<bk.t){bo+=bk[bm];bn[bm++]=bo&bl.DM;bo>>=bl.DB}bo+=bk.s}bn.s=(bo<0)?-1:0;if(bo>0){bn[bm++]=bo}else{if(bo<-1){bn[bm++]=bl.DV+bo}}bn.t=bm;bn.clamp()}function ax(bj){var bk=s();this.addTo(bj,bk);return bk}function a4(bj){var bk=s();this.subTo(bj,bk);return bk}function aq(bj){var bk=s();this.multiplyTo(bj,bk);return bk}function aJ(){var bj=s();this.squareTo(bj);return bj}function l(bj){var bk=s();this.divRemTo(bj,bk,null);return bk}function p(bj){var bk=s();this.divRemTo(bj,null,bk);return bk}function aL(bj){var bl=s(),bk=s();this.divRemTo(bj,bl,bk);return new Array(bl,bk)}function u(bj){this[this.t]=this.am(0,bj-1,this,0,0,this.t);++this.t;this.clamp()}function ai(bk,bj){if(bk==0){return}while(this.t<=bj){this[this.t++]=0}this[bj]+=bk;while(this[bj]>=this.DV){this[bj]-=this.DV;if(++bj>=this.t){this[this.t++]=0}++this[bj]}}function aw(){}function aR(bj){return bj}function w(bj,bl,bk){bj.multiplyTo(bl,bk)}function aB(bj,bk){bj.squareTo(bk)}aw.prototype.convert=aR;aw.prototype.revert=aR;aw.prototype.mulTo=w;aw.prototype.sqrTo=aB;function M(bj){return this.exp(bj,new aw())}function r(bj,bn,bm){var bl=Math.min(this.t+bj.t,bn);bm.s=0;bm.t=bl;while(bl>0){bm[--bl]=0}var bk;for(bk=bm.t-this.t;bl<bk;++bl){bm[bl+this.t]=this.am(0,bj[bl],bm,bl,0,this.t)}for(bk=Math.min(bj.t,bn);bl<bk;++bl){this.am(0,bj[bl],bm,bl,0,bn-bl)}bm.clamp()}function n(bj,bm,bl){--bm;var bk=bl.t=this.t+bj.t-bm;bl.s=0;while(--bk>=0){bl[bk]=0}for(bk=Math.max(bm-this.t,0);bk<bj.t;++bk){bl[this.t+bk-bm]=this.am(bm-bk,bj[bk],bl,0,0,this.t+bk-bm)}bl.clamp();bl.drShiftTo(1,bl)}function N(bj){this.r2=s();this.q3=s();a2.ONE.dlShiftTo(2*bj.t,this.r2);this.mu=this.r2.divide(bj);this.m=bj}function ae(bj){if(bj.s<0||bj.t>2*this.m.t){return bj.mod(this.m)}else{if(bj.compareTo(this.m)<0){return bj}else{var bk=s();bj.copyTo(bk);this.reduce(bk);return bk}}}function ah(bj){return bj}function a8(bj){var bk=this;bj.drShiftTo(bk.m.t-1,bk.r2);if(bj.t>bk.m.t+1){bj.t=bk.m.t+1;bj.clamp()}bk.mu.multiplyUpperTo(bk.r2,bk.m.t+1,bk.q3);bk.m.multiplyLowerTo(bk.q3,bk.m.t+1,bk.r2);while(bj.compareTo(bk.r2)<0){bj.dAddOffset(1,bk.m.t+1)}bj.subTo(bk.r2,bj);while(bj.compareTo(bk.m)>=0){bj.subTo(bk.m,bj)}}function at(bj,bk){bj.squareTo(bk);this.reduce(bk)}function a9(bj,bl,bk){bj.multiplyTo(bl,bk);this.reduce(bk)}N.prototype.convert=ae;N.prototype.revert=ah;N.prototype.reduce=a8;N.prototype.mulTo=a9;N.prototype.sqrTo=at;function az(bs,bn){var bq=bs.bitLength(),bo,bk=k(1),bv;if(bq<=0){return bk}else{if(bq<18){bo=1}else{if(bq<48){bo=3}else{if(bq<144){bo=4}else{if(bq<768){bo=5}else{bo=6}}}}}if(bq<8){bv=new af(bn)}else{if(bn.isEven()){bv=new N(bn)}else{bv=new o(bn)}}var br=new Array(),bm=3,bt=bo-1,bj=(1<<bo)-1;br[1]=bv.convert(this);if(bo>1){var by=s();bv.sqrTo(br[1],by);while(bm<=bj){br[bm]=s();bv.mulTo(by,br[bm-2],br[bm]);bm+=2}}var bp=bs.t-1,bw,bu=true,bl=s(),bx;bq=x(bs[bp])-1;while(bp>=0){if(bq>=bt){bw=(bs[bp]>>(bq-bt))&bj}else{bw=(bs[bp]&((1<<(bq+1))-1))<<(bt-bq);if(bp>0){bw|=bs[bp-1]>>(this.DB+bq-bt)}}bm=bo;while((bw&1)==0){bw>>=1;--bm}if((bq-=bm)<0){bq+=this.DB;--bp}if(bu){br[bw].copyTo(bk);bu=false}else{while(bm>1){bv.sqrTo(bk,bl);bv.sqrTo(bl,bk);bm-=2}if(bm>0){bv.sqrTo(bk,bl)}else{bx=bk;bk=bl;bl=bx}bv.mulTo(bl,br[bw],bk)}while(bp>=0&&(bs[bp]&(1<<bq))==0){bv.sqrTo(bk,bl);bx=bk;bk=bl;bl=bx;if(--bq<0){bq=this.DB-1;--bp}}}return bv.revert(bk)}function a6(bk){var bj=(this.s<0)?this.negate():this.clone();var bo=(bk.s<0)?bk.negate():bk.clone();if(bj.compareTo(bo)<0){var bm=bj;bj=bo;bo=bm}var bl=bj.getLowestSetBit(),bn=bo.getLowestSetBit();if(bn<0){return bj}if(bl<bn){bn=bl}if(bn>0){bj.rShiftTo(bn,bj);bo.rShiftTo(bn,bo)}while(bj.signum()>0){if((bl=bj.getLowestSetBit())>0){bj.rShiftTo(bl,bj)}if((bl=bo.getLowestSetBit())>0){bo.rShiftTo(bl,bo)}if(bj.compareTo(bo)>=0){bj.subTo(bo,bj);bj.rShiftTo(1,bj)}else{bo.subTo(bj,bo);bo.rShiftTo(1,bo)}}if(bn>0){bo.lShiftTo(bn,bo)}return bo}function E(bm){if(bm<=0){return 0}var bl=this.DV%bm,bk=(this.s<0)?bm-1:0;if(this.t>0){if(bl==0){bk=this[0]%bm}else{for(var bj=this.t-1;bj>=0;--bj){bk=(bl*bk+this[bj])%bm}}}return bk}function i(bk){var bo=bk.isEven();if((this.isEven()&&bo)||bk.signum()==0){return a2.ZERO}var bn=bk.clone(),bm=this.clone();var bl=k(1),bj=k(0),bq=k(0),bp=k(1);while(bn.signum()!=0){while(bn.isEven()){bn.rShiftTo(1,bn);if(bo){if(!bl.isEven()||!bj.isEven()){bl.addTo(this,bl);bj.subTo(bk,bj)}bl.rShiftTo(1,bl)}else{if(!bj.isEven()){bj.subTo(bk,bj)}}bj.rShiftTo(1,bj)}while(bm.isEven()){bm.rShiftTo(1,bm);if(bo){if(!bq.isEven()||!bp.isEven()){bq.addTo(this,bq);bp.subTo(bk,bp)}bq.rShiftTo(1,bq)}else{if(!bp.isEven()){bp.subTo(bk,bp)}}bp.rShiftTo(1,bp)}if(bn.compareTo(bm)>=0){bn.subTo(bm,bn);if(bo){bl.subTo(bq,bl)}bj.subTo(bp,bj)}else{bm.subTo(bn,bm);if(bo){bq.subTo(bl,bq)}bp.subTo(bj,bp)}}if(bm.compareTo(a2.ONE)!=0){return a2.ZERO}if(bp.compareTo(bk)>=0){return bp.subtract(bk)}if(bp.signum()<0){bp.addTo(bk,bp)}else{return bp}if(bp.signum()<0){return bp.add(bk)}else{return bp}}bc.chunkSize=aD;bc.toRadix=O;bc.fromRadix=au;bc.fromNumber=aN;bc.bitwiseTo=aO;bc.changeBit=Y;bc.addTo=av;bc.dMultiply=u;bc.dAddOffset=ai;bc.multiplyLowerTo=r;bc.multiplyUpperTo=n;bc.modInt=E;bc.clone=q;bc.intValue=Z;bc.byteValue=aQ;bc.shortValue=an;bc.signum=a3;bc.toByteArray=bb;bc.equals=ar;bc.min=aa;bc.max=ay;bc.and=be;bc.or=aC;bc.xor=m;bc.andNot=z;bc.not=V;bc.shiftLeft=J;bc.shiftRight=bd;bc.getLowestSetBit=C;bc.bitCount=aM;bc.testBit=aK;bc.setBit=S;bc.clearBit=A;bc.flipBit=j;bc.add=ax;bc.subtract=a4;bc.multiply=aq;bc.divide=l;bc.remainder=p;bc.divideAndRemainder=aL;bc.modPow=az;bc.modInverse=i;bc.pow=M;bc.gcd=a6;bc.square=aJ;a2.ZERO=k(0);a2.ONE=k(1);a2.valueOf=k;a2.fromByteArrayUnsigned=function(bj){if(!bj.length){return new a2.valueOf(0)}else{if(bj[0]&128){return new a2([0].concat(bj))}else{return new a2(bj)}}};a2.fromByteArraySigned=function(bj){if(bj[0]&128){bj[0]&=127;return a2.fromByteArrayUnsigned(bj).negate()}else{return a2.fromByteArrayUnsigned(bj)}};a2.prototype.toByteArrayUnsigned=function(){var bk=this.abs().toByteArray();if(!bk.length){return bk}if(bk[0]===0){bk=bk.slice(1)}for(var bj=0;bj<bk.length;++bj){bk[bj]=(bk[bj]<0)?bk[bj]+256:bk[bj]}return bk};a2.prototype.toByteArraySigned=function(){var bj=this.toByteArrayUnsigned();var bk=this.s<0;if(bj[0]&128){bj.unshift((bk)?128:0)}else{if(bk){bj[0]|=128}}return bj};ba.set("cipher.asymmetric.ec.bigi",a2)})(b);(function(i){function h(n,m){var j=n.ECPointFp;function k(u,q,t,p){var o=Math.max(q.bitLength(),p.bitLength());var v=u.add2D(t);var s=u.curve.getInfinity();for(var r=o-1;r>=0;--r){s=s.twice2D();s.z=m.ONE;if(q.testBit(r)){if(p.testBit(r)){s=s.add2D(v)}else{s=s.add2D(u)}}else{if(p.testBit(r)){s=s.add2D(t)}}}return s}function l(v){var x=this;var w=null;var u=new i.get("util.srand")();var o={nextBytes:function(y){var A=u.bytes(y.length);for(var z=0;z<A.length;++z){y[z]=A[z]}}};this.sign=function(B,H){var E=H;var z=v.getN();var D=m.fromByteArrayUnsigned(B);var A=s(z);var F=v.getG();var C=F.multiply(A);var y=C.getX().toBigInteger().mod(z);var I=A.modInverse(z).multiply(D.add(E.multiply(y))).mod(z);if(I.compareTo(z.divide(m.valueOf(2)))>0){I=z.subtract(I)}return p(y,I)};this.verify=function(E,F,z){var B,y;if(Array.isArray(F)){var D=r(F);B=D.r;y=D.s}else{throw new Error("Invalid value for signature")}var A;if(z instanceof j){A=z}else{if(Array.isArray(z)){A=j.decodeFrom(v.getCurve(),z)}else{throw new Error("Invalid format for pubkey value, must be byte array or ECPointFp")}}var C=m.fromByteArrayUnsigned(E);return t(C,B,y,A)};function t(D,y,J,C){var B=v.getN();var I=v.getG();if(y.compareTo(m.ONE)<0||y.compareTo(B)>=0){return false}if(J.compareTo(m.ONE)<0||J.compareTo(B)>=0){return false}var E=J.modInverse(B);var A=D.multiply(E).mod(B);var z=y.multiply(E).mod(B);var F=I.multiply(A).add(C.multiply(z));var H=F.getX().toBigInteger().mod(B);return H.equals(y)}function q(B){if(B.length!==65){throw new Error("Signature has the wrong length")}var y=B[0]-27;if(y<0||y>7){throw new Error("Invalid signature type")}var C=v.getN();var A=m.fromByteArrayUnsigned(B.slice(1,33)).mod(C);var z=m.fromByteArrayUnsigned(B.slice(33,65)).mod(C);return{r:A,s:z,i:y}}function s(y){return new m(y.bitLength(),o).mod(y.subtract(m.ONE)).add(m.ONE)}function p(A,z){var B=A.toByteArraySigned();var y=z.toByteArraySigned();var C=[];C.push(2);C.push(B.length);C=C.concat(B);C.push(2);C.push(y.length);C=C.concat(y);C.unshift(C.length);C.unshift(48);return C}function r(D){var C;if(D[0]!=48){throw new Error("Signature not a valid DERSequence")}C=2;if(D[C]!=2){throw new Error("First element in signature must be a DERInteger")}var B=D.slice(C+2,C+2+D[C+1]);C+=2+D[C+1];if(D[C]!=2){throw new Error("Second element in signature must be a DERInteger")}var y=D.slice(C+2,C+2+D[C+1]);C+=2+D[C+1];var A=m.fromByteArrayUnsigned(B);var z=m.fromByteArrayUnsigned(y);return{r:A,s:z}}return this}return l}i.set("cipher.asymmetric.ec.ecdsa",function(k){var j=h(i.get("cipher.asymmetric.ec.ecurve"),i.get("cipher.asymmetric.ec.bigi"));return new j(k)})})(b);(function(h){function i(p){var t=this;var o=h.get("cipher.asymmetric.ec.ecparams"),l=h.get("cipher.asymmetric.ec.ecdsa"),q=h.get("cipher.asymmetric.ec.ecurve"),n=h.get("cipher.asymmetric.ec.bigi");var A=null,z=null;var B=o(p);if(!B){throw Error("unknown-ec-curve-name")}var s=l(B);function w(E){var F=new Array(E.length);for(var D=0;D<F.length;D++){F[D]=E[D]}return F}this.setPrivateKey=function(D){y(h.get("util.encoding")(D).toArray())};this.setPublicKey=function(D){v(h.get("util.encoding")(D).toArray())};function x(D){if(D){t.sign=C;t.decrypt=m;t._computeSecret=r}t.verify=k;t.encrypt=u;t.getPublicKey=function(){return new Uint8Array(z).buffer};delete t.setPrivateKey;delete t.setPublicKey}function v(D){A=null;z=D;x(false)}function y(E){A=n.fromByteArrayUnsigned(E);var D=B.getG().multiply(A);z=D.getEncoded(false);x(true)}function C(E){if(!h.get("util.type")(E).isArrayBuffer()){throw new Error("invalid-parameter")}var D=s.sign(h.get("util.encoding")(E).toArray(),A);return h.get("util.encoding")(D).toArrayBuffer()}function k(E,G){if(!(h.get("util.type")(E).isArrayBuffer()&&h.get("util.type")(G).isArrayBuffer())){throw new Error("invalid-parameter")}try{var H=h.get("util.encoding")(G).toArray(),I=h.get("util.encoding")(E).toArray();var D=s.verify(I,H,z)}catch(F){console.log(F);return false}return D}function r(E){if(!h.get("util.type")(E).isArrayBuffer()){throw Error("invalid-parameter")}var D=h.get("util.encoding")(E).toArray();var G=q.ECPointFp.decodeFrom(B.getCurve(),D);var F=G.multiply(A);var H=F.getEncoded().slice(1);return h.get("util.encoding")(H).toArrayBuffer()}function u(G){if(!h.get("util.type")(G).isArrayBuffer()){throw new Error("invalid-parameter")}var F=new i(p);F.setPrivateKey(new h.get("util.srand")().bytes(64));var J=F._computeSecret(t.getPublicKey()),I=F.getPublicKey();var D=new h.get("cipher.symmetric")().key(J),H=D.encrypt(G);var E=new Uint16Array([I.byteLength]);return h.get("util.buffer").concat([E.buffer,I,H])}function m(H){if(!(h.get("util.type")(H).isArrayBuffer()&&H.byteLength>2)){throw new Error("invalid-parameter")}var D=H.slice(0,2),H=H.slice(2);var F=new Uint16Array(D)[0];if(H.length<=F){throw new Error("invalid-ciphertext")}var K=H.slice(0,F),I=H.slice(F);var J=r(K);var G=new h.get("cipher.symmetric")().key(J);var E=G.decrypt(I);return E}return this}var j={name:"EC",constructor:function(k){return new i(k.curve)}};h.set("cipher.asymmetric.ec",j)})(b);(function(p){var j,h;"use strict";function r(u,t,v,s){this.curve=u;this.g=t;this.n=v;this.h=s}r.prototype.getCurve=function q(){return this.curve};r.prototype.getG=function o(){return this.g};r.prototype.getN=function k(){return this.n};r.prototype.getH=function m(){return this.h};function n(t){t=t.replace(/[^0-9a-f]/ig,"").toUpperCase();return new j(t,16)}var l={secp128r1:function(){var w=n("FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFF");var t=n("FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFC");var s=n("E87579C11079F43DD824993C2CEE5ED3");var y=n("FFFFFFFE0000000075A30D1B9038A115");var v=j.ONE;var x=new h(w,t,s);var u=x.decodePointHex("04161FF7528B899B2D0C28607CA52C5B86CF5AC8395BAFEB13C02DA292DDED7A83");return new r(x,u,y,v)},secp160k1:function(){var w=n("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFAC73");var t=j.ZERO;var s=n("7");var y=n("0100000000000000000001B8FA16DFAB9ACA16B6B3");var v=j.ONE;var x=new h(w,t,s);var u=x.decodePointHex("043B4C382CE37AA192A4019E763036F4F5DD4D7EBB938CF935318FDCED6BC28286531733C3F03C4FEE");return new r(x,u,y,v)},secp160r1:function(){var w=n("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFF");var t=n("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFC");var s=n("1C97BEFC54BD7A8B65ACF89F81D4D4ADC565FA45");var y=n("0100000000000000000001F4C8F927AED3CA752257");var v=j.ONE;var x=new h(w,t,s);var u=x.decodePointHex("044A96B5688EF573284664698968C38BB913CBFC8223A628553168947D59DCC912042351377AC5FB32");return new r(x,u,y,v)},secp192k1:function(){var w=n("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFEE37");var t=j.ZERO;var s=n("3");var y=n("FFFFFFFFFFFFFFFFFFFFFFFE26F2FC170F69466A74DEFD8D");var v=j.ONE;var x=new h(w,t,s);var u=x.decodePointHex("04DB4FF10EC057E9AE26B07D0280B7F4341DA5D1B1EAE06C7D9B2F2F6D9C5628A7844163D015BE86344082AA88D95E2F9D");return new r(x,u,y,v)},secp192r1:function(){var w=n("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFF");var t=n("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFC");var s=n("64210519E59C80E70FA7E9AB72243049FEB8DEECC146B9B1");var y=n("FFFFFFFFFFFFFFFFFFFFFFFF99DEF836146BC9B1B4D22831");var v=j.ONE;var x=new h(w,t,s);var u=x.decodePointHex("04188DA80EB03090F67CBF20EB43A18800F4FF0AFD82FF101207192B95FFC8DA78631011ED6B24CDD573F977A11E794811");return new r(x,u,y,v)},secp224r1:function(){var w=n("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF000000000000000000000001");var t=n("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFE");var s=n("B4050A850C04B3ABF54132565044B0B7D7BFD8BA270B39432355FFB4");var y=n("FFFFFFFFFFFFFFFFFFFFFFFFFFFF16A2E0B8F03E13DD29455C5C2A3D");var v=j.ONE;var x=new h(w,t,s);var u=x.decodePointHex("04B70E0CBD6BB4BF7F321390B94A03C1D356C21122343280D6115C1D21BD376388B5F723FB4C22DFE6CD4375A05A07476444D5819985007E34");return new r(x,u,y,v)},secp256k1:function(){var w=n("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F");var t=j.ZERO;var s=n("7");var y=n("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141");var v=j.ONE;var x=new h(w,t,s);var u=x.decodePointHex("0479BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8");return new r(x,u,y,v)},secp256r1:function(){var w=n("FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF");var t=n("FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC");var s=n("5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B");var y=n("FFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551");var v=j.ONE;var x=new h(w,t,s);var u=x.decodePointHex("046B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C2964FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5");return new r(x,u,y,v)},secp384r1:function(){var w=n("FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFe FFFFFFFF 00000000 00000000 FFFFFFFF");var t=n("FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFe FFFFFFFF 00000000 00000000 FFFFFFFC");var s=n("B3312FA7 E23EE7E4 988E056B E3F82D19 181D9C6E FE814112 0314088F 5013875A C656398D 8A2ED19D 2A85C8ED D3EC2AEF");var y=n("FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF C7634D81 F4372DDF 581A0DB2 48B0A77A ECEC196A CCC52973");var v=j.ONE;var x=new h(w,t,s);var u=x.decodePointHex("04AA87CA22 BE8B0537 8EB1C71E F320AD74 6E1D3B62 8BA79B98 59F741E0 82542A38 5502F25D BF55296C 3A545E38 72760AB73617DE4A 96262C6F 5D9E98BF 9292DC29 F8F41DBD 289A147C E9DA3113 B5F0B8C0 0A60B1CE 1D7E819D 7A431D7C 90EA0E5F");return new r(x,u,y,v)},secp521r1:function(){var w=n("    01FF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFF FFFFFFFF");var t=n("    01FF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFF FFFFFFFC");var s=n("    0051 953EB961 8E1C9A1F 929A21A0 B68540EE A2DA725B 99B315F3B8B48991 8EF109E1 56193951 EC7E937B 1652C0BD 3BB1BF07 3573DF883D2C34F1 EF451FD4 6B503F00");var y=n("    01FF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFA 51868783 BF2F966B 7FCC0148 F709A5D0 3BB5C9B8899C47AE BB6FB71E 91386409");var v=j.ONE;var x=new h(w,t,s);var u=x.decodePointHex("      04 00C6858E 06B70404 E9CD9E3E CB662395 B4429C64 8139053FB521F828 AF606B4D 3DBAA14B 5E77EFE7 5928FE1D C127A2FF A8DE3348B3C1856A 429BF97E 7E31C2E5 BD660118 39296A78 9A3BC004 5C8A5FB42C7D1BD9 98F54449 579B4468 17AFBD17 273E662C 97EE7299 5EF42640C550B901 3FAD0761 353C7086 A272C240 88BE9476 9FD16650");return new r(x,u,y,v)}};p.set("cipher.asymmetric.ec.ecparams",function i(s){if(!j){j=p.get("cipher.asymmetric.ec.bigi"),h=p.get("cipher.asymmetric.ec.ecurve")}return(typeof l[s]=="function")?l[s]():null})})(b);"use strict";(function(h){var n;function l(q,o){var p=q.toByteArrayUnsigned();if(o<p.length){p=p.slice(p.length-o)}else{while(o>p.length){p.unshift(0)}}return p}var k=function k(p,o){this.x=o;this.q=p};k.prototype.equals=function(o){if(o==this){return true}return(this.q.equals(o.q)&&this.x.equals(o.x))};k.prototype.toBigInteger=function(){return this.x};k.prototype.negate=function(){return new k(this.q,this.x.negate().mod(this.q))};k.prototype.add=function(o){return new k(this.q,this.x.add(o.toBigInteger()).mod(this.q))};k.prototype.subtract=function(o){return new k(this.q,this.x.subtract(o.toBigInteger()).mod(this.q))};k.prototype.multiply=function(o){return new k(this.q,this.x.multiply(o.toBigInteger()).mod(this.q))};k.prototype.square=function(){return new k(this.q,this.x.square().mod(this.q))};k.prototype.divide=function i(o){return new k(this.q,this.x.multiply(o.toBigInteger().modInverse(this.q)).mod(this.q))};k.prototype.getByteLength=function(){return Math.floor((this.toBigInteger().bitLength()+7)/8)};var j=function j(q,o,r,p){if(!n){n=h.get("cipher.asymmetric.ec.bigi")}this.curve=q;this.x=o;this.y=r;if(p==null){this.z=n.ONE}else{this.z=p}this.zinv=null};j.prototype.getX=function(){if(this.zinv==null){this.zinv=this.z.modInverse(this.curve.q)}return this.curve.fromBigInteger(this.x.toBigInteger().multiply(this.zinv).mod(this.curve.q))};j.prototype.getY=function(){if(this.zinv==null){this.zinv=this.z.modInverse(this.curve.q)}return this.curve.fromBigInteger(this.y.toBigInteger().multiply(this.zinv).mod(this.curve.q))};j.prototype.equals=function(o){if(o==this){return true}if(this.isInfinity()){return o.isInfinity()}if(o.isInfinity()){return this.isInfinity()}var q,p;q=o.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(o.z)).mod(this.curve.q);if(!q.equals(n.ZERO)){return false}p=o.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(o.z)).mod(this.curve.q);return p.equals(n.ZERO)};j.prototype.isInfinity=function(){if((this.x==null)&&(this.y==null)){return true}return this.z.equals(n.ZERO)&&!this.y.toBigInteger().equals(n.ZERO)};j.prototype.negate=function(){return new j(this.curve,this.x,this.y.negate(),this.z)};j.prototype.add=function(A){if(this.isInfinity()){return A}if(A.isInfinity()){return this}var E=A.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(A.z)).mod(this.curve.q);var D=A.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(A.z)).mod(this.curve.q);if(n.ZERO.equals(D)){if(n.ZERO.equals(E)){return this.twice()}return this.curve.getInfinity()}var y=new n("3");var r=this.x.toBigInteger();var C=this.y.toBigInteger();var p=A.x.toBigInteger();var z=A.y.toBigInteger();var B=D.square();var x=B.multiply(D);var q=r.multiply(B);var t=E.square().multiply(this.z);var o=t.subtract(q.shiftLeft(1)).multiply(A.z).subtract(x).multiply(D).mod(this.curve.q);var w=q.multiply(y).multiply(E).subtract(C.multiply(x)).subtract(t.multiply(E)).multiply(A.z).add(E.multiply(x)).mod(this.curve.q);var s=x.multiply(this.z).multiply(A.z).mod(this.curve.q);return new j(this.curve,this.curve.fromBigInteger(o),this.curve.fromBigInteger(w),s)};j.prototype.twice=function(){if(this.isInfinity()){return this}if(this.y.toBigInteger().signum()==0){return this.curve.getInfinity()}var t=new n("3");var p=this.x.toBigInteger();var u=this.y.toBigInteger();var r=u.multiply(this.z);var x=r.multiply(u).mod(this.curve.q);var v=this.curve.a.toBigInteger();var y=p.square().multiply(t);if(!n.ZERO.equals(v)){y=y.add(this.z.square().multiply(v))}y=y.mod(this.curve.q);var o=y.square().subtract(p.shiftLeft(3).multiply(x)).shiftLeft(1).multiply(r).mod(this.curve.q);var s=y.multiply(t).multiply(p).subtract(x.shiftLeft(1)).shiftLeft(2).multiply(x).subtract(y.square().multiply(y)).mod(this.curve.q);var q=r.square().multiply(r).shiftLeft(3).mod(this.curve.q);return new j(this.curve,this.curve.fromBigInteger(o),this.curve.fromBigInteger(s),q)};j.prototype.multiply=function(p){if(this.isInfinity()){return this}if(p.signum()==0){return this.curve.getInfinity()}var t=p;var s=t.multiply(new n("3"));var v=this.negate();var r=this;var q;for(q=s.bitLength()-2;q>0;--q){r=r.twice();var o=s.testBit(q);var u=t.testBit(q);if(o!=u){r=r.add(o?this:v)}}return r};j.prototype.multiplyTwo=function(q,o,p){var r;if(q.bitLength()>p.bitLength()){r=q.bitLength()-1}else{r=p.bitLength()-1}var t=this.curve.getInfinity();var s=this.add(o);while(r>=0){t=t.twice();if(q.testBit(r)){if(p.testBit(r)){t=t.add(s)}else{t=t.add(this)}}else{if(p.testBit(r)){t=t.add(o)}}--r}return t};j.prototype.getEncoded=function(r){if(this.isInfinity()){return[0]}var o=this.getX().toBigInteger();var s=this.getY().toBigInteger();var q=Math.floor((this.curve.getQ().bitLength()+7)/8);var p=l(o,q);if(r){if(s.isEven()){p.unshift(2)}else{p.unshift(3)}}else{p.unshift(4);p=p.concat(l(s,q))}return p};j.decodeFrom=function(u,q){var t=q[0];var s=q.length-1;var r=q.slice(1,1+s/2);var p=q.slice(1+s/2,1+s);r.unshift(0);p.unshift(0);var o=new n(r);var v=new n(p);return new j(u,u.fromBigInteger(o),u.fromBigInteger(v))};j.prototype.add2D=function(p){if(this.isInfinity()){return p}if(p.isInfinity()){return this}if(this.x.equals(p.x)){if(this.y.equals(p.y)){return this.twice()}return this.curve.getInfinity()}var t=p.x.subtract(this.x);var r=p.y.subtract(this.y);var o=r.divide(t);var q=o.square().subtract(this.x).subtract(p.x);var s=o.multiply(this.x.subtract(q)).subtract(this.y);return new j(this.curve,q,s)};j.prototype.twice2D=function(){if(this.isInfinity()){return this}if(this.y.toBigInteger().signum()==0){return this.curve.getInfinity()}var p=this.curve.fromBigInteger(n.valueOf(2));var s=this.curve.fromBigInteger(n.valueOf(3));var o=this.x.square().multiply(s).add(this.curve.a).divide(this.y.multiply(p));var q=o.square().subtract(this.x.multiply(p));var r=o.multiply(this.x.subtract(q)).subtract(this.y);return new j(this.curve,q,r)};j.prototype.multiply2D=function(p){if(this.isInfinity()){return this}if(p.signum()==0){return this.curve.getInfinity()}var t=p;var s=t.multiply(new n("3"));var v=this.negate();var r=this;var q;for(q=s.bitLength()-2;q>0;--q){r=r.twice();var o=s.testBit(q);var u=t.testBit(q);if(o!=u){r=r.add2D(o?this:v)}}return r};j.prototype.isOnCurve=function(){if(this.isInfinity()){return true}var p=this.getX().toBigInteger();var u=this.getY().toBigInteger();var r=this.curve.getA().toBigInteger();var o=this.curve.getB().toBigInteger();var t=this.curve.getQ();var q=u.multiply(u).mod(t);var s=p.multiply(p).multiply(p).add(r.multiply(p)).add(o).mod(t);return q.equals(s)};j.prototype.toString=function(){if(this.isInfinity()){return"(INFINITY)"}return"("+this.getX().toBigInteger().toString()+","+this.getY().toBigInteger().toString()+")"};j.prototype.validate=function(){var q=this.curve.getQ();if(this.isInfinity()){throw new Error("Point is at infinity.")}var o=this.getX().toBigInteger();var p=this.getY().toBigInteger();if(o.compareTo(n.ONE)<0||o.compareTo(q.subtract(n.ONE))>0){throw new Error("x coordinate out of bounds")}if(p.compareTo(n.ONE)<0||p.compareTo(q.subtract(n.ONE))>0){throw new Error("y coordinate out of bounds")}if(!this.isOnCurve()){throw new Error("Point is not on the curve.")}if(this.multiply(q).isInfinity()){throw new Error("Point is not a scalar multiple of G.")}return true};var m=function m(r,p,o){this.q=r;this.a=this.fromBigInteger(p);this.b=this.fromBigInteger(o);this.infinity=new j(this,null,null)};m.prototype.getQ=function(){return this.q};m.prototype.getA=function(){return this.a};m.prototype.getB=function(){return this.b};m.prototype.equals=function(o){if(o==this){return true}return(this.q.equals(o.q)&&this.a.equals(o.a)&&this.b.equals(o.b))};m.prototype.getInfinity=function(){return this.infinity};m.prototype.fromBigInteger=function(o){return new k(this.q,o)};m.prototype.decodePointHex=function(r){r=r.replace(/[^0-9a-f]/ig,"");switch(parseInt(r.substr(0,2),16)){case 0:return this.infinity;case 2:case 3:return null;case 4:case 6:case 7:var o=(r.length-2)/2;var q=r.substr(2,o);var p=r.substr(o+2,o);return new j(this,this.fromBigInteger(new n(q,16)),this.fromBigInteger(new n(p,16)));default:return null}};m.ECPointFp=j;h.set("cipher.asymmetric.ec.ecurve",m)})(b);(function(h){var l={};var i={NECRAC256:{name:"NECRAC256",secretLength:64,sign:{algorithm:"ec",parameters:{curve:"secp521r1"},secretLength:64},crypt:{algorithm:"ec",parameters:{curve:"secp521r1"},secretLength:64},hashAlgorithm:"WHIRLPOOL"},NECRAC192:{name:"NECRAC192",secretLength:48,sign:{algorithm:"ec",parameters:{curve:"secp384r1"},secretLength:48},crypt:{algorithm:"ec",parameters:{curve:"secp384r1"},secretLength:48},hashAlgorithm:"BLAKE2s"},NECRAC128:{name:"NECRAC128",secretLength:32,sign:{algorithm:"ec",parameters:{curve:"secp256r1"},secretLength:32},crypt:{algorithm:"ec",parameters:{curve:"secp256k1"},secretLength:32},hashAlgorithm:"BLAKE2s"},NECRAC112:{name:"NECRAC112",secretLength:28,sign:{algorithm:"ec",parameters:{curve:"secp224r1"},secretLength:28},crypt:{algorithm:"ec",parameters:{curve:"secp224r1"},secretLength:28},hashAlgorithm:"RIPEMD160"},NECRAC96:{name:"NECRAC96",secretLength:24,sign:{algorithm:"ec",parameters:{curve:"secp192k1"},secretLength:24},crypt:{algorithm:"ec",parameters:{curve:"secp192r1"},secretLength:24},hashAlgorithm:"RIPEMD160"}};function m(s){var z=this;var t=i[s];var x,r;if(!t){throw new Error("invalid-algorithm-choice")}function n(B){var A=new h.get("hash")(t.hashAlgorithm);return A.hash(B).buffer}function w(A){var B=h.get("cipher.asymmetric."+A.algorithm).constructor;return B(A.parameters)}x=w(t.sign);r=w(t.crypt);function y(A){if(A){z.sign=p;z.decrypt=o}z.verify=v;z.encrypt=u;z.getPublicKey=q;delete z.setPrivateKey;delete z.setPublicKey}function q(){var B=x.getPublicKey(),A=r.getPublicKey();return h.get("util.buffer").concat([new Uint16Array([B.byteLength]).buffer,B,A])}function p(B){if(!h.get("util.type")(B).isArrayBuffer()){throw new Error("invalid-parameter")}var A=n(B);return x.sign(A)}function v(C,A){if(!(h.get("util.type")(C).isArrayBuffer()&&h.get("util.type")(A).isArrayBuffer())){throw new Error("invalid-parameter")}var B=n(C);return x.verify(B,A)}function u(A){if(!h.get("util.type")(A).isArrayBuffer()){throw new Error("invalid-parameter")}return r.encrypt(A)}function o(A){if(!h.get("util.type")(A).isArrayBuffer()){throw new Error("invalid-parameter")}return r.decrypt(A)}this.setPrivateKey=function(A){if(!h.get("util.type")(A).isArrayBuffer()){throw new Error("invalid-parameter")}var E=new h.get("hash")(t.hashAlgorithm).pbkdf2;var D=E(A,h.get("util.encoding")("derivation-of-signing-key","ascii").toArrayBuffer(),4,t.sign.secretLength);var B=E(A,h.get("util.encoding")("derivation-of-encrypting-key","ascii").toArrayBuffer(),4,t.crypt.secretLength);try{x.setPrivateKey(D);r.setPrivateKey(B)}catch(C){throw new Error("invalid-private-key")}y(true)};this.setPublicKey=function(B){if(!(h.get("util.type")(B).isArrayBuffer()&&B.byteLength>2)){throw new Error("invalid-public-key")}var C=new Uint16Array(B.slice(0,2))[0];B=B.slice(2);if(B.byteLength<=C){throw new Error("invalid-public-key")}var E=B.slice(0,C),A=B.slice(C);try{x.setPublicKey(E);r.setPublicKey(A)}catch(D){throw new Error("invalid-public-key")}y(false)};return this}function j(n){if(n){h.get("util.log").notice("Load asymmetric cipher component: ["+n.name+"]");l[n.name]=n.constructor;return}if("undefined"!=typeof l.EC){h.get("util.log").notice("Asymmetric ciphers ready.");return function(o){return new m(o)}}return null}var k=function(n){return new m(n)};h.set("cipher.asymmetric",k);h.set("cipher.asymmetric.definition",function(n){return i[n]||null});h.exp("cipher.asymmetric",k)})(b);(function(h){function i(){var D=16;var E=4;var r=4;var n=[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22];var q=[82,9,106,213,48,54,165,56,191,64,163,158,129,243,215,251,124,227,57,130,155,47,255,135,52,142,67,68,196,222,233,203,84,123,148,50,166,194,35,61,238,76,149,11,66,250,195,78,8,46,161,102,40,217,36,178,118,91,162,73,109,139,209,37,114,248,246,100,134,104,152,22,212,164,92,204,93,101,182,146,108,112,72,80,253,237,185,218,94,21,70,87,167,141,157,132,144,216,171,0,140,188,211,10,247,228,88,5,184,179,69,6,208,44,30,143,202,63,15,2,193,175,189,3,1,19,138,107,58,145,17,65,79,103,220,234,151,242,207,206,240,180,230,115,150,172,116,34,231,173,53,133,226,249,55,232,28,117,223,110,71,241,26,113,29,41,197,137,111,183,98,14,170,24,190,27,252,86,62,75,198,210,121,32,154,219,192,254,120,205,90,244,31,221,168,51,136,7,199,49,177,18,16,89,39,128,236,95,96,81,127,169,25,181,74,13,45,229,122,159,147,201,156,239,160,224,59,77,174,42,245,176,200,235,187,60,131,83,153,97,23,43,4,126,186,119,214,38,225,105,20,99,85,33,12,125];var C=[0,16777216,33554432,67108864,134217728,268435456,536870912,1073741824,2147483648,452984832,905969664];function F(H,G){var J=0;var I;while(H){if((H&1)){J=J^G}I=G&128;G<<=1;if(I){G^=27}H>>=1}return J}function o(I){var H=new Array(256);for(var G=0;G<256;G++){H[G]=F(I,G)&255}return H}var A=o(2);var y=o(3);var s=o(9);var z=o(11);var x=o(13);var w=o(14);function B(G){var H=n;return(H[G>>>24]<<24|H[(G>>>16)&255]<<16|H[(G>>>8)&255]<<8|H[G&255])}function u(G){return G>>>24|G<<8}function p(G){return G>>>24|(G&16711680)>>>8|(G&65280)<<8|(G&255)<<24}var t=((new Uint8Array((new Uint32Array([1])).buffer))[0]==1);function v(M){var G=C;var I=new Uint8Array(M);var K=I.length/4;var N=K+6;var H=new Uint32Array(r*(N+1));for(var L=0;L<K;L++){H[L]=(I[L*4]<<24|I[L*4+1]<<16|I[L*4+2]<<8|I[L*4+3])}for(var L=K;L<r*(N+1);L++){var J=H[L-1];if(L%K==0){J=B(u(J))^G[L/K]}else{if(K>6&&L%K==4){J=B(J)}}H[L]=H[L-K]^J}if(t){for(var L=0;L<H.length;L++){H[L]=p(H[L])}}return H}function l(G,P){var M=(P.length/r-1)*4;var T,R,O,N;var K,J,I,H;var W,V,S,Q;var L=n;T=(G[0]^P[0])>>>0;R=(G[1]^P[1])>>>0;O=(G[2]^P[2])>>>0;N=(G[3]^P[3])>>>0;for(var U=4;U<M;U+=4){K=T;J=R;I=O;H=N;W=L[K&255]>>>0;V=L[(J>>>8)&255]>>>0;S=L[(I>>>16)&255]>>>0;Q=L[H>>>24]>>>0;T=(((A[W]^y[V]^S^Q)|(W^A[V]^y[S]^Q)<<8|(W^V^A[S]^y[Q])<<16|(y[W]^V^S^A[Q])<<24)^P[U])>>>0;W=L[J&255]>>>0;V=L[(I>>>8)&255]>>>0;S=L[(H>>>16)&255]>>>0;Q=L[K>>>24]>>>0;R=(((A[W]^y[V]^S^Q)|(W^A[V]^y[S]^Q)<<8|(W^V^A[S]^y[Q])<<16|(y[W]^V^S^A[Q])<<24)^P[U+1])>>>0;W=L[I&255]>>>0;V=L[(H>>>8)&255]>>>0;S=L[(K>>>16)&255]>>>0;Q=L[J>>>24]>>>0;O=(((A[W]^y[V]^S^Q)|(W^A[V]^y[S]^Q)<<8|(W^V^A[S]^y[Q])<<16|(y[W]^V^S^A[Q])<<24)^P[U+2])>>>0;W=L[H&255]>>>0;V=L[(K>>>8)&255]>>>0;S=L[(J>>>16)&255]>>>0;Q=L[I>>>24]>>>0;N=(((A[W]^y[V]^S^Q)|(W^A[V]^y[S]^Q)<<8|(W^V^A[S]^y[Q])<<16|(y[W]^V^S^A[Q])<<24)^P[U+3])>>>0}G[0]=P[M]^(L[T&255]|L[(R>>>8)&255]<<8|L[(O>>>16)&255]<<16|L[N>>>24]<<24);G[1]=P[M+1]^(L[R&255]|L[(O>>>8)&255]<<8|L[(N>>>16)&255]<<16|L[T>>>24]<<24);G[2]=P[M+2]^(L[O&255]|L[(N>>>8)&255]<<8|L[(T>>>16)&255]<<16|L[R>>>24]<<24);G[3]=P[M+3]^(L[N&255]|L[(T>>>8)&255]<<8|L[(R>>>16)&255]<<16|L[O>>>24]<<24)}function m(G,P){var H=q;var M=(P.length/r-1)*4;var R,Q,O,N;var L,K,J,I;R=(G[0]^P[M])>>>0;Q=(G[1]^P[M+1])>>>0;O=(G[2]^P[M+2])>>>0;N=(G[3]^P[M+3])>>>0;for(var S=M-4;S>0;S-=4){L=R;K=Q;J=O;I=N;R=((H[L&255]|H[(I>>>8)&255]<<8|H[(J>>>16)&255]<<16|H[K>>>24]<<24)^P[S])>>>0;Q=((H[K&255]|H[(L>>>8)&255]<<8|H[(I>>>16)&255]<<16|H[J>>>24]<<24)^P[S+1])>>>0;O=((H[J&255]|H[(K>>>8)&255]<<8|H[(L>>>16)&255]<<16|H[I>>>24]<<24)^P[S+2])>>>0;N=((H[I&255]|H[(J>>>8)&255]<<8|H[(K>>>16)&255]<<16|H[L>>>24]<<24)^P[S+3])>>>0;L=R&255>>>0;K=((R>>>8)&255)>>>0;J=((R>>>16)&255)>>>0;I=R>>>24;R=((w[L]^z[K]^x[J]^s[I])|(s[L]^w[K]^z[J]^x[I])<<8|(x[L]^s[K]^w[J]^z[I])<<16|(z[L]^x[K]^s[J]^w[I])<<24)>>>0;L=(Q&255)>>>0;K=((Q>>>8)&255)>>>0;J=((Q>>>16)&255)>>>0;I=Q>>>24;Q=((w[L]^z[K]^x[J]^s[I])|(s[L]^w[K]^z[J]^x[I])<<8|(x[L]^s[K]^w[J]^z[I])<<16|(z[L]^x[K]^s[J]^w[I])<<24)>>>0;L=(O&255)>>>0;K=((O>>>8)&255)>>>0;J=((O>>>16)&255)>>>0;I=O>>>24;O=((w[L]^z[K]^x[J]^s[I])|(s[L]^w[K]^z[J]^x[I])<<8|(x[L]^s[K]^w[J]^z[I])<<16|(z[L]^x[K]^s[J]^w[I])<<24)>>>0;L=(N&255)>>>0;K=((N>>>8)&255)>>>0;J=((N>>>16)&255)>>>0;I=N>>>24;N=((w[L]^z[K]^x[J]^s[I])|(s[L]^w[K]^z[J]^x[I])<<8|(x[L]^s[K]^w[J]^z[I])<<16|(z[L]^x[K]^s[J]^w[I])<<24)>>>0}G[0]=P[0]^(H[R&255]|H[(N>>>8)&255]<<8|H[(O>>>16)&255]<<16|H[Q>>>24]<<24);G[1]=P[1]^(H[Q&255]|H[(R>>>8)&255]<<8|H[(N>>>16)&255]<<16|H[O>>>24]<<24);G[2]=P[2]^(H[O&255]|H[(Q>>>8)&255]<<8|H[(R>>>16)&255]<<16|H[N>>>24]<<24);G[3]=P[3]^(H[N&255]|H[(O>>>8)&255]<<8|H[(Q>>>16)&255]<<16|H[R>>>24]<<24)}return{block_size_bytes:D,block_size_words:E,endian_swap32:p,is_little_endian:t,key_expansion:v,cipher:l,inv_cipher:m}}function k(){var l=this;var n=new i(),o;function m(r){if(!(h.get("util.type")(r).isArrayBuffer()&&0==r.byteLength%n.block_size_bytes)){throw new Error("invalid-input")}var v=new Uint32Array(r);var x=new Uint32Array(v.length);var t=new Uint32Array(n.block_size_words);var q=n.key_expansion(o);var u,s;for(u=0;u<v.length;u+=n.block_size_words){for(s=0;s<n.block_size_words;s++){t[s]=v[u+s]}n.cipher(t,q);x.set(t,u)}return x.buffer}function p(r){if(!(h.get("util.type")(r).isArrayBuffer()&&0==r.byteLength%n.block_size_bytes)){throw new Error("invalid-input")}var v=new Uint32Array(r);var x=new Uint32Array(v.length);var t=new Uint32Array(n.block_size_words);var y=new Uint32Array(n.block_size_words);var q=n.key_expansion(o),u,s;for(u=0;u<v.length;u+=n.block_size_words){for(s=0;s<n.block_size_words;s++){y[s]=v[u+s]}t.set(y);n.inv_cipher(t,q);x.set(t,u)}return x.buffer}this.key=function(r){if(!h.get("util.type")(r).isArrayBuffer()){throw new Error("invalid-key")}var q=r.byteLength;if(q>32){r=r.slice(0,32)}else{if(q>24){r=r.slice(0,24)}else{if(q>16){r=r.slice(0,16)}else{throw new Error("invalid-key-length")}}}o=new Uint32Array(r);l.encrypt=m;l.decrypt=p;delete l.key;return l};return this}var j={name:"AESECB",constructor:function(){return new k()}};h.set("cipher.symmetric.aes",j)})(b);(function(i){function h(v){var w=this;if(!v||v<10){v=10}var u=new Uint32Array(16);function n(C,z){function B(E,D){return(((E)<<(D))|((E)>>>(32-(D))))}var A;var y=u;for(A=0;A<16;A++){y[A]=C[A]}for(A=0;A<v;A++){y[4]^=B(y[0]+y[12],7);y[8]^=B(y[4]+y[0],9);y[12]^=B(y[8]+y[4],13);y[0]^=B(y[12]+y[8],18);y[9]^=B(y[5]+y[1],7);y[13]^=B(y[9]+y[5],9);y[1]^=B(y[13]+y[9],13);y[5]^=B(y[1]+y[13],18);y[14]^=B(y[10]+y[6],7);y[2]^=B(y[14]+y[10],9);y[6]^=B(y[2]+y[14],13);y[10]^=B(y[6]+y[2],18);y[3]^=B(y[15]+y[11],7);y[7]^=B(y[3]+y[15],9);y[11]^=B(y[7]+y[3],13);y[15]^=B(y[11]+y[7],18);y[1]^=B(y[0]+y[3],7);y[2]^=B(y[1]+y[0],9);y[3]^=B(y[2]+y[1],13);y[0]^=B(y[3]+y[2],18);y[6]^=B(y[5]+y[4],7);y[7]^=B(y[6]+y[5],9);y[4]^=B(y[7]+y[6],13);y[5]^=B(y[4]+y[7],18);y[11]^=B(y[10]+y[9],7);y[8]^=B(y[11]+y[10],9);y[9]^=B(y[8]+y[11],13);y[10]^=B(y[9]+y[8],18);y[12]^=B(y[15]+y[14],7);y[13]^=B(y[12]+y[15],9);y[14]^=B(y[13]+y[12],13);y[15]^=B(y[14]+y[13],18)}for(A=0;A<16;A++){z[A]=y[A]+C[A]}}var q=new Uint32Array(16);function m(z,B){var y=q,A=new Uint32Array([1634760805,857760878,2036477234,1797285236]);y[0]=A[0];y[1]=B[0];y[2]=B[1];y[3]=B[2];y[4]=B[3];y[5]=A[1];y[6]=z[0];y[7]=z[1];y[10]=A[2];y[11]=B[4];y[12]=B[5];y[13]=B[6];y[14]=B[7];y[15]=A[3]}function o(A,z){var y=q;y[8]=A[0];y[9]=A[1];return n(y,z)}function m(A,z){var y=q;tau=new Uint32Array([1634760805,824206446,2036477238,1797285236]);y[0]=tau[0];y[1]=z[0];y[2]=z[1];y[3]=z[2];y[4]=z[3];y[5]=tau[1];y[6]=A[0];y[7]=A[1];y[10]=tau[2];y[11]=z[0];y[12]=z[1];y[13]=z[2];y[14]=z[3];y[15]=tau[3]}function s(A,z){var y=q;y[8]=A[0];y[9]=A[1];return n(y,z)}var k=new Uint32Array(2);var r;function t(){k[0]=0;k[1]=0}function x(){k[0]+=1;if(0==k[0]){k[1]+=1}}function p(y,B){var A=new Uint32Array(y);if(32==B.byteLength){var z=new Uint32Array(B);m(A,z);r=(function(){return function(C){o(k,C);x()}})()}else{if(16==B.byteLength){var z=new Uint32Array(B);_salsa20BufferFillKey4(A,z);r=(function(){return function(C){s(k,C);x()}})()}else{throw new Error("invalid-key-length")}}}function l(E){if(!i.get("util.type")(E).isArrayBuffer()){throw new Error("invalid-input")}var y=E.byteLength,C=Math.ceil(y/64),z=new Uint32Array(16);var F=new Uint8Array(E),G=new Uint8Array(F.length+64);var D=0,B,A;t();for(B=0;B<C;B++){r(z);for(A=0;A<16;A++){G[D++]=(z[A]>>24)&255;G[D++]=(z[A]>>16)&255;G[D++]=(z[A]>>8)&255;G[D++]=z[A]&255}}for(B=0;B<y;B++){F[B]^=G[B]}return F.buffer}this.key=function(z){if(!i.get("util.type")(z).isArrayBuffer()){throw new Error("invalid-key")}var A=z.byteLength;if(A<24){throw new Error("invalid-key")}var y=z.slice(0,8);if(A<40){p(y,z.slice(8,24))}else{p(y,z.slice(8,40))}w.encrypt=l;w.decrypt=l;delete w.key;return w};return this}var j={name:"Salsa20/20",constructor:function(){return new h(20)}};i.set("cipher.symmetric.salsa20",j)})(b);(function(j){function i(){var w=this;function v(z,B){var D=z.byteLength,C=B-(D%B),E=D+C,y=new Uint8Array(z),x=new Uint8Array(E);for(var A=0;A<E;A++){if(A<D){x[A]=y[A]}else{x[A]=C}}return x.buffer}function u(y){var x=new Uint8Array(y);var z=x[x.length-1];if(x.length<z){return null}return y.slice(0,y.byteLength-z)}function r(x){return x}function o(x){return x}var q=null;function s(A,y,B){var D=64;var C=new j.get("hash")("BLAKE2s").pbkdf2(A,y,4,B*D);var x=new Array(B);for(var z=0;z<B;z++){x[z]=new j.get("hash")("WHIRLPOOL").hash(C.slice(z*D,(z+1)*D)).buffer}return x}var t=function(z){if(!j.get("util.type")(z).isArrayBuffer()){throw new Error("invalid-parameter")}var y=new j.get("util.srand")().bytes(10);var A=s(q,y,5);var B=new j.get("hash")("BLAKE2s",{length:6}).mac(z,A[0]).buffer;z=j.get("util.buffer").concat([B,z]);var x=z;x=r(x);x=v(x,16);x=h(A[1],x);x=n(A[2],x);return j.get("util.buffer").concat([y,x])};var p=function(z){if(!(j.get("util.type")(z).isArrayBuffer()&&z.byteLength>=26)){throw new Error("invalid-parameter")}var B=z.slice(0,10);z=z.slice(10);var C=s(q,B,5);var y=z;y=l(C[2],y);y=k(C[1],y);y=u(y,16);if(!j.get("util.type")(y).isArrayBuffer()){return null}y=o(y);if(!j.get("util.type")(y).isArrayBuffer()){return null}var A=y.slice(0,6);y=y.slice(6);var x=new j.get("hash")("BLAKE2s",{length:6}).mac(y,C[0]).buffer;if(j.get("util.buffer").equal(A,x)){return y}return null};this.key=function(x){if(!j.get("util.type")(x).isArrayBuffer()){throw new Error("invalid-key")}q=x;delete w.key;w.encrypt=t;w.decrypt=p;return w};return this}var n=function(o,q){try{var p=j.get("cipher.symmetric.aes").constructor;return p().key(o).encrypt(q)}catch(r){j.get("util.log").error(r);return new Error("unable-to-encrypt",r)}};var l=function(o,q){try{var p=j.get("cipher.symmetric.aes").constructor;return p().key(o).decrypt(q)}catch(r){j.get("util.log").error(r);return new Error("unable-to-decrypt",r)}};var h=function(o,p){try{var r=j.get("cipher.symmetric.salsa20").constructor;return r().key(o).encrypt(p)}catch(q){j.get("util.log").error(q);return new Error("unable-to-encrypt")}};var k=function(o,p){try{var r=j.get("cipher.symmetric.salsa20").constructor;return r().key(o).decrypt(p)}catch(q){j.get("util.log").error(q);return new Error("unable-to-decrypt",q)}};function m(){return new i()}j.set("cipher.symmetric",m);j.exp("cipher.symmetric",m)})(b);(function(h){})(b);(function(h){function i(){var j=this;return this}})(b);(function(i){var k={algorithmName:"NECRAC128"};var j={_:["constant",new Uint8Array([69,73]).buffer],subject:"shortBinary",algorithm:["enum",["NECRAC96","NECRAC112","NECRAC128","NECRAC192","NECRAC256"]],"public":"binary",secret:"shortBinary",signature:"binary"};function h(){var w=this;var o=i.get("hash");var y=i.get("util.buffer");var l=i.get("cipher.asymmetric.definition");var A,p,r,u,t,B;function q(){return o("BLAKE2s").mac(r,A)}function n(D){}this.generate=function(F,E){if(!/^[0-9a-z\s]{8, 255}$/i.test(F)){throw new Error("invalid-subject")}A=i.get("util.encoding")(F,"ascii").toArrayBuffer();u=E.algorithm||k.algorithmName;var D=l(algoirthmName);if(!D){u=k.algorithmName;D=l(algorithmname)}p=i.get("util.srand")().bytes(D.secretLength);B=i.get("cipher.asymmetric")(D.name);B.setPrivateKey(p);r=B.getPublicKey();t=B.sign(q());n(true)};this.loadPublic=function(D){};this.loadPrivate=function(E,D){};function z(){}function s(D){}function v(E,D){}function C(D){}function x(D){}function m(D){}return this}})(b);(function(h){function i(){var l=this;this.write=function(q){};this.read=function(q){};function k(q){}function p(q){}function n(){}function m(q){}function o(q){}return this}function j(){return new i()}h.exp("enigma.message",j)})(b);var c=b.get("util.serialize")({_:["constant","hi"],name:"shortBinary"});var f=c.serialize({name:new Uint8Array([1,1,2,3,4,5,6,7,8]).buffer});console.log(f.byteLength+" bytes used");var g=c.deserialize(f);console.log(g);if("undefined"!=typeof module&&"undefined"!=module.exports){module.exports=e}else{define([],function(){return e})}})();